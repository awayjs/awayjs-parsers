require=function e(a,t,r){function s(n,o){if(!t[n]){if(!a[n]){var l=typeof require=="function"&&require;if(!o&&l)return l(n,!0);if(i)return i(n,!0);var d=new Error("Cannot find module '"+n+"'");throw d.code="MODULE_NOT_FOUND",d}var h=t[n]={exports:{}};a[n][0].call(h.exports,function(e){var t=a[n][1][e];return s(t?t:e)},h,h.exports,e,a,t,r)}return t[n].exports}var i=typeof require=="function"&&require;for(var n=0;n<r.length;n++)s(r[n]);return s}({"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":[function(e,a,t){var r=e("awayjs-core/lib/errors/AbstractMethodError");var s=function(){function e(){}Object.defineProperty(e.prototype,"awd_file_data",{get:function(){return this._awd_file_data},set:function(e){this._awd_file_data=e},enumerable:true,configurable:true});e.prototype.parseFromBytes=function(){throw new r};return e}();a.exports=s},{"awayjs-core/lib/errors/AbstractMethodError":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers":[function(e,a,t){var r=e("awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser");var s=e("awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser");var i=e("awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser");var n=e("awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser");var o=e("awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser");var l=e("awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser");var d=e("awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser");var h=e("awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser");var c=e("awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser");var p=e("awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser");var _=e("awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser");var u=e("awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser");var f=e("awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser");var y=e("awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser");var w=e("awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser");var b=e("awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser");var m=e("awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser");var v=e("awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser");var g=e("awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser");var B=e("awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser");var k=e("awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser");var D=e("awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser");var A=e("awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser");var P=e("awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser");var j=e("awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser");var N=e("awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser");var M=e("awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser");var T=e("awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser");var S=function(){function e(){this._supported_asset_blocks={};this._all_block_parsers=new Array;this.add_block_parser(new r,[1]);this.add_block_parser(new s,[11]);this.add_block_parser(new i,[22]);this.add_block_parser(new n,[23,24]);this.add_block_parser(new o,[25]);this.add_block_parser(new v,[31]);this.add_block_parser(new c,[41]);this.add_block_parser(new d,[42]);this.add_block_parser(new T,[44]);this.add_block_parser(new p,[51]);this.add_block_parser(new _,[81]);this.add_block_parser(new l,[82]);this.add_block_parser(new h,[83]);this.add_block_parser(new y,[91]);this.add_block_parser(new f,[92]);this.add_block_parser(new b,[101]);this.add_block_parser(new m,[102]);this.add_block_parser(new w,[103]);this.add_block_parser(new A,[111,112]);this.add_block_parser(new D,[113]);this.add_block_parser(new M,[122]);this.add_block_parser(new u,[133]);this.add_block_parser(new B,[134]);this.add_block_parser(new g,[135]);this.add_block_parser(new k,[136]);this.add_block_parser(new P,[253]);this.add_block_parser(new N,[254]);this.add_block_parser(new j,[255])}e.prototype.add_block_parser=function(e,a){for(var t=0;t<a.length;t++){this._supported_asset_blocks[a[t]]=e}this._all_block_parsers.push(e)};e.prototype.init_parser=function(e){for(var a=0;a<this._all_block_parsers.length;a++){this._all_block_parsers[a].awd_file_data=e}};e.prototype.parseAsset=function(e){var a=this._supported_asset_blocks[e];if(a!=undefined){a.parseFromBytes();return true}return false};return e}();a.exports=S},{"awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser","awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser","awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser","awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser","awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser","awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser","awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser","awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser","awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser","awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser","awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser","awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser","awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser","awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser","awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser","awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser","awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser","awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser","awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser","awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser","awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser","awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser","awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser":"awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser"}],"awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-renderergl/lib/animators/VertexAnimator");var n=e("awayjs-renderergl/lib/animators/SkeletonAnimator");var o=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var l=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var t=this.awd_file_data.newBlockBytes.readUnsignedShort();var r=this.awd_file_data.parseProperties({1:o.BADDR});e=this.awd_file_data.newBlockBytes.readUnsignedInt();var s=this.awd_file_data.newBlockBytes.readUnsignedShort();var l=new Array;for(var d=0;d<s;d++)l.push(this.awd_file_data.newBlockBytes.readUnsignedInt());var h=this.awd_file_data.newBlockBytes.readUnsignedShort();var c=this.awd_file_data.newBlockBytes.readUnsignedByte()==1;this.awd_file_data.parseUserAttributes();this.awd_file_data.parseUserAttributes();var p;var _=new Array;for(d=0;d<l.length;d++){var u=this.awd_file_data.getAssetByID(l[d]);if(u!=undefined)_.push(u)}var a=this.awd_file_data.getAssetByID(e);if(a==undefined){return undefined}var f;if(t==1){var y=this.awd_file_data.getAssetByID(r.get(1,0));if(y==undefined){return}f=new n(a,y)}else if(t==2)f=new i(a);for(d=0;d<_.length;d++){if(t==1)_[d].animator=f;if(t==2)_[d].animator=f}this.awd_file_data.cur_block.data=f;if(this.awd_file_data.debug)console.log("Parsed a Animator: Name = "+this.awd_file_data.cur_block.name)};return a}(s);a.exports=l},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-renderergl/lib/animators/SkeletonAnimator":undefined,"awayjs-renderergl/lib/animators/VertexAnimator":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/utils/ByteArray");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var e=this.awd_file_data.newBlockBytes.readUnsignedByte();var a;if(e==0){a=this.awd_file_data.newBlockBytes.readUnsignedInt();var t;t=this.awd_file_data.newBlockBytes.readUTFBytes(a);this.awd_file_data.cur_block.dependencies_urls.push(t)}else{a=this.awd_file_data.newBlockBytes.readUnsignedInt();var r;r=new s;this.awd_file_data.newBlockBytes.readBytes(r,0,a);this.awd_file_data.cur_block.dependencies_data.push(r)}this.awd_file_data.cur_block.state=n.BLOCKSTATE_LOAD_DEPENDENICES;this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug){var i=["external","embed"];console.log("Start parsing a "+i[e]+" AudioFile")}};return a}(i);a.exports=o},{"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-display/lib/entities/Billboard");var n=e("awayjs-display/lib/materials/BasicMaterial");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var e=this.awd_file_data.newBlockBytes.readUnsignedInt();var a=this.awd_file_data.getAssetByID(e);if(a==undefined){a=new n}a.bothSides=true;var t=new i(a);this.awd_file_data.cur_block.data=t;this.awd_file_data.parseProperties(null);t.extra=this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug){console.log("Parsed a Library-Billboard: Name = '"+t.name+"| Material-Name = "+a.name)}};return a}(s);a.exports=o},{"awayjs-display/lib/entities/Billboard":undefined,"awayjs-display/lib/materials/BasicMaterial":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase"}],"awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.state=i.BLOCKSTATE_NO_ASSET;var e=this.awd_file_data.newBlockBytes.readUnsignedByte();var a=this.awd_file_data.parseVarStr();if(this.awd_file_data.debug)console.log("Parsed a NameSpaceBlock: ID = "+e+" | String = "+a)};return a}(s);a.exports=n},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-display/lib/entities/Camera");var n=e("awayjs-core/lib/projections/PerspectiveProjection");var o=e("awayjs-core/lib/projections/OrthographicProjection");var l=e("awayjs-core/lib/projections/OrthographicOffCenterProjection");var d=e("awayjs-core/lib/geom/Vector3D");var h=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var c=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=this.awd_file_data.newBlockBytes.readUnsignedInt();var a=this.awd_file_data.parseMatrix3D();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var t="Root (TopLevel)";var r;this.awd_file_data.newBlockBytes.readUnsignedByte();this.awd_file_data.newBlockBytes.readShort();var s=this.awd_file_data.newBlockBytes.readShort();var c=this.awd_file_data.parseProperties({101:this.awd_file_data.propsNrType,102:this.awd_file_data.propsNrType,103:this.awd_file_data.propsNrType,104:this.awd_file_data.propsNrType});switch(s){case 5001:r=new n(c.get(101,60));break;case 5002:r=new o(c.get(101,500));break;case 5003:r=new l(c.get(101,-400),c.get(102,400),c.get(103,-300),c.get(104,300));break;default:console.log("unsupportedLenstype");return}var p=new i(r);p.transform.matrix3D=a;if(e>0){var _=this.awd_file_data.getAssetByID(e);if(_!=undefined){_.addChild(p);t=_.name}}p.name=name;c=this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType,2:this.awd_file_data.matrixNrType,3:this.awd_file_data.matrixNrType,4:h.UINT8});p.pivot=new d(c.get(1,0),c.get(2,0),c.get(3,0));p.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=p;if(this.awd_file_data.debug){console.log("Parsed a Camera: Name = '"+p.name+"' | Projectiontype = "+r+" | Parent-Name = "+t)}};return a}(s);a.exports=c},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/projections/OrthographicOffCenterProjection":undefined,"awayjs-core/lib/projections/OrthographicProjection":undefined,"awayjs-core/lib/projections/PerspectiveProjection":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-core/lib/geom/Vector3D");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.state=n.BLOCKSTATE_NO_ASSET;var e=this.awd_file_data.newBlockBytes.readUnsignedByte()==1;var a=this.awd_file_data.newBlockBytes.readUnsignedInt();var t=this.awd_file_data.parseMatrix3D();var r=this.awd_file_data.parseVarStr();var s;var o;if(a>0)s=this.awd_file_data.getAssetByID(a);var l=this.awd_file_data.newBlockBytes.readShort();var d=this.awd_file_data.newBlockBytes.readShort();var h=this.awd_file_data.parseProperties({1:n.BADDR});switch(d){case 1:var c=h.get(1,0);o=this.awd_file_data.getAssetByID(c);if(o==undefined){return}if(s){s.addChild(o)}o.transform.matrix3D=t;break}if(o){h=this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType,2:this.awd_file_data.matrixNrType,3:this.awd_file_data.matrixNrType,4:n.UINT8});o.pivot=new i(h.get(1,0),h.get(2,0),h.get(3,0));o.extra=this.awd_file_data.parseUserAttributes()}if(this.awd_file_data.debug){console.log("Parsed a CommandBlock: Name = '"+r)}};return a}(s);a.exports=o},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/geom/Vector3D");var i=e("awayjs-display/lib/containers/DisplayObjectContainer");var n=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var o=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var l=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t;var r;t=new i;e=this.awd_file_data.newBlockBytes.readUnsignedInt();a=this.awd_file_data.parseMatrix3D();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var n="Root (TopLevel)";t.transform.matrix3D=a;if(e>0){var r=this.awd_file_data.getAssetByID(e);if(r!=undefined){r.addChild(t);n=r.name}}if(this.awd_file_data.major_version>2||this.awd_file_data.major_version>=2&&this.awd_file_data.minor_version==1){var l=this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType,2:this.awd_file_data.matrixNrType,3:this.awd_file_data.matrixNrType,4:o.UINT8});t.pivot=new s(l.get(1,0),l.get(2,0),l.get(3,0))}else{this.awd_file_data.parseProperties(null)}t.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=t;if(this.awd_file_data.debug){console.log("Parsed a Container: Name = '"+t.name+"' | Parent-Name = "+n)}};return a}(n);a.exports=l},{"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-core/lib/data/Geometry");var o=e("awayjs-core/lib/data/CurveSubGeometry");var l=e("awayjs-core/lib/data/TriangleSubGeometry");var d=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=new n;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedShort();var t=this.awd_file_data.parseProperties({1:this.awd_file_data.geoNrType,2:this.awd_file_data.geoNrType});var r=t.get(1,1);var i=t.get(2,1);var d=0;while(d<a){var h=false;var c;var p,_;var u;var f;p=this.awd_file_data.newBlockBytes.readUnsignedInt();_=this.awd_file_data.newBlockBytes.position+p;var y=this.awd_file_data.parseProperties({1:this.awd_file_data.geoNrType,2:this.awd_file_data.geoNrType});while(this.awd_file_data.newBlockBytes.position<_){var w=0;var b,m,v,g;m=this.awd_file_data.newBlockBytes.readUnsignedByte();b=this.awd_file_data.newBlockBytes.readUnsignedByte();v=this.awd_file_data.newBlockBytes.readUnsignedInt();g=this.awd_file_data.newBlockBytes.position+v;var B,k,D;if(m==1){var A=new Array;while(this.awd_file_data.newBlockBytes.position<g){B=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);k=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);D=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);A[w++]=B;A[w++]=k;A[w++]=D}}else if(m==2){var P=new Array;while(this.awd_file_data.newBlockBytes.position<g){P[w++]=this.awd_file_data.newBlockBytes.readUnsignedShort()}}else if(m==3){var j=new Array;while(this.awd_file_data.newBlockBytes.position<g){j[w++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo)}}else if(m==4){var N=new Array;while(this.awd_file_data.newBlockBytes.position<g){N[w++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo)}}else if(m==6){u=Array();while(this.awd_file_data.newBlockBytes.position<g){u[w++]=this.awd_file_data.newBlockBytes.readUnsignedShort()*3}}else if(m==7){f=new Array;while(this.awd_file_data.newBlockBytes.position<g){f[w++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo)}}else if(m==8){this.awd_file_data.newBlockBytes.position=g}else if(m==9){this.awd_file_data.newBlockBytes.position=g}else if(m==10){h=true;var M=0;var T=0;var S=0;var x=new Array;var U=new Array;var j=new Array;while(this.awd_file_data.newBlockBytes.position<g){x[M++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);x[M++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);x[M++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);U[T++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);U[T++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);j[S++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);j[S++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo)}}else{this.awd_file_data.newBlockBytes.position=g}}this.awd_file_data.parseUserAttributes();if(h){var I=new o(new s);I.setIndices(P);I.setPositions(x);I.setCurves(U);I.setUVs(j);e.addSubGeometry(I);if(this.awd_file_data.debug)console.log("Parsed a CurveSubGeometry")}else{var W=new l(new s);if(f)W.jointsPerVertex=f.length/(A.length/3);if(N)W.autoDeriveNormals=false;if(j)W.autoDeriveUVs=false;if(true){W.autoDeriveTangents=true}W.setIndices(P);W.setPositions(A);W.setNormals(N);W.setUVs(j);W.setTangents(null);W.setJointWeights(f);W.setJointIndices(u);var C=y.get(1,1);var O=y.get(2,1);var F=false;if(r!=C||i!=O){F=true;C=r/C;O=i/O}if(F)W.scaleUV(C,O);e.addSubGeometry(W);if(this.awd_file_data.debug)console.log("Parsed a TriangleSubGeometry")}d++}if(r!=1||i!=1)e.scaleUV(r,i);this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug){console.log("Parsed a TriangleGeometry: Name = "+name)}};return a}(i);a.exports=d},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/data/CurveSubGeometry":undefined,"awayjs-core/lib/data/Geometry":undefined,"awayjs-core/lib/data/TriangleSubGeometry":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase"}],"awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper");var n=e("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var o=e("awayjs-display/lib/entities/DirectionalLight");var l=e("awayjs-display/lib/entities/PointLight");var d=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var h=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t=this.awd_file_data.newBlockBytes.readUnsignedInt();var r=this.awd_file_data.parseMatrix3D();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var s=this.awd_file_data.newBlockBytes.readUnsignedByte();var h=this.awd_file_data.parseProperties({1:this.awd_file_data.propsNrType,2:this.awd_file_data.propsNrType,3:d.COLOR,4:this.awd_file_data.propsNrType,5:this.awd_file_data.propsNrType,6:d.BOOL,7:d.COLOR,8:this.awd_file_data.propsNrType,9:d.UINT8,10:d.UINT8,11:this.awd_file_data.propsNrType,12:d.UINT16,21:this.awd_file_data.matrixNrType,22:this.awd_file_data.matrixNrType,23:this.awd_file_data.matrixNrType});var c=h.get(9,0);var p="Root (TopLevel)";var _=["Unsupported LightType","PointLight","DirectionalLight"];var u=["No ShadowMapper","DirectionalShadowMapper","NearDirectionalShadowMapper","CascadeShadowMapper","CubeMapShadowMapper"];if(s==1){e=new l;e.radius=h.get(1,9e4);e.fallOff=h.get(2,1e5);if(c>0){if(c==4){a=new i}}e.transform.matrix3D=r}if(s==2){e=new o(h.get(21,0),h.get(22,-1),h.get(23,1));if(c>0){if(c==1){a=new n}}}e.name=name;e.color=h.get(3,16777215);e.specular=h.get(4,1);e.diffuse=h.get(5,1);e.ambientColor=h.get(7,16777215);e.ambient=h.get(8,0);if(a){if(a instanceof i){if(h.get(10,1)!=1){a.depthMapSize=this.awd_file_data.getDepthSizeFromEnum(h.get(10,1))}}else{if(h.get(10,2)!=2){a.depthMapSize=this.awd_file_data.getDepthSizeFromEnum(h.get(10,2))}}e.shadowMapper=a;e.castsShadows=true}if(t!=0){var f=this.awd_file_data.getAssetByID(t);if(f!=undefined){f.addChild(e);p=f.name}else{}}else{}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug)console.log("Parsed a Light: Name = '"+this.awd_file_data.cur_block.name+"' | Type = "+_[s]+" | Parent-Name = "+p+" | ShadowMapper-Type = "+u[c])};return a}(s);a.exports=h},{"awayjs-display/lib/entities/DirectionalLight":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper":undefined,"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-display/lib/materials/lightpickers/StaticLightPicker");var n=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var e=this.awd_file_data.newBlockBytes.readUnsignedShort();var a=new Array;var t=0;var r=0;var s;var n=new Array;for(t=0;t<e;t++){r=this.awd_file_data.newBlockBytes.readUnsignedInt();var o=this.awd_file_data.getAssetByID(r);if(o!=undefined){a.push(o);n.push(o.name)}else{}}if(a.length==0){this.awd_file_data.parseUserAttributes();return undefined}var l=new i(a);this.awd_file_data.cur_block.data=l;this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug){console.log("Parsed a StaticLightPicker: Name = '"+this.awd_file_data.cur_block.name+"' | Texture-Name = "+n.toString())}};return a}(s);a.exports=n},{"awayjs-display/lib/materials/lightpickers/StaticLightPicker":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase"}],"awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-methodmaterials/lib/MethodMaterialMode");var n=e("awayjs-methodmaterials/lib/MethodMaterial");var o=e("awayjs-display/lib/materials/BasicMaterial");var l=e("awayjs-display/lib/managers/DefaultMaterialManager");var d=e("awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod");var h=e("awayjs-methodmaterials/lib/methods/DiffuseDepthMethod");var c=e("awayjs-methodmaterials/lib/methods/DiffuseCelMethod");var p=e("awayjs-methodmaterials/lib/methods/DiffuseGradientMethod");var _=e("awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod");var u=e("awayjs-methodmaterials/lib/methods/DiffuseWrapMethod");var f=e("awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod");var y=e("awayjs-methodmaterials/lib/methods/SpecularFresnelMethod");var w=e("awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod");var b=e("awayjs-methodmaterials/lib/methods/SpecularCelMethod");var m=e("awayjs-methodmaterials/lib/methods/SpecularPhongMethod");var v=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var g=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t;var r;var s;var g;var B;var k;var D;var r;var A;var P;var D;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();a=this.awd_file_data.newBlockBytes.readUnsignedByte();B=this.awd_file_data.newBlockBytes.readUnsignedByte();if(this.awd_file_data.major_version==2&&this.awd_file_data.major_version==0){t=this.awd_file_data.parseProperties({1:v.INT32,2:v.BADDR,10:this.awd_file_data.propsNrType,11:v.BOOL,12:this.awd_file_data.propsNrType,13:v.BOOL});k=0;while(k<B){var j;j=this.awd_file_data.newBlockBytes.readUnsignedShort();this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();k+=1}var N="";s=this.awd_file_data.parseUserAttributes();if(a===1){N+="Parsed a ColorMaterial(SinglePass): Name = '"+e+"' | ";var M;M=t.get(1,16777215)}else if(a===2){var T=t.get(2,0);var S=undefined;if(T>0){var S=this.awd_file_data.getAssetByID(T)}if(S==undefined){S=l.getDefaultTexture()}r=new n(S)}r.extra=s;r.alphaThreshold=t.get(12,0);r.repeat=t.get(13,false);r.name=e;if(this.awd_file_data.debug){console.log(N)}this.awd_file_data.cur_block.data=r;return}var t=this.awd_file_data.parseProperties({1:v.UINT32,2:v.BADDR,3:v.BADDR,4:v.UINT8,5:v.BOOL,6:v.BOOL,7:v.BOOL,8:v.BOOL,9:v.UINT8,10:this.awd_file_data.propsNrType,11:v.BOOL,12:this.awd_file_data.propsNrType,13:v.BOOL,15:this.awd_file_data.propsNrType,16:v.UINT32,17:v.BADDR,18:this.awd_file_data.propsNrType,19:this.awd_file_data.propsNrType,20:v.UINT32,21:v.BADDR,22:v.BADDR});var x=t.get(4,0);var N="Parsed Material ";if(x>=2){return}if(a<=2){if(x<2){if(a==1){var M=t.get(1,13421772);if(x==1){r=new n(M);r.mode=i.MULTI_PASS;N+="Parsed a ColorMaterial(MultiPass): Name = '"+e+"' | "}else{r=new n(M,t.get(10,1));r.alphaBlending=t.get(11,false);N+="Parsed a ColorMaterial(SinglePass): Name = '"+e+"' | "}}else if(a==2){var T=t.get(2,0);var U=undefined;if(T>0){U=this.awd_file_data.getAssetByID(T)}if(U==undefined){U=l.getDefaultTexture()}r=new n(U);if(x==1){r.mode=i.MULTI_PASS;N+="Parsed a MethodMaterial(MultiPass): Name = '"+this.awd_file_data.cur_block.name+"' | Texture-Name = "+U.name}else{r.alpha=t.get(10,1);r.alphaBlending=t.get(11,false);N+="Parsed a MethodMaterial(SinglePass): Name = '"+this.awd_file_data.cur_block.name+"' | Texture-Name = "+U.name}}var I=t.get(17,0);var W=undefined;if(I>0){W=this.awd_file_data.getAssetByID(I)}if(W){r.diffuseTexture=W;N+=" | DiffuseTexture-Name = "+W.name}var C=t.get(3,0);
A=undefined;if(C>0){A=this.awd_file_data.getAssetByID(C)}var O=t.get(21,0);P=undefined;if(O>0){P=this.awd_file_data.getAssetByID(O)}var F=t.get(22,0);if(F>0){r.lightPicker=this.awd_file_data.getAssetByID(F)}r.smooth=t.get(5,true);r.mipmap=t.get(6,true);r.bothSides=t.get(7,false);r.alphaPremultiplied=t.get(8,false);r.blendMode=this.awd_file_data.getBlendModeStringFromEnum(t.get(9,0));r.repeat=t.get(13,false);if(A)r.normalMap=A;if(P)r.specularMap=P;r.alphaThreshold=t.get(12,0);r.ambient=t.get(15,1);r.diffuseColor=t.get(16,16777215);r.specular=t.get(18,1);r.gloss=t.get(19,50);r.specularColor=t.get(20,16777215);var k=0;var E;while(k<B){var j;j=this.awd_file_data.newBlockBytes.readUnsignedShort();t=this.awd_file_data.parseProperties({1:v.BADDR,2:v.BADDR,3:v.BADDR,101:this.awd_file_data.propsNrType,102:this.awd_file_data.propsNrType,103:this.awd_file_data.propsNrType,201:v.UINT32,202:v.UINT32,301:v.UINT16,302:v.UINT16,401:v.UINT8,402:v.UINT8,601:v.COLOR,602:v.COLOR,701:v.BOOL,702:v.BOOL,801:v.MTX4x4});switch(j){case 999:E=t.get(1,0);if(E>0){var L=this.awd_file_data.getAssetByID(E);r.addEffectMethod(L);N+=" | EffectMethod-Name = "+L.name}break;case 998:E=t.get(1,0);if(E>0){var R=this.awd_file_data.getAssetByID(E);r.shadowMethod=R;N+=" | EffectMethod-Name = "+R.name}break;case 1:E=t.get(1,0);var G=undefined;if(E>0){G=this.awd_file_data.getAssetByID(E)}if(G==undefined){G=this.awd_file_data.getDefaultCubeTexture()}r.ambientMethod=new d;r.texture=G;N+=" | AmbientEnvMapMethod | EnvMap-Name ="+G.name;break;case 51:r.diffuseMethod=new h;N+=" | DiffuseDepthMethod";break;case 52:E=t.get(1,0);var V=undefined;if(E>0){V=this.awd_file_data.getAssetByID(E)}if(V==undefined){V=l.getDefaultTexture()}r.diffuseMethod=new p(V);N+=" | DiffuseGradientMethod | GradientDiffuseTexture-Name ="+V.name;break;case 53:r.diffuseMethod=new u(t.get(101,5));N+=" | DiffuseWrapMethod";break;case 54:E=t.get(1,0);var V=undefined;if(E>0){V=this.awd_file_data.getAssetByID(E)}if(V==undefined){V=l.getDefaultTexture()}r.diffuseMethod=new _(V,this.awd_file_data.getBlendModeStringFromEnum(t.get(401,10)),false,r.diffuseMethod);N+=" | DiffuseLightMapMethod | LightMapTexture-Name ="+V.name;break;case 55:r.diffuseMethod=new c(t.get(401,3),r.diffuseMethod);r.diffuseMethod.smoothness=t.get(101,.1);N+=" | DiffuseCelMethod";break;case 56:break;case 101:r.specularMethod=new w;N+=" | SpecularAnisotropicMethod";break;case 102:r.specularMethod=new m;N+=" | SpecularPhongMethod";break;case 103:r.specularMethod=new b(t.get(101,.5),r.specularMethod);r.specularMethod.smoothness=t.get(102,.1);N+=" | SpecularCelMethod";break;case 104:r.specularMethod=new y(t.get(701,true),r.specularMethod);r.specularMethod.fresnelPower=t.get(101,5);r.specularMethod.normalReflectance=t.get(102,.1);N+=" | SpecularFresnelMethod";break;case 151:break;case 152:E=t.get(1,0);var V=undefined;if(E>0){V=this.awd_file_data.getAssetByID(E)}if(V==undefined){V=l.getDefaultTexture()}if(r.normalMap==undefined)r.normalMap=V;r.normalMethod=new f(r.normalMap,V);N+=" | NormalSimpleWaterMethod | Second-NormalTexture-Name = "+V.name;break}this.awd_file_data.parseUserAttributes();k+=1}}}else if(a>=3&&a<=7){var M=t.get(1,13421772);N+=M;var I=t.get(2,0);var W=undefined;if(I>0){W=this.awd_file_data.getAssetByID(I)}if(I==undefined){W=l.getDefaultTexture()}var z=new o(W);N+=" texture = "+I+" ";z.bothSides=true;z.preserveAlpha=true;z.alphaBlending=true;z.extra=this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug)console.log(N);this.awd_file_data.cur_block.data=z;return}r.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=r;if(this.awd_file_data.debug){console.log(N)}};return a}(s);a.exports=g},{"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/materials/BasicMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined,"awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseCelMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseDepthMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseGradientMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseWrapMethod":undefined,"awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularCelMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularFresnelMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularPhongMethod":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-display/lib/entities/Mesh");var n=e("awayjs-core/lib/data/Geometry");var o=e("awayjs-core/lib/geom/Vector3D");var l=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var d=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;if(this.awd_file_data.cur_block.type==23){var t=this.awd_file_data.newBlockBytes.readUnsignedInt();var r=this.awd_file_data.parseMatrix3D()}this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var s="Root (TopLevel)";var d=this.awd_file_data.newBlockBytes.readUnsignedInt();var h=this.awd_file_data.getAssetByID(d);if(h==undefined){h=new n}this.awd_file_data.cur_block.geoID=d;var c=new Array;e=this.awd_file_data.newBlockBytes.readUnsignedShort();var p=new Array;a=0;while(a<e){var _;_=this.awd_file_data.newBlockBytes.readUnsignedInt();var u=this.awd_file_data.getAssetByID(_);if(u!=undefined){c.push(u);p.push(u.name)}a++}var f=new i(h,null);if(this.awd_file_data.cur_block.type==23){f.transform.matrix3D=r;if(t>0){var y=this.awd_file_data.getAssetByID(t);if(y!=undefined){y.addChild(f);s=y.name}}}if(c.length>=1&&f.subMeshes.length==1){f.material=c[0]}else if(c.length>1){var w;for(w=0;w<f.subMeshes.length;w++){f.subMeshes[w].material=c[Math.min(c.length-1,w)]}}if(this.awd_file_data.major_version>2||this.awd_file_data.major_version>=2&&this.awd_file_data.minor_version==1){var b=this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType,2:this.awd_file_data.matrixNrType,3:this.awd_file_data.matrixNrType,4:l.UINT8,5:l.BOOL});f.pivot=new o(b.get(1,0),b.get(2,0),b.get(3,0));f.castsShadows=b.get(5,true)}else{this.awd_file_data.parseProperties(null)}f.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=f;if(this.awd_file_data.debug){console.log("Parsed a Mesh: Name = '"+name+"' | Parent-Name = "+s+"| Geometry-Name = "+h.name+" | SubMeshes = "+f.subMeshes.length+" | Mat-Names = "+p.toString())}};return a}(s);a.exports=d},{"awayjs-core/lib/data/Geometry":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.state=i.BLOCKSTATE_NO_ASSET;var e=this.awd_file_data.parseProperties({1:i.UINT32,2:i.AWDSTRING,3:i.AWDSTRING,4:i.AWDSTRING,5:i.AWDSTRING});if(this.awd_file_data.debug){console.log("Parsed a MetaDataBlock: TimeStamp         = "+e.get(1,0));console.log("                        EncoderName       = "+e.get(2,"unknown"));console.log("                        EncoderVersion    = "+e.get(3,"unknown"));console.log("                        GeneratorName     = "+e.get(4,"unknown"));console.log("                        GeneratorVersion  = "+e.get(5,"unknown"))}};return a}(s);a.exports=n},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags");var n=e("awayjs-core/lib/geom/ColorTransform");var o=e("awayjs-core/lib/geom/Matrix3D");var l=e("awayjs-player/lib/timeline/TimelineKeyFrame");var d=e("awayjs-player/lib/timeline/commands/AddChildAtDepthCommand");var h=e("awayjs-player/lib/timeline/commands/ApplyAS2DepthsCommand");var c=e("awayjs-player/lib/timeline/commands/ExecuteScriptCommand");var p=e("awayjs-player/lib/timeline/commands/RemoveChildrenAtDepthCommand");var _=e("awayjs-player/lib/timeline/commands/SetInstanceNameCommand");var u=e("awayjs-player/lib/timeline/commands/UpdatePropertyCommand");var f=e("awayjs-player/lib/timeline/commands/SetMaskCommand");var y=e("awayjs-core/lib/geom/Vector3D");var w=e("awayjs-display/lib/entities/TextField");var b=e("awayjs-player/lib/factories/AS2SceneGraphFactory");var m=function(e){r(a,e);function a(){e.call(this);this.factory=new b}a.prototype.parseFromBytes=function(){var e;var a;var t;var r=this.factory.createMovieClip();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var s=!!this.awd_file_data.newBlockBytes.readUnsignedByte();var b=this.awd_file_data.newBlockBytes.readUnsignedByte();var m=this.awd_file_data.newBlockBytes.readFloat();var v=1e3/m;var g=0;var B=0;var k=this.awd_file_data.newBlockBytes.readUnsignedShort();for(e=0;e<k;e++){I=this.awd_file_data.newBlockBytes.readUnsignedInt();var D=this.awd_file_data.getAssetByID(I);if(D!=null){r.registerPotentialChild(D)}else{console.log("ERROR when collecting objects for timeline")}}B+=k;var A=this.awd_file_data.newBlockBytes.readUnsignedShort();k+=A;for(e=0;e<A;e++){I=this.awd_file_data.newBlockBytes.readUnsignedInt();g=this.awd_file_data.newBlockBytes.readUnsignedShort();B+=g;var D=this.awd_file_data.getAssetByID(I);if(D!=null){for(a=0;a<g;a++){r.registerPotentialChild(D)}}else{for(a=0;a<g;a++){console.log("ERROR when collecting objects for timeline")}}}var P=this.awd_file_data.newBlockBytes.readUnsignedShort();for(e=0;e<P;e++){I=this.awd_file_data.newBlockBytes.readUnsignedInt();var D=this.awd_file_data.getAssetByID(I);if(D!=null){console.log("ERROR when collecting objects for timeline")}else{}}var j=this.awd_file_data.newBlockBytes.readUnsignedShort();var N;var M;var T;var S;var x;var U;var I;var W;var C;var O;var F;var E;N=0;for(e=0;e<j;e++){O=new l;M=this.awd_file_data.newBlockBytes.readUnsignedInt()*v;O.setFrameTime(N,M);N+=M;T=this.awd_file_data.newBlockBytes.readUnsignedByte();for(a=0;a<T;a++){O.label=this.awd_file_data.parseVarStr()}S=this.awd_file_data.newBlockBytes.readUnsignedShort();E=false;for(a=0;a<S;a++){C=this.awd_file_data.newBlockBytes.readUnsignedByte();switch(C){case 1:W=this.awd_file_data.newBlockBytes.readUnsignedShort();var L=new Array;for(t=0;t<W;t++){U=this.awd_file_data.newBlockBytes.readShort();L.push(U)}O.addConstructCommand(new p(L));break;case 2:case 3:x=this.awd_file_data.newBlockBytes.readUnsignedShort();if(C==2){E=true;U=this.awd_file_data.newBlockBytes.readShort();var R=r.getPotentialChildPrototype(x);if(R!=undefined){O.addConstructCommand(new d(x,U));if(R.isAsset(w)){O.addConstructCommand(new _(x,R.name))}}else{console.log("ERROR: could not find the objectID ",x)}}var G=this.awd_file_data.newBlockBytes.readUnsignedShort();if(i.test(G,i.FLAG1)){var V=new o;if(i.test(G,i.FLAG2)){}else{V.rawData[0]=this.awd_file_data.newBlockBytes.readFloat();V.rawData[1]=this.awd_file_data.newBlockBytes.readFloat();V.rawData[4]=this.awd_file_data.newBlockBytes.readFloat();V.rawData[5]=this.awd_file_data.newBlockBytes.readFloat();V.position=new y(this.awd_file_data.newBlockBytes.readFloat(),this.awd_file_data.newBlockBytes.readFloat(),0)}O.addConstructCommand(new u(x,"_iMatrix3D",V))}if(i.test(G,i.FLAG3)){var z=new n;if(i.test(G,i.FLAG4)){}else{z.redMultiplier=this.awd_file_data.newBlockBytes.readFloat();z.greenMultiplier=this.awd_file_data.newBlockBytes.readFloat();z.blueMultiplier=this.awd_file_data.newBlockBytes.readFloat();z.alphaMultiplier=this.awd_file_data.newBlockBytes.readFloat();z.redOffset=this.awd_file_data.newBlockBytes.readShort();z.greenOffset=this.awd_file_data.newBlockBytes.readShort();z.blueOffset=this.awd_file_data.newBlockBytes.readShort();z.alphaOffset=this.awd_file_data.newBlockBytes.readShort()}}if(i.test(G,i.FLAG5)){var K=this.awd_file_data.newBlockBytes.readUnsignedByte();var H=this.awd_file_data.getBlendModeStringFromEnum(K)}if(i.test(G,i.FLAG6)){O.addConstructCommand(new u(x,"visible",this.awd_file_data.newBlockBytes.readByte()))}if(i.test(G,i.FLAG7)){var J=this.awd_file_data.parseVarStr();if(J.length){O.addConstructCommand(new _(x,J))}}if(i.test(G,i.FLAG8)){var X=this.awd_file_data.newBlockBytes.readUnsignedShort();var Y=new Array;for(var Q=0;Q<X;Q++){Y.push(this.awd_file_data.newBlockBytes.readShort())}if(Y.length>0){if(Y.length==1&&Y[0]==-1){O.addConstructCommand(new u(x,"_iMaskID",x))}else O.addConstructCommand(new f(x,Y))}}break;case 4:x=this.awd_file_data.newBlockBytes.readUnsignedInt();I=this.awd_file_data.newBlockBytes.readUnsignedInt();break;default:break}}if(E){O.addConstructCommand(new h);E=false}var q=this.awd_file_data.newBlockBytes.readUnsignedInt();if(q>0){var Z=this.awd_file_data.newBlockBytes.readUTFBytes(q);O.addPostConstructCommand(new c(Z))}this.awd_file_data.newBlockBytes.readUnsignedInt();r.addFrame(O)}this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=r;if(this.awd_file_data.debug)console.log("Parsed a TIMELINE: Name = "+name+"| isScene = "+s+"| sceneID = "+b+"| numFrames = "+j)};return a}(s);a.exports=m},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-display/lib/entities/TextField":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags":"awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags","awayjs-player/lib/factories/AS2SceneGraphFactory":undefined,"awayjs-player/lib/timeline/TimelineKeyFrame":undefined,"awayjs-player/lib/timeline/commands/AddChildAtDepthCommand":undefined,"awayjs-player/lib/timeline/commands/ApplyAS2DepthsCommand":undefined,"awayjs-player/lib/timeline/commands/ExecuteScriptCommand":undefined,"awayjs-player/lib/timeline/commands/RemoveChildrenAtDepthCommand":undefined,"awayjs-player/lib/timeline/commands/SetInstanceNameCommand":undefined,"awayjs-player/lib/timeline/commands/SetMaskCommand":undefined,"awayjs-player/lib/timeline/commands/UpdatePropertyCommand":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=e("awayjs-display/lib/prefabs/PrefabBase");var o=e("awayjs-display/lib/prefabs/PrimitiveCapsulePrefab");var l=e("awayjs-display/lib/prefabs/PrimitiveConePrefab");var d=e("awayjs-display/lib/prefabs/PrimitiveCubePrefab");var h=e("awayjs-display/lib/prefabs/PrimitiveCylinderPrefab");var c=e("awayjs-display/lib/prefabs/PrimitivePlanePrefab");var p=e("awayjs-display/lib/prefabs/PrimitiveSpherePrefab");var _=e("awayjs-display/lib/prefabs/PrimitiveTorusPrefab");var u=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t;var r;var s;var u;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();t=this.awd_file_data.newBlockBytes.readUnsignedByte();s=this.awd_file_data.parseProperties({101:this.awd_file_data.geoNrType,102:this.awd_file_data.geoNrType,103:this.awd_file_data.geoNrType,110:this.awd_file_data.geoNrType,111:this.awd_file_data.geoNrType,301:i.UINT16,302:i.UINT16,303:i.UINT16,701:i.BOOL,702:i.BOOL,703:i.BOOL,704:i.BOOL});var f=["Unsupported Type-ID","PrimitivePlanePrefab","PrimitiveCubePrefab","PrimitiveSpherePrefab","PrimitiveCylinderPrefab","PrimitivesConePrefab","PrimitivesCapsulePrefab","PrimitivesTorusPrefab"];switch(t){case 1:a=new c(s.get(101,100),s.get(102,100),s.get(301,1),s.get(302,1),s.get(701,true),s.get(702,false));break;case 2:a=new d(s.get(101,100),s.get(102,100),s.get(103,100),s.get(301,1),s.get(302,1),s.get(303,1),s.get(701,true));break;case 3:a=new p(s.get(101,50),s.get(301,16),s.get(302,12),s.get(701,true));break;case 4:a=new h(s.get(101,50),s.get(102,50),s.get(103,100),s.get(301,16),s.get(302,1),true,true,true);if(!s.get(701,true))a.topClosed=false;if(!s.get(702,true))a.bottomClosed=false;if(!s.get(703,true))a.yUp=false;break;case 5:a=new l(s.get(101,50),s.get(102,100),s.get(301,16),s.get(302,1),s.get(701,true),s.get(702,true));break;case 6:a=new o(s.get(101,50),s.get(102,100),s.get(301,16),s.get(302,15),s.get(701,true));break;case 7:a=new _(s.get(101,50),s.get(102,50),s.get(301,16),s.get(302,8),s.get(701,true));break;default:a=new n;console.log("ERROR: UNSUPPORTED PREFAB_TYPE");break}if(s.get(110,1)!=1||s.get(111,1)!=1){}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=a;if(this.awd_file_data.debug){if(t<0||t>7){t=0}console.log("Parsed a Primivite: Name = "+this.awd_file_data.cur_block.name+"| type = "+f[t])}};return a}(s);a.exports=u},{"awayjs-display/lib/prefabs/PrefabBase":undefined,"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveConePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCubePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":undefined,"awayjs-display/lib/prefabs/PrimitivePlanePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveSpherePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveTorusPrefab":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=e("awayjs-methodmaterials/lib/methods/ShadowDitheredMethod");var o=e("awayjs-methodmaterials/lib/methods/ShadowFilteredMethod");var l=e("awayjs-methodmaterials/lib/methods/ShadowHardMethod");var d=e("awayjs-methodmaterials/lib/methods/ShadowNearMethod");var h=e("awayjs-methodmaterials/lib/methods/ShadowSoftMethod");var c=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t;var r;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();r=this.awd_file_data.newBlockBytes.readUnsignedInt();var s=this.awd_file_data.getAssetByID(r);if(s==undefined){return}t=this.parseShadowMethodList(s);if(!t)return;this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=t;if(this.awd_file_data.debug){console.log("Parsed a ShadowMapMethodMethod: Name = "+t.name+" | Type = "+t+" | Light-Name = ",s.name)}};a.prototype.parseShadowMethodList=function(e){var a=this.awd_file_data.newBlockBytes.readUnsignedShort();var t;var r=this.awd_file_data.parseProperties({1:i.BADDR,2:i.BADDR,3:i.BADDR,101:this.awd_file_data.propsNrType,102:this.awd_file_data.propsNrType,103:this.awd_file_data.propsNrType,201:i.UINT32,202:i.UINT32,301:i.UINT16,302:i.UINT16,401:i.UINT8,402:i.UINT8,601:i.COLOR,602:i.COLOR,701:i.BOOL,702:i.BOOL,801:i.MTX4x4});var s;var c;switch(a){case 1002:s=r.get(1,0);var p=this.awd_file_data.getAssetByID(s);if(p==undefined){return t}t=new d(p);break;case 1101:t=new o(e);t.alpha=r.get(101,1);t.epsilon=r.get(102,.002);break;case 1102:t=new n(e,r.get(201,5));t.alpha=r.get(101,1);t.epsilon=r.get(102,.002);t.range=r.get(103,1);break;case 1103:t=new h(e,r.get(201,5));t.alpha=r.get(101,1);t.epsilon=r.get(102,.002);t.range=r.get(103,1);break;case 1104:t=new l(e);t.alpha=r.get(101,1);t.epsilon=r.get(102,.002);break}this.awd_file_data.parseUserAttributes();return t};return a}(s);a.exports=c},{"awayjs-methodmaterials/lib/methods/ShadowDitheredMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowFilteredMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowHardMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowNearMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowSoftMethod":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/geom/ColorTransform");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=e("awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod");var l=e("awayjs-methodmaterials/lib/methods/EffectColorTransformMethod");var d=e("awayjs-methodmaterials/lib/methods/EffectFogMethod");var h=e("awayjs-methodmaterials/lib/methods/EffectRimLightMethod");var c=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();e=this.parseSharedMethodList();this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug){console.log("Parsed a EffectMethod: Name = "+e.name+" Type = "+e)}};a.prototype.parseSharedMethodList=function(){var e=this.awd_file_data.newBlockBytes.readUnsignedShort();var a;var t=this.awd_file_data.parseProperties({1:n.BADDR,2:n.BADDR,3:n.BADDR,101:this.awd_file_data.propsNrType,102:this.awd_file_data.propsNrType,103:this.awd_file_data.propsNrType,104:this.awd_file_data.propsNrType,105:this.awd_file_data.propsNrType,106:this.awd_file_data.propsNrType,107:this.awd_file_data.propsNrType,201:n.UINT32,202:n.UINT32,301:n.UINT16,302:n.UINT16,401:n.UINT8,402:n.UINT8,601:n.COLOR,602:n.COLOR,701:n.BOOL,702:n.BOOL});var r;var i;switch(e){case 401:a=new o(t.get(101,new Array(0,0,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)));break;case 402:a=new l;var c=t.get(601,0);a.colorTransform=new s(t.get(102,1),t.get(103,1),t.get(104,1),t.get(101,1),c>>16&255,c>>8&255,c&255,c>>24&255);break;case 403:break;case 404:break;case 406:a=new h(t.get(601,16777215),t.get(101,.4),t.get(101,2));break;case 407:break;case 410:break;case 411:a=new d(t.get(101,0),t.get(102,1e3),t.get(601,8421504));break}this.awd_file_data.parseUserAttributes();return a};return a}(i);a.exports=c},{"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectColorTransformMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectFogMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectRimLightMethod":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/utils/ByteArray");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedByte();var t;if(a==0){t=this.awd_file_data.newBlockBytes.readUnsignedInt();var r;r=this.awd_file_data.newBlockBytes.readUTFBytes(t);this.awd_file_data.cur_block.dependencies_urls.push(r)}else{t=this.awd_file_data.newBlockBytes.readUnsignedInt();var i;i=new s;this.awd_file_data.newBlockBytes.readBytes(i,0,t);this.awd_file_data.cur_block.dependencies_data.push(i)}this.awd_file_data.cur_block.state=n.BLOCKSTATE_LOAD_DEPENDENICES;this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug){var o=["external","embed"];console.log("Start parsing a "+o[a]+" Bitmap for Texture")}};return a}(i);a.exports=o},{"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/utils/ByteArray");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t=this.awd_file_data.newBlockBytes.readUnsignedByte();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();for(a=0;a<6;a++){if(t==0){e=this.awd_file_data.newBlockBytes.readUnsignedInt();var r;r=this.awd_file_data.newBlockBytes.readUTFBytes(e);this.awd_file_data.cur_block.dependencies_urls.push(r)}else{e=this.awd_file_data.newBlockBytes.readUnsignedInt();var i;i=new s;this.awd_file_data.newBlockBytes.readBytes(i,0,e);this.awd_file_data.cur_block.dependencies_data.push(i)}}this.awd_file_data.cur_block.state=n.BLOCKSTATE_LOAD_DEPENDENICES;this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();if(this.awd_file_data.debug){var o=["external","embed"];console.log("Start parsing 6 "+o[t]+" Bitmaps for CubeTexture")}};return a}(i);a.exports=o},{"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-renderergl/lib/animators/data/Skeleton");var n=e("awayjs-renderergl/lib/animators/data/SkeletonJoint");var o=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=new i;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedShort();this.awd_file_data.parseProperties(null);var t=0;while(t<a){var r;var s;this.awd_file_data.newBlockBytes.readUnsignedShort();r=new n;r.parentIndex=this.awd_file_data.newBlockBytes.readUnsignedShort()-1;r.name=this.awd_file_data.parseVarStr();s=this.awd_file_data.parseMatrix3D();r.inverseBindPose=s.rawData;this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();e.joints.push(r);t++}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug)console.log("Parsed a Skeleton: Name = "+this.awd_file_data.cur_block.name+" | Number of Joints = "+t)};return a}(s);a.exports=o},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-renderergl/lib/animators/data/Skeleton":undefined,"awayjs-renderergl/lib/animators/data/SkeletonJoint":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-renderergl/lib/animators/nodes/SkeletonClipNode");var n=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;var a;var t=new i;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var r=this.awd_file_data.newBlockBytes.readUnsignedShort();this.awd_file_data.parseProperties(null);var s=0;while(s<r){a=this.awd_file_data.newBlockBytes.readUnsignedInt();e=this.awd_file_data.newBlockBytes.readUnsignedShort();var n=this.awd_file_data.getAssetByID(a);if(n!=undefined){t.addFrame(n,e)}s++}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=t;if(this.awd_file_data.debug)console.log("Parsed a SkeletonClipNode: Name = "+this.awd_file_data.cur_block.name+" | Number of Frames = "+t.frames.length)};return a}(s);a.exports=n},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var n=e("awayjs-renderergl/lib/animators/data/JointPose");var o=e("awayjs-core/lib/geom/Matrix3D");var l=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=new i;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedShort();this.awd_file_data.parseProperties(null);var t=0;while(t<a){var r;var s;r=new n;s=this.awd_file_data.newBlockBytes.readUnsignedByte();if(s==1){var l=this.awd_file_data.parseMatrix43RawData();var d=new o(l);r.orientation.fromMatrix(d);r.translation.copyFrom(d.position);e.jointPoses[t]=r}t++}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug)console.log("Parsed a SkeletonPose: Name = "+this.awd_file_data.cur_block.name+" | Number of Joints = "+t)};return a}(s);a.exports=l},{"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];
function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-display/lib/entities/Skybox");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var e=this.awd_file_data.newBlockBytes.readUnsignedInt();var a=undefined;if(e>0){a=this.awd_file_data.getAssetByID(e)}if(a==undefined){a=this.awd_file_data.getDefaultCubeTexture()}var t=new s(a);this.awd_file_data.parseProperties(null);t.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=t;if(this.awd_file_data.debug)console.log("Parsed a Skybox: Name = '"+this.awd_file_data.cur_block.name+"' | CubeTexture-Name = "+a.name)};return a}(i);a.exports=n},{"awayjs-display/lib/entities/Skybox":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase"}],"awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-display/lib/text/Font");var o=e("awayjs-core/lib/data/CurveSubGeometry");var l=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=new n;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedInt();for(var t=0;t<a;++t){var r=this.awd_file_data.parseVarStr();var i=e.get_font_table(r);i.set_font_em_size(this.awd_file_data.newBlockBytes.readUnsignedInt());var l=this.awd_file_data.newBlockBytes.readUnsignedInt();for(var t=0;t<l;++t){var d=this.awd_file_data.newBlockBytes.readUnsignedInt();var h=this.awd_file_data.newBlockBytes.readUnsignedInt();var c=this.awd_file_data.newBlockBytes.position+h;while(this.awd_file_data.newBlockBytes.position<c){var p=0;var _,u,f,y;u=this.awd_file_data.newBlockBytes.readUnsignedByte();_=this.awd_file_data.newBlockBytes.readUnsignedByte();f=this.awd_file_data.newBlockBytes.readUnsignedInt();y=this.awd_file_data.newBlockBytes.position+f;if(u==2){var w=new Array;while(this.awd_file_data.newBlockBytes.position<y){w[p++]=this.awd_file_data.newBlockBytes.readUnsignedShort()}}else if(u==10){var b=0;var m=0;var v=0;var g=new Array;var B=new Array;var k=new Array;while(this.awd_file_data.newBlockBytes.position<y){g[b++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);g[b++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);g[b++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);B[m++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);B[m++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);k[v++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);k[v++]=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo)}}else{this.awd_file_data.newBlockBytes.position=y}}var D=new o(new s);D.setIndices(w);D.setPositions(g);D.setCurves(B);D.setUVs(k);i.set_subgeo_for_char(d.toString(),D)}}this.awd_file_data.parseProperties(null);this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug){console.log("Parsed a font: Name = '"+this.awd_file_data.cur_block.name)}};return a}(i);a.exports=l},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/data/CurveSubGeometry":undefined,"awayjs-display/lib/text/Font":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase"}],"awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=e("awayjs-display/lib/text/TextFormat");var o=e("awayjs-player/lib/factories/AS2SceneGraphFactory");var l=function(e){r(a,e);function a(){e.call(this);this.factory=new o}a.prototype.parseFromBytes=function(){var e=this.factory.createTextField();this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedByte();if(a==0){e.type="static"}else if(a==1){e.type="dynamic"}else if(a==2){e.type="input"}else if(a==3){e.type="input";e.displayAsPassword=true}e.width=this.awd_file_data.newBlockBytes.readFloat();e.height=this.awd_file_data.newBlockBytes.readFloat();var t=this.awd_file_data.newBlockBytes.readUnsignedInt();var r="";var s;for(var o=0;o<t;o++){var l=this.awd_file_data.newBlockBytes.readUnsignedInt();for(var d=0;d<l;d++){var h=this.awd_file_data.newBlockBytes.readUnsignedInt();var c=this.awd_file_data.getAssetByID(h);if(c==undefined){s=new n}var p=this.awd_file_data.newBlockBytes.readUnsignedInt();if(p>0){var _=this.awd_file_data.newBlockBytes.readUTFBytes(p);r+=_}}}e.textFormat=s;e.text=r;var u=this.awd_file_data.parseProperties({1:i.BOOL,3:i.BOOL,4:i.BOOL,5:i.BOOL,7:i.UINT8,8:i.UINT8,9:i.UINT8});e.selectable=u.get(1,false);e.border=u.get(3,false);e.extra=this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug){console.log("Parsed a TextField: Name = '"+e.name+"| text  = "+r)}};return a}(s);a.exports=l},{"awayjs-display/lib/text/TextFormat":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-player/lib/factories/AS2SceneGraphFactory":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=e("awayjs-display/lib/text/TextFormat");var o=e("awayjs-display/lib/text/Font");var l=e("awayjs-display/lib/materials/BasicMaterial");var d=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=new n;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedInt();var t=this.awd_file_data.parseVarStr();var r=this.awd_file_data.getAssetByID(a);if(r==undefined){r=new o}e.font_name=r.name;var s=r.get_font_table(t);if(s!=null){e.font_style=t;e.font_table=s}var d=this.awd_file_data.newBlockBytes.readUnsignedInt();var h=this.awd_file_data.getAssetByID(d);if(h==undefined){h=new l}h.bothSides=true;var c=this.awd_file_data.newBlockBytes.readUnsignedByte();var p=[];for(var _=0;_<c;_++){var u=this.awd_file_data.newBlockBytes.readFloat();p.push(u)}e.uv_values=p;var f=this.awd_file_data.parseProperties({1:i.UINT16,2:i.UINT16,3:i.UINT8,4:i.UINT8,5:i.UINT8,6:i.UINT8,7:i.UINT16,8:i.UINT16,9:i.UINT16,10:i.UINT16});e.size=f.get(1,12);e.letterSpacing=f.get(2,0);e.kerning=f.get(4,true);e.indent=f.get(7,0);e.leftMargin=f.get(8,0);e.rightMargin=f.get(9,0);e.size=f.get(1,12);e.letterSpacing=f.get(2,0);e.kerning=f.get(4,true);e.material=h;this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=e;if(this.awd_file_data.debug){console.log("Parsed a TextFormat: Name = '"+name+" font: "+r.name)}};return a}(s);a.exports=d},{"awayjs-display/lib/materials/BasicMaterial":undefined,"awayjs-display/lib/text/Font":undefined,"awayjs-display/lib/text/TextFormat":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var n=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var o=e("awayjs-core/lib/data/TriangleSubGeometry");var l=e("awayjs-renderergl/lib/animators/nodes/VertexClipNode");var d=e("awayjs-core/lib/data/Geometry");var h=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e=false;if(this.awd_file_data.cur_block.type==111){e=true}var a=1;var t;var r;var i;var h;var c;var p;var _;var u;var f;var y;var w;var b=0;var m;var v;var g=0;var B=0;var k=new Array;var D;var A;var P=new l;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var j=this.awd_file_data.newBlockBytes.readUnsignedInt();var N=this.awd_file_data.getAssetByID(j);if(N==undefined){return}var M=this.awd_file_data.getUVForVertexAnimation(j);if(!e)a=this.awd_file_data.newBlockBytes.readUnsignedShort();t=this.awd_file_data.newBlockBytes.readUnsignedShort();g=this.awd_file_data.newBlockBytes.readUnsignedShort();B=0;while(B<g){k.push(this.awd_file_data.newBlockBytes.readUnsignedShort());B++}D=this.awd_file_data.parseProperties({1:n.BOOL,2:n.BOOL});P.looping=D.get(1,true);P.stitchFinalFrame=D.get(2,false);r=0;while(r<a){h=this.awd_file_data.newBlockBytes.readUnsignedShort();y=new d;i=0;while(i<t){B=0;u=this.awd_file_data.newBlockBytes.readUnsignedInt();f=this.awd_file_data.newBlockBytes.position+u;while(B<g){if(k[B]==1){m=N.subGeometries[i].indices;v=new Array;b=0;while(this.awd_file_data.newBlockBytes.position<f){c=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);p=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);_=this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);v[b++]=c;v[b++]=p;v[b++]=_}w=new o(new s);w.setIndices(m);w.setPositions(v);w.setUVs(M[i]);w.setNormals(null);w.setTangents(null);w.autoDeriveNormals=false;w.autoDeriveTangents=false;i++;y.addSubGeometry(w)}else this.awd_file_data.newBlockBytes.position=f;B++}}P.addFrame(y,h);r++}this.awd_file_data.parseUserAttributes();this.awd_file_data.cur_block.data=P;if(this.awd_file_data.debug)console.log("Parsed a VertexClipNode: Name = "+P.name+" | Target-Geometry-Name = "+N.name+" | Number of Frames = "+P.frames.length)};return a}(i);a.exports=h},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/data/Geometry":undefined,"awayjs-core/lib/data/TriangleSubGeometry":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-renderergl/lib/animators/nodes/VertexClipNode":undefined}],"awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase");var i=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var n=e("awayjs-renderergl/lib/animators/nodes/SkeletonClipNode");var o=e("awayjs-renderergl/lib/animators/nodes/VertexClipNode");var l=e("awayjs-renderergl/lib/animators/VertexAnimationSet");var d=e("awayjs-renderergl/lib/animators/SkeletonAnimationSet");var h=function(e){r(a,e);function a(){e.call(this)}a.prototype.parseFromBytes=function(){var e;this.awd_file_data.cur_block.name=this.awd_file_data.parseVarStr();var a=this.awd_file_data.newBlockBytes.readUnsignedShort();var t=this.awd_file_data.parseProperties({1:i.UINT16});var r=0;var s=new Array;var h=new Array;while(r<a){e=this.awd_file_data.newBlockBytes.readUnsignedInt();var c=this.awd_file_data.getAssetByID(e);if(c==undefined){}else{if(c instanceof o)h.push(c);if(c instanceof n)s.push(c)}r++}if(h.length==0&&s.length==0){return}this.awd_file_data.parseUserAttributes();if(h.length>0){var p=new l;for(var _=0;_<h.length;_++)p.addAnimation(h[_]);this.awd_file_data.cur_block.data=p;if(this.awd_file_data.debug)console.log("Parsed a VertexAnimationSet: Name = "+p.name+" | Animations = "+p.animations.length+" | Animation-Names = "+p.animationNames.toString());return}else if(s.length>0){var u=new d(t.get(1,4));for(var _=0;_<s.length;_++)u.addAnimation(s[_]);this.awd_file_data.cur_block.data=u;if(this.awd_file_data.debug)console.log("Parsed a SkeletonAnimationSet: Name = "+u.name+" | Animations = "+u.animations.length+" | Animation-Names = "+u.animationNames.toString())}};return a}(s);a.exports=h},{"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-renderergl/lib/animators/SkeletonAnimationSet":undefined,"awayjs-renderergl/lib/animators/VertexAnimationSet":undefined,"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":undefined,"awayjs-renderergl/lib/animators/nodes/VertexClipNode":undefined}],"awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData":[function(e,a,t){var r=e("awayjs-core/lib/data/BitmapImageCube");var s=e("awayjs-core/lib/data/BlendMode");var i=e("awayjs-core/lib/geom/Matrix3D");var n=e("awayjs-display/lib/managers/DefaultMaterialManager");var o=e("awayjs-display/lib/entities/Mesh");var l=e("awayjs-display/lib/textures/SingleCubeTexture");var d=e("awayjs-display/lib/textures/Single2DTexture");var h=e("awayjs-methodmaterials/lib/MethodMaterial");var c=e("awayjs-parsers/lib/AWD3ParserUtils/AWDProperties");var p=e("awayjs-parsers/lib/AWD3ParserUtils/AWDBlock");var _=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var u=function(){function e(){this._debug=false;this._accuracyOnBlocks=false;this.major_version=0;this.minor_version=0;this._blocks=new Array;this._blocks.push(new p(255,0));this._cur_block=this._blocks[0];this.blendModeDic=new Array;this.blendModeDic.push(s.NORMAL);this.blendModeDic.push(s.ADD);this.blendModeDic.push(s.ALPHA);this.blendModeDic.push(s.DARKEN);this.blendModeDic.push(s.DIFFERENCE);this.blendModeDic.push(s.ERASE);this.blendModeDic.push(s.HARDLIGHT);this.blendModeDic.push(s.INVERT);this.blendModeDic.push(s.LAYER);this.blendModeDic.push(s.LIGHTEN);this.blendModeDic.push(s.MULTIPLY);this.blendModeDic.push(s.NORMAL);this.blendModeDic.push(s.OVERLAY);this.blendModeDic.push(s.SCREEN);this.blendModeDic.push(s.SHADER);this.blendModeDic.push(s.OVERLAY);this._depthSizeDic=new Array;this._depthSizeDic.push(256);this._depthSizeDic.push(512);this._depthSizeDic.push(2048);this._depthSizeDic.push(1024)}e.prototype.getDepthSizeFromEnum=function(e){return this._depthSizeDic[e]};e.prototype.getBlendModeStringFromEnum=function(e){return this.blendModeDic[e]};e.prototype.dispose=function(){for(var e in this._blocks){var a=this._blocks[e];a.dispose()}};Object.defineProperty(e.prototype,"accuracyOnBlocks",{get:function(){return this._accuracyOnBlocks},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"accuracyMatrix",{get:function(){return this._accuracyMatrix},set:function(e){this._accuracyMatrix=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"accuracyProps",{get:function(){return this._accuracyProps},set:function(e){this._accuracyProps=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"accuracyGeo",{get:function(){return this._accuracyGeo},set:function(e){this._accuracyGeo=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"debug",{get:function(){return this._debug},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"matrixNrType",{get:function(){return this._matrixNrType},set:function(e){this._matrixNrType=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"propsNrType",{get:function(){return this._propsNrType},set:function(e){this._propsNrType=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"geoNrType",{get:function(){return this._geoNrType},set:function(e){this._geoNrType=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"newBlockBytes",{get:function(){return this._newBlockBytes},set:function(e){this._newBlockBytes=e},enumerable:true,configurable:true});e.prototype.create_new_block=function(e,a){var t=new p(this._blocks.length,e);this._cur_block=t;this._blocks[a]=t};Object.defineProperty(e.prototype,"cur_block",{get:function(){return this._cur_block},enumerable:true,configurable:true});e.prototype.block_cnt=function(){return this._blocks.length};e.prototype.parseUserAttributes=function(){var e;var a;var t;a=this._newBlockBytes.readUnsignedInt();if(a>0){var r;e={};r=this._newBlockBytes.position+a;while(this._newBlockBytes.position<r){var s;var i;var n;var o;var l;s=this._newBlockBytes.readUnsignedByte();i=this.parseVarStr();n=this._newBlockBytes.readUnsignedByte();o=this._newBlockBytes.readUnsignedInt();if(this._newBlockBytes.position+o>r){console.log("           Error in reading attribute # "+t+" = skipped to end of attribute-list");this._newBlockBytes.position=r;return e}switch(n){case _.AWDSTRING:l=this._newBlockBytes.readUTFBytes(o);break;case _.INT8:l=this._newBlockBytes.readByte();break;case _.INT16:l=this._newBlockBytes.readShort();break;case _.INT32:l=this._newBlockBytes.readInt();break;case _.BOOL:case _.UINT8:l=this._newBlockBytes.readUnsignedByte();break;case _.UINT16:l=this._newBlockBytes.readUnsignedShort();break;case _.UINT32:case _.BADDR:l=this._newBlockBytes.readUnsignedInt();break;case _.FLOAT32:l=this._newBlockBytes.readFloat();break;case _.FLOAT64:l=this._newBlockBytes.readDouble();break;default:l="unimplemented attribute type "+n;this._newBlockBytes.position+=o;break}if(this._debug){console.log("attribute = name: "+i+"  / value = "+l)}e[i]=l;t+=1}}return e};e.prototype.parseProperties=function(e){var a;var t;var r=0;var s=new c;t=this._newBlockBytes.readUnsignedInt();a=this._newBlockBytes.position+t;if(e){while(this._newBlockBytes.position<a){var i;var n;var o;n=this._newBlockBytes.readUnsignedShort();i=this._newBlockBytes.readUnsignedInt();if(this._newBlockBytes.position+i>a){console.log("           Error in reading property # "+r+" = skipped to end of propertie-list");this._newBlockBytes.position=a;return s}if(e.hasOwnProperty(n.toString())){o=e[n];s.set(n,this.parseAttrValue(o,i))}else{this._newBlockBytes.position+=i}r+=1}}else{this._newBlockBytes.position=a}return s};e.prototype.parseAttrValue=function(e,a){var t;var r;switch(e){case _.BOOL:case _.INT8:t=1;r=this._newBlockBytes.readByte;break;case _.INT16:t=2;r=this._newBlockBytes.readShort;break;case _.INT32:t=4;r=this._newBlockBytes.readInt;break;case _.UINT8:t=1;r=this._newBlockBytes.readUnsignedByte;break;case _.UINT16:t=2;r=this._newBlockBytes.readUnsignedShort;break;case _.UINT32:case _.COLOR:case _.BADDR:t=4;r=this._newBlockBytes.readUnsignedInt;break;case _.FLOAT32:t=4;r=this._newBlockBytes.readFloat;break;case _.FLOAT64:t=8;r=this._newBlockBytes.readDouble;break;case _.AWDSTRING:return this._newBlockBytes.readUTFBytes(a);case _.VECTOR2x1:case _.VECTOR3x1:case _.VECTOR4x1:case _.MTX3x2:case _.MTX3x3:case _.MTX4x3:case _.MTX4x4:t=8;r=this._newBlockBytes.readDouble;break}if(t<a){var s=[];var i=0;var n=a/t;while(i<n){s.push(r.apply(this._newBlockBytes));i++}return s}else{var o=r.apply(this._newBlockBytes);return o}};e.prototype.getUVForVertexAnimation=function(e){if(this._blocks[e].data instanceof o)e=this._blocks[e].geoID;if(this._blocks[e].uvsForVertexAnimation)return this._blocks[e].uvsForVertexAnimation;var a=this._blocks[e].data;var t=0;var r;this._blocks[e].uvsForVertexAnimation=new Array;while(t<a.subGeometries.length){r=a.subGeometries[t];this._blocks[e].uvsForVertexAnimation.push(r.uvs.get(r.numVertices));t++}return this._blocks[e].uvsForVertexAnimation};e.prototype.parseVarStr=function(){var e=this._newBlockBytes.readUnsignedShort();return this._newBlockBytes.readUTFBytes(e)};e.prototype.getBlockByID=function(e){return this._blocks[e]};e.prototype.getAssetByID=function(e){return this._blocks[e].data};e.prototype.getDefaultAsset=function(e){switch(true){case e==l.assetType:return this.getDefaultCubeTexture();break;case e==d.assetType:return n.getDefaultTexture();break;case e==h.assetType:return n.getDefaultMaterial();break;default:break}return null};e.prototype.getDefaultCubeTexture=function(){if(!this._defaultCubeTexture){var e=n.createCheckeredBitmapImage2D();var a=new r(e.width);for(var t=0;t<6;t++)a.draw(t,e);this._defaultCubeTexture=new l(a);this._defaultCubeTexture.name="defaultCubeTexture"}return this._defaultCubeTexture};e.prototype.readNumber=function(e){if(e===void 0){e=false}if(e)return this._newBlockBytes.readDouble();return this._newBlockBytes.readFloat()};e.prototype.parseMatrix3D=function(){return new i(this.parseMatrix43RawData())};e.prototype.parseMatrix32RawData=function(){var e;var a=new Array(6);for(e=0;e<6;e++){a[e]=this._newBlockBytes.readFloat()}return a};e.prototype.parseMatrix43RawData=function(){var e=new Array(16);e[0]=this.readNumber(this._accuracyMatrix);e[1]=this.readNumber(this._accuracyMatrix);e[2]=this.readNumber(this._accuracyMatrix);e[3]=0;e[4]=this.readNumber(this._accuracyMatrix);e[5]=this.readNumber(this._accuracyMatrix);e[6]=this.readNumber(this._accuracyMatrix);e[7]=0;e[8]=this.readNumber(this._accuracyMatrix);e[9]=this.readNumber(this._accuracyMatrix);e[10]=this.readNumber(this._accuracyMatrix);e[11]=0;e[12]=this.readNumber(this._accuracyMatrix);e[13]=this.readNumber(this._accuracyMatrix);e[14]=this.readNumber(this._accuracyMatrix);e[15]=1;if(isNaN(e[0])){e[0]=1;e[1]=0;e[2]=0;e[4]=0;e[5]=1;e[6]=0;e[8]=0;e[9]=0;e[10]=1;e[12]=0;e[13]=0;e[14]=0}return e};return e}();a.exports=u},{"awayjs-core/lib/data/BitmapImageCube":undefined,"awayjs-core/lib/data/BlendMode":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-display/lib/textures/SingleCubeTexture":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-parsers/lib/AWD3ParserUtils/AWDBlock":"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock","awayjs-parsers/lib/AWD3ParserUtils/AWDProperties":"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties"}],"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":[function(e,a,t){var r=function(){function e(){}e.BLOCKSTATE_FINALIZE=0;e.BLOCKSTATE_INVALID=1;e.BLOCKSTATE_LOAD_DEPENDENICES=2;e.BLOCKSTATE_NO_ASSET=3;e.COMPRESSIONMODE_LZMA="lzma";e.UNCOMPRESSED=0;e.DEFLATE=1;e.LZMA=2;e.INT8=1;e.INT16=2;e.INT32=3;e.UINT8=4;e.UINT16=5;e.UINT32=6;e.FLOAT32=7;e.FLOAT64=8;e.BOOL=21;e.COLOR=22;e.BADDR=23;e.AWDSTRING=31;e.AWDBYTEARRAY=32;e.VECTOR2x1=41;e.VECTOR3x1=42;e.VECTOR4x1=43;e.MTX3x2=44;e.MTX3x3=45;e.MTX4x3=46;e.MTX4x4=47;return e}();a.exports=r},{}],"awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags":[function(e,a,t){var r=function(){function e(){}e.test=function(e,a){return(e&a)==a};e.FLAG1=1;e.FLAG2=2;e.FLAG3=4;e.FLAG4=8;e.FLAG5=16;e.FLAG6=32;e.FLAG7=64;e.FLAG8=128;e.FLAG9=256;e.FLAG10=512;e.FLAG11=1024;e.FLAG12=2048;e.FLAG13=4096;e.FLAG14=8192;e.FLAG15=16384;e.FLAG16=32768;return e}();a.exports=r},{}],"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock":[function(e,a,t){var r=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var s=function(){function e(e,a){this.type=a;this.id=e;this.state=r.BLOCKSTATE_FINALIZE;this.dependencies_data=Array();this.dependencies_urls=Array();if(a==83){this.loaded_dependencies=Array(6)}this.loaded_dependencies_cnt=0}e.prototype.dispose=function(){this.id=null;this.bytes=null;this.errorMessages=null;this.uvsForVertexAnimation=null};e.prototype.addError=function(e){if(!this.errorMessages)this.errorMessages=new Array;this.errorMessages.push(e)};return e}();a.exports=s},{"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils"}],"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties":[function(e,a,t){var r=function(){function e(){}e.prototype.set=function(e,a){this[e.toString()]=a};e.prototype.get=function(e,a){if(this.hasOwnProperty(e.toString())){return this[e.toString()]}else{return a}};return e}();a.exports=r},{}],"awayjs-parsers/lib/AWD3Parser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/net/URLLoaderDataFormat");var i=e("awayjs-core/lib/net/URLRequest");var n=e("awayjs-core/lib/parsers/ParserBase");var o=e("awayjs-core/lib/parsers/ParserUtils");var l=e("awayjs-core/lib/data/BitmapImageCube");var d=e("awayjs-core/lib/utils/ByteArray");var h=e("awayjs-display/lib/base/DisplayObject");var c=e("awayjs-display/lib/containers/DisplayObjectContainer");var p=e("awayjs-display/lib/textures/SingleCubeTexture");var _=e("awayjs-display/lib/textures/Single2DTexture");var u=e("awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags");var f=e("awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers");var y=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData");var w=e("awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils");var b=function(e){r(a,e);function a(a){if(a===void 0){a=undefined}e.call(this,s.ARRAY_BUFFER);this._debug=false;this._startedParsing=false;this._parsed_header=false;this.total_time=0;this.geom_time=0;this.timeline_time=0;this._block_parser=a;if(this._block_parser==undefined){this._block_parser=new f}this._awd_data=new y;this._block_parser.init_parser(this._awd_data)}a.supportsType=function(e){e=e.toLowerCase();return e=="awd"};a.supportsData=function(e){return o.toString(e,3)=="AWD"};a.prototype._iResolveDependency=function(e){if(e.assets.length==1){var a=this._awd_data.getBlockByID(parseInt(e.id));if(a.type==82){var t=new _(e.assets[0]);a.data=t;this._pFinalizeAsset(t,a.name);if(this._debug){console.log("Successfully loaded Bitmap for texture");console.log("Parsed texture: Name = "+a.name)}}else if(a.type==44){if(this._debug){console.log("Successfully loaded Sound into AudioAsset");console.log("Loaded Sound: Name = "+a.name)}}else if(a.type==83){a.loaded_dependencies[e.sub_id]=e.assets[0];a.loaded_dependencies_cnt++;if(a.loaded_dependencies_cnt==6){if(this._debug){console.log("Successfully loaded Bitmap "+e.sub_id+" / 6 for Cubetexture")}var r=new l(a.loaded_dependencies[0].width);for(var s=0;s<6;s++)r.draw(s,a.loaded_dependencies[s]);var i=new p(r);a.data=i;this._pFinalizeAsset(i,a.name);if(this._debug){console.log("Parsed CubeTexture: Name = "+a.name)}}}}};a.prototype._iResolveDependencyFailure=function(e){};a.prototype._iResolveDependencyName=function(e,a){var t=a.name;if(a){var r=this._awd_data.getBlockByID(parseInt(e.id));a.resetAssetPath(r.name,null,true)}var s=a.name;a.name=t;return s};a.prototype._pProceedParsing=function(){if(!this._startedParsing){this._byteData=this._pGetByteData();this._startedParsing=true}if(!this._parsed_header){this.parseHeader();switch(this._compression){case w.DEFLATE:case w.LZMA:this._pDieWithError("Compressed AWD formats not yet supported");break;case w.UNCOMPRESSED:this._body=this._byteData;break}this._parsed_header=true}if(this._body){while(this._body.getBytesAvailable()>0&&!this.parsingPaused){this.parseNextBlock()}if(this._body.getBytesAvailable()==0){this.dispose();return n.PARSING_DONE}else{return n.MORE_TO_PARSE}}else{switch(this._compression){case w.DEFLATE:case w.LZMA:if(this._debug){console.log("(!) AWD3Utils Error: Compressed AWD formats not yet supported (!)")}break}return n.PARSING_DONE}};a.prototype._pStartParsing=function(a){e.prototype._pStartParsing.call(this,a);this._pContent=new c};a.prototype.dispose=function(){this._awd_data.dispose()};a.prototype.parseNextBlock=function(){var e=this._body.readUnsignedInt();var a=this._body.readUnsignedByte();var t=this._body.readUnsignedByte();var r=this._body.readUnsignedByte();var s=this._body.readUnsignedInt();var n=u.test(r,u.FLAG4);var l=u.test(r,u.FLAG5);if(this._awd_data.accuracyOnBlocks){this._awd_data.accuracyMatrix=u.test(r,u.FLAG1);this._awd_data.accuracyGeo=u.test(r,u.FLAG2);this._awd_data.accuracyProps=u.test(r,u.FLAG3);this._awd_data.geoNrType=w.FLOAT32;if(this._awd_data.accuracyGeo){this._awd_data.geoNrType=w.FLOAT64}this._awd_data.matrixNrType=w.FLOAT32;if(this._awd_data.accuracyMatrix){this._awd_data.matrixNrType=w.FLOAT64}this._awd_data.propsNrType=w.FLOAT32;if(this._awd_data.accuracyProps){this._awd_data.propsNrType=w.FLOAT64}}var c=this._body.position+s;if(s>this._body.getBytesAvailable()){this._pDieWithError("AWD2 block length is bigger than the bytes that are available!");this._body.position+=this._body.getBytesAvailable();return}var p=new d;this._body.readBytes(p,0,s);this._awd_data.newBlockBytes=p;if(n){this._pDieWithError("Compressed AWD formats not yet supported")}this._awd_data.newBlockBytes.position=0;this._awd_data.create_new_block(t,e);if(n){this._pDieWithError("Compressed AWD formats not yet supported")}console.log("AWDBlock:  ID = "+e+" | TypeID = "+t+" | Compression = "+n+" | Matrix-Precision = "+this._awd_data.accuracyMatrix+" | Geometry-Precision = "+this._awd_data.accuracyGeo+" | Properties-Precision = "+this._awd_data.accuracyProps);var _=performance.now();if(this._block_parser.parseAsset(t)){if(this._awd_data.cur_block.state==w.BLOCKSTATE_FINALIZE){this._pFinalizeAsset(this._awd_data.cur_block.data,this._awd_data.cur_block.name);if(this._awd_data.cur_block.data instanceof h){if(this._awd_data.cur_block.data.parent==undefined){this._pContent.addChild(this._awd_data.cur_block.data)}}}else if(this._awd_data.cur_block.state==w.BLOCKSTATE_INVALID){console.log("ERROR while parsing block - type = ",t," id = ",e)}else if(this._awd_data.cur_block.state==w.BLOCKSTATE_LOAD_DEPENDENICES){for(var f=0;f<this._awd_data.cur_block.dependencies_urls.length;f++){this._pAddDependency(this._awd_data.cur_block.id.toString(),new i(this._awd_data.cur_block.dependencies_urls[f]),false,null,true,f)}for(var f=0;f<this._awd_data.cur_block.dependencies_data.length;f++){if(t==82||t==83){this._pAddDependency(this._awd_data.cur_block.id.toString(),null,false,o.byteArrayToImage(this._awd_data.cur_block.dependencies_data[f]),true,f)}else if(t==44){}}this._pPauseAndRetrieveDependencies()}else if(this._awd_data.cur_block.state==w.BLOCKSTATE_NO_ASSET){}}else{console.log("Encountered unknown blocktype - type = ",t," id = ",e)}var y=performance.now();var b=y-_;this.total_time+=b;if(t==1){this.geom_time+=b}else if(t==133){this.timeline_time+=b}console.log("'parsed '"+t+"'  block in "+b+" ms"," total: ",this.total_time," geom: ",this.geom_time,"timelines:",this.timeline_time);this._body.position=c;this._awd_data.newBlockBytes=null};a.prototype.parseHeader=function(){var e;var a;this._byteData.position=3;this._awd_data.major_version=this._byteData.readUnsignedByte();this._awd_data.minor_version=this._byteData.readUnsignedByte();e=this._byteData.readUnsignedShort();this._streaming=u.test(e,u.FLAG1);if(this._awd_data.major_version==2&&this._awd_data.minor_version==1){this._awd_data.accuracyMatrix=u.test(e,u.FLAG2);this._awd_data.accuracyGeo=u.test(e,u.FLAG3);this._awd_data.accuracyProps=u.test(e,u.FLAG4)}this._awd_data.geoNrType=w.FLOAT32;if(this._awd_data.accuracyGeo){this._awd_data.geoNrType=w.FLOAT64}this._awd_data.matrixNrType=w.FLOAT32;if(this._awd_data.accuracyMatrix){this._awd_data.matrixNrType=w.FLOAT64}this._awd_data.propsNrType=w.FLOAT32;if(this._awd_data.accuracyProps){this._awd_data.propsNrType=w.FLOAT64}this._compression=this._byteData.readUnsignedByte();if(this._debug){console.log("Import AWDFile of version = "+this._awd_data.major_version+" - "+this._awd_data.minor_version);console.log("Global Settings = Compression = "+this._compression+" | Streaming = "+this._streaming+" | Matrix-Precision = "+this._awd_data.accuracyMatrix+" | Geometry-Precision = "+this._awd_data.accuracyGeo+" | Properties-Precision = "+this._awd_data.accuracyProps)
}a=this._byteData.readUnsignedInt();if(!this._streaming&&a!=this._byteData.getBytesAvailable()){this._pDieWithError("AWD2 body length does not match header integrity field")}};return a}(n);a.exports=b},{"awayjs-core/lib/data/BitmapImageCube":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-display/lib/base/DisplayObject":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-display/lib/textures/SingleCubeTexture":undefined,"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers":"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers","awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData":"awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData","awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils":"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils","awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags":"awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags"}],"awayjs-parsers/lib/AWDParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-core/lib/attributes/Float3Attributes");var n=e("awayjs-core/lib/attributes/Float2Attributes");var o=e("awayjs-core/lib/data/BitmapImageCube");var l=e("awayjs-core/lib/data/BlendMode");var d=e("awayjs-core/lib/data/Geometry");var h=e("awayjs-core/lib/data/CurveSubGeometry");var c=e("awayjs-core/lib/data/TriangleSubGeometry");var p=e("awayjs-core/lib/geom/ColorTransform");var _=e("awayjs-core/lib/geom/Matrix3D");var u=e("awayjs-core/lib/geom/Vector3D");var f=e("awayjs-core/lib/net/URLLoaderDataFormat");var y=e("awayjs-core/lib/net/URLRequest");var w=e("awayjs-core/lib/parsers/ParserBase");var b=e("awayjs-core/lib/parsers/ParserUtils");var m=e("awayjs-core/lib/projections/PerspectiveProjection");var v=e("awayjs-core/lib/projections/OrthographicProjection");var g=e("awayjs-core/lib/projections/OrthographicOffCenterProjection");var B=e("awayjs-core/lib/utils/ByteArray");var k=e("awayjs-display/lib/animators/nodes/AnimationNodeBase");var D=e("awayjs-display/lib/containers/DisplayObjectContainer");var A=e("awayjs-display/lib/base/LightBase");var P=e("awayjs-display/lib/entities/DirectionalLight");var j=e("awayjs-display/lib/entities/PointLight");var N=e("awayjs-display/lib/entities/Camera");var M=e("awayjs-display/lib/entities/Mesh");var T=e("awayjs-display/lib/entities/TextField");var S=e("awayjs-display/lib/entities/Billboard");var x=e("awayjs-display/lib/entities/Skybox");var U=e("awayjs-display/lib/managers/DefaultMaterialManager");var I=e("awayjs-display/lib/materials/lightpickers/LightPickerBase");var W=e("awayjs-display/lib/materials/lightpickers/StaticLightPicker");var C=e("awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper");var O=e("awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper");var F=e("awayjs-display/lib/prefabs/PrefabBase");var E=e("awayjs-display/lib/prefabs/PrimitivePrefabBase");var L=e("awayjs-display/lib/prefabs/PrimitiveCapsulePrefab");var R=e("awayjs-display/lib/prefabs/PrimitiveConePrefab");var G=e("awayjs-display/lib/prefabs/PrimitiveCubePrefab");var V=e("awayjs-display/lib/prefabs/PrimitiveCylinderPrefab");var z=e("awayjs-display/lib/prefabs/PrimitivePlanePrefab");var K=e("awayjs-display/lib/prefabs/PrimitiveSpherePrefab");var H=e("awayjs-display/lib/prefabs/PrimitiveTorusPrefab");var J=e("awayjs-display/lib/textures/SingleCubeTexture");var X=e("awayjs-display/lib/textures/Single2DTexture");var Y=e("awayjs-renderergl/lib/animators/AnimationSetBase");var Q=e("awayjs-renderergl/lib/animators/VertexAnimationSet");var q=e("awayjs-renderergl/lib/animators/VertexAnimator");var Z=e("awayjs-renderergl/lib/animators/SkeletonAnimationSet");var $=e("awayjs-renderergl/lib/animators/SkeletonAnimator");var ea=e("awayjs-renderergl/lib/animators/data/JointPose");var aa=e("awayjs-renderergl/lib/animators/data/Skeleton");var ta=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var ra=e("awayjs-renderergl/lib/animators/data/SkeletonJoint");var sa=e("awayjs-renderergl/lib/animators/nodes/SkeletonClipNode");var ia=e("awayjs-renderergl/lib/animators/nodes/VertexClipNode");var na=e("awayjs-methodmaterials/lib/MethodMaterialMode");var oa=e("awayjs-methodmaterials/lib/MethodMaterial");var la=e("awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod");var da=e("awayjs-methodmaterials/lib/methods/DiffuseDepthMethod");var ha=e("awayjs-methodmaterials/lib/methods/DiffuseCelMethod");var ca=e("awayjs-methodmaterials/lib/methods/DiffuseGradientMethod");var pa=e("awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod");var _a=e("awayjs-methodmaterials/lib/methods/DiffuseWrapMethod");var ua=e("awayjs-methodmaterials/lib/methods/EffectAlphaMaskMethod");var fa=e("awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod");var ya=e("awayjs-methodmaterials/lib/methods/EffectColorTransformMethod");var wa=e("awayjs-methodmaterials/lib/methods/EffectEnvMapMethod");var ba=e("awayjs-methodmaterials/lib/methods/EffectFogMethod");var ma=e("awayjs-methodmaterials/lib/methods/EffectFresnelEnvMapMethod");var va=e("awayjs-methodmaterials/lib/methods/EffectLightMapMethod");var ga=e("awayjs-methodmaterials/lib/methods/EffectMethodBase");var Ba=e("awayjs-methodmaterials/lib/methods/EffectRimLightMethod");var ka=e("awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod");var Da=e("awayjs-methodmaterials/lib/methods/ShadowDitheredMethod");var Aa=e("awayjs-methodmaterials/lib/methods/ShadowFilteredMethod");var Pa=e("awayjs-methodmaterials/lib/methods/ShadowMapMethodBase");var ja=e("awayjs-methodmaterials/lib/methods/SpecularFresnelMethod");var Na=e("awayjs-methodmaterials/lib/methods/ShadowHardMethod");var Ma=e("awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod");var Ta=e("awayjs-methodmaterials/lib/methods/SpecularCelMethod");var Sa=e("awayjs-methodmaterials/lib/methods/SpecularPhongMethod");var xa=e("awayjs-methodmaterials/lib/methods/ShadowNearMethod");var Ua=e("awayjs-methodmaterials/lib/methods/ShadowSoftMethod");var Ia=e("awayjs-display/lib/materials/BasicMaterial");var Wa=e("awayjs-player/lib/factories/AS2SceneGraphFactory");var Ca=e("awayjs-player/lib/timeline/TimelineKeyFrame");var Oa=e("awayjs-player/lib/timeline/commands/AddChildAtDepthCommand");var Fa=e("awayjs-player/lib/timeline/commands/ApplyAS2DepthsCommand");var Ea=e("awayjs-player/lib/timeline/commands/ExecuteScriptCommand");var La=e("awayjs-player/lib/timeline/commands/RemoveChildrenAtDepthCommand");var Ra=e("awayjs-player/lib/timeline/commands/SetInstanceNameCommand");var Ga=e("awayjs-player/lib/timeline/commands/UpdatePropertyCommand");var Va=e("awayjs-player/lib/timeline/commands/SetMaskCommand");var za=e("awayjs-display/lib/text/Font");var Ka=e("awayjs-display/lib/text/TextFormat");var Ha=e("awayjs-parsers/lib/AWD3ParserUtils/AWDBlock");var Ja=function(e){r(a,e);function a(){e.call(this,f.ARRAY_BUFFER);this._debug=false;this._startedParsing=false;this._texture_users={};this._parsed_header=false;this._time_all=0;this._time_geom=0;this._time_timeline=0;this._time_fonts=0;this._blocks=new Array;this._blocks[0]=new Ha(0,255);this._blocks[0].data=null;this.blendModeDic=new Array;this.blendModeDic.push(l.NORMAL);this.blendModeDic.push(l.ADD);this.blendModeDic.push(l.ALPHA);this.blendModeDic.push(l.DARKEN);this.blendModeDic.push(l.DIFFERENCE);this.blendModeDic.push(l.ERASE);this.blendModeDic.push(l.HARDLIGHT);this.blendModeDic.push(l.INVERT);this.blendModeDic.push(l.LAYER);this.blendModeDic.push(l.LIGHTEN);this.blendModeDic.push(l.MULTIPLY);this.blendModeDic.push(l.NORMAL);this.blendModeDic.push(l.OVERLAY);this.blendModeDic.push(l.SCREEN);this.blendModeDic.push(l.SHADER);this.blendModeDic.push(l.OVERLAY);this._depthSizeDic=new Array;this._depthSizeDic.push(256);this._depthSizeDic.push(512);this._depthSizeDic.push(2048);this._depthSizeDic.push(1024);this._version=Array()}a.supportsType=function(e){e=e.toLowerCase();return e=="awd"};a.supportsData=function(e){return b.toString(e,3)=="AWD"};a.prototype._iResolveDependency=function(e){if(e.assets.length==1){var a=this._blocks[parseInt(e.id)];if(a.type==82){var t=new X(e.assets[0]);a.data=t;this._pFinalizeAsset(t,a.name);if(this._debug){console.log("Successfully loaded Bitmap for texture");console.log("Parsed texture: Name = "+a.name)}}else if(a.type==44){var r=e.assets[0];a.data=r;console.log("Parsing audio "+a.name);this._pFinalizeAsset(r,a.name);if(this._debug){console.log("Successfully loaded Sound into WaveAudio");console.log("Loaded audio: Name = "+a.name)}}else if(a.type==83){a.loaded_dependencies[e.sub_id]=e.assets[0];a.loaded_dependencies_cnt++;if(this._debug){console.log("Successfully loaded Bitmap "+e.sub_id+" / 6 for Cubetexture")}if(a.loaded_dependencies_cnt==6){var s=new o(a.loaded_dependencies[0].width);for(var i=0;i<6;i++)s.draw(i,a.loaded_dependencies[i]);var n=new J(s);a.data=n;this._pFinalizeAsset(n,a.name);if(this._debug){console.log("Parsed CubeTexture: Name = "+a.name)}}}}};a.prototype._iResolveDependencyFailure=function(e){};a.prototype._iResolveDependencyName=function(e,a){var t=a.name;if(a){var r=this._blocks[parseInt(e.id)];a.resetAssetPath(r.name,null,true)}var s=a.name;a.name=t;return s};a.prototype._pProceedParsing=function(){if(!this._startedParsing){this._byteData=this._pGetByteData();this._startedParsing=true}if(!this._parsed_header){this.parseHeader();switch(this._compression){case a.DEFLATE:case a.LZMA:this._pDieWithError("Compressed AWD formats not yet supported");break;case a.UNCOMPRESSED:this._body=this._byteData;break}this._parsed_header=true}if(this._body){while(this._body.getBytesAvailable()>0&&!this.parsingPaused){this.parseNextBlock()}if(this._body.getBytesAvailable()==0){this.dispose();return w.PARSING_DONE}else{return w.MORE_TO_PARSE}}else{switch(this._compression){case a.DEFLATE:case a.LZMA:if(this._debug){console.log("(!) AWDParser Error: Compressed AWD formats not yet supported (!)")}break}return w.PARSING_DONE}};a.prototype._pStartParsing=function(a){e.prototype._pStartParsing.call(this,a);this._pContent=new D};a.prototype.dispose=function(){for(var e in this._blocks){var a=this._blocks[e];a.dispose()}};a.prototype.parseNextBlock=function(){var e;var t;var r=false;var s;var i;var n;var o;this._cur_block_id=this._body.readUnsignedInt();s=this._body.readUnsignedByte();i=this._body.readUnsignedByte();n=this._body.readUnsignedByte();o=this._body.readUnsignedInt();var l=Ya.test(n,Ya.FLAG4);var d=Ya.test(n,Ya.FLAG5);if(this._accuracyOnBlocks){this._accuracyMatrix=Ya.test(n,Ya.FLAG1);this._accuracyGeo=Ya.test(n,Ya.FLAG2);this._accuracyProps=Ya.test(n,Ya.FLAG3);this._geoNrType=a.FLOAT32;if(this._accuracyGeo){this._geoNrType=a.FLOAT64}this._matrixNrType=a.FLOAT32;if(this._accuracyMatrix){this._matrixNrType=a.FLOAT64}this._propsNrType=a.FLOAT32;if(this._accuracyProps){this._propsNrType=a.FLOAT64}}var h=this._body.position+o;if(o>this._body.getBytesAvailable()){this._pDieWithError("AWD2 block length is bigger than the bytes that are available!");this._body.position+=this._body.getBytesAvailable();return}this._newBlockBytes=new B;this._body.readBytes(this._newBlockBytes,0,o);if(l){this._pDieWithError("Compressed AWD formats not yet supported")}this._newBlockBytes.position=0;e=new Ha(this._cur_block_id,i);e.len=this._newBlockBytes.position+o;var c=this._newBlockBytes.position+o;if(l){this._pDieWithError("Compressed AWD formats not yet supported")}if(this._debug){console.log("AWDBlock:  ID = "+this._cur_block_id+" | TypeID = "+i+" | Compression = "+l+" | Matrix-Precision = "+this._accuracyMatrix+" | Geometry-Precision = "+this._accuracyGeo+" | Properties-Precision = "+this._accuracyProps)}this._blocks[this._cur_block_id]=e;if(this._version[0]==3&&this._version[1]==0){var p=new Wa;switch(i){case 24:this.parseMeshLibraryBlock(this._cur_block_id);r=true;break;case 25:this.parseBillBoardLibraryBlock(this._cur_block_id);r=true;break;case 44:this.parseAudioBlock(this._cur_block_id,p);r=true;break;case 133:this.parseTimeLine(this._cur_block_id,p);r=true;break;case 134:this.paresTextField(this._cur_block_id,p);r=true;break;case 135:this.parseTesselatedFont(this._cur_block_id);r=true;break;case 136:this.parseTextFormat(this._cur_block_id);r=true;break}}if(this._version[0]>2||this._version[0]>=2&&this._version[1]>=1){switch(i){case 11:this.parsePrimitves(this._cur_block_id);r=true;break;case 31:this.parseSkyboxInstance(this._cur_block_id);r=true;break;case 41:this.parseLight(this._cur_block_id);r=true;break;case 42:this.parseCamera(this._cur_block_id);r=true;break;case 51:this.parseLightPicker(this._cur_block_id);r=true;break;case 81:this.parseMaterial_v1(this._cur_block_id);r=true;break;case 83:this.parseCubeTexture(this._cur_block_id);r=true;break;case 91:this.parseSharedMethodBlock(this._cur_block_id);r=true;break;case 92:this.parseShadowMethodBlock(this._cur_block_id);r=true;break;case 111:this.parseMeshPoseAnimation(this._cur_block_id,true);r=true;break;case 112:this.parseMeshPoseAnimation(this._cur_block_id);r=true;break;case 113:this.parseVertexAnimationSet(this._cur_block_id);r=true;break;case 122:this.parseAnimatorSet(this._cur_block_id);r=true;break;case 253:this.parseCommand(this._cur_block_id);r=true;break}}if(r==false){switch(i){case 1:this.parseTriangleGeometrieBlock(this._cur_block_id);break;case 22:this.parseContainer(this._cur_block_id);break;case 23:this.parseMeshInstance(this._cur_block_id);break;case 81:this.parseMaterial(this._cur_block_id);break;case 82:this.parseTexture(this._cur_block_id);break;case 101:this.parseSkeleton(this._cur_block_id);break;case 102:this.parseSkeletonPose(this._cur_block_id);break;case 103:this.parseSkeletonAnimation(this._cur_block_id);break;case 121:case 254:this.parseNameSpace(this._cur_block_id);break;case 255:this.parseMetaData(this._cur_block_id);break;default:if(this._debug){console.log("AWDBlock:   Unknown BlockType  (BlockID = "+this._cur_block_id+") - Skip "+o+" bytes")}this._newBlockBytes.position+=o;break}}var _=0;if(this._newBlockBytes.position==c){if(this._debug){if(e.errorMessages){while(_<e.errorMessages.length){console.log("        (!) Error: "+e.errorMessages[_]+" (!)");_++}}}if(this._debug){console.log("\n")}}else{if(this._debug){console.log("  (!)(!)(!) Error while reading AWDBlock ID "+this._cur_block_id+" = skip to next block");if(e.errorMessages){while(_<e.errorMessages.length){console.log("        (!) Error: "+e.errorMessages[_]+" (!)");_++}}}}this._body.position=h;this._newBlockBytes=null};a.prototype.parseTesselatedFont=function(e){var a=this.parseVarStr();this._blocks[e].name=a;var t=this._newBlockBytes.readUnsignedInt();var r=new za;for(var o=0;o<t;++o){var l=this.parseVarStr();var d=r.get_font_table(l);d.set_font_em_size(this._newBlockBytes.readUnsignedInt());var c=this._newBlockBytes.readUnsignedInt();for(var o=0;o<c;++o){var p=this._newBlockBytes.readUnsignedInt();var _=this._newBlockBytes.readUnsignedInt();var u=this._newBlockBytes.position+_;while(this._newBlockBytes.position<u){var f=0;var y,w,b,m;w=this._newBlockBytes.readUnsignedByte();y=this._newBlockBytes.readUnsignedByte();b=this._newBlockBytes.readUnsignedInt();m=this._newBlockBytes.position+b;if(w==2){var v=new Array;while(this._newBlockBytes.position<m){v[f++]=this._newBlockBytes.readUnsignedShort()}}else if(w==10){var g=new B;this._newBlockBytes.readBytes(g,0,b)}else{this._newBlockBytes.position=m}}var k=new s(28,b/28);k.bufferView=new Uint8Array(g.arraybytes);var D=new h(k);D.setIndices(v);D.setPositions(new i(k));D.setCurves(new n(k));D.setUVs(new n(k));d.set_subgeo_for_char(p.toString(),D)}}this.parseProperties(null);this.parseUserAttributes();this._pFinalizeAsset(r,a);this._blocks[e].data=r;if(this._debug){console.log("Parsed a font: Name = '"+a)}};a.prototype.parseTextFormat=function(e){var t=this.parseVarStr();this._blocks[e].name=t;var r=this._newBlockBytes.readUnsignedInt();var s=this.parseVarStr();var i=this.getAssetByID(r,[za.assetType]);var n;if(i[0]){n=i[1]}else{this._blocks[e].addError("Could not find a Font for this TextFormat. A empty Font is created!");n=new za}var o=new Ka;o.font_name=n.name;var l=n.get_font_table(s);if(l!=null){o.font_style=s;o.font_table=l}var d=this._newBlockBytes.readUnsignedInt();var h;var c=this.getAssetByID(d,[oa.assetType,Ia.assetType]);if(c[0]){h=c[1]}else{this._blocks[e].addError("Could not find a Material for this TextFormat. Default Material will be used!");h=new Ia}h.bothSides=true;var p=this._newBlockBytes.readUnsignedByte();var _=[];for(var u=0;u<p;u++){var f=this._newBlockBytes.readFloat();_.push(f)}o.uv_values=_;var y=this.parseProperties({1:a.UINT16,2:a.UINT16,3:a.UINT8,4:a.UINT8,5:a.UINT8,6:a.UINT8,7:a.UINT16,8:a.UINT16,9:a.UINT16,10:a.UINT16});o.size=y.get(1,12);o.letterSpacing=y.get(2,0);o.kerning=y.get(4,true);o.indent=y.get(7,0);o.leftMargin=y.get(8,0);o.rightMargin=y.get(9,0);o.material=h;this.parseUserAttributes();this._pFinalizeAsset(o,t);this._blocks[e].data=o;if(this._debug){console.log("Parsed a TextFormat: Name = '"+t+" font: "+n.name)}};a.prototype.paresTextField=function(e,t){var r=this.parseVarStr();this._blocks[e].name=r;var s=t.createTextField();var i=this._newBlockBytes.readUnsignedByte();if(i==0){s.type="static"}else if(i==1){s.type="dynamic"}else if(i==2){s.type="input"}else if(i==3){s.type="input";s.displayAsPassword=true}s.width=this._newBlockBytes.readFloat();s.height=this._newBlockBytes.readFloat();var n=this._newBlockBytes.readUnsignedInt();var o="";var l;for(var d=0;d<n;d++){var h=this._newBlockBytes.readUnsignedInt();for(var c=0;c<h;c++){var p=this._newBlockBytes.readUnsignedInt();var _=this.getAssetByID(p,[Ka.assetType]);if(_[0]){l=_[1]}else{this._blocks[e].addError("Could not find a Material for this Billboard. A empty material is created!");l=new Ka}var u=this._newBlockBytes.readUnsignedInt();if(u>0){var f=this._newBlockBytes.readUTFBytes(u);o+=f}}}s.textFormat=l;s.text=o;var y=this.parseProperties({1:a.BOOL,3:a.BOOL,4:a.BOOL,5:a.BOOL,7:a.UINT8,8:a.UINT8,9:a.UINT8});s.selectable=y.get(1,false);s.border=y.get(3,false);s.extra=this.parseUserAttributes();this._pFinalizeAsset(s,r);this._blocks[e].data=s;if(this._debug){console.log("Parsed a TextField: Name = '"+r+"| text  = "+o)}};a.prototype.parseBillBoardLibraryBlock=function(e){var a=this.parseVarStr();var t=this._newBlockBytes.readUnsignedInt();var r;var s=this.getAssetByID(t,[oa.assetType,Ia.assetType]);if(s[0]){r=s[1]}else{this._blocks[e].addError("Could not find a Material for this Billboard. A empty material is created!");r=new Ia}r.bothSides=true;var i=new S(r);this.parseProperties(null);i.extra=this.parseUserAttributes();this._pFinalizeAsset(i,a);this._blocks[e].data=i;if(this._debug){console.log("Parsed a Library-Billboard: Name = '"+a+"| Material-Name = "+r.name)}};a.prototype.parseMeshLibraryBlock=function(e){var a;var t;var r=this.parseVarStr();var s=this._newBlockBytes.readUnsignedInt();var i;var n=this.getAssetByID(s,[d.assetType]);if(n[0]){i=n[1]}else{this._blocks[e].addError("Could not find a Geometry for this Mesh. A empty Geometry is created!");i=new d}this._blocks[e].geoID=s;var o=new Array;a=this._newBlockBytes.readUnsignedShort();var l=new Array;t=0;var h;while(t<a){var c;c=this._newBlockBytes.readUnsignedInt();h=this.getAssetByID(c,[oa.assetType,Ia.assetType]);if(!h[0]&&c>0){this._blocks[e].addError("Could not find Material Nr "+t+" (ID = "+c+" ) for this Mesh")}var p=h[1];p.alphaBlending=true;p.useColorTransform=true;o.push(p);l.push(p.name);t++}var _=new M(i,null);if(o.length>=1&&_.subMeshes.length==1){_.material=o[0]}else if(o.length>1){var u;for(u=0;u<_.subMeshes.length;u++){_.subMeshes[u].material=o[Math.min(o.length-1,u)]}}this.parseProperties(null);_.extra=this.parseUserAttributes();this._pFinalizeAsset(_,r);this._blocks[e].data=_;if(this._debug){console.log("Parsed a Library-Mesh: Name = '"+r+"| Geometry-Name = "+i.name+" | SubMeshes = "+_.subMeshes.length+" | Mat-Names = "+l.toString())}};a.prototype.parseAudioBlock=function(e,a){this._blocks[e].name=this.parseVarStr();var t=this._newBlockBytes.readUnsignedByte();var r;if(t==0){r=this._newBlockBytes.readUnsignedInt();var s;s=this._newBlockBytes.readUTFBytes(r);this._pAddDependency(this._cur_block_id.toString(),new y(s),false,null,true);console.log("Audio url = "+s)}else{r=this._newBlockBytes.readUnsignedInt();var i;i=new B;this._newBlockBytes.readBytes(i,0,r);this._pAddDependency(this._cur_block_id.toString(),null,false,i,true)}this.parseProperties(null);this._blocks[e].extras=this.parseUserAttributes();this._pPauseAndRetrieveDependencies();if(this._debug){var n=["external","embed"];console.log("Start parsing a "+n[t]+" Audio file")}};a.prototype.parseTimeLine=function(e,a){var t;var r;var s;var i=a.createMovieClip();var n=this.parseVarStr();var o=!!this._newBlockBytes.readUnsignedByte();var l=this._newBlockBytes.readUnsignedByte();var d=this._newBlockBytes.readFloat();i.fps=d;var h=1e3/d;var c=0;var f=0;var y=this._newBlockBytes.readUnsignedShort();for(t=0;t<y;t++){j=this._newBlockBytes.readUnsignedInt();var w=this._blocks[j].data;if(w!=null){i.registerPotentialChild(w)}else{console.log("ERROR when collecting objects for timeline")}}f+=y;var b=this._newBlockBytes.readUnsignedShort();y+=b;for(t=0;t<b;t++){j=this._newBlockBytes.readUnsignedInt();c=this._newBlockBytes.readUnsignedShort();f+=c;var w=this._blocks[j].data;if(w!=null){for(r=0;r<c;r++){i.registerPotentialChild(w)}}else{for(r=0;r<c;r++){console.log("ERROR when collecting objects for timeline")}}}if(this._debug)console.log("Parsed "+y+" potential childs. They will be used by "+f+" instances.");var m=this._newBlockBytes.readUnsignedShort();for(t=0;t<m;t++){j=this._newBlockBytes.readUnsignedInt();var w=this._blocks[j].data;if(w!=null){console.log("ERROR when collecting objects for timeline")}else{}}var v=this._newBlockBytes.readUnsignedShort();var g;var B;var k;var D;var A;var P;var j;var N;var M;var S;var x;var U;g=0;for(t=0;t<v;t++){S=new Ca;B=this._newBlockBytes.readUnsignedInt();S.setFrameTime(g,B);g+=B;k=this._newBlockBytes.readUnsignedByte();for(r=0;r<k;r++){S.label=this.parseVarStr()}D=this._newBlockBytes.readUnsignedShort();U=false;for(r=0;r<D;r++){M=this._newBlockBytes.readUnsignedByte();switch(M){case 1:N=this._newBlockBytes.readUnsignedShort();var I=new Array;for(s=0;s<N;s++){P=this._newBlockBytes.readShort();I.push(P)}S.addConstructCommand(new La(I));break;case 2:case 3:A=this._newBlockBytes.readUnsignedShort();if(M==2){U=true;P=this._newBlockBytes.readShort();var W=i.getPotentialChildPrototype(A);if(W!=undefined){S.addConstructCommand(new Oa(A,P));if(W.isAsset(T)){S.addConstructCommand(new Ra(A,W.name))}}else{console.log("ERROR: could not find the objectID ",A)}}var C=this._newBlockBytes.readUnsignedShort();if(Ya.test(C,Ya.FLAG1)){var O=new _;if(Ya.test(C,Ya.FLAG2)){}else{O.rawData[0]=this._newBlockBytes.readFloat();O.rawData[1]=this._newBlockBytes.readFloat();O.rawData[4]=this._newBlockBytes.readFloat();O.rawData[5]=this._newBlockBytes.readFloat();O.position=new u(this._newBlockBytes.readFloat(),this._newBlockBytes.readFloat(),0)}S.addConstructCommand(new Ga(A,"_iMatrix3D",O))}if(Ya.test(C,Ya.FLAG3)){var F=new p;if(Ya.test(C,Ya.FLAG4)){}else{F.redMultiplier=this._newBlockBytes.readFloat();F.greenMultiplier=this._newBlockBytes.readFloat();F.blueMultiplier=this._newBlockBytes.readFloat();F.alphaMultiplier=this._newBlockBytes.readFloat();F.redOffset=this._newBlockBytes.readShort();F.greenOffset=this._newBlockBytes.readShort();F.blueOffset=this._newBlockBytes.readShort();F.alphaOffset=this._newBlockBytes.readShort()}S.addConstructCommand(new Ga(A,"colorTransform",F))}if(Ya.test(C,Ya.FLAG5)){var E=this._newBlockBytes.readUnsignedByte();var L=this.blendModeDic[E]}if(Ya.test(C,Ya.FLAG6)){S.addConstructCommand(new Ga(A,"visible",this._newBlockBytes.readByte()))}if(Ya.test(C,Ya.FLAG7)){var R=this.parseVarStr();if(R.length){S.addConstructCommand(new Ra(A,R))}}if(Ya.test(C,Ya.FLAG8)){var G=this._newBlockBytes.readUnsignedShort();var V=new Array;for(var z=0;z<G;z++){V.push(this._newBlockBytes.readShort())}if(V.length>0){if(V.length==1&&V[0]==-1){S.addConstructCommand(new Ga(A,"_iMaskID",A))}else S.addConstructCommand(new Va(A,V))}}break;case 4:A=this._newBlockBytes.readUnsignedInt();j=this._newBlockBytes.readUnsignedInt();break;default:break}}if(U){S.addConstructCommand(new Fa);U=false}var K=this._newBlockBytes.readUnsignedInt();if(K>0){var H=this._newBlockBytes.readUTFBytes(K);S.addPostConstructCommand(new Ea(H))}this._newBlockBytes.readUnsignedInt();i.addFrame(S)}this._pFinalizeAsset(i,n);this._blocks[e].data=i;this.parseProperties(null);this.parseUserAttributes();if(this._debug)console.log("Parsed a TIMELINE: Name = "+n+"| isScene = "+o+"| sceneID = "+l+"| numFrames = "+v)};a.prototype.parseTriangleGeometrieBlock=function(e){var a=new d;var t=this.parseVarStr();var r=this._newBlockBytes.readUnsignedShort();var o=this.parseProperties({1:this._geoNrType,2:this._geoNrType});var l=o.get(1,1);var p=o.get(2,1);var _=0;while(_<r){var u=false;var f;var y,w;var b;var m;y=this._newBlockBytes.readUnsignedInt();w=this._newBlockBytes.position+y;var v=this.parseProperties({1:this._geoNrType,2:this._geoNrType});while(this._newBlockBytes.position<w){var g=0;var k,D,A,P;D=this._newBlockBytes.readUnsignedByte();k=this._newBlockBytes.readUnsignedByte();A=this._newBlockBytes.readUnsignedInt();P=this._newBlockBytes.position+A;var j,N,M;if(D==1){var T=new Array;while(this._newBlockBytes.position<P){j=this.readNumber(this._accuracyGeo);N=this.readNumber(this._accuracyGeo);M=this.readNumber(this._accuracyGeo);T[g++]=j;T[g++]=N;T[g++]=M}}else if(D==2){var S=new Array;while(this._newBlockBytes.position<P){S[g++]=this._newBlockBytes.readUnsignedShort()}}else if(D==3){var x=new Array;while(this._newBlockBytes.position<P){x[g++]=this.readNumber(this._accuracyGeo)}}else if(D==4){var U=new Array;while(this._newBlockBytes.position<P){U[g++]=this.readNumber(this._accuracyGeo)}}else if(D==6){b=Array();while(this._newBlockBytes.position<P){b[g++]=this._newBlockBytes.readUnsignedShort()*3}}else if(D==7){m=new Array;while(this._newBlockBytes.position<P){m[g++]=this.readNumber(this._accuracyGeo)}}else if(D==8){this._newBlockBytes.position=P}else if(D==9){this._newBlockBytes.position=P}else if(D==10){u=true;var I=new B;this._newBlockBytes.readBytes(I,0,A)}else{this._newBlockBytes.position=P}}this.parseUserAttributes();if(u){var W=new s(28,A/28);W.bufferView=new Uint8Array(I.arraybytes);var C=new h(W);C.setIndices(S);C.setPositions(new i(W));C.setCurves(new n(W));C.setUVs(new n(W));a.addSubGeometry(C);if(this._debug)console.log("Parsed a CurveSubGeometry")}else{var O=new c(new s);if(m)O.jointsPerVertex=m.length/(T.length/3);if(U)O.autoDeriveNormals=false;if(x)O.autoDeriveUVs=false;if(true){O.autoDeriveTangents=true}O.setIndices(S);O.setPositions(T);O.setNormals(U);O.setUVs(x);O.setTangents(null);O.setJointWeights(m);O.setJointIndices(b);var F=v.get(1,1);var E=v.get(2,1);var L=false;if(l!=F||p!=E){L=true;F=l/F;E=p/E}if(L)O.scaleUV(F,E);a.addSubGeometry(O);if(this._debug)console.log("Parsed a TriangleSubGeometry")}_++}if(l!=1||p!=1)a.scaleUV(l,p);this.parseUserAttributes();this._pFinalizeAsset(a,t);this._blocks[e].data=a;if(this._debug){console.log("Parsed a TriangleGeometry: Name = "+t)}};a.prototype.parsePrimitves=function(e){var t;var r;var s;var i;var n;var o;t=this.parseVarStr();s=this._newBlockBytes.readUnsignedByte();n=this.parseProperties({101:this._geoNrType,102:this._geoNrType,103:this._geoNrType,110:this._geoNrType,111:this._geoNrType,301:a.UINT16,302:a.UINT16,303:a.UINT16,701:a.BOOL,702:a.BOOL,703:a.BOOL,704:a.BOOL});var l=["Unsupported Type-ID","PrimitivePlanePrefab","PrimitiveCubePrefab","PrimitiveSpherePrefab","PrimitiveCylinderPrefab","PrimitivesConePrefab","PrimitivesCapsulePrefab","PrimitivesTorusPrefab"];switch(s){case 1:r=new z(n.get(101,100),n.get(102,100),n.get(301,1),n.get(302,1),n.get(701,true),n.get(702,false));break;case 2:r=new G(n.get(101,100),n.get(102,100),n.get(103,100),n.get(301,1),n.get(302,1),n.get(303,1),n.get(701,true));break;case 3:r=new K(n.get(101,50),n.get(301,16),n.get(302,12),n.get(701,true));break;case 4:r=new V(n.get(101,50),n.get(102,50),n.get(103,100),n.get(301,16),n.get(302,1),true,true,true);if(!n.get(701,true))r.topClosed=false;if(!n.get(702,true))r.bottomClosed=false;if(!n.get(703,true))r.yUp=false;break;case 5:r=new R(n.get(101,50),n.get(102,100),n.get(301,16),n.get(302,1),n.get(701,true),n.get(702,true));break;case 6:r=new L(n.get(101,50),n.get(102,100),n.get(301,16),n.get(302,15),n.get(701,true));break;case 7:r=new H(n.get(101,50),n.get(102,50),n.get(301,16),n.get(302,8),n.get(701,true));break;default:r=new F;console.log("ERROR: UNSUPPORTED PREFAB_TYPE");break}if(n.get(110,1)!=1||n.get(111,1)!=1){}this.parseUserAttributes();r.name=t;this._pFinalizeAsset(r,t);this._blocks[e].data=r;if(this._debug){if(s<0||s>7){s=0}console.log("Parsed a Primivite: Name = "+t+"| type = "+l[s])}};a.prototype.parseContainer=function(e){var t;var r;var s;var i;var n;r=this._newBlockBytes.readUnsignedInt();s=this.parseMatrix3D();t=this.parseVarStr();var o="Root (TopLevel)";i=new D;i.transform.matrix3D=s;var l=this.getAssetByID(r,[D.assetType,A.assetType,M.assetType]);if(l[0]){var d=l[1].addChild(i);o=l[1].name}else if(r>0){this._blocks[e].addError("Could not find a parent for this ObjectContainer3D")}else{this._pContent.addChild(i)}if(this._version[0]==2&&this._version[1]==1){var h=this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:a.UINT8});i.pivot=new u(h.get(1,0),h.get(2,0),h.get(3,0))}else{this.parseProperties(null)}i.extra=this.parseUserAttributes();this._pFinalizeAsset(i,t);this._blocks[e].data=i;if(this._debug){console.log("Parsed a Container: Name = '"+t+"' | Parent-Name = "+o)}};a.prototype.parseMeshInstance=function(e){var t;var r;var s;var i=this._newBlockBytes.readUnsignedInt();var n=this.parseMatrix3D();var o=this.parseVarStr();var l="Root (TopLevel)";var h=this._newBlockBytes.readUnsignedInt();var c;var p;var _=this.getAssetByID(h,[d.assetType]);var f=false;if(_[0]){c=_[1]}else{var y=this.getAssetByID(h,[E.assetType]);if(y[0]){f=true;p=y[1]}else{this._blocks[e].addError("Could not find a Geometry or prefab for this Mesh "+h+". A empty Geometry is created!");c=new d}}this._blocks[e].geoID=h;var w=new Array;t=this._newBlockBytes.readUnsignedShort();var b=new Array;r=0;var m;while(r<t){var v;v=this._newBlockBytes.readUnsignedInt();m=this.getAssetByID(v,[oa.assetType,Ia.assetType]);if(!m[0]&&v>0){this._blocks[e].addError("Could not find Material Nr "+r+" (ID = "+v+" ) for this Mesh")}var g=m[1];w.push(g);b.push(g.name);r++}var B;if(f){B=p.getNewObject()}else{B=new M(c,null)}B.transform.matrix3D=n;var k=this.getAssetByID(i,[D.assetType,A.assetType,M.assetType]);if(k[0]){var P=k[1];P.addChild(B);l=P.name}else if(i>0){this._blocks[e].addError("Could not find a parent for this Mesh")}else{this._pContent.addChild(B)}if(w.length>=1&&B.subMeshes.length==1){B.material=w[0]}else if(w.length>1){var j;for(j=0;j<B.subMeshes.length;j++){B.subMeshes[j].material=w[Math.min(w.length-1,j)]}}if(this._version[0]==2&&this._version[1]==1){var N=this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:a.UINT8,5:a.BOOL});B.pivot=new u(N.get(1,0),N.get(2,0),N.get(3,0));B.castsShadows=N.get(5,true)}else{this.parseProperties(null)}B.extra=this.parseUserAttributes();this._pFinalizeAsset(B,o);this._blocks[e].data=B;if(this._debug){if(f){console.log("Parsed a Mesh for Prefab: Name = '"+o+"' | Parent-Name = "+l+"| Prefab-Name = "+p.name+" | SubMeshes = "+B.subMeshes.length+" | Mat-Names = "+b.toString())}else{console.log("Parsed a Mesh for Geometry: Name = '"+o+"' | Parent-Name = "+l+"| Geometry-Name = "+c.name+" | SubMeshes = "+B.subMeshes.length+" | Mat-Names = "+b.toString())
}}};a.prototype.parseSkyboxInstance=function(e){var a=this.parseVarStr();var t=this._newBlockBytes.readUnsignedInt();var r=this.getAssetByID(t,[J.assetType]);if(!r[0]&&t!=0)this._blocks[e].addError("Could not find the Cubetexture (ID = "+t+" ) for this Skybox");var s=new x(r[1]);this.parseProperties(null);s.extra=this.parseUserAttributes();this._pFinalizeAsset(s,a);this._blocks[e].data=s;if(this._debug)console.log("Parsed a Skybox: Name = '"+a+"' | CubeTexture-Name = "+r[1].name)};a.prototype.parseLight=function(e){var t;var r;var s=this._newBlockBytes.readUnsignedInt();var i=this.parseMatrix3D();var n=this.parseVarStr();var o=this._newBlockBytes.readUnsignedByte();var l=this.parseProperties({1:this._propsNrType,2:this._propsNrType,3:a.COLOR,4:this._propsNrType,5:this._propsNrType,6:a.BOOL,7:a.COLOR,8:this._propsNrType,9:a.UINT8,10:a.UINT8,11:this._propsNrType,12:a.UINT16,21:this._matrixNrType,22:this._matrixNrType,23:this._matrixNrType});var d=l.get(9,0);var h="Root (TopLevel)";var c=["Unsupported LightType","PointLight","DirectionalLight"];var p=["No ShadowMapper","DirectionalShadowMapper","NearDirectionalShadowMapper","CascadeShadowMapper","CubeMapShadowMapper"];if(o==1){t=new j;t.radius=l.get(1,9e4);t.fallOff=l.get(2,1e5);if(d>0){if(d==4){r=new C}}t.transform.matrix3D=i}if(o==2){t=new P(l.get(21,0),l.get(22,-1),l.get(23,1));if(d>0){if(d==1){r=new O}}}t.color=l.get(3,16777215);t.specular=l.get(4,1);t.diffuse=l.get(5,1);t.ambientColor=l.get(7,16777215);t.ambient=l.get(8,0);if(r){if(r instanceof C){if(l.get(10,1)!=1){r.depthMapSize=this._depthSizeDic[l.get(10,1)]}}else{if(l.get(10,2)!=2){r.depthMapSize=this._depthSizeDic[l.get(10,2)]}}t.shadowMapper=r;t.castsShadows=true}if(s!=0){var _=this.getAssetByID(s,[D.assetType,A.assetType,M.assetType]);if(_[0]){_[1].addChild(t);h=_[1].name}else{this._blocks[e].addError("Could not find a parent for this Light")}}else{this._pContent.addChild(t)}this.parseUserAttributes();this._pFinalizeAsset(t,n);this._blocks[e].data=t;if(this._debug)console.log("Parsed a Light: Name = '"+n+"' | Type = "+c[o]+" | Parent-Name = "+h+" | ShadowMapper-Type = "+p[d])};a.prototype.parseCamera=function(e){var t=this._newBlockBytes.readUnsignedInt();var r=this.parseMatrix3D();var s=this.parseVarStr();var i="Root (TopLevel)";var n;this._newBlockBytes.readUnsignedByte();this._newBlockBytes.readShort();var o=this._newBlockBytes.readShort();var l=this.parseProperties({101:this._propsNrType,102:this._propsNrType,103:this._propsNrType,104:this._propsNrType});switch(o){case 5001:n=new m(l.get(101,60));break;case 5002:n=new v(l.get(101,500));break;case 5003:n=new g(l.get(101,-400),l.get(102,400),l.get(103,-300),l.get(104,300));break;default:console.log("unsupportedLenstype");return}var d=new N(n);d.transform.matrix3D=r;var h=this.getAssetByID(t,[D.assetType,A.assetType,M.assetType]);if(h[0]){var c=h[1];c.addChild(d);i=c.name}else if(t>0){this._blocks[e].addError("Could not find a parent for this Camera")}else{this._pContent.addChild(d)}d.name=s;l=this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:a.UINT8});d.pivot=new u(l.get(1,0),l.get(2,0),l.get(3,0));d.extra=this.parseUserAttributes();this._pFinalizeAsset(d,s);this._blocks[e].data=d;if(this._debug){console.log("Parsed a Camera: Name = '"+s+"' | Projectiontype = "+n+" | Parent-Name = "+i)}};a.prototype.parseLightPicker=function(e){var a=this.parseVarStr();var t=this._newBlockBytes.readUnsignedShort();var r=new Array;var s=0;var i=0;var n;var o=new Array;for(s=0;s<t;s++){i=this._newBlockBytes.readUnsignedInt();n=this.getAssetByID(i,[A.assetType]);if(n[0]){r.push(n[1]);o.push(n[1].name)}else{this._blocks[e].addError("Could not find a Light Nr "+s+" (ID = "+i+" ) for this LightPicker")}}if(r.length==0){this._blocks[e].addError("Could not create this LightPicker, cause no Light was found.");this.parseUserAttributes();return}var l=new W(r);l.name=a;this.parseUserAttributes();this._pFinalizeAsset(l,a);this._blocks[e].data=l;if(this._debug){console.log("Parsed a StaticLightPicker: Name = '"+a+"' | Texture-Name = "+o.toString())}};a.prototype.parseMaterial=function(e){var t;var r;var s;var i;var n;var o;var l;var d;var h;t=this.parseVarStr();r=this._newBlockBytes.readUnsignedByte();l=this._newBlockBytes.readUnsignedByte();s=this.parseProperties({1:a.INT32,2:a.BADDR,10:this._propsNrType,11:a.BOOL,12:this._propsNrType,13:a.BOOL});d=0;while(d<l){var c;c=this._newBlockBytes.readUnsignedShort();this.parseProperties(null);this.parseUserAttributes();d+=1}var p="";n=this.parseUserAttributes();if(r===1){p+="Parsed a ColorMaterial(SinglePass): Name = '"+t+"' | ";var _;_=s.get(1,16777215);if(this.materialMode<2){i=new oa(_,s.get(10,1))}else{i=new oa(_);i.mode=na.MULTI_PASS}}else if(r===2){var u=s.get(2,0);h=this.getAssetByID(u,[X.assetType]);if(!h[0]&&u>0)this._blocks[e].addError("Could not find the DiffsueTexture (ID = "+u+" ) for this Material");i=new oa(h[1]);if(this.materialMode<2){i.alphaBlending=s.get(11,false);i.alpha=s.get(10,1);p+="Parsed a MethodMaterial(SinglePass): Name = '"+t+"' | Texture-Name = "+i.name}else{i.mode=na.MULTI_PASS;p+="Parsed a MethodMaterial(MultiPass): Name = '"+t+"' | Texture-Name = "+i.name}}i.extra=n;i.alphaThreshold=s.get(12,0);i.repeat=s.get(13,false);this._pFinalizeAsset(i,t);this._blocks[e].data=i;if(this._debug){console.log(p)}};a.prototype.parseMaterial_v1=function(e){var t;var r;var s;var i;var n=this.parseVarStr();var o=this._newBlockBytes.readUnsignedByte();var l=this._newBlockBytes.readUnsignedByte();var d=this.parseProperties({1:a.UINT32,2:a.BADDR,3:a.BADDR,4:a.UINT8,5:a.BOOL,6:a.BOOL,7:a.BOOL,8:a.BOOL,9:a.UINT8,10:this._propsNrType,11:a.BOOL,12:this._propsNrType,13:a.BOOL,15:this._propsNrType,16:a.UINT32,17:a.BADDR,18:this._propsNrType,19:this._propsNrType,20:a.UINT32,21:a.BADDR,22:a.BADDR});var h=d.get(4,0);var c="Parsed Material ";if(h>=2){this._blocks[e].addError("Material-spezialType '"+h+"' is not supported, can only be 0:singlePass, 1:MultiPass !");return}if(o<=2){if(this.materialMode==1)h=0;else if(this.materialMode==2)h=1;if(h<2){if(o==1){var p=d.get(1,13421772);if(h==1){t=new oa(p);t.mode=na.MULTI_PASS;c+="Parsed a ColorMaterial(MultiPass): Name = '"+n+"' | "}else{t=new oa(p,d.get(10,1));t.alphaBlending=d.get(11,false);c+="Parsed a ColorMaterial(SinglePass): Name = '"+n+"' | "}}else if(o==2){var _=d.get(2,0);i=this.getAssetByID(_,[X.assetType]);if(!i[0]&&_>0)this._blocks[e].addError("Could not find the AmbientTexture (ID = "+_+" ) for this MethodMaterial");var u=i[1];t=new oa(u);if(h==1){t.mode=na.MULTI_PASS;c+="Parsed a MethodMaterial(MultiPass): Name = '"+n+"' | Texture-Name = "+u.name}else{t.alpha=d.get(10,1);t.alphaBlending=d.get(11,false);c+="Parsed a MethodMaterial(SinglePass): Name = '"+n+"' | Texture-Name = "+u.name}}var f;var y=d.get(17,0);i=this.getAssetByID(y,[X.assetType]);if(!i[0]&&y!=0){this._blocks[e].addError("Could not find the DiffuseTexture (ID = "+y+" ) for this MethodMaterial")}if(i[0])f=i[1];if(f){t.diffuseTexture=f;c+=" | DiffuseTexture-Name = "+f.name}var w=d.get(3,0);i=this.getAssetByID(w,[X.assetType]);if(!i[0]&&w!=0){this._blocks[e].addError("Could not find the NormalTexture (ID = "+w+" ) for this MethodMaterial")}if(i[0]){r=i[1];c+=" | NormalTexture-Name = "+r.name}var b=d.get(21,0);i=this.getAssetByID(b,[X.assetType]);if(!i[0]&&b!=0){this._blocks[e].addError("Could not find the SpecularTexture (ID = "+b+" ) for this MethodMaterial")}if(i[0]){s=i[1];c+=" | SpecularTexture-Name = "+s.name}var m=d.get(22,0);i=this.getAssetByID(m,[I.assetType]);if(!i[0]&&m){this._blocks[e].addError("Could not find the LightPicker (ID = "+m+" ) for this MethodMaterial")}else{t.lightPicker=i[1]}t.smooth=d.get(5,true);t.mipmap=d.get(6,true);t.bothSides=d.get(7,false);t.alphaPremultiplied=d.get(8,false);t.blendMode=this.blendModeDic[d.get(9,0)];t.repeat=d.get(13,false);if(r)t.normalMap=r;if(s)t.specularMap=s;t.alphaThreshold=d.get(12,0);t.ambient=d.get(15,1);t.diffuseColor=d.get(16,16777215);t.specular=d.get(18,1);t.gloss=d.get(19,50);t.specularColor=d.get(20,16777215);var v=0;var g;while(v<l){var B;B=this._newBlockBytes.readUnsignedShort();d=this.parseProperties({1:a.BADDR,2:a.BADDR,3:a.BADDR,101:this._propsNrType,102:this._propsNrType,103:this._propsNrType,201:a.UINT32,202:a.UINT32,301:a.UINT16,302:a.UINT16,401:a.UINT8,402:a.UINT8,601:a.COLOR,602:a.COLOR,701:a.BOOL,702:a.BOOL,801:a.MTX4x4});switch(B){case 999:g=d.get(1,0);i=this.getAssetByID(g,[ga.assetType]);if(!i[0]){this._blocks[e].addError("Could not find the EffectMethod (ID = "+g+" ) for this Material")}else{t.addEffectMethod(i[1]);c+=" | EffectMethod-Name = "+i[1].name}break;case 998:g=d.get(1,0);i=this.getAssetByID(g,[Pa.assetType]);if(!i[0]){this._blocks[e].addError("Could not find the ShadowMethod (ID = "+g+" ) for this Material")}else{t.shadowMethod=i[1];c+=" | ShadowMethod-Name = "+i[1].name}break;case 1:g=d.get(1,0);i=this.getAssetByID(g,[J.assetType]);if(!i[0])this._blocks[e].addError("Could not find the EnvMap (ID = "+g+" ) for this EnvMapAmbientMethodMaterial");t.ambientMethod=new la;t.texture=i[1];c+=" | AmbientEnvMapMethod | EnvMap-Name ="+i[1].name;break;case 51:t.diffuseMethod=new da;c+=" | DiffuseDepthMethod";break;case 52:g=d.get(1,0);i=this.getAssetByID(g,[X.assetType]);if(!i[0])this._blocks[e].addError("Could not find the GradientDiffuseTexture (ID = "+g+" ) for this GradientDiffuseMethod");t.diffuseMethod=new ca(i[1]);c+=" | DiffuseGradientMethod | GradientDiffuseTexture-Name ="+i[1].name;break;case 53:t.diffuseMethod=new _a(d.get(101,5));c+=" | DiffuseWrapMethod";break;case 54:g=d.get(1,0);i=this.getAssetByID(g,[X.assetType]);if(!i[0])this._blocks[e].addError("Could not find the LightMap (ID = "+g+" ) for this LightMapDiffuseMethod");t.diffuseMethod=new pa(i[1],this.blendModeDic[d.get(401,10)],false,t.diffuseMethod);c+=" | DiffuseLightMapMethod | LightMapTexture-Name ="+i[1].name;break;case 55:t.diffuseMethod=new ha(d.get(401,3),t.diffuseMethod);t.diffuseMethod.smoothness=d.get(101,.1);c+=" | DiffuseCelMethod";break;case 56:break;case 101:t.specularMethod=new Ma;c+=" | SpecularAnisotropicMethod";break;case 102:t.specularMethod=new Sa;c+=" | SpecularPhongMethod";break;case 103:t.specularMethod=new Ta(d.get(101,.5),t.specularMethod);t.specularMethod.smoothness=d.get(102,.1);c+=" | SpecularCelMethod";break;case 104:t.specularMethod=new ja(d.get(701,true),t.specularMethod);t.specularMethod.fresnelPower=d.get(101,5);t.specularMethod.normalReflectance=d.get(102,.1);c+=" | SpecularFresnelMethod";break;case 151:break;case 152:g=d.get(1,0);i=this.getAssetByID(g,[X.assetType]);if(!i[0])this._blocks[e].addError("Could not find the SecoundNormalMap (ID = "+g+" ) for this SimpleWaterNormalMethod");if(!t.normalMap)this._blocks[e].addError("Could not find a normal Map on this Material to use with this SimpleWaterNormalMethod");t.normalMap=i[1];t.normalMethod=new ka(t.normalMap,i[1]);c+=" | NormalSimpleWaterMethod | Second-NormalTexture-Name = "+i[1].name;break}this.parseUserAttributes();v+=1}}}else if(o>=3&&o<=7){var p=d.get(1,13421772);c+=p;var f;var y=d.get(2,0);i=this.getAssetByID(y,[X.assetType]);if(!i[0]&&y!=0){this._blocks[e].addError("Could not find the DiffuseTexture (ID = "+y+" ) for this MethodMaterial");f=U.getDefaultTexture()}if(i[0])f=i[1];var k=new Ia(f);c+=" texture = "+y+" ";k.bothSides=true;k.preserveAlpha=true;k.alphaBlending=true;k.extra=this.parseUserAttributes();this._pFinalizeAsset(k,n);this._blocks[e].data=k;if(this._debug)console.log(c);return}t.extra=this.parseUserAttributes();this._pFinalizeAsset(t,n);this._blocks[e].data=t;if(this._debug){console.log(c)}};a.prototype.parseTexture=function(e){var a;this._blocks[e].name=this.parseVarStr();var t=this._newBlockBytes.readUnsignedByte();var r;this._texture_users[this._cur_block_id.toString()]=[];if(t==0){r=this._newBlockBytes.readUnsignedInt();var s;s=this._newBlockBytes.readUTFBytes(r);this._pAddDependency(this._cur_block_id.toString(),new y(s),false,null,true)}else{r=this._newBlockBytes.readUnsignedInt();var i;i=new B;this._newBlockBytes.readBytes(i,0,r);this._pAddDependency(this._cur_block_id.toString(),null,false,b.byteArrayToImage(i),true)}this.parseProperties(null);this._blocks[e].extras=this.parseUserAttributes();this._blocks[e].data=a;if(this._debug){var n=["external","embed"];console.log("Start parsing a "+n[t]+" Bitmap for Texture")}this._pPauseAndRetrieveDependencies()};a.prototype.parseCubeTexture=function(e){var a;var t;var r;this._cubeBitmaps=new Array;this._texture_users[this._cur_block_id.toString()]=[];var s=this._newBlockBytes.readUnsignedByte();this._blocks[e].name=this.parseVarStr();for(r=0;r<6;r++){this._texture_users[this._cur_block_id.toString()]=[];this._cubeBitmaps.push(null);if(s==0){a=this._newBlockBytes.readUnsignedInt();var i;i=this._newBlockBytes.readUTFBytes(a);this._pAddDependency(this._cur_block_id.toString(),new y(i),false,null,true,r)}else{a=this._newBlockBytes.readUnsignedInt();var n;n=new B;this._newBlockBytes.readBytes(n,0,a);this._pAddDependency(this._cur_block_id.toString(),null,false,b.byteArrayToImage(n),true,r)}}this.parseProperties(null);this._blocks[e].extras=this.parseUserAttributes();this._pPauseAndRetrieveDependencies();this._blocks[e].data=t;if(this._debug){var o=["external","embed"];console.log("Start parsing 6 "+o[s]+" Bitmaps for CubeTexture")}};a.prototype.parseSharedMethodBlock=function(e){var a;this._blocks[e].name=this.parseVarStr();a=this.parseSharedMethodList(e);this.parseUserAttributes();this._blocks[e].data=a;this._pFinalizeAsset(a,this._blocks[e].name);this._blocks[e].data=a;if(this._debug){console.log("Parsed a EffectMethod: Name = "+a.name+" Type = "+a)}};a.prototype.parseShadowMethodBlock=function(e){var a;var t;var r;var s;this._blocks[e].name=this.parseVarStr();s=this._newBlockBytes.readUnsignedInt();var i=this.getAssetByID(s,[A.assetType]);if(!i[0]){this._blocks[e].addError("Could not find the TargetLight (ID = "+s+" ) for this ShadowMethod - ShadowMethod not created");return}r=this.parseShadowMethodList(i[1],e);if(!r)return;this.parseUserAttributes();this._pFinalizeAsset(r,this._blocks[e].name);this._blocks[e].data=r;if(this._debug){console.log("Parsed a ShadowMapMethodMethod: Name = "+r.name+" | Type = "+r+" | Light-Name = ",i[1].name)}};a.prototype.parseCommand=function(e){var t=this._newBlockBytes.readUnsignedByte()==1;var r=this._newBlockBytes.readUnsignedInt();var s=this.parseMatrix3D();var i=this.parseVarStr();var n;var o;var l=this.getAssetByID(r,[D.assetType,A.assetType,M.assetType]);if(l[0]){n=l[1]}var d=this._newBlockBytes.readShort();var h=this._newBlockBytes.readShort();var c=this.parseProperties({1:a.BADDR});switch(h){case 1:var p=c.get(1,0);var _=this.getAssetByID(p,[A.assetType]);if(!_[0]&&p!=0){this._blocks[e].addError("Could not find the light (ID = "+p+" ( for this CommandBock!");return}o=_[1];if(n){n.addChild(o)}o.transform.matrix3D=s;break}if(o){c=this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:a.UINT8});o.pivot=new u(c.get(1,0),c.get(2,0),c.get(3,0));o.extra=this.parseUserAttributes()}this._blocks[e].data=o;if(this._debug){console.log("Parsed a CommandBlock: Name = '"+i)}};a.prototype.parseMetaData=function(e){var t=this.parseProperties({1:a.UINT32,2:a.AWDSTRING,3:a.AWDSTRING,4:a.AWDSTRING,5:a.AWDSTRING});if(this._debug){console.log("Parsed a MetaDataBlock: TimeStamp         = "+t.get(1,0));console.log("                        EncoderName       = "+t.get(2,"unknown"));console.log("                        EncoderVersion    = "+t.get(3,"unknown"));console.log("                        GeneratorName     = "+t.get(4,"unknown"));console.log("                        GeneratorVersion  = "+t.get(5,"unknown"))}};a.prototype.parseNameSpace=function(e){var a=this._newBlockBytes.readUnsignedByte();var t=this.parseVarStr();if(this._debug)console.log("Parsed a NameSpaceBlock: ID = "+a+" | String = "+t)};a.prototype.parseShadowMethodList=function(e,t){var r=this._newBlockBytes.readUnsignedShort();var s;var i=this.parseProperties({1:a.BADDR,2:a.BADDR,3:a.BADDR,101:this._propsNrType,102:this._propsNrType,103:this._propsNrType,201:a.UINT32,202:a.UINT32,301:a.UINT16,302:a.UINT16,401:a.UINT8,402:a.UINT8,601:a.COLOR,602:a.COLOR,701:a.BOOL,702:a.BOOL,801:a.MTX4x4});var n;var o;switch(r){case 1002:n=i.get(1,0);o=this.getAssetByID(n,[Pa.assetType]);if(!o[0]){this._blocks[t].addError("Could not find the ShadowBaseMethod (ID = "+n+" ) for this ShadowNearMethod - ShadowMethod not created");return s}s=new xa(o[1]);break;case 1101:s=new Aa(e);s.alpha=i.get(101,1);s.epsilon=i.get(102,.002);break;case 1102:s=new Da(e,i.get(201,5));s.alpha=i.get(101,1);s.epsilon=i.get(102,.002);s.range=i.get(103,1);break;case 1103:s=new Ua(e,i.get(201,5));s.alpha=i.get(101,1);s.epsilon=i.get(102,.002);s.range=i.get(103,1);break;case 1104:s=new Na(e);s.alpha=i.get(101,1);s.epsilon=i.get(102,.002);break}this.parseUserAttributes();return s};a.prototype.parseSkeleton=function(e){var a=this.parseVarStr();var t=this._newBlockBytes.readUnsignedShort();var r=new aa;this.parseProperties(null);var s=0;while(s<t){var i;var n;this._newBlockBytes.readUnsignedShort();i=new ra;i.parentIndex=this._newBlockBytes.readUnsignedShort()-1;i.name=this.parseVarStr();n=this.parseMatrix3D();i.inverseBindPose=n.rawData;this.parseProperties(null);this.parseUserAttributes();r.joints.push(i);s++}this.parseUserAttributes();this._pFinalizeAsset(r,a);this._blocks[e].data=r;if(this._debug)console.log("Parsed a Skeleton: Name = "+r.name+" | Number of Joints = "+s)};a.prototype.parseSkeletonPose=function(e){var a=this.parseVarStr();var t=this._newBlockBytes.readUnsignedShort();this.parseProperties(null);var r=new ta;var s=0;while(s<t){var i;var n;i=new ea;n=this._newBlockBytes.readUnsignedByte();if(n==1){var o=this.parseMatrix43RawData();var l=new _(o);i.orientation.fromMatrix(l);i.translation.copyFrom(l.position);r.jointPoses[s]=i}s++}this.parseUserAttributes();this._pFinalizeAsset(r,a);this._blocks[e].data=r;if(this._debug)console.log("Parsed a SkeletonPose: Name = "+r.name+" | Number of Joints = "+s)};a.prototype.parseSkeletonAnimation=function(e){var a;var t;var r=this.parseVarStr();var s=new sa;var i=this._newBlockBytes.readUnsignedShort();this.parseProperties(null);var n=0;var o;while(n<i){t=this._newBlockBytes.readUnsignedInt();a=this._newBlockBytes.readUnsignedShort();o=this.getAssetByID(t,[ta.assetType]);if(!o[0])this._blocks[e].addError("Could not find the SkeletonPose Frame # "+n+" (ID = "+t+" ) for this SkeletonClipNode");else s.addFrame(this._blocks[t].data,a);n++}if(s.frames.length==0){this._blocks[e].addError("Could not this SkeletonClipNode, because no Frames where set.");return}this.parseUserAttributes();this._pFinalizeAsset(s,r);this._blocks[e].data=s;if(this._debug)console.log("Parsed a SkeletonClipNode: Name = "+s.name+" | Number of Frames = "+s.frames.length)};a.prototype.parseMeshPoseAnimation=function(e,t){if(t===void 0){t=false}var r=1;var i;var n;var o;var l;var h;var p;var _;var u;var f;var y;var w;var b=0;var m=new ia;var v;var g;var B=0;var k=0;var D=new Array;var A;var P;var j=this.parseVarStr();var N=this._newBlockBytes.readUnsignedInt();var M=this.getAssetByID(N,[d.assetType]);if(!M[0]){this._blocks[e].addError("Could not find the target-Geometry-Object "+N+" ) for this VertexClipNode");return}var T=this.getUVForVertexAnimation(N);if(!t)r=this._newBlockBytes.readUnsignedShort();i=this._newBlockBytes.readUnsignedShort();B=this._newBlockBytes.readUnsignedShort();k=0;while(k<B){D.push(this._newBlockBytes.readUnsignedShort());k++}A=this.parseProperties({1:a.BOOL,2:a.BOOL});m.looping=A.get(1,true);m.stitchFinalFrame=A.get(2,false);n=0;while(n<r){l=this._newBlockBytes.readUnsignedShort();y=new d;o=0;while(o<i){k=0;u=this._newBlockBytes.readUnsignedInt();f=this._newBlockBytes.position+u;while(k<B){if(D[k]==1){v=M[1].subGeometries[o].indices;g=new Array;b=0;while(this._newBlockBytes.position<f){h=this.readNumber(this._accuracyGeo);p=this.readNumber(this._accuracyGeo);_=this.readNumber(this._accuracyGeo);g[b++]=h;g[b++]=p;g[b++]=_}w=new c(new s);w.setIndices(v);w.setPositions(g);w.setUVs(T[o]);w.setNormals(null);w.setTangents(null);w.autoDeriveNormals=false;w.autoDeriveTangents=false;o++;y.addSubGeometry(w)}else this._newBlockBytes.position=f;k++}}m.addFrame(y,l);n++}this.parseUserAttributes();this._pFinalizeAsset(m,j);this._blocks[e].data=m;if(this._debug)console.log("Parsed a VertexClipNode: Name = "+m.name+" | Target-Geometry-Name = "+M[1].name+" | Number of Frames = "+m.frames.length)};a.prototype.parseVertexAnimationSet=function(e){var t;var r="";var s=this.parseVarStr();var i=this._newBlockBytes.readUnsignedShort();var n=this.parseProperties({1:a.UINT16});var o=0;var l=new Array;var d=new Array;while(o<i){t=this._newBlockBytes.readUnsignedInt();var h=this.getAssetByID(t,[k.assetType]);if(!h[0])this._blocks[e].addError("Could not find the AnimationClipNode Nr "+o+" ( "+t+" ) for this AnimationSet");else{if(h[1]instanceof ia)d.push(h[1]);if(h[1]instanceof sa)l.push(h[1])}o++}if(d.length==0&&l.length==0){this._blocks[e].addError("Could not create this AnimationSet, because it contains no animations");return}this.parseUserAttributes();if(d.length>0){var c=new Q;for(var p=0;p<d.length;p++)c.addAnimation(d[p]);this._pFinalizeAsset(c,s);this._blocks[e].data=c;if(this._debug)console.log("Parsed a VertexAnimationSet: Name = "+s+" | Animations = "+c.animations.length+" | Animation-Names = "+c.animationNames.toString())}else if(l.length>0){h=this.getAssetByID(t,[k.assetType]);var _=new Z(n.get(1,4));for(var p=0;p<l.length;p++)_.addAnimation(l[p]);this._pFinalizeAsset(_,s);this._blocks[e].data=_;if(this._debug)console.log("Parsed a SkeletonAnimationSet: Name = "+s+" | Animations = "+_.animations.length+" | Animation-Names = "+_.animationNames.toString())}};a.prototype.parseAnimatorSet=function(e){var t;var r;var s;var i="";var n=this.parseVarStr();var o=this._newBlockBytes.readUnsignedShort();var l=this.parseProperties({1:a.BADDR});r=this._newBlockBytes.readUnsignedInt();var d=this._newBlockBytes.readUnsignedShort();var h=new Array;for(var c=0;c<d;c++)h.push(this._newBlockBytes.readUnsignedInt());var p=this._newBlockBytes.readUnsignedShort();var _=this._newBlockBytes.readUnsignedByte()==1;this.parseUserAttributes();this.parseUserAttributes();var u;var f=new Array;for(c=0;c<h.length;c++){u=this.getAssetByID(h[c],[M.assetType]);if(u[0])f.push(u[1])}u=this.getAssetByID(r,[Y.assetType]);if(!u[0]){this._blocks[e].addError("Could not find the AnimationSet ( "+r+" ) for this Animator");return}s=u[1];var y;if(o==1){u=this.getAssetByID(l.get(1,0),[aa.assetType]);if(!u[0]){this._blocks[e].addError("Could not find the Skeleton ( "+l.get(1,0)+" ) for this Animator");return}y=new $(s,u[1])}else if(o==2)y=new q(s);this._pFinalizeAsset(y,n);this._blocks[e].data=y;for(c=0;c<f.length;c++){if(o==1)f[c].animator=y;if(o==2)f[c].animator=y}if(this._debug)console.log("Parsed a Animator: Name = "+n)};a.prototype.parseSharedMethodList=function(e){var t=this._newBlockBytes.readUnsignedShort();var r;var s=this.parseProperties({1:a.BADDR,2:a.BADDR,3:a.BADDR,101:this._propsNrType,102:this._propsNrType,103:this._propsNrType,104:this._propsNrType,105:this._propsNrType,106:this._propsNrType,107:this._propsNrType,201:a.UINT32,202:a.UINT32,301:a.UINT16,302:a.UINT16,401:a.UINT8,402:a.UINT8,601:a.COLOR,602:a.COLOR,701:a.BOOL,702:a.BOOL});var i;var n;switch(t){case 401:r=new fa(s.get(101,new Array(0,0,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)));break;case 402:r=new ya;var o=s.get(601,0);r.colorTransform=new p(s.get(102,1),s.get(103,1),s.get(104,1),s.get(101,1),o>>16&255,o>>8&255,o&255,o>>24&255);break;case 403:i=s.get(1,0);console.log("ENV MAP",i);n=this.getAssetByID(i,[J.assetType]);if(!n[0])this._blocks[e].addError("Could not find the EnvMap (ID = "+i+" ) for this EnvMapMethod");r=new wa(n[1],s.get(101,1));i=s.get(2,0);if(i>0){n=this.getAssetByID(i,[X.assetType]);if(!n[0])this._blocks[e].addError("Could not find the Mask-texture (ID = "+i+" ) for this EnvMapMethod")}break;case 404:i=s.get(1,0);n=this.getAssetByID(i,[X.assetType]);if(!n[0])this._blocks[e].addError("Could not find the LightMap (ID = "+i+" ) for this LightMapMethod");r=new va(n[1],this.blendModeDic[s.get(401,10)]);break;case 406:r=new Ba(s.get(601,16777215),s.get(101,.4),s.get(101,2));break;case 407:i=s.get(1,0);n=this.getAssetByID(i,[X.assetType]);if(!n[0])this._blocks[e].addError("Could not find the Alpha-texture (ID = "+i+" ) for this AlphaMaskMethod");r=new ua(n[1],s.get(701,false));break;case 410:i=s.get(1,0);n=this.getAssetByID(i,[J.assetType]);if(!n[0])this._blocks[e].addError("Could not find the EnvMap (ID = "+i+" ) for this FresnelEnvMapMethod");r=new ma(n[1],s.get(101,1));break;case 411:r=new ba(s.get(101,0),s.get(102,1e3),s.get(601,8421504));break}this.parseUserAttributes();return r};a.prototype.parseUserAttributes=function(){var e;var t;var r;t=this._newBlockBytes.readUnsignedInt();if(t>0){var s;e={};s=this._newBlockBytes.position+t;while(this._newBlockBytes.position<s){var i;var n;var o;var l;var d;i=this._newBlockBytes.readUnsignedByte();n=this.parseVarStr();o=this._newBlockBytes.readUnsignedByte();l=this._newBlockBytes.readUnsignedInt();if(this._newBlockBytes.position+l>s){console.log("           Error in reading attribute # "+r+" = skipped to end of attribute-list");this._newBlockBytes.position=s;return e}switch(o){case a.AWDSTRING:d=this._newBlockBytes.readUTFBytes(l);break;case a.INT8:d=this._newBlockBytes.readByte();break;case a.INT16:d=this._newBlockBytes.readShort();break;case a.INT32:d=this._newBlockBytes.readInt();break;case a.BOOL:case a.UINT8:d=this._newBlockBytes.readUnsignedByte();break;case a.UINT16:d=this._newBlockBytes.readUnsignedShort();break;case a.UINT32:case a.BADDR:d=this._newBlockBytes.readUnsignedInt();break;case a.FLOAT32:d=this._newBlockBytes.readFloat();break;case a.FLOAT64:d=this._newBlockBytes.readDouble();break;default:d="unimplemented attribute type "+o;this._newBlockBytes.position+=l;break}if(this._debug){console.log("attribute = name: "+n+"  / value = "+d)}e[n]=d;r+=1}}return e};a.prototype.parseProperties=function(e){var a;var t;var r=0;var s=new Xa;t=this._newBlockBytes.readUnsignedInt();a=this._newBlockBytes.position+t;if(e){while(this._newBlockBytes.position<a){var i;var n;var o;n=this._newBlockBytes.readUnsignedShort();i=this._newBlockBytes.readUnsignedInt();if(this._newBlockBytes.position+i>a){console.log("           Error in reading property # "+r+" = skipped to end of propertie-list");this._newBlockBytes.position=a;return s}if(e.hasOwnProperty(n.toString())){o=e[n];s.set(n,this.parseAttrValue(o,i))}else{this._newBlockBytes.position+=i}r+=1}}else{this._newBlockBytes.position=a}return s};a.prototype.parseAttrValue=function(e,t){var r;var s;switch(e){case a.BOOL:case a.INT8:r=1;s=this._newBlockBytes.readByte;break;case a.INT16:r=2;s=this._newBlockBytes.readShort;break;case a.INT32:r=4;s=this._newBlockBytes.readInt;break;case a.UINT8:r=1;s=this._newBlockBytes.readUnsignedByte;break;case a.UINT16:r=2;s=this._newBlockBytes.readUnsignedShort;break;case a.UINT32:case a.COLOR:case a.BADDR:r=4;s=this._newBlockBytes.readUnsignedInt;break;case a.FLOAT32:r=4;s=this._newBlockBytes.readFloat;break;case a.FLOAT64:r=8;s=this._newBlockBytes.readDouble;break;case a.AWDSTRING:return this._newBlockBytes.readUTFBytes(t);case a.VECTOR2x1:case a.VECTOR3x1:case a.VECTOR4x1:case a.MTX3x2:case a.MTX3x3:case a.MTX4x3:case a.MTX4x4:r=8;s=this._newBlockBytes.readDouble;break}if(r<t){var i=[];var n=0;var o=t/r;while(n<o){i.push(s.apply(this._newBlockBytes));n++}return i}else{var l=s.apply(this._newBlockBytes);return l}};a.prototype.parseHeader=function(){var e;var t;this._byteData.position=3;this._version[0]=this._byteData.readUnsignedByte();this._version[1]=this._byteData.readUnsignedByte();e=this._byteData.readUnsignedShort();this._streaming=Ya.test(e,Ya.FLAG1);if(this._version[0]==2&&this._version[1]==1){this._accuracyMatrix=Ya.test(e,Ya.FLAG2);this._accuracyGeo=Ya.test(e,Ya.FLAG3);this._accuracyProps=Ya.test(e,Ya.FLAG4)}this._geoNrType=a.FLOAT32;if(this._accuracyGeo){this._geoNrType=a.FLOAT64}this._matrixNrType=a.FLOAT32;if(this._accuracyMatrix){this._matrixNrType=a.FLOAT64}this._propsNrType=a.FLOAT32;if(this._accuracyProps){this._propsNrType=a.FLOAT64}this._compression=this._byteData.readUnsignedByte();if(this._debug){console.log("Import AWDFile of version = "+this._version[0]+" - "+this._version[1]);console.log("Global Settings = Compression = "+this._compression+" | Streaming = "+this._streaming+" | Matrix-Precision = "+this._accuracyMatrix+" | Geometry-Precision = "+this._accuracyGeo+" | Properties-Precision = "+this._accuracyProps)}t=this._byteData.readUnsignedInt();if(!this._streaming&&t!=this._byteData.getBytesAvailable()){this._pDieWithError("AWD2 body length does not match header integrity field")}};a.prototype.getUVForVertexAnimation=function(e){if(this._blocks[e].data instanceof M)e=this._blocks[e].geoID;if(this._blocks[e].uvsForVertexAnimation)return this._blocks[e].uvsForVertexAnimation;var a=this._blocks[e].data;var t=0;var r;this._blocks[e].uvsForVertexAnimation=new Array;while(t<a.subGeometries.length){r=a.subGeometries[t];this._blocks[e].uvsForVertexAnimation.push(r.uvs.get(r.numVertices));t++}return this._blocks[e].uvsForVertexAnimation};a.prototype.parseVarStr=function(){var e=this._newBlockBytes.readUnsignedShort();return this._newBlockBytes.readUTFBytes(e)};a.prototype.getAssetByID=function(e,a){var t=new Array;var r=0;if(e>0){if(this._blocks[e]){if(this._blocks[e].data){while(r<a.length){var s=this._blocks[e].data;if(s.assetType==a[r]){if(a[r]==J.assetType){if(this._blocks[e].data instanceof J){t.push(true);t.push(this._blocks[e].data);return t}}if(a[r]==X.assetType){if(this._blocks[e].data instanceof X){t.push(true);t.push(this._blocks[e].data);return t}}else{t.push(true);t.push(this._blocks[e].data);return t}}if(a[r]==d.assetType&&s.assetType==M.assetType){var i=this._blocks[e].data;t.push(true);t.push(i.geometry);return t}r++}}}}t.push(false);t.push(this.getDefaultAsset(a[0]));return t};a.prototype.getDefaultAsset=function(e){switch(true){case e==J.assetType:return this.getDefaultCubeTexture();break;case e==X.assetType:return U.getDefaultTexture();break;case e==oa.assetType:return U.getDefaultMaterial();break;default:break}return null};a.prototype.getDefaultCubeTexture=function(){if(!this._defaultCubeTexture){var e=U.createCheckeredBitmapImage2D();var a=new o(e.width);for(var t=0;t<6;t++)a.draw(t,e);this._defaultCubeTexture=new J(a);this._defaultCubeTexture.name="defaultCubeTexture"}return this._defaultCubeTexture};a.prototype.readNumber=function(e){if(e===void 0){e=false}if(e)return this._newBlockBytes.readDouble();return this._newBlockBytes.readFloat()};a.prototype.parseMatrix3D=function(){return new _(this.parseMatrix43RawData())};a.prototype.parseMatrix32RawData=function(){var e;var a=new Array(6);for(e=0;e<6;e++){a[e]=this._newBlockBytes.readFloat()}return a};a.prototype.parseMatrix43RawData=function(){var e=new Array(16);e[0]=this.readNumber(this._accuracyMatrix);e[1]=this.readNumber(this._accuracyMatrix);e[2]=this.readNumber(this._accuracyMatrix);e[3]=0;e[4]=this.readNumber(this._accuracyMatrix);e[5]=this.readNumber(this._accuracyMatrix);e[6]=this.readNumber(this._accuracyMatrix);e[7]=0;e[8]=this.readNumber(this._accuracyMatrix);e[9]=this.readNumber(this._accuracyMatrix);e[10]=this.readNumber(this._accuracyMatrix);e[11]=0;e[12]=this.readNumber(this._accuracyMatrix);e[13]=this.readNumber(this._accuracyMatrix);e[14]=this.readNumber(this._accuracyMatrix);e[15]=1;if(isNaN(e[0])){e[0]=1;e[1]=0;e[2]=0;e[4]=0;e[5]=1;e[6]=0;e[8]=0;e[9]=0;e[10]=1;e[12]=0;e[13]=0;e[14]=0}return e};a.COMPRESSIONMODE_LZMA="lzma";a.UNCOMPRESSED=0;a.DEFLATE=1;a.LZMA=2;a.INT8=1;a.INT16=2;a.INT32=3;a.UINT8=4;a.UINT16=5;a.UINT32=6;a.FLOAT32=7;a.FLOAT64=8;a.BOOL=21;a.COLOR=22;a.BADDR=23;a.AWDSTRING=31;a.AWDBYTEARRAY=32;a.VECTOR2x1=41;a.VECTOR3x1=42;a.VECTOR4x1=43;a.MTX3x2=44;a.MTX3x3=45;a.MTX4x3=46;a.MTX4x4=47;
return a}(w);var Xa=function(){function e(){}e.prototype.set=function(e,a){this[e.toString()]=a};e.prototype.get=function(e,a){if(this.hasOwnProperty(e.toString())){return this[e.toString()]}else{return a}};return e}();var Ya=function(){function e(){}e.test=function(e,a){return(e&a)==a};e.FLAG1=1;e.FLAG2=2;e.FLAG3=4;e.FLAG4=8;e.FLAG5=16;e.FLAG6=32;e.FLAG7=64;e.FLAG8=128;e.FLAG9=256;e.FLAG10=512;e.FLAG11=1024;e.FLAG12=2048;e.FLAG13=4096;e.FLAG14=8192;e.FLAG15=16384;e.FLAG16=32768;return e}();a.exports=Ja},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/attributes/Float2Attributes":undefined,"awayjs-core/lib/attributes/Float3Attributes":undefined,"awayjs-core/lib/data/BitmapImageCube":undefined,"awayjs-core/lib/data/BlendMode":undefined,"awayjs-core/lib/data/CurveSubGeometry":undefined,"awayjs-core/lib/data/Geometry":undefined,"awayjs-core/lib/data/TriangleSubGeometry":undefined,"awayjs-core/lib/geom/ColorTransform":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-core/lib/projections/OrthographicOffCenterProjection":undefined,"awayjs-core/lib/projections/OrthographicProjection":undefined,"awayjs-core/lib/projections/PerspectiveProjection":undefined,"awayjs-core/lib/utils/ByteArray":undefined,"awayjs-display/lib/animators/nodes/AnimationNodeBase":undefined,"awayjs-display/lib/base/LightBase":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Billboard":undefined,"awayjs-display/lib/entities/Camera":undefined,"awayjs-display/lib/entities/DirectionalLight":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/entities/PointLight":undefined,"awayjs-display/lib/entities/Skybox":undefined,"awayjs-display/lib/entities/TextField":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/materials/BasicMaterial":undefined,"awayjs-display/lib/materials/lightpickers/LightPickerBase":undefined,"awayjs-display/lib/materials/lightpickers/StaticLightPicker":undefined,"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper":undefined,"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper":undefined,"awayjs-display/lib/prefabs/PrefabBase":undefined,"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveConePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCubePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab":undefined,"awayjs-display/lib/prefabs/PrimitivePlanePrefab":undefined,"awayjs-display/lib/prefabs/PrimitivePrefabBase":undefined,"awayjs-display/lib/prefabs/PrimitiveSpherePrefab":undefined,"awayjs-display/lib/prefabs/PrimitiveTorusPrefab":undefined,"awayjs-display/lib/text/Font":undefined,"awayjs-display/lib/text/TextFormat":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-display/lib/textures/SingleCubeTexture":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined,"awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseCelMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseDepthMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseGradientMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod":undefined,"awayjs-methodmaterials/lib/methods/DiffuseWrapMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectAlphaMaskMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectColorTransformMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectEnvMapMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectFogMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectFresnelEnvMapMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectLightMapMethod":undefined,"awayjs-methodmaterials/lib/methods/EffectMethodBase":undefined,"awayjs-methodmaterials/lib/methods/EffectRimLightMethod":undefined,"awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowDitheredMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowFilteredMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowHardMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowMapMethodBase":undefined,"awayjs-methodmaterials/lib/methods/ShadowNearMethod":undefined,"awayjs-methodmaterials/lib/methods/ShadowSoftMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularCelMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularFresnelMethod":undefined,"awayjs-methodmaterials/lib/methods/SpecularPhongMethod":undefined,"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock":"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock","awayjs-player/lib/factories/AS2SceneGraphFactory":undefined,"awayjs-player/lib/timeline/TimelineKeyFrame":undefined,"awayjs-player/lib/timeline/commands/AddChildAtDepthCommand":undefined,"awayjs-player/lib/timeline/commands/ApplyAS2DepthsCommand":undefined,"awayjs-player/lib/timeline/commands/ExecuteScriptCommand":undefined,"awayjs-player/lib/timeline/commands/RemoveChildrenAtDepthCommand":undefined,"awayjs-player/lib/timeline/commands/SetInstanceNameCommand":undefined,"awayjs-player/lib/timeline/commands/SetMaskCommand":undefined,"awayjs-player/lib/timeline/commands/UpdatePropertyCommand":undefined,"awayjs-renderergl/lib/animators/AnimationSetBase":undefined,"awayjs-renderergl/lib/animators/SkeletonAnimationSet":undefined,"awayjs-renderergl/lib/animators/SkeletonAnimator":undefined,"awayjs-renderergl/lib/animators/VertexAnimationSet":undefined,"awayjs-renderergl/lib/animators/VertexAnimator":undefined,"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/Skeleton":undefined,"awayjs-renderergl/lib/animators/data/SkeletonJoint":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":undefined,"awayjs-renderergl/lib/animators/nodes/VertexClipNode":undefined}],"awayjs-parsers/lib/MD2Parser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-core/lib/data/Geometry");var n=e("awayjs-core/lib/data/TriangleSubGeometry");var o=e("awayjs-core/lib/net/URLLoaderDataFormat");var l=e("awayjs-core/lib/net/URLRequest");var d=e("awayjs-core/lib/parsers/ParserBase");var h=e("awayjs-core/lib/parsers/ParserUtils");var c=e("awayjs-display/lib/containers/DisplayObjectContainer");var p=e("awayjs-display/lib/entities/Mesh");var _=e("awayjs-display/lib/managers/DefaultMaterialManager");var u=e("awayjs-display/lib/textures/Single2DTexture");var f=e("awayjs-renderergl/lib/animators/nodes/VertexClipNode");var y=e("awayjs-renderergl/lib/animators/VertexAnimationSet");var w=e("awayjs-methodmaterials/lib/MethodMaterial");var b=e("awayjs-methodmaterials/lib/MethodMaterialMode");var m=function(e){r(a,e);function a(a,t){if(a===void 0){a="jpg"}if(t===void 0){t=true}e.call(this,o.ARRAY_BUFFER);this._clipNodes=new Object;this._animationSet=new y;this.materialFinal=false;this.geoCreated=false;this._textureType=a;this._ignoreTexturePath=t}a.supportsType=function(e){e=e.toLowerCase();return e=="md2"};a.supportsData=function(e){return h.toString(e,4)=="IDP2"};a.prototype._iResolveDependency=function(e){if(e.assets.length!=1)return;var a=new u(e.assets[0]);if(a){var t=new w(a);if(this.materialMode>=2)t.mode=b.MULTI_PASS;this._pContent.addChild(this._mesh);t.name=this._mesh.material.name;this._mesh.material=t;this._pFinalizeAsset(t);this._pFinalizeAsset(this._mesh.geometry);this._pFinalizeAsset(this._mesh)}this.materialFinal=true};a.prototype._iResolveDependencyFailure=function(e){if(this.materialMode<2){this._mesh.material=_.getDefaultMaterial()}else{this._mesh.material=new w(_.getDefaultTexture());this._mesh.material.mode=b.MULTI_PASS}this._pContent.addChild(this._mesh);this._pFinalizeAsset(this._mesh.geometry);this._pFinalizeAsset(this._mesh);this.materialFinal=true};a.prototype._pProceedParsing=function(){if(!this._startedParsing){this._byteData=this._pGetByteData();this._startedParsing=true;this._byteData.position=0}while(this._pHasTime()){if(!this._parsedHeader){this._geometry=new i;this._mesh=new p(this._geometry,null);if(this.materialMode<2){this._mesh.material=_.getDefaultMaterial()}else{this._mesh.material=new w(_.getDefaultTexture());this._mesh.material.mode=b.MULTI_PASS}this.parseHeader();this.parseMaterialNames()}else if(!this._parsedUV){this.parseUV()}else if(!this._parsedFaces){this.parseFaces()}else if(!this._parsedFrames){this.parseFrames()}else if(this.geoCreated&&this.materialFinal){return d.PARSING_DONE}else if(!this.geoCreated){this.geoCreated=true;this._geometry.addSubGeometry(this._firstSubGeom.clone());this._mesh.name="";if(this.materialFinal){this._pContent.addChild(this._mesh);this._pFinalizeAsset(this._mesh.geometry);this._pFinalizeAsset(this._mesh)}this._pPauseAndRetrieveDependencies()}}return d.MORE_TO_PARSE};a.prototype._pStartParsing=function(a){e.prototype._pStartParsing.call(this,a);this._pContent=new c};a.prototype.parseHeader=function(){this._ident=this._byteData.readInt();this._version=this._byteData.readInt();this._skinWidth=this._byteData.readInt();this._skinHeight=this._byteData.readInt();this._byteData.readInt();this._numSkins=this._byteData.readInt();this._numVertices=this._byteData.readInt();this._numST=this._byteData.readInt();this._numTris=this._byteData.readInt();this._byteData.readInt();this._numFrames=this._byteData.readInt();this._offsetSkins=this._byteData.readInt();this._offsetST=this._byteData.readInt();this._offsetTris=this._byteData.readInt();this._offsetFrames=this._byteData.readInt();this._byteData.readInt();this._offsetEnd=this._byteData.readInt();this._parsedHeader=true};a.prototype.parseMaterialNames=function(){var e;var a;var t;var r;this._materialNames=new Array;this._byteData.position=this._offsetSkins;var s=new RegExp("[^a-zA-Z0-9\\_/.]","g");for(var i=0;i<this._numSkins;++i){a=this._byteData.readUTFBytes(64);a=a.replace(s,"");t=a.lastIndexOf(".");if(this._ignoreTexturePath)r=a.lastIndexOf("/");if(a.toLowerCase().indexOf(".jpg")==-1&&a.toLowerCase().indexOf(".png")==-1){a=a.substring(r+1,t);e=a+"."+this._textureType}else{e=a}this._materialNames[i]=a;if(this.dependencies.length==0)this._pAddDependency(a,new l(e))}if(this._materialNames.length>0)this._mesh.material.name=this._materialNames[0];else this.materialFinal=true};a.prototype.parseUV=function(){var e=0;this._uvs=new Array(this._numST*2);this._byteData.position=this._offsetST;for(var a=0;a<this._numST;a++){this._uvs[e++]=this._byteData.readShort()/this._skinWidth;this._uvs[e++]=this._byteData.readShort()/this._skinHeight}this._parsedUV=true};a.prototype.parseFaces=function(){var e,a,t,r,s,i;var n;this._vertIndices=new Array;this._uvIndices=new Array;this._indices=new Array;this._byteData.position=this._offsetTris;for(n=0;n<this._numTris;n++){e=this._byteData.readUnsignedShort();a=this._byteData.readUnsignedShort();t=this._byteData.readUnsignedShort();r=this._byteData.readUnsignedShort();s=this._byteData.readUnsignedShort();i=this._byteData.readUnsignedShort();this.addIndex(e,r);this.addIndex(a,s);this.addIndex(t,i)}var o=this._uvIndices.length;this._finalUV=new Array(o*2);for(n=0;n<o;++n){this._finalUV[n<<1]=this._uvs[this._uvIndices[n]<<1];this._finalUV[(n<<1)+1]=this._uvs[(this._uvIndices[n]<<1)+1]}this._parsedFaces=true};a.prototype.addIndex=function(e,a){var t=this.findIndex(e,a);if(t==-1){this._indices.push(this._vertIndices.length);this._vertIndices.push(e);this._uvIndices.push(a)}else this._indices.push(t)};a.prototype.findIndex=function(e,a){var t=this._vertIndices.length;for(var r=0;r<t;++r){if(this._vertIndices[r]==e&&this._uvIndices[r]==a)return r}return-1};a.prototype.parseFrames=function(){var e,t,r;var o,l,d;var h;var c;var p=this._vertIndices.length;var _;var u;var y,w,b;var m="";var v=null;this._byteData.position=this._offsetFrames;for(y=0;y<this._numFrames;y++){u=new Array;_=new Array(p*3);e=this._byteData.readFloat();t=this._byteData.readFloat();r=this._byteData.readFloat();o=this._byteData.readFloat();l=this._byteData.readFloat();d=this._byteData.readFloat();m=this.readFrameName();for(w=0;w<this._numVertices;w++,this._byteData.position++)u.push(e*this._byteData.readUnsignedByte()+o,t*this._byteData.readUnsignedByte()+l,r*this._byteData.readUnsignedByte()+d);b=0;for(w=0;w<p;w++){_[b++]=u[this._vertIndices[w]*3];_[b++]=u[this._vertIndices[w]*3+2];_[b++]=u[this._vertIndices[w]*3+1]}c=new n(new s);if(this._firstSubGeom==null)this._firstSubGeom=c;h=new i;h.addSubGeometry(c);c.setIndices(this._indices);c.setPositions(_);c.setUVs(this._finalUV);c.setNormals(null);c.setTangents(null);c.autoDeriveNormals=false;c.autoDeriveTangents=false;var g=this._clipNodes[m];if(!g){if(v){this._pFinalizeAsset(v);this._animationSet.addAnimation(v)}g=new f;g.name=m;g.stitchFinalFrame=true;this._clipNodes[m]=g;v=g}g.addFrame(h,1e3/a.FPS)}if(v){this._pFinalizeAsset(v);this._animationSet.addAnimation(v)}this._pFinalizeAsset(this._animationSet);this._parsedFrames=true};a.prototype.readFrameName=function(){var e="";var a=0;for(var t=0;t<16;t++){var r=this._byteData.readUnsignedByte();if(Math.floor(r)>57&&Math.floor(r)<=122&&a==0)e+=String.fromCharCode(r);if(Math.floor(r)>=48&&Math.floor(r)<=57)a++}return e};a.FPS=6;return a}(d);a.exports=m},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/data/Geometry":undefined,"awayjs-core/lib/data/TriangleSubGeometry":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined,"awayjs-renderergl/lib/animators/VertexAnimationSet":undefined,"awayjs-renderergl/lib/animators/nodes/VertexClipNode":undefined}],"awayjs-parsers/lib/MD5AnimParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/geom/Quaternion");var i=e("awayjs-core/lib/geom/Vector3D");var n=e("awayjs-core/lib/net/URLLoaderDataFormat");var o=e("awayjs-core/lib/parsers/ParserBase");var l=e("awayjs-renderergl/lib/animators/data/JointPose");var d=e("awayjs-renderergl/lib/animators/data/SkeletonPose");var h=e("awayjs-renderergl/lib/animators/nodes/SkeletonClipNode");var c=function(e){r(a,e);function a(a,t){if(a===void 0){a=null}if(t===void 0){t=0}e.call(this,n.TEXT);this._parseIndex=0;this._line=0;this._charLineIndex=0;this._rotationQuat=new s;var r=new s;var o=new s;r.fromAxisAngle(i.X_AXIS,-Math.PI*.5);o.fromAxisAngle(i.Y_AXIS,-Math.PI*.5);this._rotationQuat.multiply(o,r);if(a){this._rotationQuat.multiply(o,r);r.fromAxisAngle(a,t);this._rotationQuat.multiply(r,this._rotationQuat)}}a.supportsType=function(e){e=e.toLowerCase();return e=="md5anim"};a.supportsData=function(e){return false};a.prototype._pProceedParsing=function(){var e;if(!this._startedParsing){this._textData=this._pGetTextData();this._startedParsing=true}while(this._pHasTime()){e=this.getNextToken();switch(e){case a.COMMENT_TOKEN:this.ignoreLine();break;case"":break;case a.VERSION_TOKEN:this._version=this.getNextInt();if(this._version!=10)throw new Error("Unknown version number encountered!");break;case a.COMMAND_LINE_TOKEN:this.parseCMD();break;case a.NUM_FRAMES_TOKEN:this._numFrames=this.getNextInt();this._bounds=new Array;this._frameData=new Array;break;case a.NUM_JOINTS_TOKEN:this._numJoints=this.getNextInt();this._hierarchy=new Array(this._numJoints);this._baseFrameData=new Array(this._numJoints);break;case a.FRAME_RATE_TOKEN:this._frameRate=this.getNextInt();break;case a.NUM_ANIMATED_COMPONENTS_TOKEN:this._numAnimatedComponents=this.getNextInt();break;case a.HIERARCHY_TOKEN:this.parseHierarchy();break;case a.BOUNDS_TOKEN:this.parseBounds();break;case a.BASE_FRAME_TOKEN:this.parseBaseFrame();break;case a.FRAME_TOKEN:this.parseFrame();break;default:if(!this._reachedEOF)this.sendUnknownKeywordError()}if(this._reachedEOF){this._clip=new h;this.translateClip();this._pFinalizeAsset(this._clip);return o.PARSING_DONE}}return o.MORE_TO_PARSE};a.prototype.translateClip=function(){for(var e=0;e<this._numFrames;++e)this._clip.addFrame(this.translatePose(this._frameData[e]),1e3/this._frameRate)};a.prototype.translatePose=function(e){var a;var t;var r;var n;var o;var h=new i;var c=new s;var p=e.components;var _=new d;var u=_.jointPoses;for(var f=0;f<this._numJoints;++f){o=0;t=new l;a=this._hierarchy[f];r=this._baseFrameData[f];n=a.flags;h.x=r.position.x;h.y=r.position.y;h.z=r.position.z;c.x=r.orientation.x;c.y=r.orientation.y;c.z=r.orientation.z;if(n&1)h.x=p[a.startIndex+o++];if(n&2)h.y=p[a.startIndex+o++];if(n&4)h.z=p[a.startIndex+o++];if(n&8)c.x=p[a.startIndex+o++];if(n&16)c.y=p[a.startIndex+o++];if(n&32)c.z=p[a.startIndex+o++];var y=1-c.x*c.x-c.y*c.y-c.z*c.z;c.w=y<0?0:-Math.sqrt(y);if(a.parentIndex<0){t.orientation.multiply(this._rotationQuat,c);t.translation=this._rotationQuat.rotatePoint(h)}else{t.orientation.copyFrom(c);t.translation.x=h.x;t.translation.y=h.y;t.translation.z=h.z}t.orientation.y=-t.orientation.y;t.orientation.z=-t.orientation.z;t.translation.x=-t.translation.x;u[f]=t}return _};a.prototype.parseHierarchy=function(){var e;var t;var r=this.getNextToken();var s=0;if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();t=new f;t.name=this.parseLiteralstring();t.parentIndex=this.getNextInt();t.flags=this.getNextInt();t.startIndex=this.getNextInt();this._hierarchy[s++]=t;e=this.getNextChar();if(e=="/"){this.putBack();e=this.getNextToken();if(e==a.COMMENT_TOKEN)this.ignoreLine();e=this.getNextChar()}if(e!="}")this.putBack()}while(e!="}")};a.prototype.parseBounds=function(){var e;var t;var r=this.getNextToken();var s=0;if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();t=new _;t.min=this.parseVector3D();t.max=this.parseVector3D();this._bounds[s++]=t;e=this.getNextChar();if(e=="/"){this.putBack();e=this.getNextToken();if(e==a.COMMENT_TOKEN)this.ignoreLine();e=this.getNextChar()}if(e!="}")this.putBack()}while(e!="}")};a.prototype.parseBaseFrame=function(){var e;var t;var r=this.getNextToken();var s=0;if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();t=new p;t.position=this.parseVector3D();t.orientation=this.parseQuaternion();this._baseFrameData[s++]=t;e=this.getNextChar();if(e=="/"){this.putBack();e=this.getNextToken();if(e==a.COMMENT_TOKEN)this.ignoreLine();e=this.getNextChar()}if(e!="}")this.putBack()}while(e!="}")};a.prototype.parseFrame=function(){var e;var t;var r;var s;s=this.getNextInt();r=this.getNextToken();if(r!="{")this.sendUnknownKeywordError();do{if(this._reachedEOF)this.sendEOFError();t=new u;t.components=new Array(this._numAnimatedComponents);for(var i=0;i<this._numAnimatedComponents;++i)t.components[i]=this.getNextNumber();this._frameData[s]=t;e=this.getNextChar();if(e=="/"){this.putBack();e=this.getNextToken();if(e==a.COMMENT_TOKEN)this.ignoreLine();e=this.getNextChar()}if(e!="}")this.putBack()}while(e!="}")};a.prototype.putBack=function(){this._parseIndex--;this._charLineIndex--;this._reachedEOF=this._parseIndex>=this._textData.length};a.prototype.getNextToken=function(){var e;var t="";while(!this._reachedEOF){e=this.getNextChar();if(e==" "||e=="\r"||e=="\n"||e=="	"){if(t!=a.COMMENT_TOKEN)this.skipWhiteSpace();if(t!="")return t}else t+=e;if(t==a.COMMENT_TOKEN)return t}return t};a.prototype.skipWhiteSpace=function(){var e;do e=this.getNextChar();while(e=="\n"||e==" "||e=="\r"||e=="	");this.putBack()};a.prototype.ignoreLine=function(){var e;while(!this._reachedEOF&&e!="\n")e=this.getNextChar()};a.prototype.getNextChar=function(){var e=this._textData.charAt(this._parseIndex++);if(e=="\n"){++this._line;this._charLineIndex=0}else if(e!="\r")++this._charLineIndex;if(this._parseIndex==this._textData.length)this._reachedEOF=true;return e};a.prototype.getNextInt=function(){var e=parseInt(this.getNextToken());if(isNaN(e))this.sendParseError("int type");return e};a.prototype.getNextNumber=function(){var e=parseFloat(this.getNextToken());if(isNaN(e))this.sendParseError("float type");return e};a.prototype.parseVector3D=function(){var e=new i;var a=this.getNextToken();if(a!="(")this.sendParseError("(");e.x=this.getNextNumber();e.y=this.getNextNumber();e.z=this.getNextNumber();if(this.getNextToken()!=")")this.sendParseError(")");return e};a.prototype.parseQuaternion=function(){var e=new s;var a=this.getNextToken();if(a!="(")this.sendParseError("(");e.x=this.getNextNumber();e.y=this.getNextNumber();e.z=this.getNextNumber();var t=1-e.x*e.x-e.y*e.y-e.z*e.z;e.w=t<0?0:-Math.sqrt(t);if(this.getNextToken()!=")")this.sendParseError(")");return e};a.prototype.parseCMD=function(){this.parseLiteralstring()};a.prototype.parseLiteralstring=function(){this.skipWhiteSpace();var e=this.getNextChar();var a="";if(e!='"')this.sendParseError('"');do{if(this._reachedEOF)this.sendEOFError();e=this.getNextChar();if(e!='"')a+=e}while(e!='"');return a};a.prototype.sendEOFError=function(){throw new Error("Unexpected end of file")};a.prototype.sendParseError=function(e){throw new Error("Unexpected token at line "+(this._line+1)+", character "+this._charLineIndex+". "+e+" expected, but "+this._textData.charAt(this._parseIndex-1)+" encountered")};a.prototype.sendUnknownKeywordError=function(){throw new Error("Unknown keyword at line "+(this._line+1)+", character "+this._charLineIndex+". ")};a.VERSION_TOKEN="MD5Version";a.COMMAND_LINE_TOKEN="commandline";a.NUM_FRAMES_TOKEN="numFrames";a.NUM_JOINTS_TOKEN="numJoints";a.FRAME_RATE_TOKEN="frameRate";a.NUM_ANIMATED_COMPONENTS_TOKEN="numAnimatedComponents";a.HIERARCHY_TOKEN="hierarchy";a.BOUNDS_TOKEN="bounds";a.BASE_FRAME_TOKEN="baseframe";a.FRAME_TOKEN="frame";a.COMMENT_TOKEN="//";return a}(o);var p=function(){function e(){}return e}();var _=function(){function e(){}return e}();var u=function(){function e(){}return e}();var f=function(){function e(){}return e}();a.exports=c},{"awayjs-core/lib/geom/Quaternion":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-renderergl/lib/animators/data/JointPose":undefined,"awayjs-renderergl/lib/animators/data/SkeletonPose":undefined,"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode":undefined}],"awayjs-parsers/lib/MD5MeshParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-core/lib/data/Geometry");var n=e("awayjs-core/lib/data/TriangleSubGeometry");var o=e("awayjs-core/lib/geom/Quaternion");var l=e("awayjs-core/lib/geom/Vector3D");var d=e("awayjs-core/lib/net/URLLoaderDataFormat");var h=e("awayjs-core/lib/parsers/ParserBase");var c=e("awayjs-display/lib/containers/DisplayObjectContainer");var p=e("awayjs-display/lib/entities/Mesh");var _=e("awayjs-renderergl/lib/animators/SkeletonAnimationSet");var u=e("awayjs-renderergl/lib/animators/data/Skeleton");var f=e("awayjs-renderergl/lib/animators/data/SkeletonJoint");var y=function(e){r(a,e);function a(a,t){if(a===void 0){a=null}if(t===void 0){t=0}e.call(this,d.TEXT);this._parseIndex=0;this._line=0;this._charLineIndex=0;this._rotationQuat=new o;this._rotationQuat.fromAxisAngle(l.X_AXIS,-Math.PI*.5);if(a){var r=new o;r.fromAxisAngle(a,t);this._rotationQuat.multiply(this._rotationQuat,r)}}a.supportsType=function(e){e=e.toLowerCase();return e=="md5mesh"};a.supportsData=function(e){return false};a.prototype._pProceedParsing=function(){var e;if(!this._startedParsing){this._textData=this._pGetTextData();this._startedParsing=true}while(this._pHasTime()){e=this.getNextToken();switch(e){case a.COMMENT_TOKEN:this.ignoreLine();break;case a.VERSION_TOKEN:this._version=this.getNextInt();if(this._version!=10)throw new Error("Unknown version number encountered!");break;case a.COMMAND_LINE_TOKEN:this.parseCMD();break;case a.NUM_JOINTS_TOKEN:this._numJoints=this.getNextInt();this._bindPoses=new Array(this._numJoints);break;case a.NUM_MESHES_TOKEN:this._numMeshes=this.getNextInt();break;case a.JOINTS_TOKEN:this.parseJoints();break;case a.MESH_TOKEN:this.parseMesh();break;default:if(!this._reachedEOF)this.sendUnknownKeywordError()}if(this._reachedEOF){this.calculateMaxJointCount();this._animationSet=new _(this._maxJointCount);this._mesh=new p(new i,null);this._geometry=this._mesh.geometry;for(var t=0;t<this._meshData.length;++t)this._geometry.addSubGeometry(this.translateGeom(this._meshData[t].vertexData,this._meshData[t].weightData,this._meshData[t].indices));this._pContent.addChild(this._mesh);this._pFinalizeAsset(this._geometry);this._pFinalizeAsset(this._mesh);this._pFinalizeAsset(this._skeleton);this._pFinalizeAsset(this._animationSet);return h.PARSING_DONE}}return h.MORE_TO_PARSE};a.prototype._pStartParsing=function(a){e.prototype._pStartParsing.call(this,a);this._pContent=new c};a.prototype.calculateMaxJointCount=function(){this._maxJointCount=0;var e=this._meshData.length;for(var a=0;a<e;++a){var t=this._meshData[a];var r=t.vertexData;var s=r.length;for(var i=0;i<s;++i){var n=this.countZeroWeightJoints(r[i],t.weightData);var o=r[i].countWeight-n;if(o>this._maxJointCount)this._maxJointCount=o}}};a.prototype.countZeroWeightJoints=function(e,a){var t=e.startWeight;var r=e.startWeight+e.countWeight;var s=0;var i;for(var n=t;n<r;++n){i=a[n].bias;if(i==0)++s}return s};a.prototype.parseJoints=function(){var e;var t;var r;var s;var i=0;var n=this.getNextToken();if(n!="{")this.sendUnknownKeywordError();this._skeleton=new u;do{if(this._reachedEOF)this.sendEOFError();t=new f;t.name=this.parseLiteralstring();t.parentIndex=this.getNextInt();r=this.parseVector3D();r=this._rotationQuat.rotatePoint(r);s=this.parseQuaternion();this._bindPoses[i]=s.toMatrix3D();this._bindPoses[i].appendTranslation(r.x,r.y,r.z);var o=this._bindPoses[i].clone();o.invert();t.inverseBindPose=o.rawData;this._skeleton.joints[i++]=t;e=this.getNextChar();if(e=="/"){this.putBack();e=this.getNextToken();if(e==a.COMMENT_TOKEN)this.ignoreLine();e=this.getNextChar()}if(e!="}")this.putBack()}while(e!="}")};a.prototype.putBack=function(){this._parseIndex--;this._charLineIndex--;this._reachedEOF=this._parseIndex>=this._textData.length};a.prototype.parseMesh=function(){var e=this.getNextToken();var t;var r;var s;var i;if(e!="{")this.sendUnknownKeywordError();if(this._shaders==null)this._shaders=new Array;while(t!="}"){t=this.getNextToken();switch(t){case a.COMMENT_TOKEN:this.ignoreLine();break;case a.MESH_SHADER_TOKEN:this._shaders.push(this.parseLiteralstring());break;case a.MESH_NUM_VERTS_TOKEN:r=new Array(this.getNextInt());break;case a.MESH_NUM_TRIS_TOKEN:i=new Array(this.getNextInt()*3);break;case a.MESH_NUM_WEIGHTS_TOKEN:s=new Array(this.getNextInt());break;case a.MESH_VERT_TOKEN:this.parseVertex(r);break;case a.MESH_TRI_TOKEN:this.parseTri(i);break;case a.MESH_WEIGHT_TOKEN:this.parseJoint(s);break}}if(this._meshData==null)this._meshData=new Array;var n=this._meshData.length;this._meshData[n]=new m;this._meshData[n].vertexData=r;this._meshData[n].weightData=s;this._meshData[n].indices=i};a.prototype.translateGeom=function(e,a,t){var r=e.length;var i,o,l;var d;var h;var c;var p;var _=new n(new s);var u=new Array(r*2);var f=new Array(r*3);var y=new Array(r*this._maxJointCount);var w=new Array(r*this._maxJointCount);var b=0;var m;for(var v=0;v<r;++v){d=e[v];i=d.index*3;o=i+1;l=i+2;f[i]=f[o]=f[l]=0;m=0;for(var g=0;g<d.countWeight;++g){h=a[d.startWeight+g];if(h.bias>0){c=this._bindPoses[h.joint];p=c.transformVector(h.pos);f[i]+=p.x*h.bias;f[o]+=p.y*h.bias;f[l]+=p.z*h.bias;y[b]=h.joint*3;w[b++]=h.bias;++m}}for(g=m;g<this._maxJointCount;++g){y[b]=0;w[b++]=0}i=d.index<<1;u[i++]=d.s;u[i]=d.t}_.jointsPerVertex=this._maxJointCount;_.setIndices(t);_.setPositions(f);_.setUVs(u);_.setJointIndices(y);_.setJointWeights(w);_.setNormals(null);_.setTangents(null);_.autoDeriveTangents=false;_.autoDeriveNormals=false;return _};a.prototype.parseTri=function(e){var a=this.getNextInt()*3;e[a]=this.getNextInt();e[a+1]=this.getNextInt();e[a+2]=this.getNextInt()};a.prototype.parseJoint=function(e){var a=new b;a.index=this.getNextInt();a.joint=this.getNextInt();a.bias=this.getNextNumber();a.pos=this.parseVector3D();e[a.index]=a};a.prototype.parseVertex=function(e){var a=new w;a.index=this.getNextInt();this.parseUV(a);a.startWeight=this.getNextInt();a.countWeight=this.getNextInt();e[a.index]=a};a.prototype.parseUV=function(e){var a=this.getNextToken();if(a!="(")this.sendParseError("(");e.s=this.getNextNumber();e.t=this.getNextNumber();if(this.getNextToken()!=")")this.sendParseError(")")};a.prototype.getNextToken=function(){var e;var t="";while(!this._reachedEOF){e=this.getNextChar();if(e==" "||e=="\r"||e=="\n"||e=="	"){if(t!=a.COMMENT_TOKEN)this.skipWhiteSpace();if(t!="")return t}else t+=e;if(t==a.COMMENT_TOKEN)return t}return t};a.prototype.skipWhiteSpace=function(){var e;do e=this.getNextChar();while(e=="\n"||e==" "||e=="\r"||e=="	");this.putBack()};a.prototype.ignoreLine=function(){var e;while(!this._reachedEOF&&e!="\n")e=this.getNextChar()};a.prototype.getNextChar=function(){var e=this._textData.charAt(this._parseIndex++);if(e=="\n"){++this._line;this._charLineIndex=0}else if(e!="\r")++this._charLineIndex;if(this._parseIndex>=this._textData.length)this._reachedEOF=true;return e};a.prototype.getNextInt=function(){var e=parseInt(this.getNextToken());if(isNaN(e))this.sendParseError("int type");return e};a.prototype.getNextNumber=function(){var e=parseFloat(this.getNextToken());if(isNaN(e))this.sendParseError("float type");return e};a.prototype.parseVector3D=function(){var e=new l;var a=this.getNextToken();if(a!="(")this.sendParseError("(");e.x=-this.getNextNumber();e.y=this.getNextNumber();e.z=this.getNextNumber();if(this.getNextToken()!=")")this.sendParseError(")");return e};a.prototype.parseQuaternion=function(){var e=new o;var a=this.getNextToken();if(a!="(")this.sendParseError("(");e.x=this.getNextNumber();e.y=-this.getNextNumber();e.z=-this.getNextNumber();var t=1-e.x*e.x-e.y*e.y-e.z*e.z;e.w=t<0?0:-Math.sqrt(t);if(this.getNextToken()!=")")this.sendParseError(")");var r=new o;r.multiply(this._rotationQuat,e);return r};a.prototype.parseCMD=function(){this.parseLiteralstring()};a.prototype.parseLiteralstring=function(){this.skipWhiteSpace();var e=this.getNextChar();var a="";if(e!='"')this.sendParseError('"');do{if(this._reachedEOF)this.sendEOFError();e=this.getNextChar();if(e!='"')a+=e}while(e!='"');return a};a.prototype.sendEOFError=function(){throw new Error("Unexpected end of file")};a.prototype.sendParseError=function(e){throw new Error("Unexpected token at line "+(this._line+1)+", character "+this._charLineIndex+". "+e+" expected, but "+this._textData.charAt(this._parseIndex-1)+" encountered")};a.prototype.sendUnknownKeywordError=function(){throw new Error("Unknown keyword at line "+(this._line+1)+", character "+this._charLineIndex+". ")};a.VERSION_TOKEN="MD5Version";
a.COMMAND_LINE_TOKEN="commandline";a.NUM_JOINTS_TOKEN="numJoints";a.NUM_MESHES_TOKEN="numMeshes";a.COMMENT_TOKEN="//";a.JOINTS_TOKEN="joints";a.MESH_TOKEN="mesh";a.MESH_SHADER_TOKEN="shader";a.MESH_NUM_VERTS_TOKEN="numverts";a.MESH_VERT_TOKEN="vert";a.MESH_NUM_TRIS_TOKEN="numtris";a.MESH_TRI_TOKEN="tri";a.MESH_NUM_WEIGHTS_TOKEN="numweights";a.MESH_WEIGHT_TOKEN="weight";return a}(h);var w=function(){function e(){}return e}();var b=function(){function e(){}return e}();var m=function(){function e(){}return e}();a.exports=y},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/data/Geometry":undefined,"awayjs-core/lib/data/TriangleSubGeometry":undefined,"awayjs-core/lib/geom/Quaternion":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-renderergl/lib/animators/SkeletonAnimationSet":undefined,"awayjs-renderergl/lib/animators/data/Skeleton":undefined,"awayjs-renderergl/lib/animators/data/SkeletonJoint":undefined}],"awayjs-parsers/lib/Max3DSParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-core/lib/data/BitmapImage2D");var n=e("awayjs-core/lib/data/Geometry");var o=e("awayjs-core/lib/data/TriangleSubGeometry");var l=e("awayjs-core/lib/geom/Matrix3D");var d=e("awayjs-core/lib/geom/Vector3D");var h=e("awayjs-core/lib/net/URLLoaderDataFormat");var c=e("awayjs-core/lib/net/URLRequest");var p=e("awayjs-core/lib/parsers/ParserBase");var _=e("awayjs-core/lib/parsers/ParserUtils");var u=e("awayjs-display/lib/containers/DisplayObjectContainer");var f=e("awayjs-display/lib/entities/Mesh");var y=e("awayjs-display/lib/managers/DefaultMaterialManager");var w=e("awayjs-display/lib/textures/Single2DTexture");var b=e("awayjs-methodmaterials/lib/MethodMaterial");var m=e("awayjs-methodmaterials/lib/MethodMaterialMode");var v=function(e){r(a,e);function a(a){if(a===void 0){a=true}e.call(this,h.ARRAY_BUFFER);this._useSmoothingGroups=a}a.supportsType=function(e){e=e.toLowerCase();return e=="3ds"};a.supportsData=function(e){var a;a=_.toByteArray(e);if(a){a.position=0;if(a.readShort()==19789)return true}return false};a.prototype._iResolveDependency=function(e){if(e.assets.length==1){var a;a=e.assets[0];if(a.isAsset(i)){var t;t=this._textures[e.id];t.texture=new w(a)}}};a.prototype._iResolveDependencyFailure=function(e){};a.prototype._pProceedParsing=function(){if(!this._byteData){this._byteData=this._pGetByteData();this._byteData.position=0;this._textures={};this._materials={};this._unfinalized_objects={}}while(this._pHasTime()){if(this._cur_mat&&this._byteData.position>=this._cur_mat_end)this.finalizeCurrentMaterial();else if(this._cur_obj&&this._byteData.position>=this._cur_obj_end){this._unfinalized_objects[this._cur_obj.name]=this._cur_obj;this._cur_obj_end=Number.MAX_VALUE;this._cur_obj=null}if(this._byteData.getBytesAvailable()>0){var e;var a;var t;e=this._byteData.readUnsignedShort();a=this._byteData.readUnsignedInt();t=this._byteData.position+(a-6);switch(e){case 19789:case 15677:case 45056:continue;break;case 45055:this._cur_mat_end=t;this._cur_mat=this.parseMaterial();break;case 16384:this._cur_obj_end=t;this._cur_obj=new k;this._cur_obj.name=this.readNulTermstring();this._cur_obj.materials=new Array;this._cur_obj.materialFaces={};break;case 16640:this._cur_obj.type=f.assetType;break;case 16656:this.parseVertexList();break;case 16672:this.parseFaceList();break;case 16704:this.parseUVList();break;case 16688:this.parseFaceMaterialList();break;case 16736:this._cur_obj.transform=this.readTransform();break;case 45058:this.parseObjectAnimation(t);break;case 16720:this.parseSmoothingGroups();break;default:this._byteData.position+=a-6;break}if(this.dependencies.length){this._pPauseAndRetrieveDependencies();break}}}if(this._byteData.getBytesAvailable()||this._cur_obj||this._cur_mat){return p.MORE_TO_PARSE}else{var r;for(r in this._unfinalized_objects){var s;s=this.constructObject(this._unfinalized_objects[r]);if(s){this._pContent.addChild(s);this._pFinalizeAsset(s,r)}}return p.PARSING_DONE}};a.prototype._pStartParsing=function(a){e.prototype._pStartParsing.call(this,a);this._pContent=new u};a.prototype.parseMaterial=function(){var e;e=new B;while(this._byteData.position<this._cur_mat_end){var a;var t;var r;a=this._byteData.readUnsignedShort();t=this._byteData.readUnsignedInt();r=this._byteData.position+(t-6);switch(a){case 40960:e.name=this.readNulTermstring();break;case 40976:e.ambientColor=this.readColor();break;case 40992:e.diffuseColor=this.readColor();break;case 41008:e.specularColor=this.readColor();break;case 41089:e.twoSided=true;break;case 41472:e.colorMap=this.parseTexture(r);break;case 41476:e.specularMap=this.parseTexture(r);break;default:this._byteData.position=r;break}}return e};a.prototype.parseTexture=function(e){var a;a=new D;while(this._byteData.position<e){var t;var r;t=this._byteData.readUnsignedShort();r=this._byteData.readUnsignedInt();switch(t){case 41728:a.url=this.readNulTermstring();break;default:this._byteData.position+=r-6;break}}this._textures[a.url]=a;this._pAddDependency(a.url,new c(a.url));return a};a.prototype.parseVertexList=function(){var e;var a;var t;t=this._byteData.readUnsignedShort();this._cur_obj.verts=new Array(t*3);e=0;a=this._cur_obj.verts.length;while(e<a){var r,s,i;r=this._byteData.readFloat();s=this._byteData.readFloat();i=this._byteData.readFloat();this._cur_obj.verts[e++]=r;this._cur_obj.verts[e++]=i;this._cur_obj.verts[e++]=s}};a.prototype.parseFaceList=function(){var e;var a;var t;t=this._byteData.readUnsignedShort();this._cur_obj.indices=new Array(t*3);e=0;a=this._cur_obj.indices.length;while(e<a){var r,s,i;r=this._byteData.readUnsignedShort();s=this._byteData.readUnsignedShort();i=this._byteData.readUnsignedShort();this._cur_obj.indices[e++]=r;this._cur_obj.indices[e++]=i;this._cur_obj.indices[e++]=s;this._byteData.position+=2}this._cur_obj.smoothingGroups=new Array(t)};a.prototype.parseSmoothingGroups=function(){var e=this._cur_obj.indices.length/3;var a=0;while(a<e){this._cur_obj.smoothingGroups[a]=this._byteData.readUnsignedInt();a++}};a.prototype.parseUVList=function(){var e;var a;var t;t=this._byteData.readUnsignedShort();this._cur_obj.uvs=new Array(t*2);e=0;a=this._cur_obj.uvs.length;while(e<a){this._cur_obj.uvs[e++]=this._byteData.readFloat();this._cur_obj.uvs[e++]=1-this._byteData.readFloat()}};a.prototype.parseFaceMaterialList=function(){var e;var a;var t;var r;e=this.readNulTermstring();a=this._byteData.readUnsignedShort();r=new Array(a);t=0;while(t<r.length)r[t++]=this._byteData.readUnsignedShort();this._cur_obj.materials.push(e);this._cur_obj.materialFaces[e]=r};a.prototype.parseObjectAnimation=function(e){var a;var t;var r;var s;var i;r=new d;while(this._byteData.position<e){var n;var o;n=this._byteData.readUnsignedShort();o=this._byteData.readUnsignedInt();switch(n){case 45072:s=this.readNulTermstring();this._byteData.position+=4;i=this._byteData.readShort();break;case 45075:r.x=this._byteData.readFloat();r.z=this._byteData.readFloat();r.y=this._byteData.readFloat();break;default:this._byteData.position+=o-6;break}}if(s!="$$$DUMMY"&&this._unfinalized_objects.hasOwnProperty(s)){a=this._unfinalized_objects[s];t=this.constructObject(a,r);if(t){this._pContent.addChild(t);this._pFinalizeAsset(t,a.name)}delete this._unfinalized_objects[s]}};a.prototype.constructObject=function(e,a){if(a===void 0){a=null}if(e.type==f.assetType){var t;var r;var i;var d;var h;var c;var p;var _;if(e.materials.length>1)console.log("The Away3D 3DS parser does not support multiple materials per mesh at this point.");if(!e.indices||e.indices.length==0)return null;p=new Array(e.verts.length/3);_=new Array(e.indices.length/3);this.prepareData(p,_,e);if(this._useSmoothingGroups)this.applySmoothGroups(p,_);e.verts=new Array(p.length*3);for(t=0;t<p.length;t++){e.verts[t*3]=p[t].x;e.verts[t*3+1]=p[t].y;e.verts[t*3+2]=p[t].z}e.indices=new Array(_.length*3);for(t=0;t<_.length;t++){e.indices[t*3]=_[t].a;e.indices[t*3+1]=_[t].b;e.indices[t*3+2]=_[t].c}if(e.uvs){e.uvs=new Array(p.length*2);for(t=0;t<p.length;t++){e.uvs[t*2]=p[t].u;e.uvs[t*2+1]=p[t].v}}i=new n;r=new o(new s);r.setIndices(e.indices);r.setPositions(e.verts);r.setUVs(e.uvs);i.addSubGeometry(r);if(e.materials.length>0){var u;u=e.materials[0];d=this._materials[u].material}if(a){if(e.transform){var y=e.transform.concat();y[12]=0;y[13]=0;y[14]=0;c=new l(y);a=c.transformVector(a)}a.scaleBy(-1);c=new l;c.appendTranslation(a.x,a.y,a.z);i.applyTransformation(c)}if(e.transform){c=new l(e.transform);c.invert();i.applyTransformation(c)}this._pFinalizeAsset(i,e.name.concat("_geom"));h=new f(i,d);h.transform.matrix3D=new l(e.transform);return h}return null};a.prototype.prepareData=function(e,a,t){var r;var s;var i;var n=t.verts.length;for(r=0,s=0,i=0;r<n;){var o=new A;o.x=t.verts[r++];o.y=t.verts[r++];o.z=t.verts[r++];if(t.uvs){o.u=t.uvs[s++];o.v=t.uvs[s++]}e[i++]=o}n=t.indices.length;for(r=0,i=0;r<n;){var l=new g;l.a=t.indices[r++];l.b=t.indices[r++];l.c=t.indices[r++];l.smoothGroup=t.smoothingGroups[i]||0;a[i++]=l}};a.prototype.applySmoothGroups=function(e,a){var t;var r;var s;var i;var n;var o=e.length;var l=a.length;var d=new Array(o);for(t=0;t<o;t++)d[t]=new Array;for(t=0;t<l;t++){var h=a[t];for(r=0;r<3;r++){var c=d[r==0?h.a:r==1?h.b:h.c];var p=h.smoothGroup;for(s=c.length-1;s>=0;s--){if((p&c[s])>0){p|=c[s];c.splice(s,1);s=c.length-1}}c.push(p)}}var _=new Array(o);for(t=0;t<o;t++){if((n=d[t].length)<1)continue;var u=new Array(n);_[t]=u;u[0]=t;var f=e[t];for(r=1;r<n;r++){var y=new A;y.x=f.x;y.y=f.y;y.z=f.z;y.u=f.u;y.v=f.v;u[r]=e.length;e.push(y)}}o=e.length;for(t=0;t<l;t++){h=a[t];p=h.smoothGroup;for(r=0;r<3;r++){s=r==0?h.a:r==1?h.b:h.c;c=d[s];n=c.length;u=_[s];for(i=0;i<n;i++){if(p==0&&c[i]==0||(p&c[i])>0){var w=u[i];if(p==0){c.splice(i,1);u.splice(i,1)}if(r==0)h.a=w;else if(r==1)h.b=w;else h.c=w;i=n}}}}};a.prototype.finalizeCurrentMaterial=function(){var e;if(this._cur_mat.colorMap)e=new b(this._cur_mat.colorMap.texture||y.getDefaultTexture());else e=new b(this._cur_mat.ambientColor);e.diffuseColor=this._cur_mat.diffuseColor;e.specularColor=this._cur_mat.specularColor;if(this.materialMode>=2)e.mode=m.MULTI_PASS;e.bothSides=this._cur_mat.twoSided;this._pFinalizeAsset(e,this._cur_mat.name);this._materials[this._cur_mat.name]=this._cur_mat;this._cur_mat.material=e;this._cur_mat=null};a.prototype.readNulTermstring=function(){var e;var a="";while((e=this._byteData.readUnsignedByte())>0)a+=String.fromCharCode(e);return a};a.prototype.readTransform=function(){var e;e=new Array(16);e[0]=this._byteData.readFloat();e[2]=this._byteData.readFloat();e[1]=this._byteData.readFloat();e[3]=0;e[8]=this._byteData.readFloat();e[10]=this._byteData.readFloat();e[9]=this._byteData.readFloat();e[11]=0;e[4]=this._byteData.readFloat();e[6]=this._byteData.readFloat();e[5]=this._byteData.readFloat();e[7]=0;e[12]=this._byteData.readFloat();e[14]=this._byteData.readFloat();e[13]=this._byteData.readFloat();e[15]=1;return e};a.prototype.readColor=function(){var e;var a;var t,r,s;e=this._byteData.readUnsignedShort();a=this._byteData.readUnsignedInt();switch(e){case 16:t=this._byteData.readFloat()*255;r=this._byteData.readFloat()*255;s=this._byteData.readFloat()*255;break;case 17:t=this._byteData.readUnsignedByte();r=this._byteData.readUnsignedByte();s=this._byteData.readUnsignedByte();break;default:this._byteData.position+=a-6;break}return t<<16|r<<8|s};return a}(p);var g=function(){function e(){}return e}();var B=function(){function e(){}return e}();var k=function(){function e(){}return e}();var D=function(){function e(){}return e}();var A=function(){function e(){}return e}();a.exports=v},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/data/BitmapImage2D":undefined,"awayjs-core/lib/data/Geometry":undefined,"awayjs-core/lib/data/TriangleSubGeometry":undefined,"awayjs-core/lib/geom/Matrix3D":undefined,"awayjs-core/lib/geom/Vector3D":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined}],"awayjs-parsers/lib/OBJParser":[function(e,a,t){var r=this.__extends||function(e,a){for(var t in a)if(a.hasOwnProperty(t))e[t]=a[t];function r(){this.constructor=e}r.prototype=a.prototype;e.prototype=new r};var s=e("awayjs-core/lib/attributes/AttributesBuffer");var i=e("awayjs-core/lib/data/BitmapImage2D");var n=e("awayjs-core/lib/data/TriangleSubGeometry");var o=e("awayjs-core/lib/data/Geometry");var l=e("awayjs-core/lib/net/URLLoaderDataFormat");var d=e("awayjs-core/lib/net/URLRequest");var h=e("awayjs-core/lib/parsers/ParserBase");var c=e("awayjs-core/lib/parsers/ParserUtils");var p=e("awayjs-display/lib/containers/DisplayObjectContainer");var _=e("awayjs-display/lib/entities/Mesh");var u=e("awayjs-display/lib/managers/DefaultMaterialManager");var f=e("awayjs-display/lib/textures/Single2DTexture");var y=e("awayjs-methodmaterials/lib/MethodMaterial");var w=e("awayjs-methodmaterials/lib/MethodMaterialMode");var b=e("awayjs-methodmaterials/lib/methods/SpecularBasicMethod");var m=function(e){r(a,e);function a(a){if(a===void 0){a=1}e.call(this,l.TEXT);this._mtlLibLoaded=true;this._activeMaterialID="";this._scale=a}Object.defineProperty(a.prototype,"scale",{set:function(e){this._scale=e},enumerable:true,configurable:true});a.supportsType=function(e){e=e.toLowerCase();return e=="obj"};a.supportsData=function(e){var a=c.toString(e);var t=false;var r=false;if(a){t=a.indexOf("\nv ")!=-1;r=a.indexOf("\nf ")!=-1}return t&&r};a.prototype._iResolveDependency=function(e){if(e.id=="mtl"){var a=c.toString(e.data);this.parseMtl(a)}else{var t;if(e.assets.length!=1){return}t=e.assets[0];if(t.isAsset(i)){var r=new D;r.materialID=e.id;r.texture=new f(t);this._materialLoaded.push(r);if(this._meshes.length>0){this.applyMaterial(r)}}}};a.prototype._iResolveDependencyFailure=function(e){if(e.id=="mtl"){this._mtlLib=false;this._mtlLibLoaded=false}else{var a=new D;a.materialID=e.id;this._materialLoaded.push(a)}if(this._meshes.length>0)this.applyMaterial(a)};a.prototype._pProceedParsing=function(){var e;var a=String.fromCharCode(10);var t;if(!this._startedParsing){this._textData=this._pGetTextData();this._textData=this._textData.replace(/\\[\r\n]+\s*/gm," ")}if(this._textData.indexOf(a)==-1)a=String.fromCharCode(13);if(!this._startedParsing){this._startedParsing=true;this._vertices=new Array;this._vertexNormals=new Array;this._materialIDs=new Array;this._materialLoaded=new Array;this._meshes=new Array;this._uvs=new Array;this._stringLength=this._textData.length;this._charIndex=this._textData.indexOf(a,0);this._oldIndex=0;this._objects=new Array;this._objectIndex=0}while(this._charIndex<this._stringLength&&this._pHasTime()){this._charIndex=this._textData.indexOf(a,this._oldIndex);if(this._charIndex==-1)this._charIndex=this._stringLength;e=this._textData.substring(this._oldIndex,this._charIndex);e=e.split("\r").join("");e=e.replace("  "," ");t=e.split(" ");this._oldIndex=this._charIndex+1;this.parseLine(t);if(this.parsingPaused){return h.MORE_TO_PARSE}}if(this._charIndex>=this._stringLength){if(this._mtlLib&&!this._mtlLibLoaded){return h.MORE_TO_PARSE}this.translate();this.applyMaterials();return h.PARSING_DONE}return h.MORE_TO_PARSE};a.prototype._pStartParsing=function(a){e.prototype._pStartParsing.call(this,a);this._pContent=new p};a.prototype.parseLine=function(e){switch(e[0]){case"mtllib":this._mtlLib=true;this._mtlLibLoaded=false;this.loadMtl(e[1]);break;case"g":this.createGroup(e);break;case"o":this.createObject(e);break;case"usemtl":if(this._mtlLib){if(!e[1])e[1]="def000";this._materialIDs.push(e[1]);this._activeMaterialID=e[1];if(this._currentGroup)this._currentGroup.materialID=this._activeMaterialID}break;case"v":this.parseVertex(e);break;case"vt":this.parseUV(e);break;case"vn":this.parseVertexNormal(e);break;case"f":this.parseFace(e)}};a.prototype.translate=function(){for(var e=0;e<this._objects.length;++e){var a=this._objects[e].groups;var t=a.length;var r;var s;var i;var n;var l;var d;var h;for(var c=0;c<t;++c){i=new o;r=a[c].materialGroups;s=r.length;for(l=0;l<s;++l)this.translateMaterialGroup(r[l],i);if(i.subGeometries.length==0)continue;this._pFinalizeAsset(i);h=new y(u.getDefaultTexture());if(this.materialMode>=2)h.mode=w.MULTI_PASS;n=new _(i,h);if(this._objects[e].name){n.name=this._objects[e].name}else if(a[c].name){n.name=a[c].name}else{n.name=""}this._meshes.push(n);if(a[c].materialID!="")h.name=a[c].materialID+"~"+n.name;else h.name=this._lastMtlID+"~"+n.name;if(n.subMeshes.length>1){for(d=1;d<n.subMeshes.length;++d)n.subMeshes[d].material=h}this._pContent.addChild(n);this._pFinalizeAsset(n)}}};a.prototype.translateMaterialGroup=function(e,a){var t=e.faces;var r;var i=t.length;var o;var l;var d=new Array;var h=new Array;var c=new Array;var p=new Array;this._realIndices=[];this._vertexIndex=0;var _;for(var u=0;u<i;++u){r=t[u];o=r.indexIds.length-1;for(_=1;_<o;++_){this.translateVertexData(r,_,d,h,p,c);this.translateVertexData(r,0,d,h,p,c);this.translateVertexData(r,_+1,d,h,p,c)}}if(d.length>0){l=new n(new s);l.autoDeriveNormals=c.length?false:true;l.setIndices(p);l.setPositions(d);l.setNormals(c);l.setUVs(h);a.addSubGeometry(l)}};a.prototype.translateVertexData=function(e,a,t,r,s,i){var n;var o;var l;var d;if(!this._realIndices[e.indexIds[a]]){n=this._vertexIndex;this._realIndices[e.indexIds[a]]=++this._vertexIndex;o=this._vertices[e.vertexIndices[a]-1];t.push(o.x*this._scale,o.y*this._scale,o.z*this._scale);if(e.normalIndices.length>0){l=this._vertexNormals[e.normalIndices[a]-1];i.push(l.x,l.y,l.z)}if(e.uvIndices.length>0){try{d=this._uvs[e.uvIndices[a]-1];r.push(d.u,d.v)}catch(h){switch(a){case 0:r.push(0,1);break;case 1:r.push(.5,0);break;case 2:r.push(1,1)}}}}else{n=this._realIndices[e.indexIds[a]]-1}s.push(n)};a.prototype.createObject=function(e){this._currentGroup=null;this._currentMaterialGroup=null;this._objects.push(this._currentObject=new v);if(e)this._currentObject.name=e[1]};a.prototype.createGroup=function(e){if(!this._currentObject)this.createObject(null);this._currentGroup=new g;this._currentGroup.materialID=this._activeMaterialID;if(e)this._currentGroup.name=e[1];this._currentObject.groups.push(this._currentGroup);this.createMaterialGroup(null)};a.prototype.createMaterialGroup=function(e){this._currentMaterialGroup=new B;if(e)this._currentMaterialGroup.url=e[1];this._currentGroup.materialGroups.push(this._currentMaterialGroup)};a.prototype.parseVertex=function(e){var a,t,r;if(e.length>4){var s=[];var i;for(var n=1;n<e.length;++n){i=parseFloat(e[n]);if(!isNaN(i))s.push(i)}a=s[0];t=s[1];r=-s[2];this._vertices.push(new j(a,t,r))}else{a=parseFloat(e[1]);t=parseFloat(e[2]);r=-parseFloat(e[3]);this._vertices.push(new j(a,t,r))}};a.prototype.parseUV=function(e){if(e.length>3){var a=[];var t;for(var r=1;r<e.length;++r){t=parseFloat(e[r]);if(!isNaN(t))a.push(t)}this._uvs.push(new P(a[0],1-a[1]))}else{this._uvs.push(new P(parseFloat(e[1]),1-parseFloat(e[2])))}};a.prototype.parseVertexNormal=function(e){if(e.length>4){var a=[];var t;for(var r=1;r<e.length;++r){t=parseFloat(e[r]);if(!isNaN(t))a.push(t)}this._vertexNormals.push(new j(a[0],a[1],-a[2]))}else{this._vertexNormals.push(new j(parseFloat(e[1]),parseFloat(e[2]),-parseFloat(e[3])))}};a.prototype.parseFace=function(e){var a=e.length;var t=new A;if(!this._currentGroup){this.createGroup(null)}var r;for(var s=1;s<a;++s){if(e[s]==""){continue}r=e[s].split("/");t.vertexIndices.push(this.parseIndex(parseInt(r[0]),this._vertices.length));if(r[1]&&String(r[1]).length>0)t.uvIndices.push(this.parseIndex(parseInt(r[1]),this._uvs.length));if(r[2]&&String(r[2]).length>0)t.normalIndices.push(this.parseIndex(parseInt(r[2]),this._vertexNormals.length));t.indexIds.push(e[s])}this._currentMaterialGroup.faces.push(t)};a.prototype.parseIndex=function(e,a){if(e<0)return e+a+1;else return e};a.prototype.parseMtl=function(e){var a=e.split("newmtl");var t;var r;var s;var i;var n;var o;var l;var h;var c;var p;var _;var u;for(var f=0;f<a.length;++f){t=a[f].split("\r").join("").split("\n");if(t.length==1)t=a[f].split(String.fromCharCode(13));l=h=c=16777215;p=0;n=false;o=false;_=1;u="";for(s=0;s<t.length;++s){t[s]=t[s].replace(/\s+$/,"");if(t[s].substring(0,1)!="#"&&(s==0||t[s]!="")){r=t[s].split(" ");if(String(r[0]).charCodeAt(0)==9||String(r[0]).charCodeAt(0)==32)r[0]=r[0].substring(1,r[0].length);if(s==0){this._lastMtlID=r.join("");this._lastMtlID=this._lastMtlID==""?"def000":this._lastMtlID}else{switch(r[0]){case"Ka":if(r[1]&&!isNaN(Number(r[1]))&&r[2]&&!isNaN(Number(r[2]))&&r[3]&&!isNaN(Number(r[3])))h=r[1]*255<<16|r[2]*255<<8|r[3]*255;break;case"Ks":if(r[1]&&!isNaN(Number(r[1]))&&r[2]&&!isNaN(Number(r[2]))&&r[3]&&!isNaN(Number(r[3]))){c=r[1]*255<<16|r[2]*255<<8|r[3]*255;n=true}break;case"Ns":if(r[1]&&!isNaN(Number(r[1])))p=Number(r[1])*.001;if(p==0)n=false;break;case"Kd":if(r[1]&&!isNaN(Number(r[1]))&&r[2]&&!isNaN(Number(r[2]))&&r[3]&&!isNaN(Number(r[3]))){l=r[1]*255<<16|r[2]*255<<8|r[3]*255;o=true}break;case"tr":case"d":if(r[1]&&!isNaN(Number(r[1])))_=Number(r[1]);break;case"map_Kd":u=this.parseMapKdString(r);u=u.replace(/\\/g,"/")}}}}if(u!=""){if(n){i=new b;i.specularColor=c;i.specular=p;var m=new k;m.alpha=_;m.basicSpecularMethod=i;m.materialID=this._lastMtlID;if(!this._materialSpecularData)this._materialSpecularData=new Array;this._materialSpecularData.push(m)}this._pAddDependency(this._lastMtlID,new d(u))}else if(o&&!isNaN(h)){var v=new D;v.materialID=this._lastMtlID;if(_==0)console.log("Warning: an alpha value of 0 was found in mtl color tag (Tr or d) ref:"+this._lastMtlID+", mesh(es) using it will be invisible!");var g;if(this.materialMode<2){g=new y(h);var B=g;B.alpha=_;B.diffuseColor=l;B.repeat=true;if(n){B.specularColor=c;B.specular=p}}else{g=new y(h);g.mode=w.MULTI_PASS;var A=g;A.diffuseColor=l;A.repeat=true;if(n){A.specularColor=c;A.specular=p}}v.cm=g;this._materialLoaded.push(v);if(this._meshes.length>0)this.applyMaterial(v)}}this._mtlLibLoaded=true};a.prototype.parseMapKdString=function(e){var a="";var t;var r;for(t=1;t<e.length;){switch(e[t]){case"-blendu":case"-blendv":case"-cc":case"-clamp":case"-texres":t+=2;break;case"-mm":t+=3;break;case"-o":case"-s":case"-t":t+=4;continue;default:r=true;break}if(r)break}for(t;t<e.length;t++){a+=e[t];a+=" "}a=a.replace(/\s+$/,"");return a};a.prototype.loadMtl=function(e){this._pAddDependency("mtl",new d(e),true);this._pPauseAndRetrieveDependencies()};a.prototype.applyMaterial=function(e){var a;var t;var r;var s;var i;for(var n=0;n<this._meshes.length;++n){t=this._meshes[n];a=t.material.name.split("~");if(a[0]==e.materialID){if(e.cm){if(t.material)t.material=null;t.material=e.cm}else if(e.texture){if(this.materialMode<2){r=t.material;r.texture=e.texture;r.color=e.color;r.alpha=e.alpha;r.repeat=true;if(e.specularMethod){r.specularMethod=null;r.specularMethod=e.specularMethod}else if(this._materialSpecularData){for(s=0;s<this._materialSpecularData.length;++s){i=this._materialSpecularData[s];if(i.materialID==e.materialID){r.specularMethod=null;r.specularMethod=i.basicSpecularMethod;r.color=i.color;r.alpha=i.alpha;break}}}}else{r=t.material;r.mode=w.MULTI_PASS;r.texture=e.texture;r.color=e.color;r.repeat=true;if(e.specularMethod){r.specularMethod=null;r.specularMethod=e.specularMethod}else if(this._materialSpecularData){for(s=0;s<this._materialSpecularData.length;++s){i=this._materialSpecularData[s];if(i.materialID==e.materialID){r.specularMethod=null;r.specularMethod=i.basicSpecularMethod;r.color=i.color;break}}}}}t.material.name=a[1]?a[1]:a[0];this._meshes.splice(n,1);--n}}if(e.cm||r)this._pFinalizeAsset(e.cm||r)};a.prototype.applyMaterials=function(){if(this._materialLoaded.length==0)return;for(var e=0;e<this._materialLoaded.length;++e)this.applyMaterial(this._materialLoaded[e])};return a}(h);var v=function(){function e(){this.groups=new Array}return e}();var g=function(){function e(){this.materialGroups=new Array}return e}();var B=function(){function e(){this.faces=new Array}return e}();var k=function(){function e(){this.color=16777215;this.alpha=1}return e}();var D=function(){function e(){this.color=16777215;this.alpha=1}return e}();var A=function(){function e(){this.vertexIndices=new Array;this.uvIndices=new Array;this.normalIndices=new Array;this.indexIds=new Array}return e}();var P=function(){function e(e,a){if(e===void 0){e=0}if(a===void 0){a=0}this._u=e;this._v=a}Object.defineProperty(e.prototype,"v",{get:function(){return this._v},set:function(e){this._v=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"u",{get:function(){return this._u},set:function(e){this._u=e},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this._u,this._v)};e.prototype.toString=function(){return this._u+","+this._v};return e}();var j=function(){function e(e,a,t,r){if(e===void 0){e=0}if(a===void 0){a=0}if(t===void 0){t=0}if(r===void 0){r=0}this._x=e;this._y=a;this._z=t;this._index=r}Object.defineProperty(e.prototype,"index",{get:function(){return this._index},set:function(e){this._index=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"z",{get:function(){return this._z},set:function(e){this._z=e},enumerable:true,configurable:true});e.prototype.clone=function(){return new e(this._x,this._y,this._z)};return e}();a.exports=m},{"awayjs-core/lib/attributes/AttributesBuffer":undefined,"awayjs-core/lib/data/BitmapImage2D":undefined,"awayjs-core/lib/data/Geometry":undefined,"awayjs-core/lib/data/TriangleSubGeometry":undefined,"awayjs-core/lib/net/URLLoaderDataFormat":undefined,"awayjs-core/lib/net/URLRequest":undefined,"awayjs-core/lib/parsers/ParserBase":undefined,"awayjs-core/lib/parsers/ParserUtils":undefined,"awayjs-display/lib/containers/DisplayObjectContainer":undefined,"awayjs-display/lib/entities/Mesh":undefined,"awayjs-display/lib/managers/DefaultMaterialManager":undefined,"awayjs-display/lib/textures/Single2DTexture":undefined,"awayjs-methodmaterials/lib/MethodMaterial":undefined,"awayjs-methodmaterials/lib/MethodMaterialMode":undefined,"awayjs-methodmaterials/lib/methods/SpecularBasicMethod":undefined}],"awayjs-parsers/lib/Parsers":[function(e,a,t){var r=e("awayjs-core/lib/library/AssetLoader");var s=e("awayjs-parsers/lib/AWDParser");var i=e("awayjs-parsers/lib/Max3DSParser");var n=e("awayjs-parsers/lib/MD2Parser");var o=e("awayjs-parsers/lib/OBJParser");var l=function(){function e(){}e.enableAllBundled=function(){r.enableParsers(e.ALL_BUNDLED)};e.ALL_BUNDLED=Array(s,i,n,o);return e}();a.exports=l},{"awayjs-core/lib/library/AssetLoader":undefined,"awayjs-parsers/lib/AWDParser":"awayjs-parsers/lib/AWDParser","awayjs-parsers/lib/MD2Parser":"awayjs-parsers/lib/MD2Parser","awayjs-parsers/lib/Max3DSParser":"awayjs-parsers/lib/Max3DSParser","awayjs-parsers/lib/OBJParser":"awayjs-parsers/lib/OBJParser"}]},{},[]);

//# sourceMappingURL=awayjs-parsers.min.js.map