{
  "version": 3,
  "sources": [
    "node_modules/browserify/node_modules/browser-pack/_prelude.js",
    "awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase.ts",
    "awayjs-parsers.js",
    "awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser.ts",
    "awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser.ts",
    "awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData.ts",
    "awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils.ts",
    "awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags.ts",
    "awayjs-parsers/lib/AWD3ParserUtils/AWDBlock.ts",
    "awayjs-parsers/lib/AWD3ParserUtils/AWDProperties.ts",
    "awayjs-parsers/lib/AWD3Parser.ts",
    "awayjs-parsers/lib/AWDParser.ts",
    "awayjs-parsers/lib/MD2Parser.ts",
    "awayjs-parsers/lib/MD5AnimParser.ts",
    "awayjs-parsers/lib/MD5MeshParser.ts",
    "awayjs-parsers/lib/Max3DSParser.ts",
    "awayjs-parsers/lib/OBJParser.ts",
    "awayjs-parsers/lib/Parsers.ts"
  ],
  "names": [
    "require",
    "e",
    "t",
    "n",
    "r",
    "s",
    "o",
    "u",
    "a",
    "i",
    "f",
    "Error",
    "code",
    "l",
    "exports",
    "call",
    "length",
    "awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase",
    "module",
    "AbstractMethodError",
    "AWDAssetParserBase",
    "Object",
    "defineProperty",
    "prototype",
    "get",
    "this",
    "_awd_file_data",
    "set",
    "awd_file_data",
    "enumerable",
    "configurable",
    "parseFromBytes",
    "awayjs-core/lib/errors/AbstractMethodError",
    "undefined",
    "awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers",
    "GeometryAWDParser",
    "PrefabAWDParser",
    "DisplayObjectContainerAWDParser",
    "MeshAWDParser",
    "BillboardAWDParser",
    "Single2DTextureAWDParser",
    "CameraAWDParser",
    "SingleCubeTextureAWDParser",
    "LightAWDParser",
    "LightPickerAWDParser",
    "MaterialAWDParser",
    "MovieClipAWDParser",
    "ShadowMethodAWDParser",
    "SharedMethodAWDParser",
    "SkeletonAnimClipAWDParser",
    "SkeletonAWDParser",
    "SkeletonPoseAWDParser",
    "SkyboxAWDParser",
    "TesselatedFontAWDParser",
    "TextfieldAWDParser",
    "TextformatAWDParser",
    "VertexAnimationSetAWDParser",
    "VertexAnimClipAWDParser",
    "CommandAWDParser",
    "MetadataAWDParser",
    "BlockNameSpaceAWDParser",
    "AnimatorAWDParser",
    "AudioAWDParser",
    "AWDBlockParsers",
    "_supported_asset_blocks",
    "_all_block_parsers",
    "Array",
    "add_block_parser",
    "block_parser",
    "block_types",
    "push",
    "init_parser",
    "file_data",
    "parseAsset",
    "type",
    "this_parser",
    "awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser",
    "awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser",
    "__extends",
    "d",
    "b",
    "p",
    "hasOwnProperty",
    "__",
    "constructor",
    "AWDBlockParserBase",
    "VertexAnimator",
    "SkeletonAnimator",
    "AWD3Utils",
    "_super",
    "animSetBlockAdress",
    "targetAnimationSet",
    "cur_block",
    "name",
    "parseVarStr",
    "newBlockBytes",
    "readUnsignedShort",
    "props",
    "parseProperties",
    1,
    "BADDR",
    "readUnsignedInt",
    "targetMeshLength",
    "meshAdresses",
    "activeState",
    "autoplay",
    "readUnsignedByte",
    "parseUserAttributes",
    "returnedArray",
    "targetMeshes",
    "targetMesh",
    "getAssetByID",
    "thisAnimator",
    "skeleton",
    "animator",
    "data",
    "debug",
    "console",
    "log",
    "awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils",
    "awayjs-renderergl/lib/animators/SkeletonAnimator",
    "awayjs-renderergl/lib/animators/VertexAnimator",
    "ByteArray",
    "data_len",
    "url",
    "readUTFBytes",
    "dependencies_urls",
    "readBytes",
    "dependencies_data",
    "state",
    "BLOCKSTATE_LOAD_DEPENDENICES",
    "audioStylesNames",
    "awayjs-core/lib/utils/ByteArray",
    "Billboard",
    "BasicMaterial",
    "data_id",
    "mat",
    "bothSides",
    "billboard",
    "extra",
    "awayjs-display/lib/entities/Billboard",
    "awayjs-display/lib/materials/BasicMaterial",
    "BLOCKSTATE_NO_ASSET",
    "id",
    "nameSpaceString",
    "Camera",
    "PerspectiveProjection",
    "OrthographicProjection",
    "OrthographicOffCenterProjection",
    "Vector3D",
    "CameraAWD3Parser",
    "par_id",
    "mtx",
    "parseMatrix3D",
    "parentName",
    "projection",
    "readShort",
    "projectiontype",
    101,
    "propsNrType",
    102,
    103,
    104,
    "camera",
    "transform",
    "matrix3D",
    "parent",
    "addChild",
    "matrixNrType",
    2,
    3,
    4,
    "UINT8",
    "pivot",
    "awayjs-core/lib/geom/Vector3D",
    "awayjs-core/lib/projections/OrthographicOffCenterProjection",
    "awayjs-core/lib/projections/OrthographicProjection",
    "awayjs-core/lib/projections/PerspectiveProjection",
    "awayjs-display/lib/entities/Camera",
    "hasBlocks",
    "parentObject",
    "targetObject",
    "numCommands",
    "typeCommand",
    "targetID",
    "DisplayObjectContainer",
    "ctr",
    "major_version",
    "minor_version",
    "awayjs-display/lib/containers/DisplayObjectContainer",
    "AttributesBuffer",
    "Geometry",
    "CurveSubGeometry",
    "TriangleSubGeometry",
    "geom",
    "num_subs",
    "geoNrType",
    "geoScaleU",
    "geoScaleV",
    "subs_parsed",
    "is_curve_geom",
    "sm_len",
    "sm_end",
    "w_indices",
    "weights",
    "position",
    "subProps",
    "idx",
    "str_ftype",
    "str_type",
    "str_len",
    "str_end",
    "x",
    "y",
    "z",
    "verts",
    "readNumber",
    "accuracyGeo",
    "indices",
    "uvs",
    "normals",
    "idx_pos",
    "idx_curves",
    "idx_uvs",
    "positions",
    "curveData",
    "curve_sub_geom",
    "setIndices",
    "setPositions",
    "setCurves",
    "setUVs",
    "addSubGeometry",
    "triangle_sub_geom",
    "jointsPerVertex",
    "autoDeriveNormals",
    "autoDeriveUVs",
    "autoDeriveTangents",
    "setNormals",
    "setTangents",
    "setJointWeights",
    "setJointIndices",
    "scaleU",
    "scaleV",
    "setSubUVs",
    "scaleUV",
    "awayjs-core/lib/attributes/AttributesBuffer",
    "awayjs-display/lib/base/CurveSubGeometry",
    "awayjs-display/lib/base/Geometry",
    "awayjs-display/lib/base/TriangleSubGeometry",
    "CubeMapShadowMapper",
    "DirectionalShadowMapper",
    "DirectionalLight",
    "PointLight",
    "light",
    "newShadowMapper",
    "lightType",
    "COLOR",
    5,
    6,
    "BOOL",
    7,
    8,
    9,
    10,
    11,
    12,
    "UINT16",
    21,
    22,
    23,
    "shadowMapperType",
    "lightTypes",
    "shadowMapperTypes",
    "radius",
    "fallOff",
    "color",
    "specular",
    "diffuse",
    "ambientColor",
    "ambient",
    "depthMapSize",
    "getDepthSizeFromEnum",
    "shadowMapper",
    "castsShadows",
    "awayjs-display/lib/entities/DirectionalLight",
    "awayjs-display/lib/entities/PointLight",
    "awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper",
    "awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper",
    "StaticLightPicker",
    "numLights",
    "lightsArray",
    "k",
    "lightID",
    "returnedArrayLight",
    "lightsArrayNames",
    "lightPicker",
    "toString",
    "awayjs-display/lib/materials/lightpickers/StaticLightPicker",
    "Sampler2D",
    "MethodMaterialMode",
    "MethodMaterial",
    "DefaultMaterialManager",
    "AmbientEnvMapMethod",
    "DiffuseDepthMethod",
    "DiffuseCelMethod",
    "DiffuseGradientMethod",
    "DiffuseLightMapMethod",
    "DiffuseWrapMethod",
    "NormalSimpleWaterMethod",
    "SpecularFresnelMethod",
    "SpecularAnisotropicMethod",
    "SpecularCelMethod",
    "SpecularPhongMethod",
    "attributes",
    "finalize",
    "num_methods",
    "methods_parsed",
    "normalTexture",
    "specTexture",
    "INT32",
    13,
    "method_type",
    "debugString",
    "tex_addr",
    "texture",
    "getDefaultTexture",
    "ambientMethod",
    "alphaThreshold",
    "style",
    "sampler",
    "UINT32",
    15,
    16,
    17,
    18,
    19,
    20,
    "spezialType",
    "mode",
    "MULTI_PASS",
    "alphaBlending",
    "diftexture",
    "alpha",
    "diffuseTex_addr",
    "diffuseTexture",
    "normalTex_addr",
    "specTex_addr",
    "lightPickerAddr",
    "alphaPremultiplied",
    "blendMode",
    "getBlendModeStringFromEnum",
    "normalMethod",
    "specularMethod",
    "strength",
    "diffuseMethod",
    "gloss",
    201,
    202,
    301,
    302,
    401,
    402,
    601,
    602,
    701,
    702,
    801,
    "MTX4x4",
    "fx_method",
    "addEffectMethod",
    "shadow_method",
    "shadowMethod",
    "cubeTex",
    "getDefaultCubeTexture",
    "thisTex",
    "smoothness",
    "fresnelPower",
    "normalReflectance",
    "basic_mat",
    "preserveAlpha",
    "awayjs-core/lib/image/Sampler2D",
    "awayjs-display/lib/managers/DefaultMaterialManager",
    "awayjs-methodmaterials/lib/MethodMaterial",
    "awayjs-methodmaterials/lib/MethodMaterialMode",
    "awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod",
    "awayjs-methodmaterials/lib/methods/DiffuseCelMethod",
    "awayjs-methodmaterials/lib/methods/DiffuseDepthMethod",
    "awayjs-methodmaterials/lib/methods/DiffuseGradientMethod",
    "awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod",
    "awayjs-methodmaterials/lib/methods/DiffuseWrapMethod",
    "awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod",
    "awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod",
    "awayjs-methodmaterials/lib/methods/SpecularCelMethod",
    "awayjs-methodmaterials/lib/methods/SpecularFresnelMethod",
    "awayjs-methodmaterials/lib/methods/SpecularPhongMethod",
    "Mesh",
    "num_materials",
    "materials_parsed",
    "geoID",
    "materials",
    "materialNames",
    "mat_id",
    "m",
    "mesh",
    "subMeshes",
    "material",
    "Math",
    "min",
    "awayjs-display/lib/entities/Mesh",
    "AWDSTRING",
    "AWDBitFlags",
    "ColorTransform",
    "Matrix3D",
    "Timeline",
    "TextField",
    "AS2SceneGraphFactory",
    "view",
    "factory",
    "j",
    "c",
    "new_timeline",
    "new_mc",
    "createMovieClip",
    "isScene",
    "sceneID",
    "fps",
    "readFloat",
    "ms_per_frame",
    "num_instances",
    "num_all_display_instances",
    "num_potential_childs",
    "resourceID",
    "cmd_asset",
    "registerPotentialChild",
    "num_potential_childs_multi_instanced",
    "num_potential_sounds",
    "numFrames",
    "totalDuration",
    "frameDuration",
    "numLabels",
    "objectID",
    "target_depth",
    "number_of_obj",
    "commandType",
    "hasDepthChanges",
    "sessionCount",
    "remove_depths",
    "potChild",
    "getPotentialChildPrototype",
    "isAsset",
    "props_flag",
    "test",
    "FLAG1",
    "thisMatrix",
    "FLAG2",
    "rawData",
    "FLAG3",
    "thisColorTransform",
    "FLAG4",
    "redMultiplier",
    "greenMultiplier",
    "blueMultiplier",
    "alphaMultiplier",
    "redOffset",
    "greenOffset",
    "blueOffset",
    "alphaOffset",
    "FLAG5",
    "blendmode_int",
    "blendmode_string",
    "FLAG6",
    "FLAG7",
    "instanceName",
    "FLAG8",
    "mask_id_nums",
    "mask_ids",
    "mi_cnt",
    "length_code",
    "awayjs-core/lib/geom/ColorTransform",
    "awayjs-core/lib/geom/Matrix3D",
    "awayjs-display/lib/base/Timeline",
    "awayjs-display/lib/entities/TextField",
    "awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags",
    "awayjs-player/lib/factories/AS2SceneGraphFactory",
    "PrefabBase",
    "PrimitiveCapsulePrefab",
    "PrimitiveConePrefab",
    "PrimitiveCubePrefab",
    "PrimitiveCylinderPrefab",
    "PrimitivePlanePrefab",
    "PrimitiveSpherePrefab",
    "PrimitiveTorusPrefab",
    "prefab",
    "primType",
    "bsm",
    110,
    111,
    303,
    703,
    704,
    "primitiveTypes",
    "topClosed",
    "bottomClosed",
    "yUp",
    "awayjs-display/lib/prefabs/PrefabBase",
    "awayjs-display/lib/prefabs/PrimitiveCapsulePrefab",
    "awayjs-display/lib/prefabs/PrimitiveConePrefab",
    "awayjs-display/lib/prefabs/PrimitiveCubePrefab",
    "awayjs-display/lib/prefabs/PrimitiveCylinderPrefab",
    "awayjs-display/lib/prefabs/PrimitivePlanePrefab",
    "awayjs-display/lib/prefabs/PrimitiveSpherePrefab",
    "awayjs-display/lib/prefabs/PrimitiveTorusPrefab",
    "ShadowDitheredMethod",
    "ShadowFilteredMethod",
    "ShadowHardMethod",
    "ShadowNearMethod",
    "ShadowSoftMethod",
    "asset",
    "shadowLightID",
    "parseShadowMethodList",
    "methodType",
    "shadow_meth",
    "epsilon",
    "range",
    "awayjs-methodmaterials/lib/methods/ShadowDitheredMethod",
    "awayjs-methodmaterials/lib/methods/ShadowFilteredMethod",
    "awayjs-methodmaterials/lib/methods/ShadowHardMethod",
    "awayjs-methodmaterials/lib/methods/ShadowNearMethod",
    "awayjs-methodmaterials/lib/methods/ShadowSoftMethod",
    "EffectColorMatrixMethod",
    "EffectColorTransformMethod",
    "EffectFogMethod",
    "EffectRimLightMethod",
    "parseSharedMethodList",
    "effectMethodReturn",
    105,
    106,
    107,
    "offCol",
    "colorTransform",
    "awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod",
    "awayjs-methodmaterials/lib/methods/EffectColorTransformMethod",
    "awayjs-methodmaterials/lib/methods/EffectFogMethod",
    "awayjs-methodmaterials/lib/methods/EffectRimLightMethod",
    "textureStylesNames",
    "Skeleton",
    "SkeletonJoint",
    "num_joints",
    "joints_parsed",
    "joint",
    "ibp",
    "parentIndex",
    "inverseBindPose",
    "joints",
    "awayjs-renderergl/lib/animators/data/Skeleton",
    "awayjs-renderergl/lib/animators/data/SkeletonJoint",
    "SkeletonClipNode",
    "frame_dur",
    "pose_addr",
    "clip",
    "num_frames",
    "frames_parsed",
    "skel_pose",
    "addFrame",
    "frames",
    "awayjs-renderergl/lib/animators/nodes/SkeletonClipNode",
    "SkeletonPose",
    "JointPose",
    "pose",
    "joint_pose",
    "has_transform",
    "mtx_data",
    "parseMatrix43RawData",
    "orientation",
    "fromMatrix",
    "translation",
    "copyFrom",
    "jointPoses",
    "awayjs-renderergl/lib/animators/data/JointPose",
    "awayjs-renderergl/lib/animators/data/SkeletonPose",
    "Skybox",
    "cubeTexAddr",
    "cube_tex",
    "new_skybox",
    "awayjs-display/lib/entities/Skybox",
    "Font",
    "new_font",
    "font_style_cnt",
    "font_style_name",
    "new_font_style",
    "get_font_table",
    "set_font_em_size",
    "font_style_char_cnt",
    "font_style_char",
    "set_subgeo_for_char",
    "awayjs-display/lib/text/Font",
    "TextFormat",
    "newTextField",
    "createTextField",
    "text_field_type",
    "displayAsPassword",
    "width",
    "height",
    "num_paragraphs",
    "complete_text",
    "text_format",
    "paracnt",
    "num_textruns",
    "textrun_cnt",
    "format_id",
    "textFormat",
    "txt_length",
    "this_txt",
    "text",
    "selectable",
    "border",
    "awayjs-display/lib/text/TextFormat",
    "newTextFormat",
    "font_id",
    "font",
    "font_name",
    "font_table",
    "font_style",
    "num_uv_values",
    "uv_values",
    "uvcnt",
    "uv_value",
    "format_props",
    "size",
    "letterSpacing",
    "kerning",
    "indent",
    "leftMargin",
    "rightMargin",
    "VertexClipNode",
    "poseOnly",
    "num_submeshes",
    "subMeshParsed",
    "geometry",
    "subGeom",
    "num_Streams",
    "streamsParsed",
    "streamtypes",
    "thisGeo",
    "geoAdress",
    "getUVForVertexAnimation",
    "looping",
    "stitchFinalFrame",
    "subGeometries",
    "awayjs-renderergl/lib/animators/nodes/VertexClipNode",
    "VertexAnimationSet",
    "SkeletonAnimationSet",
    "poseBlockAdress",
    "skeletonFrames",
    "vertexFrames",
    "animNode",
    "newVertexAnimationSet",
    "addAnimation",
    "animations",
    "animationNames",
    "newSkeletonAnimationSet",
    "awayjs-renderergl/lib/animators/SkeletonAnimationSet",
    "awayjs-renderergl/lib/animators/VertexAnimationSet",
    "awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData",
    "BlendMode",
    "SingleCubeTexture",
    "Single2DTexture",
    "AWDProperties",
    "AWDBlock",
    "AWD3FileData",
    "_debug",
    "_accuracyOnBlocks",
    "_blocks",
    "_cur_block",
    "blendModeDic",
    "NORMAL",
    "ADD",
    "ALPHA",
    "DARKEN",
    "DIFFERENCE",
    "ERASE",
    "HARDLIGHT",
    "INVERT",
    "LAYER",
    "LIGHTEN",
    "MULTIPLY",
    "OVERLAY",
    "SCREEN",
    "SHADER",
    "_depthSizeDic",
    "depthSize",
    "blendmode",
    "dispose",
    "_accuracyMatrix",
    "new_accuracyMatrix",
    "_accuracyProps",
    "new_accuracyProps",
    "_accuracyGeo",
    "new_accuracyGeo",
    "_matrixNrType",
    "newmatrixNrType",
    "_propsNrType",
    "new_props_nr",
    "_geoNrType",
    "new_geoNrType",
    "_newBlockBytes",
    "new_newBlockBytes",
    "create_new_block",
    "new_block",
    "block_cnt",
    "list_len",
    "attibuteCnt",
    "list_end",
    "ns_id",
    "attr_key",
    "attr_type",
    "attr_len",
    "attr_val",
    "INT8",
    "readByte",
    "INT16",
    "readInt",
    "FLOAT32",
    "FLOAT64",
    "readDouble",
    "expected",
    "propertyCnt",
    "len",
    "key",
    "parseAttrValue",
    "elem_len",
    "read_func",
    "VECTOR2x1",
    "VECTOR3x1",
    "VECTOR4x1",
    "MTX3x2",
    "MTX3x3",
    "MTX4x3",
    "list",
    "num_read",
    "num_elems",
    "apply",
    "val",
    "meshID",
    "uvsForVertexAnimation",
    "geoCnt",
    "sub_geom",
    "numVertices",
    "getBlockByID",
    "assetID",
    "getDefaultAsset",
    "assetType",
    "getDefaultMaterial",
    "_defaultCubeTexture",
    "precision",
    "parseMatrix32RawData",
    "mtx_raw",
    "Float32Array",
    "isNaN",
    "awayjs-core/lib/image/BlendMode",
    "awayjs-display/lib/textures/Single2DTexture",
    "awayjs-display/lib/textures/SingleCubeTexture",
    "awayjs-parsers/lib/AWD3ParserUtils/AWDBlock",
    "awayjs-parsers/lib/AWD3ParserUtils/AWDProperties",
    "BLOCKSTATE_FINALIZE",
    "BLOCKSTATE_INVALID",
    "COMPRESSIONMODE_LZMA",
    "UNCOMPRESSED",
    "DEFLATE",
    "LZMA",
    "AWDBYTEARRAY",
    "flags",
    "testFlag",
    "FLAG9",
    "FLAG10",
    "FLAG11",
    "FLAG12",
    "FLAG13",
    "FLAG14",
    "FLAG15",
    "FLAG16",
    "this_id",
    "this_type",
    "loaded_dependencies",
    "loaded_dependencies_cnt",
    "bytes",
    "errorMessages",
    "addError",
    "errorMsg",
    "value",
    "fallback",
    "awayjs-parsers/lib/AWD3Parser",
    "BitmapImageCube",
    "URLLoaderDataFormat",
    "URLRequest",
    "ParserBase",
    "ParserUtils",
    "DisplayObject",
    "AWDAssetParsers",
    "AWD3Parser",
    "ARRAY_BUFFER",
    "_startedParsing",
    "_parsed_header",
    "total_time",
    "geom_time",
    "timeline_time",
    "_block_parser",
    "_awd_data",
    "supportsType",
    "extension",
    "toLowerCase",
    "supportsData",
    "_iResolveDependency",
    "resourceDependency",
    "assets",
    "this_block",
    "parseInt",
    "testure_asset",
    "_pFinalizeAsset",
    "sub_id",
    "cube_image_asset",
    "draw",
    "cube_tex_asset",
    "_iResolveDependencyFailure",
    "_iResolveDependencyName",
    "oldName",
    "block",
    "resetAssetPath",
    "newName",
    "_pProceedParsing",
    "_byteData",
    "_pGetByteData",
    "parseHeader",
    "_compression",
    "_pDieWithError",
    "_body",
    "getBytesAvailable",
    "parsingPaused",
    "parseNextBlock",
    "PARSING_DONE",
    "MORE_TO_PARSE",
    "_pStartParsing",
    "frameLimit",
    "_pContent",
    "block_id",
    "ns",
    "block_type",
    "blockCompression",
    "blockCompressionLZMA",
    "accuracyOnBlocks",
    "accuracyMatrix",
    "accuracyProps",
    "blockEndAll",
    "time_start",
    "performance",
    "now",
    "_pAddDependency",
    "byteArrayToImage",
    "_pPauseAndRetrieveDependencies",
    "time_end",
    "thisTime",
    "body_len",
    "_streaming",
    "awayjs-core/lib/image/BitmapImageCube",
    "awayjs-core/lib/net/URLLoaderDataFormat",
    "awayjs-core/lib/net/URLRequest",
    "awayjs-core/lib/parsers/ParserBase",
    "awayjs-core/lib/parsers/ParserUtils",
    "awayjs-display/lib/base/DisplayObject",
    "awayjs-parsers/lib/AWDParser",
    "Float2Attributes",
    "EffectAlphaMaskMethod",
    "EffectEnvMapMethod",
    "EffectFresnelEnvMapMethod",
    "EffectLightMapMethod",
    "AssetLibrary",
    "Rectangle",
    "Style",
    "Matrix",
    "AWDParser",
    "_debugTimers",
    "_texture_users",
    "_time_all",
    "_time_geom",
    "_time_geom_bytes",
    "_time_timeline",
    "_time_fonts",
    "_time_textfields",
    "_time_sounds",
    "_time_textures",
    "_time_materials",
    "_time_meshes",
    "_num_geom",
    "_num_timeline",
    "_num_fonts",
    "_num_textfields",
    "_num_sounds",
    "_num_textures",
    "_num_materials",
    "_num_meshes",
    "shadowMethodListProperties",
    "PROPERTY_NUMBER",
    "meshPoseAnimationProperties",
    "sharedMethodListProperties",
    "_view",
    "_version",
    "texture_asset",
    "audio_asset",
    "_isParsing",
    "updateTimers",
    "isParsed",
    "start_timeing",
    "_cur_block_id",
    "BitFlags",
    "blockEndBlock",
    "parseMeshLibraryBlock",
    "parseBillBoardLibraryBlock",
    "parseAudioBlock",
    "parseTimeLine",
    "paresTextField",
    "parseTesselatedFont",
    "parseTextFormat",
    "parsePrimitves",
    "parseSkyboxInstance",
    "parseLight",
    "parseCamera",
    "parseLightPicker",
    "parseMaterial_v1",
    "parseCubeTexture",
    "parseSharedMethodBlock",
    "parseShadowMethodBlock",
    "parseMeshPoseAnimation",
    "parseVertexAnimationSet",
    "parseAnimatorSet",
    "parseCommand",
    "parseGeometry",
    "parseContainer",
    "parseMeshInstance",
    "parseMaterial",
    "parseTexture",
    "parseSkeleton",
    "parseSkeletonPose",
    "parseSkeletonAnimation",
    "parseNameSpace",
    "parseMetaData",
    "msgCnt",
    "end_timing",
    "time_delta",
    "blockID",
    "getAsset",
    "newfont",
    "set_whitespace_width",
    "vertexBuffer",
    "bufferView",
    "Uint8Array",
    "arraybytes",
    "textFormatProperties",
    "tf_align_int",
    "align",
    "textFieldTypes",
    "textWidth",
    "abs",
    "textHeight",
    "textFieldProperties",
    "useColorTransform",
    "num_subgeoms",
    "imageRect",
    "addSamplerAt",
    "getTextureAt",
    "hasUVTransform",
    "matrix",
    "animateUVs",
    "uvTransform",
    "extras",
    "timeLineContainer",
    "str_cnt",
    "str_data_type",
    "str_counter",
    "keyframes_start_indices_data",
    "new_buffer",
    "Uint16Array",
    "Uint32Array",
    "keyframe_durations",
    "numKeyFrames",
    "frame_command_indices",
    "frame_recipe",
    "command_length_stream",
    "command_index_stream",
    "add_child_stream",
    "remove_child_stream",
    "update_child_stream",
    "update_child_props_indices_stream",
    "update_child_props_length_stream",
    "property_type_stream",
    "property_index_stream",
    "properties_stream_int",
    "lc",
    "float_array_data",
    "properties_stream_f32_mtx_scale_rot",
    "properties_stream_f32_mtx_pos",
    "properties_stream_f32_mtx_all",
    "properties_stream_f32_ct",
    "_labels",
    "string_props_array",
    "properties_stream_strings",
    "frame_index",
    "one_str_len",
    "add_framescript",
    "init",
    "geometryProperties",
    "subGeometryProperties",
    "primitiveProperties",
    "containerProperties",
    "isPrefab",
    "getNewObject",
    "meshInstanceProperties",
    "tex",
    "lightProperties",
    "cameraProperties",
    "cameraPivotProperties",
    "lightPick",
    "materialProperties",
    "materialMode",
    "material_v1Properties",
    "method_v1Properties",
    "effectMethod",
    "shadowMapMethod",
    "cubeTexture",
    "commandProperties",
    "targetProperties",
    "metaDataProperties",
    "pose_id",
    "geo_id",
    "vertexAnimationSetProperties",
    "clipNode",
    "animatorSetProperties",
    "accuracy",
    "GEO_NUMBER",
    "MATRIX_NUMBER",
    "awayjs-core/lib/attributes/Float2Attributes",
    "awayjs-core/lib/geom/Matrix",
    "awayjs-core/lib/geom/Rectangle",
    "awayjs-core/lib/library/AssetLibrary",
    "awayjs-display/lib/base/Style",
    "awayjs-methodmaterials/lib/methods/EffectAlphaMaskMethod",
    "awayjs-methodmaterials/lib/methods/EffectEnvMapMethod",
    "awayjs-methodmaterials/lib/methods/EffectFresnelEnvMapMethod",
    "awayjs-methodmaterials/lib/methods/EffectLightMapMethod",
    "awayjs-parsers/lib/MD2Parser",
    "MD2Parser",
    "textureType",
    "ignoreTexturePath",
    "_clipNodes",
    "_animationSet",
    "materialFinal",
    "geoCreated",
    "_textureType",
    "_ignoreTexturePath",
    "_mesh",
    "getDefaultImage2D",
    "_pHasTime",
    "_parsedHeader",
    "_geometry",
    "parseMaterialNames",
    "_parsedUV",
    "parseUV",
    "_parsedFaces",
    "parseFaces",
    "_parsedFrames",
    "parseFrames",
    "_firstSubGeom",
    "clone",
    "_ident",
    "_skinWidth",
    "_skinHeight",
    "_numSkins",
    "_numVertices",
    "_numST",
    "_numTris",
    "_numFrames",
    "_offsetSkins",
    "_offsetST",
    "_offsetTris",
    "_offsetFrames",
    "_offsetEnd",
    "extIndex",
    "slashIndex",
    "_materialNames",
    "regExp",
    "RegExp",
    "replace",
    "lastIndexOf",
    "indexOf",
    "substring",
    "dependencies",
    "_uvs",
    "ta",
    "tb",
    "tc",
    "_vertIndices",
    "_uvIndices",
    "_indices",
    "addIndex",
    "_finalUV",
    "vertexIndex",
    "uvIndex",
    "index",
    "findIndex",
    "sx",
    "sy",
    "sz",
    "tx",
    "ty",
    "tz",
    "vertLen",
    "fvertices",
    "tvertices",
    "prevClip",
    "readFrameName",
    "FPS",
    "ch",
    "floor",
    "String",
    "fromCharCode",
    "awayjs-parsers/lib/MD5AnimParser",
    "Quaternion",
    "MD5AnimParser",
    "additionalRotationAxis",
    "additionalRotationRadians",
    "TEXT",
    "_parseIndex",
    "_line",
    "_charLineIndex",
    "_rotationQuat",
    "t1",
    "t2",
    "fromAxisAngle",
    "X_AXIS",
    "PI",
    "Y_AXIS",
    "multiply",
    "token",
    "_textData",
    "_pGetTextData",
    "getNextToken",
    "COMMENT_TOKEN",
    "ignoreLine",
    "VERSION_TOKEN",
    "getNextInt",
    "COMMAND_LINE_TOKEN",
    "parseCMD",
    "NUM_FRAMES_TOKEN",
    "_bounds",
    "_frameData",
    "NUM_JOINTS_TOKEN",
    "_numJoints",
    "_hierarchy",
    "_baseFrameData",
    "FRAME_RATE_TOKEN",
    "_frameRate",
    "NUM_ANIMATED_COMPONENTS_TOKEN",
    "_numAnimatedComponents",
    "HIERARCHY_TOKEN",
    "parseHierarchy",
    "BOUNDS_TOKEN",
    "parseBounds",
    "BASE_FRAME_TOKEN",
    "parseBaseFrame",
    "FRAME_TOKEN",
    "parseFrame",
    "_reachedEOF",
    "sendUnknownKeywordError",
    "_clip",
    "translateClip",
    "translatePose",
    "frameData",
    "hierarchy",
    "base",
    "translate",
    "components",
    "skelPose",
    "startIndex",
    "w",
    "sqrt",
    "rotatePoint",
    "sendEOFError",
    "HierarchyData",
    "parseLiteralstring",
    "getNextChar",
    "putBack",
    "BoundsData",
    "parseVector3D",
    "max",
    "BaseFrameData",
    "parseQuaternion",
    "frameIndex",
    "FrameData",
    "getNextNumber",
    "skipWhiteSpace",
    "charAt",
    "sendParseError",
    "parseFloat",
    "vec",
    "quat",
    "str",
    "awayjs-core/lib/geom/Quaternion",
    "awayjs-parsers/lib/MD5MeshParser",
    "MD5MeshParser",
    "_bindPoses",
    "NUM_MESHES_TOKEN",
    "_numMeshes",
    "JOINTS_TOKEN",
    "parseJoints",
    "MESH_TOKEN",
    "parseMesh",
    "calculateMaxJointCount",
    "_maxJointCount",
    "_meshData",
    "translateGeom",
    "vertexData",
    "weightData",
    "_skeleton",
    "numMeshData",
    "meshData",
    "numVerts",
    "zeroWeights",
    "countZeroWeightJoints",
    "totalJoints",
    "countWeight",
    "vertex",
    "start",
    "startWeight",
    "end",
    "count",
    "weight",
    "bias",
    "pos",
    "toMatrix3D",
    "appendTranslation",
    "inv",
    "invert",
    "_shaders",
    "MESH_SHADER_TOKEN",
    "MESH_NUM_VERTS_TOKEN",
    "MESH_NUM_TRIS_TOKEN",
    "MESH_NUM_WEIGHTS_TOKEN",
    "MESH_VERT_TOKEN",
    "parseVertex",
    "MESH_TRI_TOKEN",
    "parseTri",
    "MESH_WEIGHT_TOKEN",
    "parseJoint",
    "MeshData",
    "v1",
    "v2",
    "v3",
    "bindPose",
    "vertices",
    "jointIndices",
    "jointWeights",
    "nonZeroWeights",
    "transformVector",
    "JointData",
    "VertexData",
    "rotQuat",
    "awayjs-parsers/lib/Max3DSParser",
    "BitmapImage2D",
    "Max3DSParser",
    "useSmoothingGroups",
    "_useSmoothingGroups",
    "ba",
    "toByteArray",
    "_textures",
    "_materials",
    "_unfinalized_objects",
    "_cur_mat",
    "_cur_mat_end",
    "finalizeCurrentMaterial",
    "_cur_obj",
    "_cur_obj_end",
    "Number",
    "MAX_VALUE",
    "cid",
    "ObjectVO",
    "readNulTermstring",
    "materialFaces",
    "parseVertexList",
    "parseFaceList",
    "parseUVList",
    "parseFaceMaterialList",
    "readTransform",
    "parseObjectAnimation",
    "parseSmoothingGroups",
    "obj",
    "constructObject",
    "MaterialVO",
    "readColor",
    "diffuseColor",
    "specularColor",
    "twoSided",
    "colorMap",
    "specularMap",
    "TextureVO",
    "i0",
    "i1",
    "i2",
    "smoothingGroups",
    "faces",
    "vo",
    "hier",
    "sub",
    "prepareData",
    "applySmoothGroups",
    "v",
    "mname",
    "scaleBy",
    "applyTransformation",
    "concat",
    "VertexVO",
    "FaceVO",
    "smoothGroup",
    "numFaces",
    "vGroups",
    "face",
    "groups",
    "group",
    "splice",
    "vClones",
    "clones",
    "v0",
    "chr",
    "g",
    "awayjs-core/lib/image/BitmapImage2D",
    "awayjs-parsers/lib/OBJParser",
    "SpecularBasicMethod",
    "OBJParser",
    "scale",
    "_mtlLibLoaded",
    "_activeMaterialID",
    "_scale",
    "content",
    "hasV",
    "hasF",
    "parseMtl",
    "lm",
    "LoadedMaterial",
    "materialID",
    "_materialLoaded",
    "_meshes",
    "applyMaterial",
    "_mtlLib",
    "line",
    "creturn",
    "trunk",
    "_vertices",
    "_vertexNormals",
    "_materialIDs",
    "_stringLength",
    "_charIndex",
    "_oldIndex",
    "_objects",
    "_objectIndex",
    "split",
    "join",
    "parseLine",
    "applyMaterials",
    "loadMtl",
    "createGroup",
    "createObject",
    "_currentGroup",
    "parseVertexNormal",
    "parseFace",
    "objIndex",
    "numGroups",
    "materialGroups",
    "numMaterialGroups",
    "sm",
    "bmMaterial",
    "translateMaterialGroup",
    "_lastMtlID",
    "materialGroup",
    "_realIndices",
    "_vertexIndex",
    "indexIds",
    "translateVertexData",
    "vertexNormal",
    "uv",
    "vertexIndices",
    "normalIndices",
    "uvIndices",
    "_currentMaterialGroup",
    "_currentObject",
    "ObjectGroup",
    "Group",
    "createMaterialGroup",
    "MaterialGroup",
    "nTrunk",
    "Vertex",
    "UV",
    "FaceData",
    "parseIndex",
    "materialDefinitions",
    "lines",
    "basicSpecularMethod",
    "useSpecular",
    "useColor",
    "mapkd",
    "charCodeAt",
    "parseMapKdString",
    "specularData",
    "SpecularData",
    "_materialSpecularData",
    "cm",
    "breakflag",
    "mtlurl",
    "decomposeID",
    "tm",
    "_u",
    "_v",
    "_x",
    "_y",
    "_z",
    "_index",
    "ind",
    "awayjs-methodmaterials/lib/methods/SpecularBasicMethod",
    "awayjs-parsers/lib/Parsers",
    "Loader",
    "Parsers",
    "enableAllBundled",
    "enableParsers",
    "ALL_BUNDLED",
    "awayjs-core/lib/library/Loader"
  ],
  "mappings": "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",
  "file": "awayjs-parsers.min.js",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3FileData\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData\");\n\n\nclass AWDAssetParserBase\n{\n\n\tprivate _awd_file_data:AWD3FileData;\n\tconstructor()\n\t{\n\t}\n\n\n\tpublic get awd_file_data():AWD3FileData\n\t{\n\t\treturn this._awd_file_data;\n\t}\n\tpublic set awd_file_data(awd_file_data:AWD3FileData)\n\t{\n\t\tthis._awd_file_data=awd_file_data;\n\t}\n\tpublic parseFromBytes():void\n\t{\n\t\tthrow new AbstractMethodError();\n\t}\n\n\n}\n\nexport = AWDAssetParserBase;\n\n",
    null,
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\n\nimport AWDAssetParserBase\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWD3FileData \t\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData\");\n\nimport GeometryAWDParser \t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/GeometryAWDParser\");\nimport PrefabAWDParser \t\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/PrefabAWDParser\");\nimport DisplayObjectContainerAWDParser \t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/DisplayObjectContainerAWDParser\");\nimport MeshAWDParser \t\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/MeshAWDParser\");\nimport BillboardAWDParser \t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/BillboardAWDParser\");\nimport Single2DTextureAWDParser \t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/Single2DTextureAWDParser\");\nimport CameraAWDParser \t\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/CameraAWDParser\");\nimport SingleCubeTextureAWDParser \t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/SingleCubeTextureAWDParser\");\nimport LightAWDParser \t\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/LightAWDParser\");\nimport LightPickerAWDParser \t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/LightPickerAWDParser\");\nimport MaterialAWDParser \t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/MaterialAWDParser\");\nimport MovieClipAWDParser \t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/MovieClipAWDParser\");\nimport ShadowMethodAWDParser \t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/ShadowMethodAWDParser\");\nimport SharedMethodAWDParser \t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/SharedMethodAWDParser\");\nimport SkeletonAnimClipAWDParser \t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/SkeletonAnimClipAWDParser\");\nimport SkeletonAWDParser \t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/SkeletonAWDParser\");\nimport SkeletonPoseAWDParser \t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/SkeletonPoseAWDParser\");\nimport SkyboxAWDParser \t\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/SkyboxAWDParser\");\nimport TesselatedFontAWDParser \t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/TesselatedFontAWDParser\");\nimport TextfieldAWDParser \t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/TextfieldAWDParser\");\nimport TextformatAWDParser \t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/TextformatAWDParser\");\nimport VertexAnimationSetAWDParser \t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/VertexAnimationSetAWDParser\");\nimport VertexAnimClipAWDParser \t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/VertexAnimClipAWDParser\");\nimport CommandAWDParser \t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/CommandAWDParser\");\nimport MetadataAWDParser \t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/MetadataAWDParser\");\nimport BlockNameSpaceAWDParser \t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/BlockNameSpaceAWDParser\");\nimport AnimatorAWDParser \t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AnimatorAWDParser\");\nimport AudioAWDParser \t\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AudioAWDParser\");\n\n\n\nclass AWDBlockParsers\n{\n\n\tprivate _supported_asset_blocks:Object = {};\n\tprivate _all_block_parsers:Array<AWDAssetParserBase>;\n\tconstructor()\n\t{\n\t\tthis._all_block_parsers=new Array<AWDAssetParserBase>();\n\n\t\tthis.add_block_parser(new GeometryAWDParser(), [1]);\n\t\tthis.add_block_parser(new PrefabAWDParser(), [11]);\n\t\tthis.add_block_parser(new DisplayObjectContainerAWDParser(), [22]);\n\t\tthis.add_block_parser(new MeshAWDParser(), [23, 24]);\n\n\t\tthis.add_block_parser(new BillboardAWDParser(), [25]);\n\t\tthis.add_block_parser(new SkyboxAWDParser(), [31]);\n\t\tthis.add_block_parser(new LightAWDParser(), [41]);\n\t\tthis.add_block_parser(new CameraAWDParser(), [42]);\n\t\t//this.add_block_parser(new TextureprojectorAWDParser(), [43]);\n\t\tthis.add_block_parser(new AudioAWDParser(), [44]);\n\t\tthis.add_block_parser(new LightPickerAWDParser(), [51]);\n\t\tthis.add_block_parser(new MaterialAWDParser(), [81]);\n\t\tthis.add_block_parser(new Single2DTextureAWDParser(), [82]);\n\t\tthis.add_block_parser(new SingleCubeTextureAWDParser(), [83]);\n\t\tthis.add_block_parser(new SharedMethodAWDParser(), [91]);\n\t\tthis.add_block_parser(new ShadowMethodAWDParser(), [92]);\n\t\tthis.add_block_parser(new SkeletonAWDParser(), [101]);\n\t\tthis.add_block_parser(new SkeletonPoseAWDParser(), [102]);\n\t\tthis.add_block_parser(new SkeletonAnimClipAWDParser(), [103]);\n\t\tthis.add_block_parser(new VertexAnimClipAWDParser(), [111, 112]);\n\t\tthis.add_block_parser(new VertexAnimationSetAWDParser(), [113]);\n\t\t//this.add_block_parser(new UVAnimationClipAWDParser(), [121]);\n\t\tthis.add_block_parser(new AnimatorAWDParser(), [122]);\n\t\tthis.add_block_parser(new MovieClipAWDParser(), [133]);\n\t\tthis.add_block_parser(new TextfieldAWDParser(), [134]);\n\t\tthis.add_block_parser(new TesselatedFontAWDParser(), [135]);\n\t\tthis.add_block_parser(new TextformatAWDParser(), [136]);\n\n\n\t\tthis.add_block_parser(new CommandAWDParser(), [253]);\n\t\tthis.add_block_parser(new BlockNameSpaceAWDParser(), [254]);\n\t\tthis.add_block_parser(new MetadataAWDParser(), [255]);\n\n\n\t}\n\n\tpublic add_block_parser(block_parser:AWDAssetParserBase, block_types:Array<number>):void\n\t{\n\t\tfor(var i:number=0; i<block_types.length;i++){\n\t\t\tthis._supported_asset_blocks[block_types[i]]  = block_parser;\n\t\t}\n\t\tthis._all_block_parsers.push(block_parser);\n\n\t}\n\n\tpublic init_parser(file_data:AWD3FileData):void\n\t{\n\t\tfor(var i:number=0; i<this._all_block_parsers.length;i++){\n\t\t\tthis._all_block_parsers[i].awd_file_data=file_data;\n\t\t}\n\n\t}\n\tpublic parseAsset(type:number):boolean\n\t{\n\n\t\tvar this_parser:AWDAssetParserBase=this._supported_asset_blocks[type];\n\t\tif(this_parser!=undefined){\n\t\t\tthis_parser.parseFromBytes();\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n}\n\nexport = AWDBlockParsers;",
    "/**\n * Created by 80prozent on 4/18/2015.\n */\n\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\n\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport VertexAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimationSet\");\nimport VertexAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimator\");\nimport SkeletonAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimationSet\");\nimport SkeletonAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimator\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nclass AnimatorAWDParser extends AWDBlockParserBase\n{\n\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar animSetBlockAdress:number; /*int*/\n\t\tvar targetAnimationSet:AnimationSetBase;\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar type:number /*uint*/ = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:AWD3Utils.BADDR});\n\n\t\tanimSetBlockAdress = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\tvar targetMeshLength:number /*uint*/ = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tvar meshAdresses:Array<number> /*uint*/ = new Array<number>() /*uint*/;\n\t\tfor (var i:number /*int*/ = 0; i < targetMeshLength; i++)\n\t\t\tmeshAdresses.push(this.awd_file_data.newBlockBytes.readUnsignedInt());\n\n\t\tvar activeState:number /*uint*/ = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tvar autoplay:boolean = ( this.awd_file_data.newBlockBytes.readUnsignedByte() == 1 );\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.parseUserAttributes();\n\n\t\tvar returnedArray:Array<any>;\n\t\tvar targetMeshes:Array<Mesh> = new Array<Mesh>();\n\n\t\tfor (i = 0; i < meshAdresses.length; i++) {\n\t\t\tvar targetMesh:Mesh = <Mesh>this.awd_file_data.getAssetByID(meshAdresses[i]);\n\t\t\tif (targetMesh!=undefined)\n\t\t\t\ttargetMeshes.push(targetMesh);\n\t\t}\n\t\tvar targetAnimationSet:AnimationSetBase = <AnimationSetBase>this.awd_file_data.getAssetByID(animSetBlockAdress);\n\t\tif (targetAnimationSet==undefined) {\n\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find the AnimationSet ( \" + animSetBlockAdress + \" ) for this.awd_file_data Animator\");\n\t\t\treturn undefined;\n\t\t}\n\t\tvar thisAnimator:AnimatorBase;\n\t\tif (type == 1) {\n\n\t\t\tvar skeleton:Skeleton = <Skeleton>this.awd_file_data.getAssetByID(props.get(1, 0));\n\t\t\tif (skeleton==undefined) {\n\t\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find the Skeleton ( \" + props.get(1, 0) + \" ) for this.awd_file_data Animator\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthisAnimator = new SkeletonAnimator(<SkeletonAnimationSet> targetAnimationSet, skeleton);\n\n\t\t} else if (type == 2)\n\t\t\tthisAnimator = new VertexAnimator(<VertexAnimationSet> targetAnimationSet);\n\n\t\tfor (i = 0; i < targetMeshes.length; i++) {\n\t\t\tif (type == 1)\n\t\t\t\ttargetMeshes[i].animator = (<SkeletonAnimator> thisAnimator);\n\t\t\tif (type == 2)\n\t\t\t\ttargetMeshes[i].animator = (<VertexAnimator> thisAnimator);\n\t\t}\n\t\tthis.awd_file_data.cur_block.data = thisAnimator;\n\t\tif (this.awd_file_data.debug)\n\t\t\tconsole.log(\"Parsed a Animator: Name = \" + this.awd_file_data.cur_block.name);\n\t}\n\n\n}\n\nexport = AnimatorAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\n\nclass AudioAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\n\t\tvar type:number = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\tvar data_len:number;\n\n\t\t//this.awd_file_data._texture_users[this.awd_file_data._cur_block_id.toString()] = [];\n\n\t\t// External\n\t\tif (type == 0) {\n\t\t\tdata_len = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tvar url:string;\n\t\t\turl = this.awd_file_data.newBlockBytes.readUTFBytes(data_len);\n\t\t\tthis.awd_file_data.cur_block.dependencies_urls.push(url);\n\t\t\t//this.awd_file_data._pAddDependency(this.awd_file_data.cur_block.id.toString(), new URLRequest(url), false, null, true);\n\n\t\t} else {\n\t\t\tdata_len = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\n\t\t\tvar data:ByteArray;\n\t\t\tdata = new ByteArray();\n\t\t\tthis.awd_file_data.newBlockBytes.readBytes(data, 0, data_len);\n\t\t\tthis.awd_file_data.cur_block.dependencies_data.push(data);\n\n\t\t\t//\n\t\t\t// AWD3Parserutils - Fix for FireFox Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=715075 .\n\t\t\t//\n\t\t\t// Converting data to image here instead of parser - fix FireFox bug where image width / height is 0 when created from data\n\t\t\t// This gives the browser time to initialise image width / height.\n\n\t\t\t//this.awd_file_data._pAddDependency(this.awd_file_data._cur_block_id.toString(), null, false, ParserUtils.byteArrayToImage(data), true);\n\t\t\t//this.awd_file_data._pAddDependency(this.awd_file_data._cur_block_id.toString(), null, false, data, true);\n\n\t\t}\n\t\tthis.awd_file_data.cur_block.state=AWD3Utils.BLOCKSTATE_LOAD_DEPENDENICES;\n\t\t// Ignore for now\n\t\tthis.awd_file_data.parseProperties(null);\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\t//this.awd_file_data._pPauseAndRetrieveDependencies();\n\n\t\tif (this.awd_file_data.debug) {\n\t\t\tvar audioStylesNames:Array<string> = [\"external\", \"embed\"]\n\t\t\tconsole.log(\"Start parsing a \" + audioStylesNames[type] + \" AudioFile\");\n\t\t}\n\t}\n\n\n}\n\nexport = AudioAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\n\n\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport Billboard\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport BasicMaterial\t\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nclass BillboardAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\n\t\tvar data_id:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\tvar mat:MaterialBase= <MaterialBase> this.awd_file_data.getAssetByID(data_id);\n\n\t\tif (mat==undefined) {\n\t\t\tmat = new BasicMaterial();\n\t\t}\n\t\tmat.bothSides=true;\n\t\tvar billboard:Billboard = new Billboard(mat);\n\t\tthis.awd_file_data.cur_block.data = billboard;\n\t\t// todo: optional matrix etc can be put in properties.\n\t\tthis.awd_file_data.parseProperties(null);\n\n\t\tbillboard.extra = this.awd_file_data.parseUserAttributes();\n\n\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a Library-Billboard: Name = '\" + billboard.name + \"| Material-Name = \" + mat.name);\n\t\t}\n\n\t}\n\n\n}\n\nexport = BillboardAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nclass BlockNameSpaceAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tthis.awd_file_data.cur_block.state=AWD3Utils.BLOCKSTATE_NO_ASSET;\n\t\tvar id:number = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\tvar nameSpaceString:string = this.awd_file_data.parseVarStr();\n\t\tif (this.awd_file_data.debug)\n\t\t\tconsole.log(\"Parsed a NameSpaceBlock: ID = \" + id + \" | String = \" + nameSpaceString);\n\t}\n\n\n}\n\nexport = BlockNameSpaceAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Parser\t\t\t\t= require(\"awayjs-parsers/lib/AWD3Parser\");\n\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport ProjectionBase\t\t\t\t\t= require(\"awayjs-core/lib/projections/ProjectionBase\");\nimport PerspectiveProjection\t\t\t= require(\"awayjs-core/lib/projections/PerspectiveProjection\");\nimport OrthographicProjection\t\t\t= require(\"awayjs-core/lib/projections/OrthographicProjection\");\nimport OrthographicOffCenterProjection\t= require(\"awayjs-core/lib/projections/OrthographicOffCenterProjection\");\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nclass CameraAWD3Parser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void {\n\t\tvar par_id:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\tvar mtx:Matrix3D = this.awd_file_data.parseMatrix3D();\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar parentName:string = \"Root (TopLevel)\";\n\t\tvar projection:ProjectionBase;\n\n\t\tthis.awd_file_data.newBlockBytes.readUnsignedByte(); //set as active camera\n\t\tthis.awd_file_data.newBlockBytes.readShort(); //lengthof lenses - not used yet\n\n\t\tvar projectiontype:number = this.awd_file_data.newBlockBytes.readShort();\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({\n\t\t\t101: this.awd_file_data.propsNrType,\n\t\t\t102: this.awd_file_data.propsNrType,\n\t\t\t103: this.awd_file_data.propsNrType,\n\t\t\t104: this.awd_file_data.propsNrType\n\t\t});\n\n\t\tswitch (projectiontype) {\n\t\t\tcase 5001:\n\t\t\t\tprojection = new PerspectiveProjection(props.get(101, 60));\n\t\t\t\tbreak;\n\t\t\tcase 5002:\n\t\t\t\tprojection = new OrthographicProjection(props.get(101, 500));\n\t\t\t\tbreak;\n\t\t\tcase 5003:\n\t\t\t\tprojection = new OrthographicOffCenterProjection(props.get(101, -400), props.get(102, 400), props.get(103, -300), props.get(104, 300));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.log(\"unsupportedLenstype\");\n\t\t\t\treturn;\n\t\t}\n\n\t\tvar camera:Camera = new Camera(projection);\n\t\tcamera.transform.matrix3D = mtx;\n\t\tif (par_id > 0) {\n\t\t\tvar parent:DisplayObjectContainer = <DisplayObjectContainer>this.awd_file_data.getAssetByID(par_id);\n\t\t\tif (parent != undefined) {\n\t\t\t\tparent.addChild(camera);\n\t\t\t\tparentName = parent.name;\n\t\t\t}\n\t\t}\n\n\t\tcamera.name = name;\n\t\tprops = this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType, 2:this.awd_file_data.matrixNrType, 3:this.awd_file_data.matrixNrType, 4:AWD3Utils.UINT8});\n\t\tcamera.pivot = new Vector3D(props.get(1, 0), props.get(2, 0), props.get(3, 0));\n\t\tcamera.extra = this.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = camera;\n\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a Camera: Name = '\" + camera.name + \"' | Projectiontype = \" + projection + \" | Parent-Name = \" + parentName);\n\t\t}\n\n\t}\n\n\n}\n\nexport = CameraAWD3Parser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport DisplayObjectContainer\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nclass CommandAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tthis.awd_file_data.cur_block.state=AWD3Utils.BLOCKSTATE_NO_ASSET;\n\t\tvar hasBlocks:boolean = ( this.awd_file_data.newBlockBytes.readUnsignedByte() == 1 );\n\t\tvar par_id:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\tvar mtx:Matrix3D = this.awd_file_data.parseMatrix3D();\n\t\tvar name:string = this.awd_file_data.parseVarStr();\n\n\t\tvar parentObject:DisplayObjectContainer;\n\t\tvar targetObject:DisplayObject;\n\n\t\tif(par_id>0)\n\t\t\tparentObject = <DisplayObjectContainer>this.awd_file_data.getAssetByID(par_id); //for no only light is requested!!!!\n\n\t\tvar numCommands:number = this.awd_file_data.newBlockBytes.readShort();\n\t\tvar typeCommand:number = this.awd_file_data.newBlockBytes.readShort();\n\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:AWD3Utils.BADDR});\n\n\t\tswitch (typeCommand) {\n\t\t\tcase 1:\n\n\t\t\t\tvar targetID:number = props.get(1, 0);\n\t\t\t\t//var returnedArrayTarget:Array<any> = this.getAssetByID(targetID, [LightBase.assetType, TextureProjector.assetType]); //for no only light is requested!!!!\n\t\t\t\ttargetObject = <DisplayObject>this.awd_file_data.getAssetByID(targetID); //for no only light is requested!!!!\n\t\t\t\tif(targetObject==undefined){\n\t\t\t\t\t//this._awd_data._blocks[blockID].addError(\"Could not find the light (ID = \" + targetID + \" ( for this CommandBock!\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (parentObject) {\n\t\t\t\t\tparentObject.addChild(targetObject);\n\t\t\t\t}\n\t\t\t\ttargetObject.transform.matrix3D = mtx;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (targetObject) {\n\t\t\tprops = this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType, 2:this.awd_file_data.matrixNrType, 3:this.awd_file_data.matrixNrType, 4:AWD3Utils.UINT8});\n\n\t\t\ttargetObject.pivot = new Vector3D(props.get(1, 0), props.get(2, 0), props.get(3, 0));\n\t\t\ttargetObject.extra = this.awd_file_data.parseUserAttributes();\n\n\t\t}\n\t\t//this._awd_data._blocks[blockID].data = targetObject\n\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a CommandBlock: Name = '\" + name);\n\t\t}\n\t}\n\n\n}\n\nexport = CommandAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport Matrix3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport AWDProperties\t\t\t= require(\"../AWD3ParserUtils/AWDProperties\");\n\nimport DisplayObjectContainer\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport DisplayObject\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\n\nclass DisplayObjectContainerAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\n\t\tvar par_id:number;\n\t\tvar mtx:Matrix3D;\n\t\tvar ctr:DisplayObjectContainer;\n\t\tvar parent:DisplayObjectContainer;\n\n\t\tctr = new DisplayObjectContainer();\n\t\tpar_id = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\tmtx = this.awd_file_data.parseMatrix3D();\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\n\t\tvar parentName:string = \"Root (TopLevel)\";\n\t\tctr.transform.matrix3D = mtx;\n\n\n\t\tif (par_id > 0) {\n\t\t\tvar parent:DisplayObjectContainer = <DisplayObjectContainer>this.awd_file_data.getAssetByID(par_id);\n\t\t\tif (parent != undefined) {\n\t\t\t\tparent.addChild(ctr);\n\t\t\t\tparentName = parent.name;\n\t\t\t}\n\t\t}\n\n\t\t// in AWD version 2.1 we read the Container properties\n\t\tif ((this.awd_file_data.major_version > 2)||((this.awd_file_data.major_version >= 2) && (this.awd_file_data.minor_version == 1))) {\n\t\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType, 2:this.awd_file_data.matrixNrType, 3:this.awd_file_data.matrixNrType, 4:AWD3Utils.UINT8});\n\t\t\tctr.pivot = new Vector3D(props.get(1, 0), props.get(2, 0), props.get(3, 0));\n\t\t}\n\t\t// in other versions we do not read the Container properties\n\t\telse {\n\t\t\tthis.awd_file_data.parseProperties(null);\n\t\t}\n\n\t\t// the extraProperties should only be set for AWD2.1-Files, but is read for both versions\n\t\tctr.extra = this.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data=ctr;\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a Container: Name = '\" + ctr.name + \"' | Parent-Name = \" + parentName);\n\t\t}\n\t}\n\n\n}\n\nexport = DisplayObjectContainerAWDParser;",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport EventDispatcher\t\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport SubGeometryBase\t\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport CurveSubGeometry\t\t\t\t\t= require(\"awayjs-display/lib/base/CurveSubGeometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\n\nclass GeometryAWDParser extends AWDBlockParserBase\n{\n\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar geom:Geometry = new Geometry();\n\n\t\t// Read name and sub count\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar num_subs:number = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\n\t\t// Read optional properties\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:this.awd_file_data.geoNrType, 2:this.awd_file_data.geoNrType});\n\t\tvar geoScaleU:number = props.get(1, 1);\n\t\tvar geoScaleV:number = props.get(2, 1);\n\n\t\t// Loop through sub meshes\n\t\tvar subs_parsed:number = 0;\n\t\twhile (subs_parsed < num_subs) {\n\t\t\tvar is_curve_geom:boolean=false;\n\t\t\tvar i:number;\n\t\t\tvar sm_len:number, sm_end:number;\n\t\t\tvar w_indices:Array<number>;\n\t\t\tvar weights:Array<number>;\n\n\t\t\tsm_len = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tsm_end = this.awd_file_data.newBlockBytes.position + sm_len;\n\n\t\t\tvar subProps:AWDProperties = this.awd_file_data.parseProperties({1:this.awd_file_data.geoNrType, 2:this.awd_file_data.geoNrType});\n\t\t\t// Loop through data streams\n\t\t\twhile (this.awd_file_data.newBlockBytes.position < sm_end) {\n\t\t\t\tvar idx:number = 0;\n\t\t\t\tvar str_ftype:number, str_type:number, str_len:number, str_end:number;\n\n\t\t\t\t// Type, field type, length\n\t\t\t\tstr_type = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\t\t\tstr_ftype = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\t\t\tstr_len = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\tstr_end = this.awd_file_data.newBlockBytes.position + str_len;\n\n\t\t\t\tvar x:number, y:number, z:number;\n\n\t\t\t\tif (str_type == 1) {//vertex 3d positions\n\t\t\t\t\tvar verts:Array<number> = new Array<number>();\n\n\t\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < str_end) {\n\n\t\t\t\t\t\tx = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);\n\t\t\t\t\t\ty = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);\n\t\t\t\t\t\tz = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);\n\n\t\t\t\t\t\tverts[idx++] = x;\n\t\t\t\t\t\tverts[idx++] = y;\n\t\t\t\t\t\tverts[idx++] = z;\n\t\t\t\t\t}\n\t\t\t\t} else if (str_type == 2) {//face indicies positions\n\t\t\t\t\tvar indices:Array<number> = new Array<number>();\n\n\t\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < str_end) {\n\t\t\t\t\t\tindices[idx++] = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\t\t\t}\n\n\t\t\t\t} else if (str_type == 3) {\n\t\t\t\t\tvar uvs:Array<number> = new Array<number>();\n\t\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < str_end) {\n\t\t\t\t\t\tuvs[idx++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);\n\n\t\t\t\t\t}\n\t\t\t\t} else if (str_type == 4) {\n\n\t\t\t\t\tvar normals:Array<number> = new Array<number>();\n\n\t\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < str_end) {\n\t\t\t\t\t\tnormals[idx++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);\n\t\t\t\t\t}\n\n\t\t\t\t} else if (str_type == 6) {\n\t\t\t\t\tw_indices = Array<number>();\n\n\t\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < str_end) {\n\t\t\t\t\t\tw_indices[idx++] = this.awd_file_data.newBlockBytes.readUnsignedShort()*3;\n\t\t\t\t\t}\n\n\t\t\t\t} else if (str_type == 7) {\n\n\t\t\t\t\tweights = new Array<number>();\n\n\t\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < str_end) {\n\t\t\t\t\t\tweights[idx++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);\n\t\t\t\t\t}\n\t\t\t\t} else if (str_type == 8) {// 2d-positions - not used yet.\n\t\t\t\t\tthis.awd_file_data.newBlockBytes.position = str_end;\n\t\t\t\t} else if (str_type == 9) {// combined vertex3D stream 13 x float32\n\t\t\t\t\tthis.awd_file_data.newBlockBytes.position = str_end;\n\t\t\t\t} else if (str_type == 10) {// combined vertex2D stream 5 x float32\n\t\t\t\t\tis_curve_geom=true;\n\t\t\t\t\tvar idx_pos:number = 0;\n\t\t\t\t\tvar idx_curves:number = 0;\n\t\t\t\t\tvar idx_uvs:number = 0;\n\n\t\t\t\t\tvar positions:Array<number> = new Array<number>();\n\t\t\t\t\tvar curveData:Array<number> = new Array<number>();\n\t\t\t\t\tvar uvs:Array<number> = new Array<number>();\n\n\t\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < str_end) {\n\n\t\t\t\t\t\tpositions[idx_pos++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// x\n\t\t\t\t\t\tpositions[idx_pos++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// y\n\t\t\t\t\t\tpositions[idx_pos++] =  this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// type\n\n\t\t\t\t\t\tcurveData[idx_curves++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// curve value 1\n\t\t\t\t\t\tcurveData[idx_curves++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// curve value 2\n\n\t\t\t\t\t\tuvs[idx_uvs++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// curve value 1\n\t\t\t\t\t\tuvs[idx_uvs++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// curve value 1\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.awd_file_data.newBlockBytes.position = str_end;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tthis.awd_file_data.parseUserAttributes(); // Ignore sub-mesh attributes for now\n\t\t\tif(is_curve_geom){\n\t\t\t\tvar curve_sub_geom:CurveSubGeometry = new CurveSubGeometry(new AttributesBuffer());\n\t\t\t\tcurve_sub_geom.setIndices(indices);\n\t\t\t\tcurve_sub_geom.setPositions(positions);\n\t\t\t\tcurve_sub_geom.setCurves(curveData);\n\t\t\t\tcurve_sub_geom.setUVs(uvs);\n\t\t\t\tgeom.addSubGeometry(curve_sub_geom);\n\t\t\t\tif (this.awd_file_data.debug)\n\t\t\t\t\tconsole.log(\"Parsed a CurveSubGeometry\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar triangle_sub_geom = new TriangleSubGeometry(new AttributesBuffer());\n\t\t\t\tif (weights)\n\t\t\t\t\ttriangle_sub_geom.jointsPerVertex = weights.length / (verts.length / 3);\n\t\t\t\tif (normals)\n\t\t\t\t\ttriangle_sub_geom.autoDeriveNormals = false;\n\t\t\t\tif (uvs)\n\t\t\t\t\ttriangle_sub_geom.autoDeriveUVs = false;\n\t\t\t\t//triangle_sub_geom.autoDeriveNormals = false;\n\t\t\t\tif (true) {\n\t\t\t\t\ttriangle_sub_geom.autoDeriveTangents = true;\n\t\t\t\t}\n\t\t\t\ttriangle_sub_geom.setIndices(indices);\n\t\t\t\ttriangle_sub_geom.setPositions(verts);\n\t\t\t\ttriangle_sub_geom.setNormals(normals);\n\t\t\t\ttriangle_sub_geom.setUVs(uvs);\n\t\t\t\ttriangle_sub_geom.setTangents(null);\n\t\t\t\ttriangle_sub_geom.setJointWeights(weights);\n\t\t\t\ttriangle_sub_geom.setJointIndices(w_indices);\n\n\t\t\t\tvar scaleU:number = subProps.get(1, 1);\n\t\t\t\tvar scaleV:number = subProps.get(2, 1);\n\t\t\t\tvar setSubUVs:boolean = false; //this should remain false atm, because in AwayBuilder the uv is only scaled by the geometry\n\n\t\t\t\tif ((geoScaleU != scaleU) || (geoScaleV != scaleV)) {\n\t\t\t\t\tsetSubUVs = true;\n\t\t\t\t\tscaleU = geoScaleU / scaleU;\n\t\t\t\t\tscaleV = geoScaleV / scaleV;\n\t\t\t\t}\n\n\t\t\t\tif (setSubUVs)\n\t\t\t\t\ttriangle_sub_geom.scaleUV(scaleU, scaleV);\n\t\t\t\tgeom.addSubGeometry(triangle_sub_geom);\n\t\t\t\tif (this.awd_file_data.debug)\n\t\t\t\t\tconsole.log(\"Parsed a TriangleSubGeometry\");\n\t\t\t}\n\n\n\t\t\t// TODO: Somehow map in-sub to out-sub indices to enable look-up\n\t\t\t// when creating meshes (and their material assignments.)\n\n\t\t\tsubs_parsed++;\n\t\t}\n\t\tif ((geoScaleU != 1) || (geoScaleV != 1))\n\t\t\tgeom.scaleUV(geoScaleU, geoScaleV);\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data=geom;\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a TriangleGeometry: Name = \" + name);\n\t\t}\n\t}\n\n}\n\nexport = GeometryAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\n\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport CubeMapShadowMapper\t\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper\");\nimport DirectionalShadowMapper\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper\");\nimport ShadowMapperBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase\");\n\nimport LightBase\t\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport DirectionalLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport PointLight\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nclass LightAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\t\n\t\tvar light:LightBase;\n\t\tvar newShadowMapper:ShadowMapperBase;\n\n\t\tvar par_id:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\tvar mtx:Matrix3D = this.awd_file_data.parseMatrix3D();\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar lightType:number = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:this.awd_file_data.propsNrType, 2:this.awd_file_data.propsNrType, 3:AWD3Utils.COLOR, 4:this.awd_file_data.propsNrType, 5:this.awd_file_data.propsNrType, 6:AWD3Utils.BOOL, 7:AWD3Utils.COLOR, 8:this.awd_file_data.propsNrType, 9:AWD3Utils.UINT8, 10:AWD3Utils.UINT8, 11:this.awd_file_data.propsNrType, 12:AWD3Utils.UINT16, 21:this.awd_file_data.matrixNrType, 22:this.awd_file_data.matrixNrType, 23:this.awd_file_data.matrixNrType});\n\t\tvar shadowMapperType:number = props.get(9, 0);\n\t\tvar parentName:string = \"Root (TopLevel)\";\n\t\tvar lightTypes:Array<string> = [\"Unsupported LightType\", \"PointLight\", \"DirectionalLight\"];\n\t\tvar shadowMapperTypes:Array<string> = [\"No ShadowMapper\", \"DirectionalShadowMapper\", \"NearDirectionalShadowMapper\", \"CascadeShadowMapper\", \"CubeMapShadowMapper\"];\n\n\t\tif (lightType == 1) {\n\t\t\tlight = new PointLight();\n\n\t\t\t(<PointLight> light).radius = props.get(1, 90000);\n\t\t\t(<PointLight> light).fallOff = props.get(2, 100000);\n\n\t\t\tif (shadowMapperType > 0) {\n\t\t\t\tif (shadowMapperType == 4) {\n\t\t\t\t\tnewShadowMapper = new CubeMapShadowMapper();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlight.transform.matrix3D = mtx;\n\n\t\t}\n\n\t\tif (lightType == 2) {\n\n\t\t\tlight = new DirectionalLight(props.get(21, 0), props.get(22, -1), props.get(23, 1));\n\n\t\t\tif (shadowMapperType > 0) {\n\t\t\t\tif (shadowMapperType == 1) {\n\t\t\t\t\tnewShadowMapper = new DirectionalShadowMapper();\n\t\t\t\t}\n\n\t\t\t\t//if (shadowMapperType == 2)\n\t\t\t\t//  newShadowMapper = new NearDirectionalShadowMapper(props.get(11, 0.5));\n\t\t\t\t//if (shadowMapperType == 3)\n\t\t\t\t//   newShadowMapper = new CascadeShadowMapper(props.get(12, 3));\n\n\t\t\t}\n\n\t\t}\n\t\tlight.name=name;\n\t\tlight.color = props.get(3, 0xffffff);\n\t\tlight.specular = props.get(4, 1.0);\n\t\tlight.diffuse = props.get(5, 1.0);\n\t\tlight.ambientColor = props.get(7, 0xffffff);\n\t\tlight.ambient = props.get(8, 0.0);\n\n\t\t// if a shadowMapper has been created, adjust the depthMapSize if needed, assign to light and set castShadows to true\n\t\tif (newShadowMapper) {\n\t\t\tif (newShadowMapper instanceof CubeMapShadowMapper) {\n\t\t\t\tif (props.get(10, 1) != 1) {\n\t\t\t\t\tnewShadowMapper.depthMapSize = this.awd_file_data.getDepthSizeFromEnum(props.get(10, 1));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (props.get(10, 2) != 2) {\n\t\t\t\t\tnewShadowMapper.depthMapSize = this.awd_file_data.getDepthSizeFromEnum(props.get(10, 2));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlight.shadowMapper = newShadowMapper;\n\t\t\tlight.castsShadows = true;\n\t\t}\n\n\t\tif (par_id != 0) {\n\n\t\t\tvar parent:DisplayObjectContainer = <DisplayObjectContainer>this.awd_file_data.getAssetByID(par_id)\n\n\t\t\tif (parent!=undefined){\n\t\t\t\tparent.addChild(light);\n\t\t\t\tparentName = parent.name;\n\t\t\t} else {\n\t\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find a parent for this.awd_file_data Light\");\n\t\t\t}\n\t\t} else {\n\t\t\t//add to the content property\n\t\t\t//(<DisplayObjectContainer> this.awd_file_data._pContent).addChild(light);\n\t\t}\n\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = light;\n\n\n\t\tif (this.awd_file_data.debug)\n\t\t\tconsole.log(\"Parsed a Light: Name = '\" + this.awd_file_data.cur_block.name + \"' | Type = \" + lightTypes[lightType] + \" | Parent-Name = \" + parentName + \" | ShadowMapper-Type = \" + shadowMapperTypes[shadowMapperType]);\n\t}\n\n\n}\n\nexport = LightAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\n\nimport LightPickerBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport StaticLightPicker\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/StaticLightPicker\");\nimport LightBase\t\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\n\nclass LightPickerAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar numLights:number = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tvar lightsArray:Array<LightBase> = new Array<LightBase>();\n\t\tvar k:number = 0;\n\t\tvar lightID:number = 0;\n\n\t\tvar returnedArrayLight:Array<any>;\n\t\tvar lightsArrayNames:Array<string> = new Array<string>();\n\n\t\tfor (k = 0; k < numLights; k++) {\n\t\t\tlightID = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tvar light:LightBase = <LightBase>this.awd_file_data.getAssetByID(lightID)\n\n\t\t\tif (light!=undefined) {\n\t\t\t\tlightsArray.push(<LightBase> light);\n\t\t\t\tlightsArrayNames.push(( <LightBase> light).name);\n\n\t\t\t} else {\n\t\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find a Light Nr \" + k + \" (ID = \" + lightID + \" ) for this.awd_file_data LightPicker\");\n\t\t\t}\n\t\t}\n\n\t\tif (lightsArray.length == 0) {\n\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not create this.awd_file_data LightPicker, cause no Light was found.\");\n\t\t\tthis.awd_file_data.parseUserAttributes();\n\t\t\treturn undefined; //return without any more parsing for this.awd_file_data block\n\t\t}\n\n\t\tvar lightPicker:LightPickerBase = new StaticLightPicker(lightsArray);\n\t\tthis.awd_file_data.cur_block.data = lightPicker;\n\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a StaticLightPicker: Name = '\" + this.awd_file_data.cur_block.name + \"' | Texture-Name = \" + lightsArrayNames.toString());\n\t\t}\n\t}\n\n\n}\n\nexport = LightPickerAWDParser;",
    "import Sampler2D\t\t\t\t\t= require(\"awayjs-core/lib/image/Sampler2D\");\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\n\nimport MethodMaterialMode\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterialMode\");\nimport MethodMaterial\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterial\");\n\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport LightPickerBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\")\nimport BasicMaterial\t\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\nimport DefaultMaterialManager\t\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\nimport TextureBase\t\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\nimport Single2DTexture\t\t\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\nimport SingleCubeTexture\t\t\t\t= require(\"awayjs-display/lib/textures/SingleCubeTexture\");\n\nimport EffectMethodBase\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectMethodBase\");\nimport AmbientEnvMapMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod\");\nimport DiffuseDepthMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/DiffuseDepthMethod\");\nimport DiffuseCelMethod\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/DiffuseCelMethod\");\nimport DiffuseGradientMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/DiffuseGradientMethod\");\nimport DiffuseLightMapMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod\");\nimport DiffuseWrapMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/DiffuseWrapMethod\");\nimport NormalSimpleWaterMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod\");\nimport SpecularFresnelMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/SpecularFresnelMethod\");\nimport SpecularAnisotropicMethod\t\t= require(\"awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod\");\nimport SpecularCelMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/SpecularCelMethod\");\nimport SpecularPhongMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/SpecularPhongMethod\");\nimport ShadowMapMethodBase\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowMapMethodBase\");\nimport ShadowMethodBase\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowMethodBase\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nclass MaterialAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\t// version 2.0\n\t\t////blockLength = block.len;\n\t\tvar name:string;\n\t\tvar type:number;\n\t\tvar props:AWDProperties;\n\t\tvar mat:MethodMaterial;\n\t\tvar attributes:Object;\n\t\tvar finalize:boolean;\n\t\tvar num_methods:number;\n\t\tvar methods_parsed:number;\n\t\tvar returnedArray:Array<any>;\n\t\tvar mat:MethodMaterial;\n\t\tvar normalTexture:Single2DTexture;\n\t\tvar specTexture:Single2DTexture;\n\t\tvar returnedArray:Array<any>;\n\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\ttype = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\tnum_methods = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\n\t\tif((this.awd_file_data.major_version==2)&&(this.awd_file_data.major_version==0)) {\n\n\t\t\t// Read material numerical properties\n\t\t\t// (1=color, 2=bitmap url, 10=alpha, 11=alpha_blending, 12=alpha_threshold, 13=repeat)\n\t\t\tprops = this.awd_file_data.parseProperties({\n\t\t\t\t1: AWD3Utils.INT32,\n\t\t\t\t2: AWD3Utils.BADDR,\n\t\t\t\t10: this.awd_file_data.propsNrType,\n\t\t\t\t11: AWD3Utils.BOOL,\n\t\t\t\t12: this.awd_file_data.propsNrType,\n\t\t\t\t13: AWD3Utils.BOOL\n\t\t\t});\n\t\t\tmethods_parsed = 0;\n\t\t\twhile (methods_parsed < num_methods) {\n\t\t\t\tvar method_type:number;\n\n\t\t\t\tmethod_type = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\t\tthis.awd_file_data.parseProperties(null);\n\t\t\t\tthis.awd_file_data.parseUserAttributes();\n\t\t\t\tmethods_parsed += 1;\n\t\t\t}\n\t\t\tvar debugString:string = \"\";\n\t\t\tattributes = this.awd_file_data.parseUserAttributes();\n\t\t\tif (type === 1) { // Color material\n\t\t\t\tdebugString += \"Parsed a ColorMaterial(SinglePass): Name = '\" + name + \"' | \";\n\t\t\t\tvar color:number;\n\t\t\t\tcolor = props.get(1, 0xffffff);\n\t\t\t\t/*if (this.awd_file_data.materialMode < 2) {\n\t\t\t\t\tmat = new MethodMaterial(color, props.get(10, 1.0));\n\t\t\t\t} else {\n\t\t\t\t\tmat = new MethodMaterial(color);\n\t\t\t\t\tmat.mode = MethodMaterialMode.MULTI_PASS;\n\t\t\t\t}*/\n\t\t\t} else if (type === 2) {\n\t\t\t\tvar tex_addr:number = props.get(2, 0);\n\t\t\t\tvar texture:TextureBase=undefined;\n\t\t\t\tif (tex_addr > 0) {\n\t\t\t\t\tvar texture:TextureBase = <TextureBase> this.awd_file_data.getAssetByID(tex_addr);\n\t\t\t\t}\n\t\t\t\tif (texture==undefined) {\n\t\t\t\t\ttexture= DefaultMaterialManager.getDefaultTexture();\n\t\t\t\t}\n\n\t\t\t\tmat = new MethodMaterial();\n\t\t\t\tmat.ambientMethod.texture = texture;\n\t\t\t\t/*\n\t\t\t\tif (this.awd_file_data.materialMode < 2) {\n\t\t\t\t\tmat.alphaBlending = props.get(11, false);\n\t\t\t\t\tmat.alpha = props.get(10, 1.0);\n\t\t\t\t\tdebugString += \"Parsed a MethodMaterial(SinglePass): Name = '\" + name + \"' | Texture-Name = \" + mat.name;\n\t\t\t\t} else {\n\t\t\t\t\tmat.mode = MethodMaterialMode.MULTI_PASS;\n\t\t\t\t\tdebugString += \"Parsed a MethodMaterial(MultiPass): Name = '\" + name + \"' | Texture-Name = \" + mat.name;\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}\n\n\t\t\tmat.extra = attributes;\n\t\t\tmat.alphaThreshold = props.get(12, 0.0);\n\t\t\tmat.style.sampler = new Sampler2D(props.get(13, false));\n\t\t\tmat.name=name;\n\t\t\tif (this.awd_file_data.debug) {\n\t\t\t\tconsole.log(debugString);\n\n\t\t\t}\n\t\t\tthis.awd_file_data.cur_block.data=mat;\n\t\t\treturn;\n\t\t}\n\n\t\t// version 2.1+\n\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:AWD3Utils.UINT32, 2:AWD3Utils.BADDR, 3:AWD3Utils.BADDR, 4:AWD3Utils.UINT8, 5:AWD3Utils.BOOL, 6:AWD3Utils.BOOL, 7:AWD3Utils.BOOL, 8:AWD3Utils.BOOL, 9:AWD3Utils.UINT8, 10:this.awd_file_data.propsNrType, 11:AWD3Utils.BOOL, 12:this.awd_file_data.propsNrType, 13:AWD3Utils.BOOL, 15:this.awd_file_data.propsNrType, 16:AWD3Utils.UINT32, 17:AWD3Utils.BADDR, 18:this.awd_file_data.propsNrType, 19:this.awd_file_data.propsNrType, 20:AWD3Utils.UINT32, 21:AWD3Utils.BADDR, 22:AWD3Utils.BADDR});\n\t\tvar spezialType:number = props.get(4, 0);\n\t\tvar debugString:string = \"Parsed Material \";\n\n\t\tif (spezialType >= 2) {//this.awd_file_data is no supported material\n\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Material-spezialType '\" + spezialType + \"' is not supported, can only be 0:singlePass, 1:MultiPass !\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (type <= 2) {// Color material\n\t\t\t/*\n\t\t\tif (this.awd_file_data.materialMode == 1)\n\t\t\t\tspezialType = 0;\n\t\t\telse if (this.awd_file_data.materialMode == 2)\n\t\t\t\tspezialType = 1;\n\t\t\t\t*/\n\n\t\t\tif (spezialType < 2) {//this.awd_file_data is SinglePass or MultiPass\n\n\t\t\t\tif (type == 1) {// Color material\n\t\t\t\t\tvar color:number = props.get(1, 0xcccccc);//TODO temporarily swapped so that diffuse color goes to ambient\n\n\t\t\t\t\tif (spezialType == 1) {//\tMultiPassMaterial\n\t\t\t\t\t\tmat = new MethodMaterial(color);\n\t\t\t\t\t\tmat.mode = MethodMaterialMode.MULTI_PASS;\n\t\t\t\t\t\tdebugString += \"Parsed a ColorMaterial(MultiPass): Name = '\" + name + \"' | \";\n\n\t\t\t\t\t} else { //\tSinglePassMaterial\n\t\t\t\t\t\tmat = new MethodMaterial(color, props.get(10, 1.0));\n\t\t\t\t\t\tmat.alphaBlending = props.get(11, false);\n\t\t\t\t\t\tdebugString += \"Parsed a ColorMaterial(SinglePass): Name = '\" + name + \"' | \";\n\t\t\t\t\t}\n\n\t\t\t\t} else if (type == 2) {// texture material\n\t\t\t\t\tvar tex_addr:number = props.get(2, 0);//TODO temporarily swapped so that diffuse texture goes to ambient\n\t\t\t\t\tvar diftexture:TextureBase=undefined;\n\t\t\t\t\tif (tex_addr > 0) {\n\t\t\t\t\t\tdiftexture = <TextureBase> this.awd_file_data.getAssetByID(tex_addr);\n\t\t\t\t\t}\n\t\t\t\t\tif (diftexture==undefined) {\n\t\t\t\t\t\tdiftexture= DefaultMaterialManager.getDefaultTexture();\n\t\t\t\t\t}\n\t\t\t\t\tmat = new MethodMaterial();\n\t\t\t\t\tmat.ambientMethod.texture = diftexture;\n\n\t\t\t\t\tif (spezialType == 1) {// MultiPassMaterial\n\t\t\t\t\t\tmat.mode = MethodMaterialMode.MULTI_PASS;\n\n\t\t\t\t\t\tdebugString += \"Parsed a MethodMaterial(MultiPass): Name = '\" + this.awd_file_data.cur_block.name + \"' | Texture-Name = \" + diftexture.name;\n\t\t\t\t\t} else {//\tSinglePassMaterial\n\t\t\t\t\t\tmat.alpha = props.get(10, 1.0);\n\t\t\t\t\t\tmat.alphaBlending = props.get(11, false);\n\n\t\t\t\t\t\tdebugString += \"Parsed a MethodMaterial(SinglePass): Name = '\" + this.awd_file_data.cur_block.name + \"' | Texture-Name = \" + diftexture.name;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\n\t\t\t\tvar diffuseTex_addr:number = props.get(17, 0);\n\n\t\t\t\tvar diffuseTexture:TextureBase = undefined;\n\t\t\t\tif (diffuseTex_addr > 0) {\n\t\t\t\t\tdiffuseTexture = <Single2DTexture> this.awd_file_data.getAssetByID(diffuseTex_addr);\n\t\t\t\t}\n\t\t\t\tif (diffuseTexture) {\n\t\t\t\t\tmat.diffuseTexture = <Single2DTexture>diffuseTexture;\n\t\t\t\t\tdebugString += \" | DiffuseTexture-Name = \" + diffuseTexture.name;\n\t\t\t\t}\n\n\t\t\t\tvar normalTex_addr:number = props.get(3, 0);\n\n\n\t\t\t\tnormalTexture = undefined;\n\t\t\t\tif (normalTex_addr > 0) {\n\t\t\t\t\tnormalTexture = <Single2DTexture> this.awd_file_data.getAssetByID(normalTex_addr);\n\t\t\t\t}\n\n\t\t\t\tvar specTex_addr:number = props.get(21, 0);\n\t\t\t\tspecTexture=undefined;\n\t\t\t\tif (specTex_addr > 0) {\n\t\t\t\t\tspecTexture = <Single2DTexture> this.awd_file_data.getAssetByID(specTex_addr);\n\t\t\t\t}\n\n\t\t\t\tvar lightPickerAddr:number = props.get(22, 0);\n\t\t\t\tif(lightPickerAddr>0) {\n\t\t\t\t\tmat.lightPicker = <LightPickerBase> this.awd_file_data.getAssetByID(lightPickerAddr);\n\t\t\t\t}\n\n\t\t\t\tmat.style.sampler = new Sampler2D(props.get(13, false), props.get(5, true), props.get(6, true));\n\t\t\t\tmat.bothSides = props.get(7, false);\n\t\t\t\tmat.alphaPremultiplied = props.get(8, false);\n\t\t\t\tmat.blendMode = this.awd_file_data.getBlendModeStringFromEnum(props.get(9, 0));\n\t\t\t\tmat.normalMethod.texture = normalTexture;\n\t\t\t\tmat.specularMethod.texture = specTexture;\n\n\t\t\t\tmat.alphaThreshold = props.get(12, 0.0);\n\t\t\t\tmat.ambientMethod.strength = props.get(15, 1.0);\n\t\t\t\tmat.diffuseMethod.color = props.get(16, 0xffffff);\n\t\t\t\tmat.specularMethod.strength = props.get(18, 1.0);\n\t\t\t\tmat.specularMethod.gloss = props.get(19, 50);\n\t\t\t\tmat.specularMethod.color = props.get(20, 0xffffff);\n\n\t\t\t\tvar methods_parsed:number = 0;\n\t\t\t\tvar targetID:number;\n\n\t\t\t\twhile (methods_parsed < num_methods) {\n\t\t\t\t\tvar method_type:number;\n\t\t\t\t\tmethod_type = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\n\t\t\t\t\tprops = this.awd_file_data.parseProperties({\n\t\t\t\t\t\t1: AWD3Utils.BADDR,\n\t\t\t\t\t\t2: AWD3Utils.BADDR,\n\t\t\t\t\t\t3: AWD3Utils.BADDR,\n\t\t\t\t\t\t101: this.awd_file_data.propsNrType,\n\t\t\t\t\t\t102: this.awd_file_data.propsNrType,\n\t\t\t\t\t\t103: this.awd_file_data.propsNrType,\n\t\t\t\t\t\t201: AWD3Utils.UINT32,\n\t\t\t\t\t\t202: AWD3Utils.UINT32,\n\t\t\t\t\t\t301: AWD3Utils.UINT16,\n\t\t\t\t\t\t302: AWD3Utils.UINT16,\n\t\t\t\t\t\t401: AWD3Utils.UINT8,\n\t\t\t\t\t\t402: AWD3Utils.UINT8,\n\t\t\t\t\t\t601: AWD3Utils.COLOR,\n\t\t\t\t\t\t602: AWD3Utils.COLOR,\n\t\t\t\t\t\t701: AWD3Utils.BOOL,\n\t\t\t\t\t\t702: AWD3Utils.BOOL,\n\t\t\t\t\t\t801: AWD3Utils.MTX4x4\n\t\t\t\t\t});\n\n\t\t\t\t\tswitch (method_type) {\n\t\t\t\t\t\tcase 999: //wrapper-Methods that will load a previous parsed EffectMethod\n\n\t\t\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\t\t\t\tif (targetID>0) {\n\t\t\t\t\t\t\t\tvar fx_method:EffectMethodBase = <EffectMethodBase>this.awd_file_data.getAssetByID(targetID);\n\t\t\t\t\t\t\t\tmat.addEffectMethod(fx_method);\n\t\t\t\t\t\t\t\tdebugString += \" | EffectMethod-Name = \" + (<EffectMethodBase> fx_method).name;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 998: //wrapper-Methods that will load a previous parsed ShadowMapMethod\n\n\t\t\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\t\t\t\tif (targetID>0) {\n\t\t\t\t\t\t\t\tvar shadow_method:ShadowMethodBase = <ShadowMethodBase>this.awd_file_data.getAssetByID(targetID);\n\t\t\t\t\t\t\t\tmat.shadowMethod=shadow_method;\n\t\t\t\t\t\t\t\tdebugString += \" | EffectMethod-Name = \" + (<ShadowMethodBase> shadow_method).name;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 1: //EnvMapAmbientMethod\n\t\t\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\t\t\t\tvar cubeTex:SingleCubeTexture=undefined;\n\t\t\t\t\t\t\tif (targetID>0) {\n\t\t\t\t\t\t\t\tcubeTex = <SingleCubeTexture>this.awd_file_data.getAssetByID(targetID);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(cubeTex==undefined){\n\t\t\t\t\t\t\t\tcubeTex=<SingleCubeTexture>this.awd_file_data.getDefaultCubeTexture();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//if (!returnedArray[0])\n\t\t\t\t\t\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find the EnvMap (ID = \" + targetID + \" ) for this.awd_file_data EnvMapAmbientMethodMaterial\");\n\t\t\t\t\t\t\tmat.ambientMethod = new AmbientEnvMapMethod();\n\t\t\t\t\t\t\tmat.ambientMethod.texture = cubeTex;\n\t\t\t\t\t\t\tdebugString += \" | AmbientEnvMapMethod | EnvMap-Name =\" + (<SingleCubeTexture> cubeTex).name;\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 51: //DepthDiffuseMethod\n\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseDepthMethod();\n\t\t\t\t\t\t\tdebugString += \" | DiffuseDepthMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 52: //GradientDiffuseMethod\n\t\t\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\t\t\t\tvar thisTex:TextureBase=undefined;\n\t\t\t\t\t\t\tif (targetID>0) {\n\t\t\t\t\t\t\t\tthisTex = <TextureBase>this.awd_file_data.getAssetByID(targetID);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(thisTex==undefined){\n\t\t\t\t\t\t\t\tthisTex=DefaultMaterialManager.getDefaultTexture();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//if (!returnedArray[0])\n\t\t\t\t\t\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find the GradientDiffuseTexture (ID = \" + targetID + \" ) for this.awd_file_data GradientDiffuseMethod\");\n\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseGradientMethod(<Single2DTexture>thisTex);\n\t\t\t\t\t\t\tdebugString += \" | DiffuseGradientMethod | GradientDiffuseTexture-Name =\" + (<Single2DTexture>thisTex).name;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 53: //WrapDiffuseMethod\n\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseWrapMethod(props.get(101, 5));\n\t\t\t\t\t\t\tdebugString += \" | DiffuseWrapMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 54: //LightMapDiffuseMethod\n\t\t\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\t\t\t\tvar thisTex:TextureBase=undefined;\n\t\t\t\t\t\t\tif (targetID>0) {\n\t\t\t\t\t\t\t\tthisTex = <TextureBase>this.awd_file_data.getAssetByID(targetID);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(thisTex==undefined){\n\t\t\t\t\t\t\t\tthisTex=DefaultMaterialManager.getDefaultTexture();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//if (!returnedArray[0])\n\t\t\t\t\t\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find the LightMap (ID = \" + targetID + \" ) for this.awd_file_data LightMapDiffuseMethod\");\n\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseLightMapMethod(<Single2DTexture>thisTex, this.awd_file_data.getBlendModeStringFromEnum(props.get(401, 10)), false, mat.diffuseMethod);\n\t\t\t\t\t\t\tdebugString += \" | DiffuseLightMapMethod | LightMapTexture-Name =\" + (<Single2DTexture> thisTex).name;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 55: //CelDiffuseMethod\n\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseCelMethod(props.get(401, 3), mat.diffuseMethod);\n\t\t\t\t\t\t\t(<DiffuseCelMethod> mat.diffuseMethod).smoothness = props.get(101, 0.1);\n\t\t\t\t\t\t\tdebugString += \" | DiffuseCelMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 56: //SubSurfaceScatteringMethod\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseSubSurfaceMethod(); //depthMapSize and depthMapOffset ?\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\t(<DiffuseSubSurfaceMethod> mat.diffuseMethod).scattering = props.get(101, 0.2);\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\t(<DiffuseSubSurfaceMethod> mat.diffuseMethod).translucency = props.get(102, 1);\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\t(<DiffuseSubSurfaceMethod> mat.diffuseMethod).scatterColor = props.get(601, 0xffffff);\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\tdebugString += \" | DiffuseSubSurfaceMethod\";\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 101: //AnisotropicSpecularMethod\n\t\t\t\t\t\t\tmat.specularMethod = new SpecularAnisotropicMethod();\n\t\t\t\t\t\t\tdebugString += \" | SpecularAnisotropicMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 102: //SpecularPhongMethod\n\t\t\t\t\t\t\tmat.specularMethod = new SpecularPhongMethod();\n\t\t\t\t\t\t\tdebugString += \" | SpecularPhongMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 103: //CellSpecularMethod\n\t\t\t\t\t\t\tmat.specularMethod = new SpecularCelMethod(props.get(101, 0.5), mat.specularMethod);\n\t\t\t\t\t\t\t(<SpecularCelMethod> mat.specularMethod).smoothness = props.get(102, 0.1);\n\t\t\t\t\t\t\tdebugString += \" | SpecularCelMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 104: //SpecularFresnelMethod\n\t\t\t\t\t\t\tmat.specularMethod = new SpecularFresnelMethod(props.get(701, true), mat.specularMethod);\n\t\t\t\t\t\t\t(<SpecularFresnelMethod> mat.specularMethod).fresnelPower = props.get(101, 5);\n\t\t\t\t\t\t\t(<SpecularFresnelMethod> mat.specularMethod).normalReflectance = props.get(102, 0.1);\n\t\t\t\t\t\t\tdebugString += \" | SpecularFresnelMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 151://HeightMapNormalMethod - thios is not implemented for now, but might appear later\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 152: //SimpleWaterNormalMethod\n\t\t\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\t\t\t\tvar thisTex:TextureBase=undefined;\n\t\t\t\t\t\t\tif (targetID>0) {\n\t\t\t\t\t\t\t\tthisTex = <TextureBase>this.awd_file_data.getAssetByID(targetID);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(thisTex==undefined){\n\t\t\t\t\t\t\t\tthisTex=DefaultMaterialManager.getDefaultTexture();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//if (!returnedArray[0])\n\t\t\t\t\t\t\t//\tthis.awd_file_data._blocks[blockID].addError(\"Could not find the SecoundNormalMap (ID = \" + targetID + \" ) for this.awd_file_data SimpleWaterNormalMethod\");\n\t\t\t\t\t\t\t//if (!mat.normalMap)\n\t\t\t\t\t\t\t//\tthis.awd_file_data._blocks[blockID].addError(\"Could not find a normal Map on this.awd_file_data Material to use with this.awd_file_data SimpleWaterNormalMethod\");\n\t\t\t\t\t\t\tmat.normalMethod = new NormalSimpleWaterMethod(<Single2DTexture> mat.normalMethod.texture || thisTex, <Single2DTexture>thisTex);\n\t\t\t\t\t\t\tdebugString += \" | NormalSimpleWaterMethod | Second-NormalTexture-Name = \" + (<Single2DTexture> thisTex).name;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tthis.awd_file_data.parseUserAttributes();\n\t\t\t\t\tmethods_parsed += 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// todo: we should not need this.awd_file_data anymore (if using texture-atlas)\n\t\telse if ((type>=3)&&(type<=7)){\n\t\t\t// if this.awd_file_data is a curve material, we create it, finalize it, assign it to block-cache and return and return.\n\t\t\tvar color:number = props.get(1, 0xcccccc);\n\t\t\tdebugString+=color;\n\t\t\n\t\t\tvar diffuseTex_addr:number = props.get(2, 0);\n\t\t\n\t\t\tvar diffuseTexture:TextureBase=undefined;\n\t\t\tif (diffuseTex_addr>0) {\n\t\t\t\tdiffuseTexture = <TextureBase>this.awd_file_data.getAssetByID(diffuseTex_addr);\n\t\t\t}\n\t\t\tif(diffuseTex_addr==undefined){\n\t\t\t\tdiffuseTexture=DefaultMaterialManager.getDefaultTexture();\n\t\t\t}\n\t\t\n\t\t\tvar basic_mat:BasicMaterial = new BasicMaterial();\n\t\t\tbasic_mat.texture = diffuseTexture;\n\n\t\t\t//debugString+= \" alpha = \"+props.get(10, 1.0)+\" \";\n\t\t\tdebugString+= \" texture = \"+diffuseTex_addr+\" \";\n\t\t\tbasic_mat.bothSides = true;\n\t\t\tbasic_mat.preserveAlpha = true;\n\t\t\tbasic_mat.alphaBlending = true;\n\t\t\tbasic_mat.extra = this.awd_file_data.parseUserAttributes();\n\t\t\tif (this.awd_file_data.debug)\n\t\t\t\tconsole.log(debugString);\n\t\t\tthis.awd_file_data.cur_block.data=basic_mat;\n\t\t\treturn;\n\t\t\n\t\t}\n\t\tmat.extra = this.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data=mat;\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(debugString);\n\t\t}\n\t}\n\n}\n\nexport = MaterialAWDParser;",
    "/**\n * Created by 80prozent on 4/18/2015.\n */\n\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\n\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport AWD3Utils\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nclass MeshAWDParser extends AWDBlockParserBase\n{\n\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar num_materials:number;\n\t\tvar materials_parsed:number;\n\t\tif(this.awd_file_data.cur_block.type==23) {\n\t\t\tvar par_id:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tvar mtx:Matrix3D = this.awd_file_data.parseMatrix3D();\n\t\t}\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar parentName:string = \"Root (TopLevel)\";\n\t\tvar data_id:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\tvar geom:Geometry = <Geometry>this.awd_file_data.getAssetByID(data_id)\n\n\t\tif (geom==undefined) {\n\t\t\tgeom = new Geometry();\n\t\t}\n\n\t\tthis.awd_file_data.cur_block.geoID = data_id;\n\t\tvar materials:Array<MaterialBase> = new Array<MaterialBase>();\n\t\tnum_materials = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\n\t\tvar materialNames:Array<string> = new Array<string>();\n\t\tmaterials_parsed = 0;\n\n\n\t\twhile (materials_parsed < num_materials) {\n\t\t\tvar mat_id:number;\n\t\t\tmat_id = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tvar m:MaterialBase = <MaterialBase> this.awd_file_data.getAssetByID(mat_id);\n\t\t\tif(m!=undefined) {\n\t\t\t\tmaterials.push(m);\n\t\t\t\tmaterialNames.push(m.name);\n\t\t\t}\n\t\t\tmaterials_parsed++;\n\t\t}\n\n\t\tvar mesh:Mesh = new Mesh(geom, null);\n\n\t\tif(this.awd_file_data.cur_block.type==23) {\n\n\t\t\tmesh.transform.matrix3D = mtx;\n\t\t\tif(par_id>0) {\n\t\t\t\tvar parent:DisplayObjectContainer = <DisplayObjectContainer>this.awd_file_data.getAssetByID(par_id)\n\n\t\t\t\tif (parent != undefined) {\n\t\t\t\t\tparent.addChild(mesh);\n\t\t\t\t\tparentName = parent.name;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (materials.length >= 1 && mesh.subMeshes.length == 1) {\n\t\t\tmesh.material = materials[0];\n\t\t} else if (materials.length > 1) {\n\t\t\tvar i:number;\n\n\t\t\t// Assign each sub-mesh in the mesh a material from the list. If more sub-meshes\n\t\t\t// than materials, repeat the last material for all remaining sub-meshes.\n\t\t\tfor (i = 0; i < mesh.subMeshes.length; i++) {\n\t\t\t\tmesh.subMeshes[i].material = materials[Math.min(materials.length - 1, i)];\n\t\t\t}\n\t\t}\n\t\tif ((this.awd_file_data.major_version > 2)||((this.awd_file_data.major_version >= 2) && (this.awd_file_data.minor_version == 1))) {\n\t\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:this.awd_file_data.matrixNrType, 2:this.awd_file_data.matrixNrType, 3:this.awd_file_data.matrixNrType, 4:AWD3Utils.UINT8, 5:AWD3Utils.BOOL});\n\t\t\tmesh.pivot = new Vector3D(<number>props.get(1, 0), <number>props.get(2, 0), <number> props.get(3, 0));\n\t\t\tmesh.castsShadows = props.get(5, true);\n\t\t} else {\n\t\t\tthis.awd_file_data.parseProperties(null);\n\t\t}\n\n\t\tmesh.extra = this.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = mesh;\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a Mesh: Name = '\" + name + \"' | Parent-Name = \" + parentName + \"| Geometry-Name = \" + geom.name + \" | SubMeshes = \" + mesh.subMeshes.length + \" | Mat-Names = \" + materialNames.toString());\n\t\t}\n\t}\n\n\n}\n\nexport = MeshAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\n\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nclass MetadataAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tthis.awd_file_data.cur_block.state=AWD3Utils.BLOCKSTATE_NO_ASSET;\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:AWD3Utils.UINT32, 2:AWD3Utils.AWDSTRING, 3:AWD3Utils.AWDSTRING, 4:AWD3Utils.AWDSTRING, 5:AWD3Utils.AWDSTRING});\n\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a MetaDataBlock: TimeStamp         = \" + props.get(1, 0));\n\t\t\tconsole.log(\"                        EncoderName       = \" + props.get(2, \"unknown\"));\n\t\t\tconsole.log(\"                        EncoderVersion    = \" + props.get(3, \"unknown\"));\n\t\t\tconsole.log(\"                        GeneratorName     = \" + props.get(4, \"unknown\"));\n\t\t\tconsole.log(\"                        GeneratorVersion  = \" + props.get(5, \"unknown\"));\n\t\t}\n\t}\n\n\n}\n\nexport = MetadataAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDBitFlags\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags\");\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\n\nimport ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nimport MovieClip \t\t\t\t\t= require(\"awayjs-display/lib/entities/MovieClip\");\nimport Timeline\t\t\t \t\t\t= require(\"awayjs-display/lib/base/Timeline\");\n\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\n\nimport TextField\t\t\t\t\t= require(\"awayjs-display/lib/entities/TextField\");\nimport View\t\t\t= require(\"awayjs-display/lib/containers/View\");\n\nimport AS2SceneGraphFactory \t\t= require(\"awayjs-player/lib/factories/AS2SceneGraphFactory\");\n\nclass MovieClipAWDParser extends AWDBlockParserBase\n{\n\n\tprivate factory:AS2SceneGraphFactory;\n\tconstructor(view:View = null)\n\t{\n\t\tsuper();\n\t\tthis.factory = new AS2SceneGraphFactory(view);\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\n\t\tvar i:number;\n\t\tvar j:number;\n\t\tvar c:number;\n\t\tvar new_timeline:Timeline = new Timeline();\n\t\tvar new_mc = this.factory.createMovieClip(new_timeline)\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar isScene = !!this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\tvar sceneID = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\tvar fps:number = this.awd_file_data.newBlockBytes.readFloat();\n\t\t//console.log(\"fps = \"+fps);\n\t\t//new_mc.fps=fps;\n\t\tvar ms_per_frame = 1000 / fps;\n\t\tvar num_instances:number=0;\n\t\tvar num_all_display_instances:number=0;\n\n\n\t\t// register list of potential childs\n\t\t// a potential child can be reused on a timeline (added / removed / added)\n\t\t// However, for each potential child, we need to register the max-number of instances that a frame contains\n\t\t// we parse 2 lists of potential-childs:\n\t\t// -\tthe first list contains potential-childs that are only ever instanced once per frame.\n\t\t// -\tthe second list contains potential-childs that are instanced multiple times on some frames.\n\n\t\t// on registering a child, the child gets a incremental-id assigned. This is the id, that the commands are using to access the childs.\n\t\t// hence we need to be careful to register all objects in correct order.\n\n\t\tvar num_potential_childs:number = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tfor (i = 0; i < num_potential_childs; i++) {\n\t\t\tresourceID = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tvar cmd_asset:DisplayObject = <DisplayObject>this.awd_file_data.getAssetByID(resourceID);\n\t\t\tif (cmd_asset != null) {\n\t\t\t\tnew_timeline.registerPotentialChild(cmd_asset);\n\t\t\t}\n\t\t\telse{\n\t\t\t\t//todo: register a default display object on timeline, so we do not mess up the incremental obj-id\n\t\t\t\t//new_mc.registerPotentialChild(cmd_asset);\n\t\t\t\tconsole.log(\"ERROR when collecting objects for timeline\");\n\t\t\t}\n\t\t}\n\t\tnum_all_display_instances+=num_potential_childs;\n\t\tvar num_potential_childs_multi_instanced = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tnum_potential_childs+=num_potential_childs_multi_instanced;\n\t\tfor (i = 0; i < num_potential_childs_multi_instanced; i++) {\n\t\t\tresourceID = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tnum_instances = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\tnum_all_display_instances+=num_instances;\n\t\t\tvar cmd_asset:DisplayObject = <DisplayObject>this.awd_file_data.getAssetByID(resourceID);\n\t\t\tif (cmd_asset != null) {\n\t\t\t\tfor (j = 0; j < num_instances; j++) {\n\t\t\t\t\tnew_timeline.registerPotentialChild(cmd_asset);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfor (j = 0; j < num_instances; j++) {\n\t\t\t\t\t//todo: register a default display object on timeline, so we do not mess up the incremental obj-id\n\t\t\t\t\t//new_mc.registerPotentialChild(cmd_asset);\n\t\t\t\t\tconsole.log(\"ERROR when collecting objects for timeline\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//console.log(\"Parsed \"+num_potential_childs+\" potential childs. They will be used by \"+num_all_display_instances+\" instances.\");\n\n\t\t// register list of potential sounds\n\t\t// a potential child can be reused on a timeline (added / removed / added)\n\t\tvar num_potential_sounds = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tfor (i = 0; i < num_potential_sounds; i++) {\n\t\t\tresourceID = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tvar cmd_asset:DisplayObject = <DisplayObject>this.awd_file_data.getAssetByID(resourceID);\n\t\t\tif (cmd_asset != null) {\n\t\t\t\t//todo: register sound objects on movieclip\n\t\t\t\tconsole.log(\"ERROR when collecting objects for timeline\");\n\t\t\t\t//new_mc.registerPotentialChild(cmd_asset);\n\t\t\t}\n\t\t\telse{\n\t\t\t\t//todo: this.awd_file_data is a error that might break complete timeline, because all sound obj-id shift\n\t\t\t}\n\t\t}\n\t\t//console.log(\"Parsed \"+num_potential_sounds+\" potential sounds\");\n\n\t\tvar numFrames = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\n\t\t//console.log(\"numFrames \"+numFrames);\n\n\t\tvar totalDuration:number = 0;\n\t\tvar frameDuration:number;\n\t\tvar numLabels:number;\n\t\tvar numCommands:number;\n\t\tvar objectID:number;\n\t\tvar target_depth:number;\n\t\tvar resourceID:number;\n\t\tvar number_of_obj:number;\n\t\tvar commandType:number;\n\t\t//var frame:TimelineKeyFrame;\n\t\tvar hasDepthChanges:boolean;\n\t\tvar sessionCount:number=0;\n\t\tfor (i = 0; i < numFrames; i++) {\n\t\t\t// todo: remove the ms_per_frame to set the duration in frames\n\t\t\tframeDuration = this.awd_file_data.newBlockBytes.readUnsignedInt()*ms_per_frame;\n\t\t\t//frame = new TimelineKeyFrame(totalDuration, frameDuration);\n\t\t\ttotalDuration += frameDuration;\n\n\t\t\tnumLabels = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\t\t//for (j = 0; j < numLabels; j++)\n\t\t\t//\tnew_timeline._labels[this.awd_file_data.parseVarStr()]=new_timeline.numKeyFrames();\n\n\t\t\tnumCommands = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\t//console.log(\"numCommands \"+numCommands);\n\t\t\t//traceString += \"\\n      Commands \" + numCommands;\n\t\t\thasDepthChanges = false;\n\t\t\tfor (j = 0; j < numCommands; j++) {\n\t\t\t\tcommandType = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\n\t\t\t\t// 1 = remove a number of objects by depth\n\t\t\t\t// 2 = add a object by child-id at specific depth\n\t\t\t\t// 3 = update a object by child-id\n\t\t\t\t// 4 = add / update sound - (not finished)\n\n\t\t\t\tswitch (commandType) {\n\n\t\t\t\t\tcase 1:// remove a number of objects at specific depth\n\t\t\t\t\t\tnumber_of_obj = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\t\t\t\t//console.log(\"number_of_obj \", number_of_obj);\n\t\t\t\t\t\tvar remove_depths:Array<number>=new Array<number>();\n\t\t\t\t\t\tfor (c = 0; c < number_of_obj; c++) {\n\t\t\t\t\t\t\t// Remove Object Command\n\t\t\t\t\t\t\ttarget_depth = this.awd_file_data.newBlockBytes.readShort();\n\t\t\t\t\t\t\tremove_depths.push(target_depth);\n\t\t\t\t\t\t\t//console.log(\"\\n       - Remove object at depth: \" + target_depth);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//frame.frameConstructCommands.push(new RemoveChildrenAtDepthCommand(remove_depths));\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 2:// add a of object by child-id at specific depth\n\t\t\t\t\tcase 3:// update a object by child-id\n\t\t\t\t\t\tobjectID = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\t\t\t\t//console.log(\"add / update objectID \", objectID);\n\t\t\t\t\t\tif (commandType == 2) {\n\t\t\t\t\t\t\thasDepthChanges=true;\n\t\t\t\t\t\t\ttarget_depth = this.awd_file_data.newBlockBytes.readShort();\n\t\t\t\t\t\t\t//console.log(\"target_depth \", target_depth);\n\t\t\t\t\t\t\tvar potChild = new_timeline.getPotentialChildPrototype(objectID);\n\t\t\t\t\t\t\tif (potChild != undefined) {\n\t\t\t\t\t\t\t\t//frame.frameConstructCommands.push(new AddChildAtDepthCommand(objectID, target_depth, sessionCount));\n\t\t\t\t\t\t\t\tsessionCount++;\n\t\t\t\t\t\t\t\t// if the object is a tetfield, we set the textfield-name as instancename\n\t\t\t\t\t\t\t\tif(potChild.isAsset(TextField)) {\n\t\t\t\t\t\t\t\t\t//frame.frameConstructCommands.push(new SetInstanceNameCommand(objectID, potChild.name));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tconsole.log(\"ERROR: could not find the objectID \", objectID);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar props_flag = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\t\t\t\t/*\tProps_flags\n\t\t\t\t\t\t 1: read display matrix - 6 x float,\n\t\t\t\t\t\t 2: read display matrix - read another UINT8-bitflag that determinates what matrix components to parse\n\t\t\t\t\t\t 3: read color matrix - 4 x float, 4 x uint16\n\t\t\t\t\t\t 4: read color matrix - read another UINT8-bitflag that determinates what matrix components to parse\n\t\t\t\t\t\t 5: blendmode - uint8\n\t\t\t\t\t\t 6: visible - boolean\n\t\t\t\t\t\t 7: AWD3Parser.UINT8\n\t\t\t\t\t\t });*/\n\t\t\t\t\t\t// read display matrix\n\t\t\t\t\t\tif (AWDBitFlags.test(props_flag, AWDBitFlags.FLAG1)) {\n\t\t\t\t\t\t\tvar thisMatrix = new Matrix3D();\n\t\t\t\t\t\t\tif (AWDBitFlags.test(props_flag, AWDBitFlags.FLAG2)) {\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tthisMatrix.rawData[0] = this.awd_file_data.newBlockBytes.readFloat();\n\t\t\t\t\t\t\t\tthisMatrix.rawData[1] = this.awd_file_data.newBlockBytes.readFloat();\n\t\t\t\t\t\t\t\tthisMatrix.rawData[4] = this.awd_file_data.newBlockBytes.readFloat();\n\t\t\t\t\t\t\t\tthisMatrix.rawData[5] = this.awd_file_data.newBlockBytes.readFloat();\n\t\t\t\t\t\t\t\tthisMatrix.position = new Vector3D(this.awd_file_data.newBlockBytes.readFloat(), this.awd_file_data.newBlockBytes.readFloat(), 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//frame.frameConstructCommands.push(new UpdatePropertyCommand(objectID, \"_iMatrix3D\", thisMatrix));\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// read colortransforms\n\t\t\t\t\t\tif (AWDBitFlags.test(props_flag, AWDBitFlags.FLAG3)) {\n\t\t\t\t\t\t\tvar thisColorTransform = new ColorTransform();\n\t\t\t\t\t\t\tif (AWDBitFlags.test(props_flag, AWDBitFlags.FLAG4)) {\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tthisColorTransform.redMultiplier = this.awd_file_data.newBlockBytes.readFloat();\n\t\t\t\t\t\t\t\tthisColorTransform.greenMultiplier = this.awd_file_data.newBlockBytes.readFloat();\n\t\t\t\t\t\t\t\tthisColorTransform.blueMultiplier = this.awd_file_data.newBlockBytes.readFloat();\n\t\t\t\t\t\t\t\tthisColorTransform.alphaMultiplier = this.awd_file_data.newBlockBytes.readFloat();\n\t\t\t\t\t\t\t\tthisColorTransform.redOffset = this.awd_file_data.newBlockBytes.readShort();\n\t\t\t\t\t\t\t\tthisColorTransform.greenOffset = this.awd_file_data.newBlockBytes.readShort();\n\t\t\t\t\t\t\t\tthisColorTransform.blueOffset = this.awd_file_data.newBlockBytes.readShort();\n\t\t\t\t\t\t\t\tthisColorTransform.alphaOffset = this.awd_file_data.newBlockBytes.readShort();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (AWDBitFlags.test(props_flag, AWDBitFlags.FLAG5)) {\n\t\t\t\t\t\t\tvar blendmode_int = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\t\t\t\t\t\tvar blendmode_string = this.awd_file_data.getBlendModeStringFromEnum(blendmode_int);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (AWDBitFlags.test(props_flag, AWDBitFlags.FLAG6)) {\n\t\t\t\t\t\t\t//frame.frameConstructCommands.push(new UpdatePropertyCommand(objectID, \"visible\", this.awd_file_data.newBlockBytes.readByte()));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (AWDBitFlags.test(props_flag, AWDBitFlags.FLAG7)) {\n\t\t\t\t\t\t\tvar instanceName = this.awd_file_data.parseVarStr();\n\t\t\t\t\t\t\tif (instanceName.length) {\n\t\t\t\t\t\t\t\t//frame.frameConstructCommands.push(new SetInstanceNameCommand(objectID, instanceName));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (AWDBitFlags.test(props_flag, AWDBitFlags.FLAG8)) {\n\t\t\t\t\t\t\tvar mask_id_nums = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\t\t\t\t\tvar mask_ids = new Array();\n\t\t\t\t\t\t\tfor (var mi_cnt = 0; mi_cnt < mask_id_nums; mi_cnt++) {\n\t\t\t\t\t\t\t\tmask_ids.push(this.awd_file_data.newBlockBytes.readShort());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (mask_ids.length > 0) {\n\t\t\t\t\t\t\t\tif ((mask_ids.length == 1) && (mask_ids[0] == -1)) {\n\t\t\t\t\t\t\t\t\t// TODO: this.awd_file_data object is used as mask\n\t\t\t\t\t\t\t\t\t//frame.frameConstructCommands.push(new UpdatePropertyCommand(objectID, \"_iMaskID\", objectID));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//else\n\t\t\t\t\t\t\t\t//\tframe.frameConstructCommands.push(new SetMaskCommand(objectID, mask_ids));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 4:\n\n\t\t\t\t\t\t// Add Sound Command\n\t\t\t\t\t\t// TODO: create CommandPropsSound and check which asset to use\n\t\t\t\t\t\tobjectID = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\t\t\tresourceID = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\t\t\t// TODO: implement sound in timeline\n\t\t\t\t\t\t//commandString += \"\\n      - Add new Sound AWD-ID = \" + resourceID.toString() + \" as object_id = \" + objectID.toString();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t//commandString += \"\\n       - Unknown Command Type = \" + commandType;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (hasDepthChanges) {\n\t\t\t\t// only want to do this.awd_file_data once after all children's depth values are updated\n\t\t\t\t//frame.frameConstructCommands.push(new ApplyAS2DepthsCommand());\n\t\t\t\thasDepthChanges = false;\n\t\t\t}\n\n\t\t\tvar length_code = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tif (length_code > 0) {\n\t\t\t\t// TODO: Script should probably not be attached to keyframes?\n\t\t\t\t//var frame_code = this.awd_file_data.newBlockBytes.readUTFBytes(length_code);\n\t\t\t\t//frame.framePostConstructCommands.push(new ExecuteScriptCommand(frame_code));\n\t\t\t\t//traceString += \"\\nframe-code = \" + frame_code;\n\t\t\t}\n\t\t\t//traceString += commandString;\n\t\t\t//trace(\"length_code = \"+length_code+\" frame_code = \"+frame_code);\n\t\t\tthis.awd_file_data.newBlockBytes.readUnsignedInt();// user attributes - skip for now\n\t\t\t//console.log(traceString);\n\t\t\t//new_timeline.addFrame(frame);\n\n\t\t}\n\t\tthis.awd_file_data.parseProperties(null);\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = new_mc;\n\t\tif (this.awd_file_data.debug)\n\t\t\tconsole.log(\"Parsed a TIMELINE: Name = \" + name + \"| isScene = \" + isScene + \"| sceneID = \" + sceneID + \"| numFrames = \" + numFrames);\n\t}\n\n\n}\n\nexport = MovieClipAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport PrefabBase\t\t\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrefabBase\");\nimport PrimitiveCapsulePrefab\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab\");\nimport PrimitiveConePrefab\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveConePrefab\");\nimport PrimitiveCubePrefab\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveCubePrefab\");\nimport PrimitiveCylinderPrefab\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab\");\nimport PrimitivePlanePrefab\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitivePlanePrefab\");\nimport PrimitiveSpherePrefab\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveSpherePrefab\");\nimport PrimitiveTorusPrefab\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveTorusPrefab\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nclass PrefabAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar name:string;\n\t\tvar prefab:PrefabBase;\n\t\tvar primType:number;\n\t\tvar subs_parsed:number;\n\t\tvar props:AWDProperties;\n\t\tvar bsm:Matrix3D;\n\n\t\t// Read name and sub count\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tprimType = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\tprops = this.awd_file_data.parseProperties({101:this.awd_file_data.geoNrType, 102:this.awd_file_data.geoNrType, 103:this.awd_file_data.geoNrType, 110:this.awd_file_data.geoNrType, 111:this.awd_file_data.geoNrType, 301:AWD3Utils.UINT16, 302:AWD3Utils.UINT16, 303:AWD3Utils.UINT16, 701:AWD3Utils.BOOL, 702:AWD3Utils.BOOL, 703:AWD3Utils.BOOL, 704:AWD3Utils.BOOL});\n\n\t\tvar primitiveTypes:Array<string> = [\"Unsupported Type-ID\", \"PrimitivePlanePrefab\", \"PrimitiveCubePrefab\", \"PrimitiveSpherePrefab\", \"PrimitiveCylinderPrefab\", \"PrimitivesConePrefab\", \"PrimitivesCapsulePrefab\", \"PrimitivesTorusPrefab\"]\n\n\t\tswitch (primType) {\n\t\t\t// to do, not all properties are set on all primitives\n\n\t\t\tcase 1:\n\t\t\t\tprefab = new PrimitivePlanePrefab(props.get(101, 100), props.get(102, 100), props.get(301, 1), props.get(302, 1), props.get(701, true), props.get(702, false));\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\tprefab = new PrimitiveCubePrefab(props.get(101, 100), props.get(102, 100), props.get(103, 100), props.get(301, 1), props.get(302, 1), props.get(303, 1), props.get(701, true));\n\t\t\t\tbreak;\n\n\t\t\tcase 3:\n\t\t\t\tprefab = new PrimitiveSpherePrefab(props.get(101, 50), props.get(301, 16), props.get(302, 12), props.get(701, true));\n\t\t\t\tbreak;\n\n\t\t\tcase 4:\n\t\t\t\tprefab = new PrimitiveCylinderPrefab(props.get(101, 50), props.get(102, 50), props.get(103, 100), props.get(301, 16), props.get(302, 1), true, true, true); // bool701, bool702, bool703, bool704);\n\t\t\t\tif (!props.get(701, true))\n\t\t\t\t\t(<PrimitiveCylinderPrefab>prefab).topClosed = false;\n\t\t\t\tif (!props.get(702, true))\n\t\t\t\t\t(<PrimitiveCylinderPrefab>prefab).bottomClosed = false;\n\t\t\t\tif (!props.get(703, true))\n\t\t\t\t\t(<PrimitiveCylinderPrefab>prefab).yUp = false;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 5:\n\t\t\t\tprefab = new PrimitiveConePrefab(props.get(101, 50), props.get(102, 100), props.get(301, 16), props.get(302, 1), props.get(701, true), props.get(702, true));\n\t\t\t\tbreak;\n\n\t\t\tcase 6:\n\t\t\t\tprefab = new PrimitiveCapsulePrefab(props.get(101, 50), props.get(102, 100), props.get(301, 16), props.get(302, 15), props.get(701, true));\n\t\t\t\tbreak;\n\n\t\t\tcase 7:\n\t\t\t\tprefab = new PrimitiveTorusPrefab(props.get(101, 50), props.get(102, 50), props.get(301, 16), props.get(302, 8), props.get(701, true));\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tprefab = new PrefabBase();\n\t\t\t\tconsole.log(\"ERROR: UNSUPPORTED PREFAB_TYPE\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif ((props.get(110, 1) != 1) || (props.get(111, 1) != 1)) {\n\t\t\t//geom.subGeometries;\n\t\t\t//geom.scaleUV(props.get(110, 1), props.get(111, 1)); //TODO add back scaling to prefabs\n\t\t}\n\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = prefab;\n\n\t\tif (this.awd_file_data.debug) {\n\t\t\tif ((primType < 0) || (primType > 7)) {\n\t\t\t\tprimType = 0;\n\t\t\t}\n\t\t\tconsole.log(\"Parsed a Primivite: Name = \" + this.awd_file_data.cur_block.name + \"| type = \" + primitiveTypes[primType]);\n\t\t}\n\t}\n\n\n}\n\nexport = PrefabAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport LightBase\t\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport DirectionalLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport PointLight\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\n\nimport ShadowMapMethodBase\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowMapMethodBase\");\nimport ShadowMethodBase\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowMethodBase\");\nimport ShadowDitheredMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowDitheredMethod\");\nimport ShadowFilteredMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowFilteredMethod\");\nimport ShadowHardMethod\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowHardMethod\");\nimport ShadowNearMethod\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowNearMethod\");\nimport ShadowSoftMethod\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowSoftMethod\");\n\nclass ShadowMethodAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar type:number;\n\t\tvar data_len:number;\n\t\tvar asset:ShadowMethodBase;\n\t\tvar shadowLightID:number;\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\n\t\tshadowLightID = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\tvar light:LightBase=<LightBase> this.awd_file_data.getAssetByID(shadowLightID);\n\n\t\tif (light==undefined) {\n\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find the TargetLight (ID = \" + shadowLightID + \" ) for this.awd_file_data ShadowMethod - ShadowMethod not created\");\n\t\t\treturn;\n\t\t}\n\n\t\tasset = this.parseShadowMethodList(light);\n\n\t\tif (!asset)\n\t\t\treturn;\n\t\tthis.awd_file_data.parseUserAttributes(); // Ignore for now\n\t\tthis.awd_file_data.cur_block.data = asset;\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a ShadowMapMethodMethod: Name = \" + asset.name + \" | Type = \" + asset + \" | Light-Name = \", light.name);\n\t\t}\n\t}\n\n\n\t// this.awd_file_data functions reads and creates a ShadowMethodMethod\n\tprivate parseShadowMethodList(light:LightBase):ShadowMethodBase\n\t{\n\n\t\tvar methodType:number = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tvar shadowMethod:ShadowMethodBase;\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:AWD3Utils.BADDR, 2:AWD3Utils.BADDR, 3:AWD3Utils.BADDR, 101:this.awd_file_data.propsNrType, 102:this.awd_file_data.propsNrType, 103:this.awd_file_data.propsNrType, 201:AWD3Utils.UINT32, 202:AWD3Utils.UINT32, 301:AWD3Utils.UINT16, 302:AWD3Utils.UINT16, 401:AWD3Utils.UINT8, 402:AWD3Utils.UINT8, 601:AWD3Utils.COLOR, 602:AWD3Utils.COLOR, 701:AWD3Utils.BOOL, 702:AWD3Utils.BOOL, 801:AWD3Utils.MTX4x4});\n\n\t\tvar targetID:number;\n\t\tvar returnedArray:Array<any>\n\t\tswitch (methodType) {\n\t\t\t//\t\t\t\tcase 1001: //CascadeShadowMapMethod\n\t\t\t//\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t//\t\t\t\t\treturnedArray = getAssetByID(targetID, [ShadowMapMethodBase.assetType]);\n\t\t\t//\t\t\t\t\tif (!returnedArray[0]) {\n\t\t\t//\t\t\t\t\t\t_blocks[blockID].addError(\"Could not find the ShadowBaseMethod (ID = \" + targetID + \" ) for this.awd_file_data CascadeShadowMapMethod - ShadowMethod not created\");\n\t\t\t//\t\t\t\t\t\treturn shadowMethod;\n\t\t\t//\t\t\t\t\t}\n\t\t\t//\t\t\t\t\tshadowMethod = new CascadeShadowMapMethod(returnedArray[1]);\n\t\t\t//\t\t\t\t\tbreak;\n\t\t\tcase 1002: //ShadowNearMethod\n\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\tvar shadow_meth:ShadowMapMethodBase = <ShadowMapMethodBase>this.awd_file_data.getAssetByID(targetID);\n\t\t\t\tif (shadow_meth==undefined) {\n\t\t\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find the ShadowBaseMethod (ID = \" + targetID + \" ) for this.awd_file_data ShadowNearMethod - ShadowMethod not created\");\n\t\t\t\t\treturn shadowMethod;\n\t\t\t\t}\n\t\t\t\tshadowMethod = new ShadowNearMethod(<ShadowMethodBase> shadow_meth);\n\t\t\t\tbreak;\n\t\t\tcase 1101: //ShadowFilteredMethod\n\n\t\t\t\tshadowMethod = new ShadowFilteredMethod(<DirectionalLight> light);\n\t\t\t\t(<ShadowFilteredMethod> shadowMethod).alpha = props.get(101, 1);\n\t\t\t\t(<ShadowFilteredMethod> shadowMethod).epsilon = props.get(102, 0.002);\n\t\t\t\tbreak;\n\n\t\t\tcase 1102: //ShadowDitheredMethod\n\n\n\t\t\t\tshadowMethod = new ShadowDitheredMethod(<DirectionalLight> light, <number> props.get(201, 5));\n\t\t\t\t(<ShadowDitheredMethod> shadowMethod).alpha = props.get(101, 1);\n\t\t\t\t(<ShadowDitheredMethod> shadowMethod).epsilon = props.get(102, 0.002);\n\t\t\t\t(<ShadowDitheredMethod> shadowMethod).range = props.get(103, 1);\n\n\t\t\t\tbreak;\n\t\t\tcase 1103: //ShadowSoftMethod\n\n\t\t\t\tshadowMethod = new ShadowSoftMethod(<DirectionalLight> light, <number> props.get(201, 5));\n\t\t\t\t(<ShadowSoftMethod> shadowMethod).alpha = props.get(101, 1);\n\t\t\t\t(<ShadowSoftMethod> shadowMethod).epsilon = props.get(102, 0.002);\n\t\t\t\t(<ShadowSoftMethod> shadowMethod).range = props.get(103, 1);\n\n\t\t\t\tbreak;\n\t\t\tcase 1104: //ShadowHardMethod\n\t\t\t\tshadowMethod = new ShadowHardMethod(light);\n\t\t\t\t(<ShadowHardMethod> shadowMethod).alpha = props.get(101, 1);\n\t\t\t\t(<ShadowHardMethod> shadowMethod).epsilon = props.get(102, 0.002);\n\t\t\t\tbreak;\n\n\t\t}\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\treturn shadowMethod;\n\t}\n}\n\nexport = ShadowMethodAWDParser;",
    "import EventDispatcher\t\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\n\nimport TextureBase\t\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\nimport SingleCubeTexture\t\t\t\t= require(\"awayjs-display/lib/textures/SingleCubeTexture\");\nimport AWDBlockParserBase\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport EffectMethodBase\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectMethodBase\");\nimport EffectColorMatrixMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod\");\nimport EffectColorTransformMethod\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectColorTransformMethod\");\nimport EffectEnvMapMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectEnvMapMethod\");\nimport EffectAlphaMaskMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectAlphaMaskMethod\");\nimport EffectFogMethod\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectFogMethod\");\nimport EffectFresnelEnvMapMethod\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectFresnelEnvMapMethod\");\nimport EffectLightMapMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectLightMapMethod\");\nimport EffectRimLightMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectRimLightMethod\");\n\nclass SharedMethodAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\n\t\tvar asset:EffectMethodBase;\n\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tasset = this.parseSharedMethodList();\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = asset;\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a EffectMethod: Name = \" + asset.name + \" Type = \" + asset);\n\t\t}\n\t}\n\n\t// this.awd_file_data functions reads and creates a EffectMethod\n\tprivate parseSharedMethodList():EffectMethodBase\n\t{\n\n\t\tvar methodType:number = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tvar effectMethodReturn:EffectMethodBase;\n\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:AWD3Utils.BADDR, 2:AWD3Utils.BADDR, 3:AWD3Utils.BADDR, 101:this.awd_file_data.propsNrType, 102:this.awd_file_data.propsNrType, 103:this.awd_file_data.propsNrType, 104:this.awd_file_data.propsNrType, 105:this.awd_file_data.propsNrType, 106:this.awd_file_data.propsNrType, 107:this.awd_file_data.propsNrType, 201:AWD3Utils.UINT32, 202:AWD3Utils.UINT32, 301:AWD3Utils.UINT16, 302:AWD3Utils.UINT16, 401:AWD3Utils.UINT8, 402:AWD3Utils.UINT8, 601:AWD3Utils.COLOR, 602:AWD3Utils.COLOR, 701:AWD3Utils.BOOL, 702:AWD3Utils.BOOL});\n\t\tvar targetID:number;\n\t\tvar returnedArray:Array<any>;\n\n\t\tswitch (methodType) {\n\t\t\t// Effect Methods\n\t\t\tcase 401: //ColorMatrix\n\t\t\t\teffectMethodReturn = new EffectColorMatrixMethod(props.get(101, new Array(0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)));\n\t\t\t\tbreak;\n\t\t\tcase 402: //ColorTransform\n\t\t\t\teffectMethodReturn = new EffectColorTransformMethod();\n\t\t\t\tvar offCol:number /*uint*/ = props.get(601, 0x00000000);\n\t\t\t\t(<EffectColorTransformMethod> effectMethodReturn).colorTransform = new ColorTransform(props.get(102, 1), props.get(103, 1), props.get(104, 1), props.get(101, 1), ((offCol >> 16) & 0xFF), ((offCol >> 8) & 0xFF), (offCol & 0xFF), ((offCol >> 24) & 0xFF));\n\t\t\t\tbreak;\n\t\t\tcase 403: //EnvMap\n\n\t\t\t\t/*\n\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\tconsole.log('ENV MAP', targetID);\n\n\n\t\t\t\treturnedArray = this.awd_file_data.getAssetByID(targetID, [ TextureBase.assetType ], \"CubeTexture\");\n\t\t\t\t//if (!returnedArray[0])\n\t\t\t\t//\tthis.awd_file_data._blocks[blockID].addError(\"Could not find the EnvMap (ID = \" + targetID + \" ) for this.awd_file_data EnvMapMethod\");\n\t\t\t\teffectMethodReturn = new EffectEnvMapMethod(<SingleCubeTexture> returnedArray[1], <number> props.get(101, 1));\n\t\t\t\ttargetID = props.get(2, 0);\n\t\t\t\tif (targetID > 0) {\n\t\t\t\t\treturnedArray = this.awd_file_data.getAssetByID(targetID, [TextureBase.assetType]);\n\t\t\t\t\t//if (!returnedArray[0])\n\t\t\t\t\t//\tthis.awd_file_data._blocks[blockID].addError(\"Could not find the Mask-texture (ID = \" + targetID + \" ) for this.awd_file_data EnvMapMethod\");\n\n\t\t\t\t\t// Todo: test mask with EnvMapMethod\n\t\t\t\t\t//(<EnvMapMethod> effectMethodReturn).mask = <Texture2DBase> returnedArray[1];\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tbreak;\n\t\t\tcase 404: //LightMapMethod\n\t\t\t\t/*\n\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\treturnedArray = this.awd_file_data.getAssetByID(targetID, [TextureBase.assetType]);\n\t\t\t\t//if (!returnedArray[0])\n\t\t\t\t//\tthis.awd_file_data._blocks[blockID].addError(\"Could not find the LightMap (ID = \" + targetID + \" ) for this.awd_file_data LightMapMethod\");\n\t\t\t\teffectMethodReturn = new EffectLightMapMethod(returnedArray[1], this.awd_file_data.getBlendModeStringFromEnum(props.get(401, 10))); //usesecondaryUV not set\n\t\t\t\t*/\n\t\t\t\tbreak;\n\t\t\t//\t\t\t\tcase 405: //ProjectiveTextureMethod\n\t\t\t//\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t//\t\t\t\t\treturnedArray = getAssetByID(targetID, [TextureProjector.assetType]);\n\t\t\t//\t\t\t\t\tif (!returnedArray[0])\n\t\t\t//\t\t\t\t\t\t_blocks[blockID].addError(\"Could not find the TextureProjector (ID = \" + targetID + \" ) for this.awd_file_data ProjectiveTextureMethod\");\n\t\t\t//\t\t\t\t\teffectMethodReturn = new ProjectiveTextureMethod(returnedArray[1], blendModeDic[props.get(401, 10)]);\n\t\t\t//\t\t\t\t\tbreak;\n\t\t\tcase 406: //RimLightMethod\n\t\t\t\teffectMethodReturn = new EffectRimLightMethod(props.get(601, 0xffffff), props.get(101, 0.4), props.get(101, 2)); //blendMode\n\t\t\t\tbreak;\n\t\t\tcase 407: //AlphaMaskMethod\n\t\t\t\t/*\n\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\treturnedArray = this.awd_file_data.getAssetByID(targetID, [TextureBase.assetType]);\n\t\t\t\t//if (!returnedArray[0])\n\t\t\t\t//\tthis.awd_file_data._blocks[blockID].addError(\"Could not find the Alpha-texture (ID = \" + targetID + \" ) for this.awd_file_data AlphaMaskMethod\");\n\t\t\t\teffectMethodReturn = new EffectAlphaMaskMethod(returnedArray[1], props.get(701, false));\n\t\t\t\t*/\n\t\t\t\tbreak;\n\t\t\t//\t\t\t\tcase 408: //RefractionEnvMapMethod\n\t\t\t//\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t//\t\t\t\t\treturnedArray = getAssetByID(targetID, [TextureBase.assetType], \"CubeTexture\");\n\t\t\t//\t\t\t\t\tif (!returnedArray[0])\n\t\t\t//\t\t\t\t\t\t_blocks[blockID].addError(\"Could not find the EnvMap (ID = \" + targetID + \" ) for this.awd_file_data RefractionEnvMapMethod\");\n\t\t\t//\t\t\t\t\teffectMethodReturn = new RefractionEnvMapMethod(returnedArray[1], props.get(101, 0.1), props.get(102, 0.01), props.get(103, 0.01), props.get(104, 0.01));\n\t\t\t//\t\t\t\t\tRefractionEnvMapMethod(effectMethodReturn).alpha = props.get(104, 1);\n\t\t\t//\t\t\t\t\tbreak;\n\t\t\t//\t\t\t\tcase 409: //OutlineMethod\n\t\t\t//\t\t\t\t\teffectMethodReturn = new OutlineMethod(props.get(601, 0x00000000), props.get(101, 1), props.get(701, true), props.get(702, false));\n\t\t\t//\t\t\t\t\tbreak;\n\t\t\tcase 410: //FresnelEnvMapMethod\n\t\t\t\t/*\n\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t\treturnedArray = this.awd_file_data.getAssetByID(targetID, [TextureBase.assetType], \"CubeTexture\");\n\t\t\t\t//if (!returnedArray[0])\n\t\t\t\t//\tthis.awd_file_data._blocks[blockID].addError(\"Could not find the EnvMap (ID = \" + targetID + \" ) for this.awd_file_data FresnelEnvMapMethod\");\n\t\t\t\teffectMethodReturn = new EffectFresnelEnvMapMethod(returnedArray[1], props.get(101, 1));\n\t\t\t\t*/\n\t\t\t\tbreak;\n\t\t\tcase 411: //FogMethod\n\t\t\t\teffectMethodReturn = new EffectFogMethod(props.get(101, 0), props.get(102, 1000), props.get(601, 0x808080));\n\t\t\t\tbreak;\n\n\t\t}\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\treturn effectMethodReturn;\n\n\t}\n\n}\n\nexport = SharedMethodAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport Single2DTexture\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\n\nclass Single2DTextureAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\n\t\tvar asset:Single2DTexture;\n\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\n\t\tvar type:number = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\tvar data_len:number;\n\n\t\t//this.awd_file_data._texture_users[this.awd_file_data._cur_block_id.toString()] = [];\n\n\t\t// External\n\t\tif (type == 0) {\n\t\t\tdata_len = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tvar url:string;\n\t\t\turl = this.awd_file_data.newBlockBytes.readUTFBytes(data_len);\n\t\t\tthis.awd_file_data.cur_block.dependencies_urls.push(url);\n\n\t\t} else {\n\t\t\tdata_len = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\n\t\t\tvar data:ByteArray;\n\t\t\tdata = new ByteArray();\n\t\t\tthis.awd_file_data.newBlockBytes.readBytes(data, 0, data_len);\n\t\t\tthis.awd_file_data.cur_block.dependencies_data.push(data);\n\n\t\t\t//\n\t\t\t// AWD3Parserutils - Fix for FireFox Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=715075 .\n\t\t\t//\n\t\t\t// Converting data to image here instead of parser - fix FireFox bug where image width / height is 0 when created from data\n\t\t\t// This gives the browser time to initialise image width / height.\n\n\t\t\t//this.awd_file_data._pAddDependency(this.awd_file_data._cur_block_id.toString(), null, false, data, true);\n\n\t\t}\n\t\tthis.awd_file_data.cur_block.state=AWD3Utils.BLOCKSTATE_LOAD_DEPENDENICES;\n\t\t// Ignore for now\n\t\tthis.awd_file_data.parseProperties(null);\n\t\tthis.awd_file_data.parseUserAttributes();\n\n\t\tif (this.awd_file_data.debug) {\n\t\t\tvar textureStylesNames:Array<string> = [\"external\", \"embed\"]\n\t\t\tconsole.log(\"Start parsing a \" + textureStylesNames[type] + \" Bitmap for Texture\");\n\t\t}\n\t}\n\n\n}\n\nexport = Single2DTextureAWDParser;",
    "import EventDispatcher\t\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport URLRequest\t\t\t\t\t\t= require(\"awayjs-core/lib/net/URLRequest\");\nimport ParserUtils\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserUtils\");\n\nimport SingleCubeTexture\t\t\t\t= require(\"awayjs-display/lib/textures/SingleCubeTexture\");\n\nimport AWDBlockParserBase\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\n\nclass SingleCubeTextureAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar data_len:number;\n\t\tvar i:number;\n\n\t\t//this.awd_file_data._cubeTextures = new Array<any>();\n\t\t//this.awd_file_data._texture_users[ this.awd_file_data._cur_block_id.toString() ] = [];\n\n\t\tvar type:number = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\n\t\t//this.awd_file_data._blocks[blockID].name =\n\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\n\t\tfor (i = 0; i < 6; i++) {\n\t\t\t//this.awd_file_data.texture_users[this.awd_file_data.cur_block_id.toString()] = [];\n\t\t\t//this.awd_file_data.cubeTextures.push(null);\n\n\t\t\t// External\n\t\t\tif (type == 0) {\n\t\t\t\tdata_len = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\tvar url:string;\n\t\t\t\turl = this.awd_file_data.newBlockBytes.readUTFBytes(data_len);\n\n\t\t\t\tthis.awd_file_data.cur_block.dependencies_urls.push(url);\n\t\t\t\t//this.awd_file_data._pAddDependency(this.awd_file_data.cur_block_id.toString() + \"#\" + i, new URLRequest(url), false, null, true);\n\t\t\t} else {\n\n\t\t\t\tdata_len = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\tvar data:ByteArray;\n\t\t\t\tdata = new ByteArray();\n\n\t\t\t\tthis.awd_file_data.newBlockBytes.readBytes(data, 0, data_len);\n\n\t\t\t\tthis.awd_file_data.cur_block.dependencies_data.push(data);\n\t\t\t\t//this.awd_file_data._pAddDependency(this.awd_file_data.cur_block_id.toString() + \"#\" + i, null, false, ParserUtils.byteArrayToImage(data), true);\n\t\t\t}\n\t\t}\n\t\tthis.awd_file_data.cur_block.state=AWD3Utils.BLOCKSTATE_LOAD_DEPENDENICES;\n\t\t// Ignore for now\n\t\tthis.awd_file_data.parseProperties(null);\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\t//this.awd_file_data._pPauseAndRetrieveDependencies();\n\t\t//this.awd_file_data._blocks[blockID].data = asset;\n\n\t\tif (this.awd_file_data.debug) {\n\t\t\tvar textureStylesNames:Array<string> = [\"external\", \"embed\"]\n\t\t\tconsole.log(\"Start parsing 6 \" + textureStylesNames[type] + \" Bitmaps for CubeTexture\");\n\t\t}\n\t}\n\n\n}\n\nexport = SingleCubeTextureAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonJoint\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonJoint\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nclass SkeletonAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar skeleton:Skeleton = new Skeleton();\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar num_joints:number /*uint*/ = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tthis.awd_file_data.parseProperties(null); // Discard properties for now\n\n\t\tvar joints_parsed:number /*uint*/ = 0;\n\t\twhile (joints_parsed < num_joints) {\n\t\t\tvar joint:SkeletonJoint;\n\t\t\tvar ibp:Matrix3D;\n\t\t\t// Ignore joint id\n\t\t\tthis.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\tjoint = new SkeletonJoint();\n\t\t\tjoint.parentIndex = this.awd_file_data.newBlockBytes.readUnsignedShort() - 1; // 0=null in AWD\n\t\t\tjoint.name = this.awd_file_data.parseVarStr();\n\n\t\t\tibp = this.awd_file_data.parseMatrix3D();\n\t\t\tjoint.inverseBindPose = ibp.rawData;\n\t\t\t// Ignore joint props/attributes for now\n\t\t\tthis.awd_file_data.parseProperties(null);\n\t\t\tthis.awd_file_data.parseUserAttributes();\n\t\t\tskeleton.joints.push(joint);\n\t\t\tjoints_parsed++;\n\t\t}\n\n\t\t// Discard attributes for now\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = skeleton;\n\t\tif (this.awd_file_data.debug)\n\t\t\tconsole.log(\"Parsed a Skeleton: Name = \" + this.awd_file_data.cur_block.name + \" | Number of Joints = \" + joints_parsed);\n\t}\n\n\n}\n\nexport = SkeletonAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport SkeletonClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\n\nclass SkeletonAnimClipAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar frame_dur:number;\n\t\tvar pose_addr:number /*uint*/;\n\t\tvar clip:SkeletonClipNode = new SkeletonClipNode();\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar num_frames:number /*uint*/ = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tthis.awd_file_data.parseProperties(null); // Ignore properties for now\n\n\t\tvar frames_parsed:number /*uint*/ = 0;\n\t\twhile (frames_parsed < num_frames) {\n\t\t\tpose_addr = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tframe_dur = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\tvar skel_pose:SkeletonPose = <SkeletonPose>this.awd_file_data.getAssetByID(pose_addr);\n\t\t\tif (skel_pose!=undefined) {\n\t\t\t\tclip.addFrame(skel_pose, frame_dur);\n\t\t\t}\n\t\t\tframes_parsed++;\n\t\t}\n\t\t// Ignore attributes for now\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = clip;\n\t\tif (this.awd_file_data.debug)\n\t\t\tconsole.log(\"Parsed a SkeletonClipNode: Name = \" + this.awd_file_data.cur_block.name + \" | Number of Frames = \" + clip.frames.length);\n\t}\n\n\n}\n\nexport = SkeletonAnimClipAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\n\nclass SkeletonPoseAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar pose:SkeletonPose = new SkeletonPose();\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar num_joints:number /*uint*/ = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tthis.awd_file_data.parseProperties(null); // Ignore properties for now\n\n\n\t\tvar joints_parsed:number /*uint*/ = 0;\n\t\twhile (joints_parsed < num_joints) {\n\t\t\tvar joint_pose:JointPose;\n\t\t\tvar has_transform:number /*uint*/;\n\t\t\tjoint_pose = new JointPose();\n\t\t\thas_transform = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\t\tif (has_transform == 1) {\n\t\t\t\tvar mtx_data:Float32Array = this.awd_file_data.parseMatrix43RawData();\n\n\t\t\t\tvar mtx:Matrix3D = new Matrix3D(mtx_data);\n\t\t\t\tjoint_pose.orientation.fromMatrix(mtx);\n\t\t\t\tjoint_pose.translation.copyFrom(mtx.position);\n\n\t\t\t\tpose.jointPoses[joints_parsed] = joint_pose;\n\t\t\t}\n\t\t\tjoints_parsed++;\n\t\t}\n\t\t// Skip attributes for now\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = pose;\n\t\tif (this.awd_file_data.debug)\n\t\t\tconsole.log(\"Parsed a SkeletonPose: Name = \" + this.awd_file_data.cur_block.name + \" | Number of Joints = \" + joints_parsed);\n\t}\n\n\n}\n\nexport = SkeletonPoseAWDParser;",
    "import EventDispatcher\t\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\n\nimport DefaultMaterialManager\t\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\nimport Skybox\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport SingleCubeTexture\t\t\t\t= require(\"awayjs-display/lib/textures/SingleCubeTexture\");\n\nimport AWDBlockParserBase\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nclass SkyboxAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar cubeTexAddr:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\n\t\tvar cube_tex:SingleCubeTexture = undefined;\n\t\tif(cubeTexAddr>0) {\n\t\t\tcube_tex = <SingleCubeTexture> this.awd_file_data.getAssetByID(cubeTexAddr);\n\t\t}\n\t\tif(cube_tex==undefined){\n\t\t\tcube_tex=<SingleCubeTexture>this.awd_file_data.getDefaultCubeTexture();\n\t\t}\n\t\t//if ((!returnedArrayCubeTex[0]) && (cubeTexAddr != 0))\n\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find the Cubetexture (ID = \" + cubeTexAddr + \" ) for this.awd_file_data Skybox\");\n\t\tvar new_skybox:Skybox = new Skybox();\n\t\tnew_skybox.texture = cube_tex;\n\t\tthis.awd_file_data.parseProperties(null)\n\t\tnew_skybox.extra = this.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = new_skybox;\n\t\tif (this.awd_file_data.debug)\n\t\t\tconsole.log(\"Parsed a Skybox: Name = '\" + this.awd_file_data.cur_block.name + \"' | CubeTexture-Name = \" + cube_tex.name);\n\t}\n\n\n}\n\nexport = SkyboxAWDParser;",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport EventDispatcher\t\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport Font\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/text/Font\");\nimport TesselatedFontTable\t\t\t\t= require(\"awayjs-display/lib/text/TesselatedFontTable\");\nimport SubGeometryBase\t\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport CurveSubGeometry\t\t\t\t\t= require(\"awayjs-display/lib/base/CurveSubGeometry\");\n\nclass TesselatedFontAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar new_font:Font=new Font();\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar font_style_cnt:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t//console.log(\"Font font_style_cnt = \"+font_style_cnt);\n\t\tfor (var i:number = 0; i < font_style_cnt; ++i) {\n\t\t\tvar font_style_name:string = this.awd_file_data.parseVarStr();\n\t\t\t//console.log(\"Font font_style_name = \"+font_style_name);\n\t\t\tvar new_font_style:TesselatedFontTable=new_font.get_font_table(font_style_name);\n\t\t\tnew_font_style.set_font_em_size(this.awd_file_data.newBlockBytes.readUnsignedInt());\n\t\t\t//console.log(\"Font new_font_style.font_em_size = \"+new_font_style.get_font_em_size);\n\t\t\tvar font_style_char_cnt:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t//console.log(\"Font font_style_char_cnt = \"+font_style_char_cnt);\n\t\t\tfor (var i:number = 0; i < font_style_char_cnt; ++i) {\n\n\t\t\t\tvar font_style_char:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\t//console.log(\"Font font_style_char = \"+font_style_char);\n\t\t\t\t// todo: this.awd_file_data is basically a simplified version of the subgeom-parsing done in parseTriangleGeometry. Make a parseSubGeom() instead (?)\n\t\t\t\tvar sm_len:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\tvar sm_end:number = this.awd_file_data.newBlockBytes.position + sm_len;\n\t\t\t\t//console.log(\"Font sm_len = \"+sm_len);\n\n\t\t\t\t//this.awd_file_data.parseProperties(null); // no properties for font-table subgeos\n\t\t\t\t// Loop through data streams\n\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < sm_end) {\n\t\t\t\t\tvar idx:number = 0;\n\t\t\t\t\tvar str_ftype:number, str_type:number, str_len:number, str_end:number;\n\n\t\t\t\t\t// Type, field type, length\n\t\t\t\t\tstr_type = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\t\t\t\tstr_ftype = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\t\t\t\tstr_len = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\t\tstr_end = this.awd_file_data.newBlockBytes.position + str_len;\n\n\t\t\t\t\tif (str_type == 2) {//face indicies positions\n\t\t\t\t\t\tvar indices:Array<number> = new Array<number>();\n\n\t\t\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < str_end) {\n\t\t\t\t\t\t\tindices[idx++] = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (str_type == 10) {// combined vertex2D stream 5 x float32\n\t\t\t\t\t\tvar idx_pos:number = 0;\n\t\t\t\t\t\tvar idx_curves:number = 0;\n\t\t\t\t\t\tvar idx_uvs:number = 0;\n\n\t\t\t\t\t\tvar positions:Array<number> = new Array<number>();\n\t\t\t\t\t\tvar curveData:Array<number> = new Array<number>();\n\t\t\t\t\t\tvar uvs:Array<number> = new Array<number>();\n\n\t\t\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < str_end) {\n\n\t\t\t\t\t\t\tpositions[idx_pos++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// x\n\t\t\t\t\t\t\tpositions[idx_pos++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// y\n\t\t\t\t\t\t\tpositions[idx_pos++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// type\n\n\t\t\t\t\t\t\tcurveData[idx_curves++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// curve value 1\n\t\t\t\t\t\t\tcurveData[idx_curves++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// curve value 2\n\n\t\t\t\t\t\t\tuvs[idx_uvs++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// curve value 1\n\t\t\t\t\t\t\tuvs[idx_uvs++] = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);// curve value 1\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.awd_file_data.newBlockBytes.position = str_end;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//this.awd_file_data.parseProperties(null);// no attributes for font-table subgeos\n\t\t\t\tvar curve_sub_geom:CurveSubGeometry = new CurveSubGeometry(new AttributesBuffer());\n\t\t\t\tcurve_sub_geom.setIndices(indices);\n\t\t\t\tcurve_sub_geom.setPositions(positions);\n\t\t\t\tcurve_sub_geom.setCurves(curveData);\n\t\t\t\tcurve_sub_geom.setUVs(uvs);\n\t\t\t\tnew_font_style.set_subgeo_for_char(font_style_char.toString(), curve_sub_geom);\n\t\t\t}\n\t\t\t//console.log(\"Parsed a font-table\");\n\n\t\t}\n\t\t//console.log(\"Parsed a font\");\n\t\tthis.awd_file_data.parseProperties(null);\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = new_font;\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a font: Name = '\" + this.awd_file_data.cur_block.name);\n\t\t}\n\n\t}\n\n}\n\nexport = TesselatedFontAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\n\nimport TextFormat\t\t\t\t\t= require(\"awayjs-display/lib/text/TextFormat\");\nimport TextFieldType\t\t\t\t= require(\"awayjs-display/lib/text/TextFieldType\");\nimport View\t\t\t= require(\"awayjs-display/lib/containers/View\");\n\nimport AS2SceneGraphFactory \t\t= require(\"awayjs-player/lib/factories/AS2SceneGraphFactory\");\n\nclass TextfieldAWDParser extends AWDBlockParserBase\n{\n\n\tprivate factory:AS2SceneGraphFactory;\n\tconstructor(view:View = null)\n\t{\n\t\tsuper();\n\t\tthis.factory = new AS2SceneGraphFactory(view);\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar newTextField = this.factory.createTextField();\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar text_field_type:number=this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\tif(text_field_type==0) {\n\t\t\tnewTextField.type = \"static\";\n\t\t}\n\t\telse if(text_field_type==1) {\n\t\t\tnewTextField.type = \"dynamic\";\n\t\t}\n\t\telse if(text_field_type==2) {\n\t\t\tnewTextField.type = \"input\";\n\t\t}\n\t\telse if(text_field_type==3) {\n\t\t\tnewTextField.type =\"input\";\n\t\t\tnewTextField.displayAsPassword=true;\n\t\t}\n\n\t\tnewTextField.width=this.awd_file_data.newBlockBytes.readFloat();\n\t\tnewTextField.height=this.awd_file_data.newBlockBytes.readFloat();\n\t\tvar num_paragraphs:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\tvar complete_text:string = \"\";\n\t\t//console.log(\"num_paragraphs  '\" + num_paragraphs);\n\t\tvar text_format:TextFormat;\n\t\tfor(var paracnt:number=0; paracnt<num_paragraphs; paracnt++){\n\n\t\t\tvar num_textruns:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t//console.log(\"num_textruns  '\" + num_textruns);\n\t\t\tfor(var textrun_cnt:number=0; textrun_cnt<num_textruns; textrun_cnt++) {\n\n\t\t\t\tvar format_id:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\t//console.log(\"format_id  '\" + format_id);\n\t\t\t\tvar textFormat:TextFormat = <TextFormat>this.awd_file_data.getAssetByID(format_id);\n\t\t\t\tif (textFormat==undefined) {\n\t\t\t\t\ttext_format = new TextFormat();\n\t\t\t\t}\n\t\t\t\t//console.log(\"text_format  '\" + text_format.name);\n\t\t\t\tvar txt_length = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\t//console.log(\"txt_length  '\" + txt_length);\n\t\t\t\tif (txt_length > 0) {\n\t\t\t\t\tvar this_txt:string = this.awd_file_data.newBlockBytes.readUTFBytes(txt_length);\n\t\t\t\t\t//newTextField.appendText(this_txt, text_format);\n\t\t\t\t\tcomplete_text+=this_txt;\n\t\t\t\t\t//console.log(\"this_txt  '\" + this_txt);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//newTextField.closeParagraph();\n\t\t}\n\t\tnewTextField.textFormat=text_format;\n\t\tnewTextField.text=complete_text;\n\n\t\t//newTextField.construct_geometry();\n\n\t\t// todo: optional matrix etc can be put in properties.\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:AWD3Utils.BOOL, 3:AWD3Utils.BOOL, 4:AWD3Utils.BOOL, 5:AWD3Utils.BOOL, 7:AWD3Utils.UINT8, 8:AWD3Utils.UINT8, 9:AWD3Utils.UINT8});\n\t\tnewTextField.selectable = props.get(1, false);\n\t\tnewTextField.border =  props.get(3, false);\n\t\t//newTextField.renderHTML =  props.get(4, false);\n\t\t//newTextField.scrollable =  props.get(5, false);\n\t\t//newTextField.text_flow =  props.get(7, 0);\n\t\t//newTextField.orientationMode =  props.get(8, 0);\n\t\t//newTextField.line_mode =  props.get(9, 0);\n\n\t\tnewTextField.extra = this.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data = newTextField;\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a TextField: Name = '\" + newTextField.name + \"| text  = \" + complete_text);\n\t\t}\n\n\t}\n\n\n}\n\nexport = TextfieldAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport TextFormat\t\t\t\t\t= require(\"awayjs-display/lib/text/TextFormat\");\nimport TesselatedFontTable\t\t\t= require(\"awayjs-display/lib/text/TesselatedFontTable\");\nimport Font\t\t\t\t\t\t\t= require(\"awayjs-display/lib/text/Font\");\nimport BasicMaterial\t\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\n\nclass TextformatAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar newTextFormat:TextFormat = new TextFormat();\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\t//console.log(\"this.awd_file_data._blocks[blockID].name  '\" + this.awd_file_data._blocks[blockID].name );\n\t\tvar font_id:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t//console.log(\"font_id  '\" + font_id);\n\t\tvar font_style_name:string = this.awd_file_data.parseVarStr();\n\t\t//console.log(\"font_style_name  '\" + font_style_name);\n\t\tvar font:Font = <Font>this.awd_file_data.getAssetByID(font_id);\n\t\tif (font==undefined) {\n\t\t\tfont = new Font();\n\t\t}\n\t\tnewTextFormat.font_name = font.name;\n\t\tvar font_table:TesselatedFontTable = font.get_font_table(font_style_name);\n\t\tif(font_table!=null){\n\t\t\tnewTextFormat.font_style = font_style_name;\n\t\t\tnewTextFormat.font_table = font_table;\n\t\t}\n\n\t\tvar data_id:number = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t//console.log(\"mat  '\" + data_id);\n\t\tvar mat:BasicMaterial = <BasicMaterial> this.awd_file_data.getAssetByID(data_id);\n\n\t\tif (mat==undefined) {\n\t\t\tmat = new BasicMaterial();\n\t\t}\n\t\tmat.bothSides=true;\n\n\t\tvar num_uv_values:number = this.awd_file_data.newBlockBytes.readUnsignedByte();\n\t\t//console.log(\"num_uv_values  '\" + num_uv_values);\n\t\tvar uv_values:Array<number>=[];\n\t\tfor(var uvcnt:number=0; uvcnt<num_uv_values; uvcnt++){\n\t\t\tvar uv_value:number=this.awd_file_data.newBlockBytes.readFloat();\n\t\t\tuv_values.push(uv_value);\n\t\t\t//console.log(\"uv_value  '\" + uv_value);\n\t\t}\n\t\tnewTextFormat.uv_values=uv_values;\n\t\tvar format_props:AWDProperties = this.awd_file_data.parseProperties({1:AWD3Utils.UINT16, 2:AWD3Utils.UINT16, 3:AWD3Utils.UINT8,4:AWD3Utils.UINT8,5:AWD3Utils.UINT8,6:AWD3Utils.UINT8, 7:AWD3Utils.UINT16, 8:AWD3Utils.UINT16, 9:AWD3Utils.UINT16, 10:AWD3Utils.UINT16});\n\n\t\tnewTextFormat.size = format_props.get(1,12);\n\t\tnewTextFormat.letterSpacing = format_props.get(2,0);\n\t\t//newTextFormat.rotated = format_props.get(3,false);\n\t\tnewTextFormat.kerning = format_props.get(4,true);\n\t\t//newTextFormat.baseline_shift = format_props.get(5,1);\n\t\t//newTextFormat.align = format_props.get(6,0);\n\t\tnewTextFormat.indent = format_props.get(7,0);\n\t\tnewTextFormat.leftMargin = format_props.get(8,0);\n\t\tnewTextFormat.rightMargin = format_props.get(9,0);\n\t\t//newTextFormat.linespacing = format_props.get(10,0);\n\t\tnewTextFormat.size = format_props.get(1,12);\n\t\tnewTextFormat.letterSpacing = format_props.get(2,0);\n\t\t//newTextFormat.rotated = format_props.get(3,false);\n\t\tnewTextFormat.kerning = format_props.get(4,true);\n\t\t//newTextFormat.baseline_shift = format_props.get(5,1);\n\t\tnewTextFormat.material = mat;\n\t\tthis.awd_file_data.parseUserAttributes();// textformat has no extra-properties\n\t\t//newTextFormat.extra =\n\n\t\tthis.awd_file_data.cur_block.data = newTextFormat;\n\t\tif (this.awd_file_data.debug) {\n\t\t\tconsole.log(\"Parsed a TextFormat: Name = '\" + name + \" font: \"+font.name);\n\t\t}\n\t}\n\n\n}\n\nexport = TextformatAWDParser;/**\n * Created by 80prozent on 4/18/2015.\n */\n",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Short3Attributes\t\t\t\t\t= require(\"awayjs-core/lib/attributes/Short3Attributes\");\nimport EventDispatcher\t\t\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport VertexClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/VertexClipNode\");\n\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\n\nclass VertexAnimClipAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar poseOnly:boolean=false;\n\t\tif(this.awd_file_data.cur_block.type==111){\n\t\t\tposeOnly=true\n\t\t}\n\t\tvar num_frames:number /*uint*/ = 1;\n\t\tvar num_submeshes:number /*uint*/;\n\t\tvar frames_parsed:number /*uint*/;\n\t\tvar subMeshParsed:number /*uint*/;\n\t\tvar frame_dur:number;\n\t\tvar x:number;\n\t\tvar y:number;\n\t\tvar z:number;\n\t\tvar str_len:number;\n\t\tvar str_end:number;\n\t\tvar geometry:Geometry;\n\t\tvar subGeom:TriangleSubGeometry;\n\t\tvar idx:number /*int*/ = 0;\n\t\tvar indices:Short3Attributes;\n\t\tvar verts:Array<number>;\n\t\tvar num_Streams:number /*int*/ = 0;\n\t\tvar streamsParsed:number /*int*/ = 0;\n\t\tvar streamtypes:Array<number> /*int*/ = new Array<number>() /*int*/;\n\t\tvar props:AWDProperties;\n\t\tvar thisGeo:Geometry;\n\t\tvar clip:VertexClipNode = new VertexClipNode();\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar geoAdress:number /*int*/ = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\tvar geom:Geometry = <Geometry>this.awd_file_data.getAssetByID(geoAdress);\n\t\tif (geom==undefined) {\n\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find the target-Geometry-Object \" + geoAdress + \" ) for this.awd_file_data VertexClipNode\");\n\t\t\treturn;\n\t\t}\n\t\tvar uvs:Array<Float32Array> = this.awd_file_data.getUVForVertexAnimation(geoAdress);\n\t\tif (!poseOnly)\n\t\t\tnum_frames = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\n\t\tnum_submeshes = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tnum_Streams = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tstreamsParsed = 0;\n\t\twhile (streamsParsed < num_Streams) {\n\t\t\tstreamtypes.push(this.awd_file_data.newBlockBytes.readUnsignedShort());\n\t\t\tstreamsParsed++;\n\t\t}\n\t\tprops = this.awd_file_data.parseProperties({1:AWD3Utils.BOOL, 2:AWD3Utils.BOOL});\n\n\t\tclip.looping = props.get(1, true);\n\t\tclip.stitchFinalFrame = props.get(2, false);\n\n\t\tframes_parsed = 0;\n\t\twhile (frames_parsed < num_frames) {\n\t\t\tframe_dur = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\t\tgeometry = new Geometry();\n\t\t\tsubMeshParsed = 0;\n\t\t\twhile (subMeshParsed < num_submeshes) {\n\t\t\t\tstreamsParsed = 0;\n\t\t\t\tstr_len = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\t\tstr_end = this.awd_file_data.newBlockBytes.position + str_len;\n\t\t\t\twhile (streamsParsed < num_Streams) {\n\t\t\t\t\tif (streamtypes[streamsParsed] == 1) {\n\t\t\t\t\t\tindices = geom.subGeometries[subMeshParsed].indices;\n\t\t\t\t\t\tverts = new Array<number>();\n\t\t\t\t\t\tidx = 0;\n\t\t\t\t\t\twhile (this.awd_file_data.newBlockBytes.position < str_end) {\n\t\t\t\t\t\t\tx = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);\n\t\t\t\t\t\t\ty = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);\n\t\t\t\t\t\t\tz = this.awd_file_data.readNumber(this.awd_file_data.accuracyGeo);\n\t\t\t\t\t\t\tverts[idx++] = x;\n\t\t\t\t\t\t\tverts[idx++] = y;\n\t\t\t\t\t\t\tverts[idx++] = z;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsubGeom = new TriangleSubGeometry(new AttributesBuffer());\n\t\t\t\t\t\tsubGeom.setIndices(indices);\n\t\t\t\t\t\tsubGeom.setPositions(verts);\n\t\t\t\t\t\tsubGeom.setUVs(uvs[subMeshParsed]);\n\t\t\t\t\t\tsubGeom.setNormals(null);\n\t\t\t\t\t\tsubGeom.setTangents(null);\n\t\t\t\t\t\tsubGeom.autoDeriveNormals = false;\n\t\t\t\t\t\tsubGeom.autoDeriveTangents = false;\n\t\t\t\t\t\tsubMeshParsed++;\n\t\t\t\t\t\tgeometry.addSubGeometry(subGeom)\n\t\t\t\t\t} else\n\t\t\t\t\t\tthis.awd_file_data.newBlockBytes.position = str_end;\n\t\t\t\t\tstreamsParsed++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tclip.addFrame(geometry, frame_dur);\n\t\t\tframes_parsed++;\n\t\t}\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tthis.awd_file_data.cur_block.data=clip;\n\t\tif (this.awd_file_data.debug)\n\t\t\tconsole.log(\"Parsed a VertexClipNode: Name = \" + clip.name + \" | Target-Geometry-Name = \" + geom.name + \" | Number of Frames = \" + clip.frames.length);\n\t}\n\n\n}\n\nexport = VertexAnimClipAWDParser;",
    "\nimport EventDispatcher\t\t\t= require(\"awayjs-core/lib/events/EventDispatcher\");\nimport ByteArray\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AbstractMethodError\t\t= require(\"awayjs-core/lib/errors/AbstractMethodError\");\nimport IAsset\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport AWDBlockParserBase\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParserBase\");\nimport AWDProperties\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWD3Utils\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\nimport SkeletonClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode\");\nimport VertexClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/VertexClipNode\");\nimport VertexAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimationSet\");\nimport SkeletonAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimationSet\");\n\nclass VertexAnimationSetAWDParser extends AWDBlockParserBase\n{\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t}\n\n\n\tpublic parseFromBytes():void\n\t{\n\t\tvar poseBlockAdress:number /*int*/\n\t\tthis.awd_file_data.cur_block.name = this.awd_file_data.parseVarStr();\n\t\tvar num_frames:number /*uint*/ = this.awd_file_data.newBlockBytes.readUnsignedShort();\n\t\tvar props:AWDProperties = this.awd_file_data.parseProperties({1:AWD3Utils.UINT16});\n\t\tvar frames_parsed:number /*uint*/ = 0;\n\t\tvar skeletonFrames:Array<SkeletonClipNode> = new Array<SkeletonClipNode>();\n\t\tvar vertexFrames:Array<VertexClipNode> = new Array<VertexClipNode>();\n\t\twhile (frames_parsed < num_frames) {\n\t\t\tposeBlockAdress = this.awd_file_data.newBlockBytes.readUnsignedInt();\n\t\t\tvar animNode:AnimationNodeBase = <AnimationNodeBase>this.awd_file_data.getAssetByID(poseBlockAdress);\n\t\t\tif (animNode==undefined) {\n\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not find the AnimationClipNode Nr \" + frames_parsed + \" ( \" + poseBlockAdress + \" ) for this.awd_file_data AnimationSet\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (animNode instanceof VertexClipNode)\n\t\t\t\t\tvertexFrames.push(<VertexClipNode>animNode)\n\t\t\t\tif (animNode instanceof SkeletonClipNode)\n\t\t\t\t\tskeletonFrames.push(<SkeletonClipNode>animNode)\n\t\t\t}\n\t\t\tframes_parsed++;\n\t\t}\n\t\tif ((vertexFrames.length == 0) && (skeletonFrames.length == 0)) {\n\t\t\t//this.awd_file_data._blocks[blockID].addError(\"Could not create this.awd_file_data AnimationSet, because it contains no animations\");\n\t\t\treturn;\n\t\t}\n\t\tthis.awd_file_data.parseUserAttributes();\n\t\tif (vertexFrames.length > 0) {\n\t\t\tvar newVertexAnimationSet:VertexAnimationSet = new VertexAnimationSet();\n\t\t\tfor (var i:number /*int*/ = 0; i < vertexFrames.length; i++)\n\t\t\t\tnewVertexAnimationSet.addAnimation(vertexFrames[i]);\n\t\t\tthis.awd_file_data.cur_block.data = newVertexAnimationSet;\n\t\t\tif (this.awd_file_data.debug)\n\t\t\t\tconsole.log(\"Parsed a VertexAnimationSet: Name = \" + newVertexAnimationSet.name + \" | Animations = \" + newVertexAnimationSet.animations.length + \" | Animation-Names = \" + newVertexAnimationSet.animationNames.toString());\n\t\t\treturn;\n\t\t} else if (skeletonFrames.length > 0) {\n\t\t\tvar newSkeletonAnimationSet:SkeletonAnimationSet = new SkeletonAnimationSet(props.get(1, 4)); //props.get(1,4));\n\t\t\tfor (var i:number /*int*/ = 0; i < skeletonFrames.length; i++)\n\t\t\t\tnewSkeletonAnimationSet.addAnimation(skeletonFrames[i]);\n\t\t\tthis.awd_file_data.cur_block.data = newSkeletonAnimationSet;\n\t\t\tif (this.awd_file_data.debug)\n\t\t\t\tconsole.log(\"Parsed a SkeletonAnimationSet: Name = \" + newSkeletonAnimationSet.name + \" | Animations = \" + newSkeletonAnimationSet.animations.length + \" | Animation-Names = \" + newSkeletonAnimationSet.animationNames.toString());\n\t\t}\n\t}\n\n\n}\n\nexport = VertexAnimationSetAWDParser;",
    "import BitmapImage2D\t\t\t\t\t= require(\"awayjs-core/lib/image/BitmapImage2D\");\nimport BitmapImageCube\t\t\t\t\t= require(\"awayjs-core/lib/image/BitmapImageCube\");\nimport BlendMode\t\t\t\t\t\t= require(\"awayjs-core/lib/image/BlendMode\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport URLLoaderDataFormat\t\t\t\t= require(\"awayjs-core/lib/net/URLLoaderDataFormat\");\nimport URLRequest\t\t\t\t\t\t= require(\"awayjs-core/lib/net/URLRequest\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport ParserBase\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserBase\");\nimport ParserUtils\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserUtils\");\nimport ResourceDependency\t\t\t\t= require(\"awayjs-core/lib/parsers/ResourceDependency\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport DefaultMaterialManager\t\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport TextureBase\t\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\nimport SingleCubeTexture\t\t\t\t= require(\"awayjs-display/lib/textures/SingleCubeTexture\");\nimport Single2DTexture\t\t\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\n\nimport MethodMaterial\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterial\");\n\nimport AWDBitFlags\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags\");\nimport AWDProperties\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\nimport AWDBlock\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\n\n\n/**\n * AWD3FileData stores the data loaded for a AWD-file. It also gives access to some helper functions.\n */\nclass AWD3FileData\n{\n\t//set to \"true\" to have some console.logs in the Console\n\tprivate _debug:boolean = false;\n\n\tprivate _cur_block:AWDBlock;\n\tprivate _blocks:Array<AWDBlock>;\n\tprivate _newBlockBytes:ByteArray;\n\n\tpublic  major_version:number;\n\tpublic  minor_version:number;\n\n\tprivate _accuracyOnBlocks:boolean = false;\n\n\tprivate _accuracyMatrix:boolean;\n\tprivate _accuracyGeo:boolean;\n\tprivate _accuracyProps:boolean;\n\tprivate _matrixNrType:number;\n\tprivate _geoNrType:number;\n\tprivate _propsNrType:number;\n\n\tprivate blendModeDic:Array<string>;\n\tprivate _depthSizeDic:Array<number>;\n\n\tprivate _defaultCubeTexture:SingleCubeTexture;\n\t/**\n\t * Creates a new AWD3FileData object.\n\t */\n\tconstructor()\n\t{\n\t\tthis.major_version=0;\n\t\tthis.minor_version=0;\n\n\t\tthis._blocks = new Array<AWDBlock>();\n\t\tthis._blocks.push(new AWDBlock(255, 0));\n\t\tthis._cur_block=this._blocks[0];\n\t\tthis.blendModeDic = new Array<string>(); // used to translate ints to blendMode-strings\n\t\tthis.blendModeDic.push(BlendMode.NORMAL);\n\t\tthis.blendModeDic.push(BlendMode.ADD);\n\t\tthis.blendModeDic.push(BlendMode.ALPHA);\n\t\tthis.blendModeDic.push(BlendMode.DARKEN);\n\t\tthis.blendModeDic.push(BlendMode.DIFFERENCE);\n\t\tthis.blendModeDic.push(BlendMode.ERASE);\n\t\tthis.blendModeDic.push(BlendMode.HARDLIGHT);\n\t\tthis.blendModeDic.push(BlendMode.INVERT);\n\t\tthis.blendModeDic.push(BlendMode.LAYER);\n\t\tthis.blendModeDic.push(BlendMode.LIGHTEN);\n\t\tthis.blendModeDic.push(BlendMode.MULTIPLY);\n\t\tthis.blendModeDic.push(BlendMode.NORMAL);\n\t\tthis.blendModeDic.push(BlendMode.OVERLAY);\n\t\tthis.blendModeDic.push(BlendMode.SCREEN);\n\t\tthis.blendModeDic.push(BlendMode.SHADER);\n\t\tthis.blendModeDic.push(BlendMode.OVERLAY);\n\n\t\tthis._depthSizeDic = new Array<number>(); // used to translate ints to depthSize-values\n\t\tthis._depthSizeDic.push(256);\n\t\tthis._depthSizeDic.push(512);\n\t\tthis._depthSizeDic.push(2048);\n\t\tthis._depthSizeDic.push(1024);\n\t}\n\n\tpublic getDepthSizeFromEnum(depthSize:number):number\n\t{\n\t\treturn this._depthSizeDic[depthSize];\n\t}\n\tpublic getBlendModeStringFromEnum(blendmode:number):string\n\t{\n\t\treturn this.blendModeDic[blendmode];\n\t}\n\n\tpublic dispose():void\n\t{\n\n\t\tfor (var c in this._blocks) {\n\n\t\t\tvar b:AWDBlock = <AWDBlock> this._blocks[ c ];\n\t\t\tb.dispose();\n\n\t\t}\n\n\t}\n\tpublic get accuracyOnBlocks():boolean\n\t{\n\t\treturn this._accuracyOnBlocks;\n\t}\n\tpublic get accuracyMatrix():boolean\n\t{\n\t\treturn this._accuracyMatrix;\n\t}\n\tpublic set accuracyMatrix(new_accuracyMatrix:boolean)\n\t{\n\t\tthis._accuracyMatrix = new_accuracyMatrix;\n\t}\n\tpublic get accuracyProps():boolean\n\t{\n\t\treturn this._accuracyProps;\n\t}\n\tpublic set accuracyProps(new_accuracyProps:boolean)\n\t{\n\t\tthis._accuracyProps = new_accuracyProps;\n\t}\n\tpublic set accuracyGeo(new_accuracyGeo:boolean)\n\t{\n\t\tthis._accuracyGeo = new_accuracyGeo;\n\t}\n\tpublic get accuracyGeo():boolean\n\t{\n\t\treturn this._accuracyGeo;\n\t}\n\tpublic get debug():boolean\n\t{\n\t\treturn this._debug;\n\t}\n\n\tpublic get matrixNrType():number\n\t{\n\t\treturn this._matrixNrType;\n\t}\n\tpublic set matrixNrType(newmatrixNrType:number)\n\t{\n\t\tthis._matrixNrType = newmatrixNrType;\n\t}\n\n\tpublic get propsNrType():number\n\t{\n\t\treturn this._propsNrType;\n\t}\n\tpublic set propsNrType(new_props_nr:number)\n\t{\n\t\tthis._propsNrType = new_props_nr;\n\t}\n\n\tpublic get geoNrType():number\n\t{\n\t\treturn this._geoNrType;\n\t}\n\tpublic set geoNrType(new_geoNrType:number)\n\t{\n\t\tthis._geoNrType = new_geoNrType;\n\t}\n\n\n\tpublic set newBlockBytes(new_newBlockBytes:ByteArray)\n\t{\n\t\tthis._newBlockBytes = new_newBlockBytes;\n\t}\n\tpublic get newBlockBytes():ByteArray\n\t{\n\t\treturn this._newBlockBytes;\n\t}\n\tpublic create_new_block(type:number, id:number)\n\t{\n\t\tvar new_block:AWDBlock= new AWDBlock(this._blocks.length, type);\n\t\tthis._cur_block=new_block;\n\t\tthis._blocks[id]=new_block;\n\t}\n\tpublic get cur_block():AWDBlock\n\t{\n\t\treturn this._cur_block;\n\t}\n\tpublic block_cnt():number\n\t{\n\t\treturn this._blocks.length;\n\t}\n\n\t//--Parser UTILS---------------------------------------------------------------------------\n\n\tpublic parseUserAttributes():Object\n\t{\n\t\tvar attributes:Object;\n\t\tvar list_len:number;\n\t\tvar attibuteCnt:number;\n\n\t\tlist_len = this._newBlockBytes.readUnsignedInt();\n\n\t\tif (list_len > 0) {\n\n\t\t\tvar list_end:number;\n\n\t\t\tattributes = {};\n\n\t\t\tlist_end = this._newBlockBytes.position + list_len;\n\n\t\t\twhile (this._newBlockBytes.position < list_end) {\n\t\t\t\tvar ns_id:number;\n\t\t\t\tvar attr_key:string;\n\t\t\t\tvar attr_type:number;\n\t\t\t\tvar attr_len:number;\n\t\t\t\tvar attr_val:any;\n\n\t\t\t\t// TODO: Properly tend to namespaces in attributes\n\t\t\t\tns_id = this._newBlockBytes.readUnsignedByte();\n\t\t\t\tattr_key = this.parseVarStr();\n\t\t\t\tattr_type = this._newBlockBytes.readUnsignedByte();\n\t\t\t\tattr_len = this._newBlockBytes.readUnsignedInt();\n\n\t\t\t\tif ((this._newBlockBytes.position + attr_len) > list_end) {\n\t\t\t\t\tconsole.log(\"           Error in reading attribute # \" + attibuteCnt + \" = skipped to end of attribute-list\");\n\t\t\t\t\tthis._newBlockBytes.position = list_end;\n\t\t\t\t\treturn attributes;\n\t\t\t\t}\n\n\t\t\t\tswitch (attr_type) {\n\t\t\t\t\tcase AWD3Utils.AWDSTRING:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readUTFBytes(attr_len);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWD3Utils.INT8:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readByte();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWD3Utils.INT16:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readShort();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWD3Utils.INT32:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readInt();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWD3Utils.BOOL:\n\t\t\t\t\tcase AWD3Utils.UINT8:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readUnsignedByte();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWD3Utils.UINT16:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readUnsignedShort();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWD3Utils.UINT32:\n\t\t\t\t\tcase AWD3Utils.BADDR:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readUnsignedInt();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWD3Utils.FLOAT32:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readFloat();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWD3Utils.FLOAT64:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readDouble();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tattr_val = 'unimplemented attribute type ' + attr_type;\n\t\t\t\t\t\tthis._newBlockBytes.position += attr_len;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (this._debug) {\n\t\t\t\t\tconsole.log(\"attribute = name: \" + attr_key + \"  / value = \" + attr_val);\n\t\t\t\t}\n\n\t\t\t\tattributes[attr_key] = attr_val;\n\t\t\t\tattibuteCnt += 1;\n\t\t\t}\n\t\t}\n\n\t\treturn attributes;\n\t}\n\n\tpublic parseProperties(expected:Object):AWDProperties\n\t{\n\t\tvar list_end:number;\n\t\tvar list_len:number;\n\t\tvar propertyCnt:number = 0;\n\t\tvar props:AWDProperties = new AWDProperties();\n\n\t\tlist_len = this._newBlockBytes.readUnsignedInt();\n\t\tlist_end = this._newBlockBytes.position + list_len;\n\n\t\tif (expected) {\n\n\t\t\twhile (this._newBlockBytes.position < list_end) {\n\t\t\t\tvar len:number;\n\t\t\t\tvar key:number;\n\t\t\t\tvar type:number;\n\n\t\t\t\tkey = this._newBlockBytes.readUnsignedShort();\n\t\t\t\tlen = this._newBlockBytes.readUnsignedInt();\n\n\t\t\t\tif ((this._newBlockBytes.position + len) > list_end) {\n\t\t\t\t\tconsole.log(\"           Error in reading property # \" + propertyCnt + \" = skipped to end of propertie-list\");\n\t\t\t\t\tthis._newBlockBytes.position = list_end;\n\t\t\t\t\treturn props;\n\t\t\t\t}\n\n\t\t\t\tif (expected.hasOwnProperty(key.toString())) {\n\t\t\t\t\ttype = expected[key];\n\t\t\t\t\tprops.set(key, this.parseAttrValue(type, len));\n\t\t\t\t} else {\n\t\t\t\t\tthis._newBlockBytes.position += len;\n\t\t\t\t}\n\n\t\t\t\tpropertyCnt += 1;\n\n\t\t\t}\n\t\t} else {\n\t\t\tthis._newBlockBytes.position = list_end;\n\t\t}\n\n\t\treturn props;\n\n\t}\n\n\tprivate parseAttrValue(type:number, len:number):any\n\t{\n\t\tvar elem_len:number;\n\t\tvar read_func:Function;\n\n\t\tswitch (type) {\n\n\t\t\tcase AWD3Utils.BOOL:\n\t\t\tcase AWD3Utils.INT8:\n\t\t\t\telem_len = 1;\n\t\t\t\tread_func = this._newBlockBytes.readByte;\n\t\t\t\tbreak;\n\n\t\t\tcase AWD3Utils.INT16:\n\t\t\t\telem_len = 2;\n\t\t\t\tread_func = this._newBlockBytes.readShort;\n\t\t\t\tbreak;\n\n\t\t\tcase AWD3Utils.INT32:\n\t\t\t\telem_len = 4;\n\t\t\t\tread_func = this._newBlockBytes.readInt;\n\t\t\t\tbreak;\n\n\t\t\tcase AWD3Utils.UINT8:\n\t\t\t\telem_len = 1;\n\t\t\t\tread_func = this._newBlockBytes.readUnsignedByte;\n\t\t\t\tbreak;\n\n\t\t\tcase AWD3Utils.UINT16:\n\t\t\t\telem_len = 2;\n\t\t\t\tread_func = this._newBlockBytes.readUnsignedShort;\n\t\t\t\tbreak;\n\n\t\t\tcase AWD3Utils.UINT32:\n\t\t\tcase AWD3Utils.COLOR:\n\t\t\tcase AWD3Utils.BADDR:\n\t\t\t\telem_len = 4;\n\t\t\t\tread_func = this._newBlockBytes.readUnsignedInt;\n\t\t\t\tbreak;\n\n\t\t\tcase AWD3Utils.FLOAT32:\n\t\t\t\telem_len = 4;\n\t\t\t\tread_func = this._newBlockBytes.readFloat;\n\t\t\t\tbreak;\n\n\t\t\tcase AWD3Utils.FLOAT64:\n\t\t\t\telem_len = 8;\n\t\t\t\tread_func = this._newBlockBytes.readDouble;\n\t\t\t\tbreak;\n\n\t\t\tcase AWD3Utils.AWDSTRING:\n\t\t\t\treturn this._newBlockBytes.readUTFBytes(len);\n\n\t\t\tcase AWD3Utils.VECTOR2x1:\n\t\t\tcase AWD3Utils.VECTOR3x1:\n\t\t\tcase AWD3Utils.VECTOR4x1:\n\t\t\tcase AWD3Utils.MTX3x2:\n\t\t\tcase AWD3Utils.MTX3x3:\n\t\t\tcase AWD3Utils.MTX4x3:\n\t\t\tcase AWD3Utils.MTX4x4:\n\t\t\t\telem_len = 8;\n\t\t\t\tread_func = this._newBlockBytes.readDouble;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tif (elem_len < len) {\n\t\t\tvar list:Array<any> = [];\n\t\t\tvar num_read:number = 0;\n\t\t\tvar num_elems:number = len/elem_len;\n\n\t\t\twhile (num_read < num_elems) {\n\t\t\t\tlist.push(read_func.apply(this._newBlockBytes)); // list.push(read_func());\n\t\t\t\tnum_read++;\n\t\t\t}\n\n\t\t\treturn list;\n\t\t} else {\n\n\t\t\tvar val:any = read_func.apply(this._newBlockBytes);//read_func();\n\t\t\treturn val;\n\t\t}\n\t}\n\n\t// Helper - functions\n\tpublic getUVForVertexAnimation(meshID:number /*uint*/):Array<Float32Array>\n\t{\n\t\tif (this._blocks[meshID].data instanceof Mesh)\n\t\t\tmeshID = this._blocks[meshID].geoID;\n\t\tif (this._blocks[meshID].uvsForVertexAnimation)\n\t\t\treturn this._blocks[meshID].uvsForVertexAnimation;\n\t\tvar geometry:Geometry = (<Geometry> this._blocks[meshID].data);\n\t\tvar geoCnt:number /*int*/ = 0;\n\t\tvar sub_geom:TriangleSubGeometry;\n\t\tthis._blocks[meshID].uvsForVertexAnimation = new Array<Float32Array>();\n\t\twhile (geoCnt < geometry.subGeometries.length) {\n\t\t\tsub_geom = <TriangleSubGeometry> geometry.subGeometries[geoCnt];\n\t\t\tthis._blocks[meshID].uvsForVertexAnimation.push(sub_geom.uvs.get(sub_geom.numVertices));\n\t\t\tgeoCnt++;\n\t\t}\n\t\treturn this._blocks[meshID].uvsForVertexAnimation;\n\t}\n\n\tpublic parseVarStr():string\n\t{\n\n\t\tvar len:number = this._newBlockBytes.readUnsignedShort();\n\t\treturn this._newBlockBytes.readUTFBytes(len);\n\t}\n\n\tpublic getBlockByID(assetID:number):AWDBlock\n\t{\n\t\treturn this._blocks[assetID];\n\t}\n\tpublic getAssetByID(assetID:number):IAsset\n\t{\n\t\treturn this._blocks[assetID].data;\n\t}\n\tprivate getDefaultAsset(assetType:string):IAsset\n\t{\n\t\tswitch (true) {\n\t\t\tcase (assetType == SingleCubeTexture.assetType):\n\t\t\t\treturn this.getDefaultCubeTexture();\n\t\t\t\tbreak;\n\t\t\tcase (assetType == Single2DTexture.assetType):\n\t\t\t\treturn DefaultMaterialManager.getDefaultTexture();\n\t\t\t\tbreak;\n\t\t\tcase (assetType == MethodMaterial.assetType):\n\t\t\t\treturn DefaultMaterialManager.getDefaultMaterial();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tpublic getDefaultCubeTexture():IAsset\n\t{\n\t\t/*\n\t\tif (!this._defaultCubeTexture) {\n\t\t\tvar defaultBitmap:BitmapImage2D = DefaultMaterialManager.createCheckeredBitmapImage2D();\n\n\t\t\tvar bitmapImageCube = new BitmapImageCube(defaultBitmap.width);\n\n\t\t\tfor (var i:number = 0; i < 6; i++)\n\t\t\t\tbitmapImageCube.draw(i, defaultBitmap);\n\n\n\t\t\tthis._defaultCubeTexture = new SingleCubeTexture(bitmapImageCube);\n\t\t\tthis._defaultCubeTexture.name = \"defaultCubeTexture\";\n\t\t}\n\t\t*/\n\t\treturn <IAsset> this._defaultCubeTexture;\n\t}\n\n\tpublic  readNumber(precision:boolean = false):number\n\t{\n\t\tif (precision)\n\t\t\treturn this._newBlockBytes.readDouble();\n\t\treturn this._newBlockBytes.readFloat();\n\n\t}\n\n\tpublic parseMatrix3D():Matrix3D\n\t{\n\t\treturn new Matrix3D(this.parseMatrix43RawData());\n\t}\n\n\tprivate parseMatrix32RawData():Array<number>\n\t{\n\t\tvar i:number;\n\t\tvar mtx_raw:Array<number> = new Array<number>(6);\n\t\tfor (i = 0; i < 6; i++) {\n\t\t\tmtx_raw[i] = this._newBlockBytes.readFloat();\n\t\t}\n\n\t\treturn mtx_raw;\n\t}\n\n\tpublic parseMatrix43RawData():Float32Array\n\t{\n\t\tvar mtx_raw:Float32Array = new Float32Array(16);\n\n\t\tmtx_raw[0] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[1] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[2] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[3] = 0.0;\n\t\tmtx_raw[4] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[5] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[6] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[7] = 0.0;\n\t\tmtx_raw[8] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[9] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[10] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[11] = 0.0;\n\t\tmtx_raw[12] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[13] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[14] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[15] = 1.0;\n\n\t\t//TODO: fix max exporter to remove NaN values in joint 0 inverse bind pose\n\n\t\tif (isNaN(mtx_raw[0])) {\n\t\t\tmtx_raw[0] = 1;\n\t\t\tmtx_raw[1] = 0;\n\t\t\tmtx_raw[2] = 0;\n\t\t\tmtx_raw[4] = 0;\n\t\t\tmtx_raw[5] = 1;\n\t\t\tmtx_raw[6] = 0;\n\t\t\tmtx_raw[8] = 0;\n\t\t\tmtx_raw[9] = 0;\n\t\t\tmtx_raw[10] = 1;\n\t\t\tmtx_raw[12] = 0;\n\t\t\tmtx_raw[13] = 0;\n\t\t\tmtx_raw[14] = 0;\n\n\t\t}\n\n\t\treturn mtx_raw;\n\t}\n\n}\n\nexport = AWD3FileData;\n\n\n\n",
    "\nclass AWD3Utils {\n\tpublic static BLOCKSTATE_FINALIZE:number = 0;\n\tpublic static BLOCKSTATE_INVALID:number = 1;\n\tpublic static BLOCKSTATE_LOAD_DEPENDENICES:number = 2;\n\tpublic static BLOCKSTATE_NO_ASSET:number = 3;\n\tpublic static COMPRESSIONMODE_LZMA:string = \"lzma\";\n\tpublic static UNCOMPRESSED:number = 0;\n\tpublic static DEFLATE:number = 1;\n\tpublic static LZMA:number = 2;\n\tpublic static INT8:number = 1;\n\tpublic static INT16:number = 2;\n\tpublic static INT32:number = 3;\n\tpublic static UINT8:number = 4;\n\tpublic static UINT16:number = 5;\n\tpublic static UINT32:number = 6;\n\tpublic static FLOAT32:number = 7;\n\tpublic static FLOAT64:number = 8;\n\tpublic static BOOL:number = 21;\n\tpublic static COLOR:number = 22;\n\tpublic static BADDR:number = 23;\n\tpublic static AWDSTRING:number = 31;\n\tpublic static AWDBYTEARRAY:number = 32;\n\tpublic static VECTOR2x1:number = 41;\n\tpublic static VECTOR3x1:number = 42;\n\tpublic static VECTOR4x1:number = 43;\n\tpublic static MTX3x2:number = 44;\n\tpublic static MTX3x3:number = 45;\n\tpublic static MTX4x3:number = 46;\n\tpublic static MTX4x4:number = 47;\n}\nexport = AWD3Utils;",
    "\n/**\n *\n */\nclass AWDBitFlags\n{\n\tpublic static FLAG1:number = 1;\n\tpublic static FLAG2:number = 2;\n\tpublic static FLAG3:number = 4;\n\tpublic static FLAG4:number = 8;\n\tpublic static FLAG5:number = 16;\n\tpublic static FLAG6:number = 32;\n\tpublic static FLAG7:number = 64;\n\tpublic static FLAG8:number = 128;\n\tpublic static FLAG9:number = 256;\n\tpublic static FLAG10:number = 512;\n\tpublic static FLAG11:number = 1024;\n\tpublic static FLAG12:number = 2048;\n\tpublic static FLAG13:number = 4096;\n\tpublic static FLAG14:number = 8192;\n\tpublic static FLAG15:number = 16384;\n\tpublic static FLAG16:number = 32768;\n\n\tpublic static test(flags:number, testFlag:number):boolean\n\t{\n\t\treturn (flags & testFlag) == testFlag;\n\t}\n}\nexport = AWDBitFlags;",
    "import ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\n\nclass AWDBlock\n{\n\tpublic id:number;\n\tpublic name:string;\n\tpublic type:number;\n\tpublic data:any;\n\tpublic dependencies_data:Array<ByteArray>;\n\tpublic dependencies_urls:Array<string>;\n\tpublic loaded_dependencies:Array<any>;\n\tpublic loaded_dependencies_cnt:number;\n\tpublic len:number;\n\tpublic geoID:number;\n\tpublic state:number;\n\tpublic extras:Object;\n\tpublic bytes:ByteArray;\n\tpublic errorMessages:Array<string>;\n\tpublic uvsForVertexAnimation:Array<Float32Array>;\n\n\tconstructor(this_id:number, this_type:number)\n\t{\n\t\tthis.type=this_type;\n\t\tthis.id=this_id;\n\t\tthis.state = AWD3Utils.BLOCKSTATE_FINALIZE;\n\t\tthis.dependencies_data=Array<any>();\n\t\tthis.dependencies_urls=Array<string>();\n\t\tif(this_type==83){\n\t\t\tthis.loaded_dependencies=Array<any>(6);\n\t\t}\n\t\tthis.loaded_dependencies_cnt=0;\n\t}\n\n\tpublic dispose()\n\t{\n\n\t\tthis.id = null;\n\t\tthis.bytes = null;\n\t\tthis.errorMessages = null;\n\t\tthis.uvsForVertexAnimation = null;\n\n\t}\n\n\tpublic addError(errorMsg:string):void\n\t{\n\t\tif (!this.errorMessages)\n\t\t\tthis.errorMessages = new Array<string>();\n\n\t\tthis.errorMessages.push(errorMsg);\n\t}\n}\nexport = AWDBlock;",
    "\nclass AWDProperties\n{\n\tpublic set(key:number, value:any):void\n\t{\n\t\tthis[ key.toString() ] = value;\n\t}\n\n\tpublic get(key:number, fallback:any):any\n\t{\n\t\tif (this.hasOwnProperty(key.toString())) {\n\t\t\treturn this[key.toString()];\n\t\t} else {\n\t\t\treturn fallback;\n\t\t}\n\t}\n}\nexport = AWDProperties;",
    "import BlendMode\t\t\t\t\t\t= require(\"awayjs-core/lib/image/BlendMode\");\nimport BitmapImage2D\t\t\t\t\t= require(\"awayjs-core/lib/image/BitmapImage2D\");\nimport BitmapImageCube\t\t\t\t\t= require(\"awayjs-core/lib/image/BitmapImageCube\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport URLLoaderDataFormat\t\t\t\t= require(\"awayjs-core/lib/net/URLLoaderDataFormat\");\nimport URLRequest\t\t\t\t\t\t= require(\"awayjs-core/lib/net/URLRequest\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport ParserBase\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserBase\");\nimport ParserUtils\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserUtils\");\nimport ResourceDependency\t\t\t\t= require(\"awayjs-core/lib/parsers/ResourceDependency\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport SingleCubeTexture\t\t\t\t= require(\"awayjs-display/lib/textures/SingleCubeTexture\");\nimport Single2DTexture\t\t\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\n\n\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport DefaultMaterialManager\t\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\n\n\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\n\n\n\nimport AWDBitFlags\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDBitFlags\");\nimport AWDProperties\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDProperties\");\n\nimport AWDAssetParsers\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3BlockParsers/AWDBlockParsers\");\nimport AWDBlock\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock\");\nimport AWD3FileData\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3FileData\");\nimport AWD3Utils\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWD3Utils\");\n\n\n\n/**\n * AWD3Utils provides a parser for the AWD data type.\n */\nclass AWD3Parser extends ParserBase\n{\n\t//set to \"true\" to have some console.logs in the Console\n\tprivate _debug:boolean = false;\n\tprivate _byteData:ByteArray;\n\tprivate _startedParsing:boolean = false;\n\tprivate _compression:number;\n\tprivate _streaming:boolean;\n\tprivate _parsed_header:boolean = false;\n\tprivate _body:ByteArray;\n\tprivate _awd_data:AWD3FileData;\n\tprivate _block_parser:AWDAssetParsers;\n\n\t// temp for checking stats\n\tpublic total_time:number = 0;\n\tpublic geom_time:number = 0;\n\tpublic timeline_time:number = 0;\n\n\t/**\n\t * Creates a new AWD3Utils object.\n\t * @param uri The url or id of the data or file to be parsed.\n\t * @param extra The holder for extra contextual data that the parser might need.\n\t */\n\tconstructor(block_parser:AWDAssetParsers = undefined)\n\t{\n\t\tsuper(URLLoaderDataFormat.ARRAY_BUFFER);\n\n\t\tthis._block_parser=block_parser;\n\t\tif(this._block_parser==undefined){\n\t\t\tthis._block_parser=new AWDAssetParsers();\n\t\t}\n\t\tthis._awd_data=new AWD3FileData();\n\t\tthis._block_parser.init_parser(this._awd_data);\n\t}\n\n\t/**\n\t * Indicates whether or not a given file extension is supported by the parser.\n\t * @param extension The file extension of a potential file to be parsed.\n\t * @return Whether or not the given file type is supported.\n\t */\n\tpublic static supportsType(extension:string):boolean\n\t{\n\t\textension = extension.toLowerCase();\n\t\treturn extension == \"awd\";\n\t}\n\n\t/**\n\t * Tests whether a data block can be parsed by the parser.\n\t * @param data The data block to potentially be parsed.\n\t * @return Whether or not the given data is supported.\n\t */\n\tpublic static supportsData(data:any):boolean\n\t{\n\t\treturn (ParserUtils.toString(data, 3) == 'AWD');\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iResolveDependency(resourceDependency:ResourceDependency)\n\t{\n\t\t// this will be called when Dependency has finished loading.\n\t\t// the ressource dependecniy has a id that point to the awd_block waiting for it.\n\t\tif (resourceDependency.assets.length == 1) {\n\t\t\tvar this_block:AWDBlock = this._awd_data.getBlockByID(parseInt(resourceDependency.id));\n\t\t\tif(this_block.type==82){\n\t\t\t\tvar testure_asset:Single2DTexture = new Single2DTexture(<BitmapImage2D> resourceDependency.assets[0]);\n\t\t\t\tthis_block.data = testure_asset; // Store finished asset\n\t\t\t\t// Finalize texture asset to dispatch texture event, which was\n\t\t\t\t// previously suppressed while the dependency was loaded.\n\t\t\t\tthis._pFinalizeAsset(<IAsset> testure_asset, this_block.name);\n\n\t\t\t\tif (this._debug) {\n\t\t\t\t\tconsole.log(\"Successfully loaded Bitmap for texture\");\n\t\t\t\t\tconsole.log(\"Parsed texture: Name = \" + this_block.name);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(this_block.type==44){\n\t\t\t\t// todo: implement parsing of Audio block data\n\t\t\t\t/*\n\t\t\t\t var audio_asset:AudioAsset = <AudioAsset> resourceDependency.assets[0];\n\t\t\t\t this_block.data = audio_asset; // Store finished asset\n\t\t\t\t // Finalize texture asset to dispatch texture event, which was\n\t\t\t\t // previously suppressed while the dependency was loaded.\n\t\t\t\t this._pFinalizeAsset(<IAsset> audio_asset, this_block.name);\n\t\t\t\t */\n\t\t\t\tif (this._debug) {\n\t\t\t\t\tconsole.log(\"Successfully loaded Sound into AudioAsset\");\n\t\t\t\t\tconsole.log(\"Loaded Sound: Name = \" + this_block.name);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(this_block.type==83){\n\t\t\t\tthis_block.loaded_dependencies[resourceDependency.sub_id]= resourceDependency.assets[0];\n\t\t\t\tthis_block.loaded_dependencies_cnt++;\n\t\t\t\tif(this_block.loaded_dependencies_cnt==6){\n\t\t\t\t\tif (this._debug) {\n\t\t\t\t\t\tconsole.log(\"Successfully loaded Bitmap \" + resourceDependency.sub_id + \" / 6 for Cubetexture\");\n\t\t\t\t\t}\n\n\t\t\t\t\tvar cube_image_asset = new BitmapImageCube(this_block.loaded_dependencies[0].width);\n\n\t\t\t\t\tfor (var i:number = 0; i < 6; i++)\n\t\t\t\t\t\tcube_image_asset.draw(i, this_block.loaded_dependencies[i]);\n\n\n\t\t\t\t\tvar cube_tex_asset = new SingleCubeTexture(cube_image_asset);\n\t\t\t\t\tthis_block.data = cube_tex_asset; // Store finished asset\n\t\t\t\t\tthis._pFinalizeAsset(<IAsset> cube_tex_asset, this_block.name);\n\t\t\t\t\tif (this._debug) {\n\t\t\t\t\t\tconsole.log(\"Parsed CubeTexture: Name = \" + this_block.name);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iResolveDependencyFailure(resourceDependency:ResourceDependency)\n\t{\n\t\t//\tnot used - if a dependcy fails, the awaiting Texture or CubeTexture will never be finalized, and the default-bitmaps will be used.\n\t\t// \tthis means, that if one Bitmap of a CubeTexture fails, the CubeTexture will have the DefaultTexture applied for all six Bitmaps.\n\t}\n\n\t/**\n\t * Resolve a dependency name\n\t *\n\t * @param resourceDependency The dependency to be resolved.\n\t */\n\tpublic _iResolveDependencyName(resourceDependency:ResourceDependency, asset:IAsset):string\n\t{\n\t\tvar oldName:string = asset.name;\n\n\t\tif (asset) {\n\t\t\tvar block:AWDBlock = this._awd_data.getBlockByID(parseInt(resourceDependency.id));\n\t\t\t// Reset name of texture to the one defined in the AWD file,\n\t\t\t// as opposed to whatever the image parser came up with.\n\t\t\tasset.resetAssetPath(block.name, null, true);\n\t\t}\n\n\t\tvar newName:string = asset.name;\n\n\t\tasset.name = oldName;\n\n\t\treturn newName;\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pProceedParsing():boolean\n\t{\n\n\t\tif (!this._startedParsing) {\n\t\t\tthis._byteData = this._pGetByteData();//getByteData();\n\t\t\tthis._startedParsing = true;\n\t\t}\n\n\t\tif (!this._parsed_header) {\n\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t// LITTLE_ENDIAN - Default for ArrayBuffer / Not implemented in ByteArray\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t//this._byteData.endian = Endian.LITTLE_ENDIAN;\n\t\t\t//----------------------------------------------------------------------------\n\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t// Parse header and decompress body if needed\n\t\t\tthis.parseHeader();\n\n\t\t\tswitch (this._compression) {\n\n\t\t\t\tcase AWD3Utils.DEFLATE:\n\t\t\t\tcase AWD3Utils.LZMA:\n\t\t\t\t\tthis._pDieWithError('Compressed AWD formats not yet supported');\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AWD3Utils.UNCOMPRESSED:\n\t\t\t\t\tthis._body = this._byteData;\n\t\t\t\t\tbreak;\n\n\t\t\t\t//----------------------------------------------------------------------------\n\t\t\t\t// Compressed AWD Formats not yet supported\n\t\t\t\t//----------------------------------------------------------------------------\n\n\t\t\t\t/*\n\t\t\t\t case AWD3Parserutils.DEFLATE:\n\n\t\t\t\t this._body = new ByteArray();\n\t\t\t\t this._byteData.readBytes(this._body, 0, this._byteData.getBytesAvailable());\n\t\t\t\t this._body.uncompress();\n\n\t\t\t\t break;\n\t\t\t\t case AWD3Parserutils.LZMA:\n\n\t\t\t\t this._body = new ByteArray();\n\t\t\t\t this._byteData.readBytes(this._body, 0, this._byteData.getBytesAvailable());\n\t\t\t\t this._body.uncompress(COMPRESSIONMODE_LZMA);\n\n\t\t\t\t break;\n\t\t\t\t //*/\n\n\t\t\t}\n\n\t\t\tthis._parsed_header = true;\n\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t// LITTLE_ENDIAN - Default for ArrayBuffer / Not implemented in ByteArray\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t//this._body.endian = Endian.LITTLE_ENDIAN;// Should be default\n\t\t\t//----------------------------------------------------------------------------\n\n\t\t}\n\n\t\tif (this._body) {\n\n\t\t\twhile (this._body.getBytesAvailable() > 0 && !this.parsingPaused) //&& this._pHasTime() )\n\t\t\t{\n\t\t\t\tthis.parseNextBlock();\n\n\t\t\t}\n\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t// Return complete status\n\t\t\tif (this._body.getBytesAvailable() == 0) {\n\t\t\t\tthis.dispose();\n\t\t\t\treturn  ParserBase.PARSING_DONE;\n\t\t\t} else {\n\t\t\t\treturn  ParserBase.MORE_TO_PARSE;\n\t\t\t}\n\t\t} else {\n\n\t\t\tswitch (this._compression) {\n\n\t\t\t\tcase AWD3Utils.DEFLATE:\n\t\t\t\tcase AWD3Utils.LZMA:\n\n\t\t\t\t\tif (this._debug) {\n\t\t\t\t\t\tconsole.log(\"(!) AWD3Utils Error: Compressed AWD formats not yet supported (!)\");\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t\t// Error - most likely _body not set because we do not support compression.\n\t\t\treturn  ParserBase.PARSING_DONE;\n\n\t\t}\n\n\t}\n\n\tpublic _pStartParsing(frameLimit:number)\n\t{\n\t\tsuper._pStartParsing(frameLimit);\n\n\t\t//create a content object for Loaders\n\t\tthis._pContent = new DisplayObjectContainer();\n\t}\n\n\tprivate dispose():void\n\t{\n\t\tthis._awd_data.dispose();\n\t}\n\n\tprivate parseNextBlock():void\n\t{\n\t\tvar block_id:number = this._body.readUnsignedInt();\n\n\t\tvar ns:number = this._body.readUnsignedByte();\n\t\tvar block_type:number = this._body.readUnsignedByte();\n\t\tvar flags:number = this._body.readUnsignedByte();\n\t\tvar len:number = this._body.readUnsignedInt();\n\n\t\tvar blockCompression:boolean = AWDBitFlags.test(flags, AWDBitFlags.FLAG4);\n\t\tvar blockCompressionLZMA:boolean = AWDBitFlags.test(flags, AWDBitFlags.FLAG5);\n\n\t\tif (this._awd_data.accuracyOnBlocks) {\n\t\t\tthis._awd_data.accuracyMatrix = AWDBitFlags.test(flags, AWDBitFlags.FLAG1);\n\t\t\tthis._awd_data.accuracyGeo = AWDBitFlags.test(flags, AWDBitFlags.FLAG2);\n\t\t\tthis._awd_data.accuracyProps = AWDBitFlags.test(flags, AWDBitFlags.FLAG3);\n\t\t\tthis._awd_data.geoNrType = AWD3Utils.FLOAT32;\n\n\t\t\tif (this._awd_data.accuracyGeo) {\n\t\t\t\tthis._awd_data.geoNrType = AWD3Utils.FLOAT64;\n\t\t\t}\n\n\t\t\tthis._awd_data.matrixNrType = AWD3Utils.FLOAT32;\n\n\t\t\tif (this._awd_data.accuracyMatrix) {\n\t\t\t\tthis._awd_data.matrixNrType = AWD3Utils.FLOAT64;\n\t\t\t}\n\n\t\t\tthis._awd_data.propsNrType = AWD3Utils.FLOAT32;\n\n\t\t\tif (this._awd_data.accuracyProps) {\n\t\t\t\tthis._awd_data.propsNrType = AWD3Utils.FLOAT64;\n\t\t\t}\n\t\t}\n\n\t\tvar blockEndAll:number = this._body.position + len;\n\n\t\tif (len > this._body.getBytesAvailable()) {\n\t\t\tthis._pDieWithError('AWD2 block length is bigger than the bytes that are available!');\n\t\t\tthis._body.position += this._body.getBytesAvailable();\n\t\t\treturn;\n\t\t}\n\n\t\tvar newBlockBytes:ByteArray = new ByteArray();\n\t\tthis._body.readBytes(newBlockBytes, 0, len);\n\t\tthis._awd_data.newBlockBytes = newBlockBytes;\n\n\t\t//----------------------------------------------------------------------------\n\t\t// Compressed AWD Formats not yet supported\n\n\t\tif (blockCompression) {\n\t\t\tthis._pDieWithError('Compressed AWD formats not yet supported');\n\n\t\t\t/*\n\t\t\t if (blockCompressionLZMA)\n\t\t\t {\n\t\t\t this._newBlockBytes.uncompress(AWD3Parserutils.COMPRESSIONMODE_LZMA);\n\t\t\t }\n\t\t\t else\n\t\t\t {\n\t\t\t this._newBlockBytes.uncompress();\n\t\t\t }\n\t\t\t */\n\n\t\t}\n\n\t\t//----------------------------------------------------------------------------\n\t\t// LITTLE_ENDIAN - Default for ArrayBuffer / Not implemented in ByteArray\n\t\t//----------------------------------------------------------------------------\n\t\t//this._newBlockBytes.endian = Endian.LITTLE_ENDIAN;\n\t\t//----------------------------------------------------------------------------\n\n\t\tthis._awd_data.newBlockBytes.position = 0;\n\n\t\t// we create AWDBlock for all exept the metadata. the metadata block has is the first awdblock in the list by default.\n\t\t//if(block_type!=255)\n\t\tthis._awd_data.create_new_block(block_type, block_id);\n\n\n\t\tif (blockCompression) {\n\t\t\tthis._pDieWithError('Compressed AWD formats not yet supported');\n\t\t\t//blockEndBlock   = this._newBlockBytes.position + this._newBlockBytes.length;\n\t\t\t//block.len       = blockEndBlock;\n\t\t}\n\n\t\t//if (this._debug) {\n\t\t\tconsole.log(\"AWDBlock:  ID = \" + block_id + \" | TypeID = \" + block_type + \" | Compression = \" + blockCompression + \" | Matrix-Precision = \" + this._awd_data.accuracyMatrix + \" | Geometry-Precision = \" + this._awd_data.accuracyGeo + \" | Properties-Precision = \" + this._awd_data.accuracyProps);\n\t\t//}\n\n\t\tvar time_start = performance.now();\n\n\t\t// first check if the block is any of the 3 blocks that does not produce a asset.\n\t\t\t// this block contains a asset.\n\t\tif(this._block_parser.parseAsset(block_type)){\n\t\t\tif(this._awd_data.cur_block.state==AWD3Utils.BLOCKSTATE_FINALIZE){\n\t\t\t\tthis._pFinalizeAsset(<IAsset>this._awd_data.cur_block.data, this._awd_data.cur_block.name);\n\t\t\t\tif(this._awd_data.cur_block.data instanceof DisplayObject){\n\t\t\t\t\tif((<DisplayObjectContainer> this._awd_data.cur_block.data).parent==undefined){\n\t\t\t\t\t\t(<DisplayObjectContainer> this._pContent).addChild((<DisplayObjectContainer> this._awd_data.cur_block.data));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(this._awd_data.cur_block.state==AWD3Utils.BLOCKSTATE_INVALID){\n\t\t\t\tconsole.log(\"ERROR while parsing block - type = \", block_type, \" id = \", block_id);\n\t\t\t}\n\t\t\telse if(this._awd_data.cur_block.state==AWD3Utils.BLOCKSTATE_LOAD_DEPENDENICES){\n\t\t\t\t// trigger No asset created yet, because the block has dependencies. load the dependencies:.\n\t\t\t\tfor(var r:number=0; r<this._awd_data.cur_block.dependencies_urls.length;r++){\n\t\t\t\t\t// load dependencies by url. let the parser system decide how to parse it\n\t\t\t\t\tthis._pAddDependency(this._awd_data.cur_block.id.toString(), new URLRequest(this._awd_data.cur_block.dependencies_urls[r]), false, null, true, r);\n\t\t\t\t}\n\t\t\t\tfor(var r:number=0; r<this._awd_data.cur_block.dependencies_data.length;r++) {\n\t\t\t\t\t// load dependencies from data. need to prepare the data based on block_type (image vs audio).\n\t\t\t\t\tif ((block_type == 82) || (block_type == 83)) {\n\t\t\t\t\t\tthis._pAddDependency(this._awd_data.cur_block.id.toString(), null, false, ParserUtils.byteArrayToImage(this._awd_data.cur_block.dependencies_data[r]), true, r);\n\t\t\t\t\t}\n\t\t\t\t\telse if (block_type == 44) {\n\t\t\t\t\t\t// todo: parse audio data\n\t\t\t\t\t\t// this._pAddDependency(this._awd_data.cur_block.id.toString(), null, false, this._awd_data.cur_block.dependencies_data[r], true, r);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._pPauseAndRetrieveDependencies();\n\t\t\t}\n\t\t\telse if(this._awd_data.cur_block.state==AWD3Utils.BLOCKSTATE_NO_ASSET){\n\t\t\t\t// this block does not produce any asset (metadata, namespace, command)\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tconsole.log(\"Encountered unknown blocktype - type = \", block_type, \" id = \", block_id);\n\t\t}\n\n\t\tvar time_end = performance.now();\n\t\tvar thisTime:number=time_end-time_start;\n\t\tthis.total_time+=thisTime;\n\t\tif(block_type==1){\n\t\t\tthis.geom_time+=thisTime;\n\t\t}\n\t\telse if(block_type==133){\n\t\t\tthis.timeline_time+=thisTime;\n\t\t}\n\t\tconsole.log(\"'parsed '\"+block_type+\"'  block in \"+thisTime+ \" ms\", \" total: \",this.total_time,\" geom: \",this.geom_time,\"timelines:\",this.timeline_time);\n\n\t\tthis._body.position = blockEndAll;\n\t\tthis._awd_data.newBlockBytes = null;\n\n\t}\n\n\n\n\n\tprivate parseHeader():void\n\t{\n\t\tvar flags:number;\n\t\tvar body_len:number;\n\n\t\tthis._byteData.position = 3; // Skip magic string and parse version\n\n\t\tthis._awd_data.major_version = this._byteData.readUnsignedByte();\n\t\tthis._awd_data.minor_version = this._byteData.readUnsignedByte();\n\n\t\tflags = this._byteData.readUnsignedShort(); // Parse bit flags\n\n\t\tthis._streaming = AWDBitFlags.test(flags, AWDBitFlags.FLAG1);\n\n\t\tif ((this._awd_data.major_version == 2) && (this._awd_data.minor_version == 1)) {\n\t\t\tthis._awd_data.accuracyMatrix = AWDBitFlags.test(flags, AWDBitFlags.FLAG2);\n\t\t\tthis._awd_data.accuracyGeo = AWDBitFlags.test(flags, AWDBitFlags.FLAG3);\n\t\t\tthis._awd_data.accuracyProps = AWDBitFlags.test(flags, AWDBitFlags.FLAG4);\n\t\t}\n\n\t\t// if we set _accuracyOnBlocks, the precision-values are read from each block-header.\n\n\t\t// set storagePrecision types\n\t\tthis._awd_data.geoNrType = AWD3Utils.FLOAT32;\n\n\t\tif (this._awd_data.accuracyGeo) {\n\t\t\tthis._awd_data.geoNrType = AWD3Utils.FLOAT64;\n\t\t}\n\n\t\tthis._awd_data.matrixNrType = AWD3Utils.FLOAT32;\n\n\t\tif (this._awd_data.accuracyMatrix) {\n\t\t\tthis._awd_data.matrixNrType = AWD3Utils.FLOAT64;\n\t\t}\n\n\t\tthis._awd_data.propsNrType = AWD3Utils.FLOAT32;\n\n\t\tif (this._awd_data.accuracyProps) {\n\t\t\tthis._awd_data.propsNrType = AWD3Utils.FLOAT64;\n\t\t}\n\n\t\tthis._compression = this._byteData.readUnsignedByte(); // compression\n\n\t\tif (this._debug) {\n\t\t\tconsole.log(\"Import AWDFile of version = \" + this._awd_data.major_version + \" - \" + this._awd_data.minor_version );\n\t\t\tconsole.log(\"Global Settings = Compression = \" + this._compression + \" | Streaming = \" + this._streaming + \" | Matrix-Precision = \" + this._awd_data.accuracyMatrix + \" | Geometry-Precision = \" + this._awd_data.accuracyGeo + \" | Properties-Precision = \" + this._awd_data.accuracyProps);\n\t\t}\n\n\t\t// Check file integrity\n\t\tbody_len = this._byteData.readUnsignedInt();\n\t\tif (!this._streaming && body_len != this._byteData.getBytesAvailable()) {\n\t\t\tthis._pDieWithError('AWD2 body length does not match header integrity field');\n\t\t}\n\t}\n}\n\nexport = AWD3Parser;\n\n",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Short3Attributes\t\t\t\t\t= require(\"awayjs-core/lib/attributes/Short3Attributes\");\nimport Float3Attributes\t\t\t\t\t= require(\"awayjs-core/lib/attributes/Float3Attributes\");\nimport Float2Attributes\t\t\t\t\t= require(\"awayjs-core/lib/attributes/Float2Attributes\");\nimport BitmapImage2D\t\t\t\t\t= require(\"awayjs-core/lib/image/BitmapImage2D\");\nimport BitmapImageCube\t\t\t\t\t= require(\"awayjs-core/lib/image/BitmapImageCube\");\nimport BlendMode\t\t\t\t\t\t= require(\"awayjs-core/lib/image/BlendMode\");\nimport Sampler2D\t\t\t\t\t\t= require(\"awayjs-core/lib/image/Sampler2D\");\nimport WaveAudio\t\t\t\t\t\t= require(\"awayjs-core/lib/audio/WaveAudio\");\nimport ColorTransform\t\t\t\t\t= require(\"awayjs-core/lib/geom/ColorTransform\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport URLLoaderDataFormat\t\t\t\t= require(\"awayjs-core/lib/net/URLLoaderDataFormat\");\nimport URLRequest\t\t\t\t\t\t= require(\"awayjs-core/lib/net/URLRequest\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport ParserBase\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserBase\");\nimport ParserUtils\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserUtils\");\nimport ResourceDependency\t\t\t\t= require(\"awayjs-core/lib/parsers/ResourceDependency\");\nimport ProjectionBase\t\t\t\t\t= require(\"awayjs-core/lib/projections/ProjectionBase\");\nimport PerspectiveProjection\t\t\t= require(\"awayjs-core/lib/projections/PerspectiveProjection\");\nimport OrthographicProjection\t\t\t= require(\"awayjs-core/lib/projections/OrthographicProjection\");\nimport OrthographicOffCenterProjection\t= require(\"awayjs-core/lib/projections/OrthographicOffCenterProjection\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\nimport Point\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Point\");\n\nimport AnimationNodeBase\t\t\t\t= require(\"awayjs-display/lib/animators/nodes/AnimationNodeBase\");\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport View\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/containers/View\");\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport LightBase\t\t\t\t\t\t= require(\"awayjs-display/lib/base/LightBase\");\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport SubGeometryBase\t\t\t\t\t= require(\"awayjs-display/lib/base/SubGeometryBase\");\nimport CurveSubGeometry\t\t\t\t\t= require(\"awayjs-display/lib/base/CurveSubGeometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport DirectionalLight\t\t\t\t\t= require(\"awayjs-display/lib/entities/DirectionalLight\");\nimport PointLight\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/PointLight\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport TextField\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/TextField\");\nimport Billboard\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Billboard\");\nimport Skybox\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Skybox\");\nimport DefaultMaterialManager\t\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport LightPickerBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/LightPickerBase\");\nimport StaticLightPicker\t\t\t\t= require(\"awayjs-display/lib/materials/lightpickers/StaticLightPicker\");\nimport CubeMapShadowMapper\t\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/CubeMapShadowMapper\");\nimport DirectionalShadowMapper\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/DirectionalShadowMapper\");\nimport ShadowMapperBase\t\t\t\t\t= require(\"awayjs-display/lib/materials/shadowmappers/ShadowMapperBase\");\n\nimport PrefabBase\t\t\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrefabBase\");\nimport PrimitivePrefabBase\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitivePrefabBase\");\nimport PrimitiveCapsulePrefab\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveCapsulePrefab\");\nimport PrimitiveConePrefab\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveConePrefab\");\nimport PrimitiveCubePrefab\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveCubePrefab\");\nimport PrimitiveCylinderPrefab\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveCylinderPrefab\");\nimport PrimitivePlanePrefab\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitivePlanePrefab\");\nimport PrimitiveSpherePrefab\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveSpherePrefab\");\nimport PrimitiveTorusPrefab\t\t\t\t= require(\"awayjs-display/lib/prefabs/PrimitiveTorusPrefab\");\nimport SingleCubeTexture\t\t\t\t= require(\"awayjs-display/lib/textures/SingleCubeTexture\");\nimport Single2DTexture\t\t\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\nimport TextureBase\t\t\t\t\t\t= require(\"awayjs-display/lib/textures/TextureBase\");\n\nimport AnimationSetBase\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimationSetBase\");\nimport AnimatorBase\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/AnimatorBase\");\nimport VertexAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimationSet\");\nimport VertexAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimator\");\nimport SkeletonAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimationSet\");\nimport SkeletonAnimator\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimator\");\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonJoint\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonJoint\");\nimport SkeletonClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode\");\nimport VertexClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/VertexClipNode\");\nimport AnimationClipNodeBase\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/AnimationClipNodeBase\");\n\nimport MethodMaterialMode\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterialMode\");\nimport MethodMaterial\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterial\");\nimport AmbientEnvMapMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/AmbientEnvMapMethod\");\nimport DiffuseDepthMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/DiffuseDepthMethod\");\nimport DiffuseCelMethod\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/DiffuseCelMethod\");\nimport DiffuseGradientMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/DiffuseGradientMethod\");\nimport DiffuseLightMapMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/DiffuseLightMapMethod\");\nimport DiffuseWrapMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/DiffuseWrapMethod\");\nimport EffectAlphaMaskMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectAlphaMaskMethod\");\nimport EffectColorMatrixMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectColorMatrixMethod\");\nimport EffectColorTransformMethod\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectColorTransformMethod\");\nimport EffectEnvMapMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectEnvMapMethod\");\nimport EffectFogMethod\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectFogMethod\");\nimport EffectFresnelEnvMapMethod\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectFresnelEnvMapMethod\");\nimport EffectLightMapMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectLightMapMethod\");\nimport EffectMethodBase\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectMethodBase\");\nimport EffectRimLightMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/EffectRimLightMethod\");\nimport NormalSimpleWaterMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/NormalSimpleWaterMethod\");\nimport ShadowDitheredMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowDitheredMethod\");\nimport ShadowFilteredMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowFilteredMethod\");\nimport ShadowMapMethodBase\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowMapMethodBase\");\nimport ShadowMethodBase\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowMethodBase\");\nimport SpecularFresnelMethod\t\t\t= require(\"awayjs-methodmaterials/lib/methods/SpecularFresnelMethod\");\nimport ShadowHardMethod\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowHardMethod\");\nimport SpecularAnisotropicMethod\t\t= require(\"awayjs-methodmaterials/lib/methods/SpecularAnisotropicMethod\");\nimport SpecularCelMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/SpecularCelMethod\");\nimport SpecularPhongMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/SpecularPhongMethod\");\nimport ShadowNearMethod\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowNearMethod\");\nimport ShadowSoftMethod\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/ShadowSoftMethod\");\n\nimport BasicMaterial\t\t\t\t\t= require(\"awayjs-display/lib/materials/BasicMaterial\");\n\nimport ITimelineSceneGraphFactory \t= require(\"awayjs-display/lib/factories/ITimelineSceneGraphFactory\");\nimport AS2SceneGraphFactory \t\t= require(\"awayjs-player/lib/factories/AS2SceneGraphFactory\");\nimport MovieClip \t\t\t\t\t= require(\"awayjs-display/lib/entities/MovieClip\");\nimport Timeline\t\t\t \t\t\t= require(\"awayjs-display/lib/base/Timeline\");\n\n\nimport AssetLibrary\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/AssetLibrary\");\n\nimport Font\t\t\t\t\t\t\t= require(\"awayjs-display/lib/text/Font\");\nimport TesselatedFontTable\t\t\t= require(\"awayjs-display/lib/text/TesselatedFontTable\");\nimport TextFormat\t\t\t= require(\"awayjs-display/lib/text/TextFormat\");\nimport TextFieldType\t\t\t= require(\"awayjs-display/lib/text/TextFieldType\");\n\nimport AWDBlock\t\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWD3ParserUtils/AWDBlock\");\nimport Rectangle = require(\"awayjs-core/lib/geom/Rectangle\");\nimport Style = require(\"awayjs-display/lib/base/Style\");\nimport Matrix = require(\"awayjs-core/lib/geom/Matrix\");\n/**\n * AWDParser provides a parser for the AWD data type.\n */\nclass AWDParser extends ParserBase\n{\n\tprivate _view:View;\n\n\t//set to \"true\" to have some console.logs in the Console\n\tprivate _debug:boolean = false;\n\tprivate _debugTimers:boolean = true;\n\tprivate _byteData:ByteArray;\n\tprivate _startedParsing:boolean = false;\n\tprivate _cur_block_id:number;\n\tprivate _blocks:Array<AWDBlock>;\n\tprivate _newBlockBytes:ByteArray;\n\tprivate _version:Array<number>;\n\tprivate _compression:number;\n\tprivate _accuracyOnBlocks:boolean;\n\tprivate _accuracyMatrix:boolean;\n\tprivate _accuracyGeo:boolean;\n\tprivate _accuracyProps:boolean;\n\tprivate _streaming:boolean;\n\tprivate _texture_users:Object = {};\n\tprivate _parsed_header:boolean = false;\n\tprivate _body:ByteArray;\n\n\n\tpublic static COMPRESSIONMODE_LZMA:string = \"lzma\";\n\tpublic static UNCOMPRESSED:number = 0;\n\tpublic static DEFLATE:number = 1;\n\tpublic static LZMA:number = 2;\n\tpublic static INT8:number = 1;\n\tpublic static INT16:number = 2;\n\tpublic static INT32:number = 3;\n\tpublic static UINT8:number = 4;\n\tpublic static UINT16:number = 5;\n\tpublic static UINT32:number = 6;\n\tpublic static FLOAT32:number = 7;\n\tpublic static FLOAT64:number = 8;\n\tpublic static BOOL:number = 21;\n\tpublic static COLOR:number = 22;\n\tpublic static BADDR:number = 23;\n\tpublic static AWDSTRING:number = 31;\n\tpublic static AWDBYTEARRAY:number = 32;\n\tpublic static VECTOR2x1:number = 41;\n\tpublic static VECTOR3x1:number = 42;\n\tpublic static VECTOR4x1:number = 43;\n\tpublic static MTX3x2:number = 44;\n\tpublic static MTX3x3:number = 45;\n\tpublic static MTX4x3:number = 46;\n\tpublic static MTX4x4:number = 47;\n\tpublic static GEO_NUMBER:number = 48;\n\tpublic static MATRIX_NUMBER:number = 49;\n\tpublic static PROPERTY_NUMBER:number = 50;\n\t\n\n\tprivate blendModeDic:Array<string>;\n\tprivate _depthSizeDic:Array<number>;\n\n\tprivate start_timeing:number;\n\tprivate _time_all:number=0;\n\tprivate _time_geom:number=0;\n\tprivate _time_geom_bytes:number=0;\n\tprivate _time_timeline:number=0;\n\tprivate _time_fonts:number=0;\n\tprivate _time_textfields:number=0;\n\tprivate _time_sounds:number=0;\n\tprivate _time_textures:number=0;\n\tprivate _time_materials:number=0;\n\tprivate _time_meshes:number=0;\n\tprivate _num_geom:number=0;\n\tprivate _num_timeline:number=0;\n\tprivate _num_fonts:number=0;\n\tprivate _num_textfields:number=0;\n\tprivate _num_sounds:number=0;\n\tprivate _num_textures:number=0;\n\tprivate _num_materials:number=0;\n\tprivate _num_meshes:number=0;\n\n\n\t/**\n\t * Creates a new AWD3Parserutils object.\n\t * @param uri The url or id of the data or file to be parsed.\n\t * @param extra The holder for extra contextual data that the parser might need.\n\t */\n\tconstructor(view:View = null)\n\t{\n\t\tsuper(URLLoaderDataFormat.ARRAY_BUFFER);\n\n\t\tthis._view = view;\n\t\tthis._blocks = new Array<AWDBlock>();\n\t\tthis._blocks[0] = new AWDBlock(0,255);\n\t\tthis._blocks[0].data = null; // Zero address means null in AWD\n\n\t\tthis.blendModeDic = new Array<string>(); // used to translate ints to blendMode-strings\n\t\tthis.blendModeDic.push(BlendMode.NORMAL);\n\t\tthis.blendModeDic.push(BlendMode.ADD);\n\t\tthis.blendModeDic.push(BlendMode.ALPHA);\n\t\tthis.blendModeDic.push(BlendMode.DARKEN);\n\t\tthis.blendModeDic.push(BlendMode.DIFFERENCE);\n\t\tthis.blendModeDic.push(BlendMode.ERASE);\n\t\tthis.blendModeDic.push(BlendMode.HARDLIGHT);\n\t\tthis.blendModeDic.push(BlendMode.INVERT);\n\t\tthis.blendModeDic.push(BlendMode.LAYER);\n\t\tthis.blendModeDic.push(BlendMode.LIGHTEN);\n\t\tthis.blendModeDic.push(BlendMode.MULTIPLY);\n\t\tthis.blendModeDic.push(BlendMode.NORMAL);\n\t\tthis.blendModeDic.push(BlendMode.OVERLAY);\n\t\tthis.blendModeDic.push(BlendMode.SCREEN);\n\t\tthis.blendModeDic.push(BlendMode.SHADER);\n\t\tthis.blendModeDic.push(BlendMode.OVERLAY);\n\n\t\tthis._depthSizeDic = new Array<number>(); // used to translate ints to depthSize-values\n\t\tthis._depthSizeDic.push(256);\n\t\tthis._depthSizeDic.push(512);\n\t\tthis._depthSizeDic.push(2048);\n\t\tthis._depthSizeDic.push(1024);\n\t\tthis._version = Array<number>(); // will contain 2 int (major-version, minor-version) for awd-version-check\n\t}\n\n\t/**\n\t * Indicates whether or not a given file extension is supported by the parser.\n\t * @param extension The file extension of a potential file to be parsed.\n\t * @return Whether or not the given file type is supported.\n\t */\n\tpublic static supportsType(extension:string):boolean\n\t{\n\t\textension = extension.toLowerCase();\n\t\treturn extension == \"awd\";\n\t}\n\n\t/**\n\t * Tests whether a data block can be parsed by the parser.\n\t * @param data The data block to potentially be parsed.\n\t * @return Whether or not the given data is supported.\n\t */\n\tpublic static supportsData(data:any):boolean\n\t{\n\t\treturn (ParserUtils.toString(data, 3) == 'AWD');\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iResolveDependency(resourceDependency:ResourceDependency)\n\t{\n\t\t// this will be called when Dependency has finished loading.\n\t\t// the ressource dependecniy has a id that point to the awd_block waiting for it.\n\t\t//console.log(\"AWDParser resolve dependencies\");\n\t\tif (resourceDependency.assets.length == 1) {\n\t\t\tvar this_block:AWDBlock = this._blocks[parseInt(resourceDependency.id)];\n\t\t\tif(this_block.type==82){\n\t\t\t\tvar texture_asset:Single2DTexture = new Single2DTexture(<BitmapImage2D> resourceDependency.assets[0]);\n\t\t\t\tthis_block.data = texture_asset; // Store finished asset\n\t\t\t\t// Finalize texture asset to dispatch texture event, which was\n\t\t\t\t// previously suppressed while the dependency was loaded.\n\t\t\t\tthis._pFinalizeAsset(<IAsset> texture_asset, this_block.name);\n\n\t\t\t\tif (this._debug)\n\t\t\t\t\tconsole.log(\"Parsed Texture: Name = \" + this_block.name);\n\t\t\t}\n\t\t\telse if(this_block.type==44){\n\t\t\t\tvar audio_asset:WaveAudio = <WaveAudio> resourceDependency.assets[0];\n\t\t\t\tthis_block.data = audio_asset; // Store finished asset\n\t\t\t\t// Finalize texture asset to dispatch texture event, which was\n\t\t\t\t// previously suppressed while the dependency was loaded.\n\t\t\t\t//console.log(\"Parsing audio \" + this_block.name);\n\t\t\t\tthis._pFinalizeAsset(<IAsset> audio_asset, this_block.name);\n\n\t\t\t\tif (this._debug)\n\t\t\t\t\tconsole.log(\"Parsed WaveAudio: Name = \" + this_block.name);\n\t\t\t}\n\t\t\telse if(this_block.type==83){\n\t\t\t\tthis_block.loaded_dependencies[resourceDependency.sub_id]= resourceDependency.assets[0];\n\t\t\t\tthis_block.loaded_dependencies_cnt++;\n\n\t\t\t\tif (this._debug)\n\t\t\t\t\tconsole.log(\"Successfully loaded Bitmap \" + resourceDependency.sub_id + \" / 6 for Cubetexture\");\n\n\t\t\t\tif(this_block.loaded_dependencies_cnt==6){\n\t\t\t\t\tvar cube_image_asset = new BitmapImageCube(this_block.loaded_dependencies[0].width);\n\n\t\t\t\t\tfor (var i:number = 0; i < 6; i++)\n\t\t\t\t\t\tcube_image_asset.draw(i, this_block.loaded_dependencies[i]);\n\n\t\t\t\t\tvar cube_tex_asset = new SingleCubeTexture(cube_image_asset);\n\t\t\t\t\tthis_block.data = cube_tex_asset; // Store finished asset\n\t\t\t\t\tthis._pFinalizeAsset(<IAsset> cube_tex_asset, this_block.name);\n\n\t\t\t\t\tif (this._debug)\n\t\t\t\t\t\tconsole.log(\"Parsed CubeTexture: Name = \" + this_block.name);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this._debugTimers && !this._isParsing)\n\t\t\t\tthis.updateTimers(this_block.type);\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iResolveDependencyFailure(resourceDependency:ResourceDependency)\n\t{\n\t\t//not used - if a dependcy fails, the awaiting Texture or CubeTexture will never be finalized, and the default-bitmaps will be used.\n\t\t// this means, that if one Bitmap of a CubeTexture fails, the CubeTexture will have the DefaultTexture applied for all six Bitmaps.\n\t}\n\n\t/**\n\t * Resolve a dependency name\n\t *\n\t * @param resourceDependency The dependency to be resolved.\n\t */\n\tpublic _iResolveDependencyName(resourceDependency:ResourceDependency, asset:IAsset):string\n\t{\n\t\tvar oldName:string = asset.name;\n\n\t\tif (asset) {\n\t\t\tvar block:AWDBlock = this._blocks[parseInt(resourceDependency.id)];\n\t\t\t// Reset name of texture to the one defined in the AWD file,\n\t\t\t// as opposed to whatever the image parser came up with.\n\t\t\tasset.resetAssetPath(block.name, null, true);\n\t\t}\n\n\t\tvar newName:string = asset.name;\n\n\t\tasset.name = oldName;\n\n\t\treturn newName;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pProceedParsing():boolean\n\t{\n\t\tif (!this._startedParsing) {\n\t\t\tthis._byteData = this._pGetByteData();//getByteData();\n\t\t\tthis._startedParsing = true;\n\t\t}\n\n\t\tif (!this._parsed_header) {\n\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t// LITTLE_ENDIAN - Default for ArrayBuffer / Not implemented in ByteArray\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t//this._byteData.endian = Endian.LITTLE_ENDIAN;\n\t\t\t//----------------------------------------------------------------------------\n\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t// Parse header and decompress body if needed\n\t\t\tthis.parseHeader();\n\n\t\t\tswitch (this._compression) {\n\t\t\t\tcase AWDParser.DEFLATE:\n\t\t\t\tcase AWDParser.LZMA:\n\t\t\t\t\tthis._pDieWithError('Compressed AWD formats not yet supported');\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase AWDParser.UNCOMPRESSED:\n\t\t\t\t\tthis._body = this._byteData;\n\t\t\t\t\tbreak;\n\n\t\t\t\t//----------------------------------------------------------------------------\n\t\t\t\t// Compressed AWD Formats not yet supported\n\t\t\t\t//----------------------------------------------------------------------------\n\n\t\t\t\t/*\n\t\t\t\t case AWD3Parserutils.DEFLATE:\n\n\t\t\t\t this._body = new ByteArray();\n\t\t\t\t this._byteData.readBytes(this._body, 0, this._byteData.getBytesAvailable());\n\t\t\t\t this._body.uncompress();\n\n\t\t\t\t break;\n\t\t\t\t case AWD3Parserutils.LZMA:\n\n\t\t\t\t this._body = new ByteArray();\n\t\t\t\t this._byteData.readBytes(this._body, 0, this._byteData.getBytesAvailable());\n\t\t\t\t this._body.uncompress(COMPRESSIONMODE_LZMA);\n\n\t\t\t\t break;\n\t\t\t\t //*/\n\n\t\t\t}\n\n\t\t\tthis._parsed_header = true;\n\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t// LITTLE_ENDIAN - Default for ArrayBuffer / Not implemented in ByteArray\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t//this._body.endian = Endian.LITTLE_ENDIAN;// Should be default\n\t\t\t//----------------------------------------------------------------------------\n\n\t\t}\n\n\t\tif (this._body) {\n\t\t\twhile (this._body.getBytesAvailable() > 0 && !this.parsingPaused) //&& this._pHasTime() )\n\t\t\t\tthis.parseNextBlock();\n\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t// Return complete status\n\t\t\tif (this._body.getBytesAvailable() == 0) {\n\t\t\t\tthis.dispose();\n\n\t\t\t\tif (this._debugTimers)\n\t\t\t\t\tconsole.log(\"Parsing total: \"+(this._time_all | 0)+\"ms\",\n\t\t\t\t\t\t\" | geoms: \"+this._num_geom+\", \"+(this._time_geom | 0)+\"ms\",\n\t\t\t\t\t\t\" | geoms bytes: \"+this._num_geom+\", \"+(this._time_geom_bytes | 0)+\"ms\",\n\t\t\t\t\t\t\" | timelines: \"+this._num_timeline+\", \"+(this._time_timeline | 0)+\"ms\",\n\t\t\t\t\t\t\" | fonts: \"+this._num_fonts+\", \"+(this._time_fonts | 0)+\"ms\",\n\t\t\t\t\t\t\" | sounds: \"+this._num_sounds+\", \"+(this._time_sounds | 0)+\"ms\",\n\t\t\t\t\t\t\" | mats: \"+this._num_materials+\", \"+(this._time_materials | 0)+\"ms\",\n\t\t\t\t\t\t\" | textures: \"+this._num_textures+\", \"+(this._time_textures | 0)+\"ms\",\n\t\t\t\t\t\t\" | meshes: \"+this._num_meshes+\", \"+(this._time_meshes | 0)+\"ms\");\n\n\t\t\t\treturn  ParserBase.PARSING_DONE;\n\t\t\t} else {\n\t\t\t\treturn  ParserBase.MORE_TO_PARSE;\n\t\t\t}\n\t\t} else {\n\n\t\t\tswitch (this._compression) {\n\t\t\t\tcase AWDParser.DEFLATE:\n\t\t\t\tcase AWDParser.LZMA:\n\t\t\t\t\tif (this._debug)\n\t\t\t\t\t\tconsole.log(\"(!) AWDParser Error: Compressed AWD formats not yet supported (!)\");\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t// Error - most likely _body not set because we do not support compression.\n\t\t\treturn  ParserBase.PARSING_DONE;\n\t\t}\n\t}\n\n\tpublic _pStartParsing(frameLimit:number)\n\t{\n\t\t//create a content object for Loaders\n\t\tthis._pContent = new DisplayObjectContainer();\n\n\t\tsuper._pStartParsing(frameLimit);\n\t}\n\n\tprivate dispose()\n\t{\n\t\tfor (var c in this._blocks) {\n\t\t\tvar b:AWDBlock = <AWDBlock> this._blocks[c];\n\t\t\tb.dispose();\n\t\t}\n\t}\n\n\tprivate parseNextBlock()\n\t{\n\t\tvar block:AWDBlock;\n\t\tvar isParsed:boolean = false;\n\t\tvar ns:number;\n\t\tvar type:number;\n\t\tvar flags:number;\n\t\tvar len:number;\n//*\n\t\tif (this._debugTimers)\n\t\t\tthis.start_timeing = performance.now();\n//*/\n\t\tthis._cur_block_id = this._body.readUnsignedInt();\n\n\t\tns = this._body.readUnsignedByte();\n\t\ttype = this._body.readUnsignedByte();\n\t\tflags = this._body.readUnsignedByte();\n\t\tlen = this._body.readUnsignedInt();\n\n\t\tvar blockCompression:boolean = BitFlags.test(flags, BitFlags.FLAG4);\n\t\tvar blockCompressionLZMA:boolean = BitFlags.test(flags, BitFlags.FLAG5);\n\n\t\tif (this._accuracyOnBlocks) {\n\t\t\tthis._accuracyMatrix = BitFlags.test(flags, BitFlags.FLAG1);\n\t\t\tthis._accuracyGeo = BitFlags.test(flags, BitFlags.FLAG2);\n\t\t\tthis._accuracyProps = BitFlags.test(flags, BitFlags.FLAG3);\n\t\t}\n\n\t\tvar blockEndAll:number = this._body.position + len;\n\n\t\tif (len > this._body.getBytesAvailable()) {\n\t\t\tthis._pDieWithError('AWD2 block length is bigger than the bytes that are available!');\n\t\t\tthis._body.position += this._body.getBytesAvailable();\n\t\t\treturn;\n\t\t}\n\n\t\t//----------------------------------------------------------------------------\n\t\t// Compressed AWD Formats not yet supported\n\n\t\tif (blockCompression) {\n\t\t\tthis._pDieWithError('Compressed AWD formats not yet supported');\n\t\t\tthis._newBlockBytes = new ByteArray();\n\t\t\tthis._body.readBytes(this._newBlockBytes, 0, len);\n\t\t\tthis._newBlockBytes.position = 0;\n\t\t\t/*\n\t\t\t if (blockCompressionLZMA)\n\t\t\t {\n\t\t\t this._newBlockBytes.uncompress(AWD3Parserutils.COMPRESSIONMODE_LZMA);\n\t\t\t }\n\t\t\t else\n\t\t\t {\n\t\t\t this._newBlockBytes.uncompress();\n\t\t\t }\n\t\t\t */\n\n\t\t} else {\n\t\t\tthis._newBlockBytes = this._body;\n\t\t}\n\n\t\t//----------------------------------------------------------------------------\n\t\t// LITTLE_ENDIAN - Default for ArrayBuffer / Not implemented in ByteArray\n\t\t//----------------------------------------------------------------------------\n\t\t//this._newBlockBytes.endian = Endian.LITTLE_ENDIAN;\n\t\t//----------------------------------------------------------------------------\n\n\t\tblock = new AWDBlock(this._cur_block_id, type);\n\t\tblock.len = len;\n\t\tvar blockEndBlock:number = this._newBlockBytes.position + len;\n\n\t\tif (blockCompression) {\n\t\t\tthis._pDieWithError('Compressed AWD formats not yet supported');\n\t\t\t//blockEndBlock   = this._newBlockBytes.position + this._newBlockBytes.length;\n\t\t\t//block.len       = blockEndBlock;\n\t\t}\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"AWDBlock:  ID = \" + this._cur_block_id + \" | TypeID = \" + type + \" | Compression = \" + blockCompression + \" | Matrix-Precision = \" + this._accuracyMatrix + \" | Geometry-Precision = \" + this._accuracyGeo + \" | Properties-Precision = \" + this._accuracyProps);\n\n\t\tthis._blocks[this._cur_block_id] = block;\n\n\t\tif ((this._version[0] == 3) && (this._version[1] == 0)) {\n\t\t\t// probably should contain some info about the type of animation\n\t\t\tvar factory = new AS2SceneGraphFactory(this._view);\n\n\t\t\tswitch (type) {\n\t\t\t\tcase 24:\n\t\t\t\t\tthis.parseMeshLibraryBlock(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 25:\n\t\t\t\t\tthis.parseBillBoardLibraryBlock(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4444:\n\t\t\t\t\tthis.parseAudioBlock(this._cur_block_id, factory);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 133:\n\t\t\t\t\tthis.parseTimeLine(this._cur_block_id, factory);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 134:\n\t\t\t\t\tthis.paresTextField(this._cur_block_id, factory);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 135:\n\t\t\t\t\tthis.parseTesselatedFont(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 136:\n\t\t\t\t\tthis.parseTextFormat(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif ((this._version[0] > 2)||((this._version[0] >= 2) && (this._version[1] >= 1))) {\n\t\t\tswitch (type) {\n\t\t\t\tcase 11:\n\t\t\t\t\tthis.parsePrimitves(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 31:\n\t\t\t\t\tthis.parseSkyboxInstance(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 41:\n\t\t\t\t\tthis.parseLight(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 42:\n\t\t\t\t\tthis.parseCamera(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\t//  case 43:\n\t\t\t\t//      parseTextureProjector(_cur_block_id);\n\t\t\t\t//      isParsed = true;\n\t\t\t\t//      break;\n\n\t\t\t\tcase 51:\n\t\t\t\t\tthis.parseLightPicker(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 81:\n\t\t\t\t\tthis.parseMaterial_v1(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 83:\n\t\t\t\t\tthis.parseCubeTexture(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 91:\n\t\t\t\t\tthis.parseSharedMethodBlock(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 92:\n\t\t\t\t\tthis.parseShadowMethodBlock(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 111:\n\t\t\t\t\tthis.parseMeshPoseAnimation(this._cur_block_id, true);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 112:\n\t\t\t\t\tthis.parseMeshPoseAnimation(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 113:\n\t\t\t\t\tthis.parseVertexAnimationSet(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 122:\n\t\t\t\t\tthis.parseAnimatorSet(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 253:\n\t\t\t\t\tthis.parseCommand(this._cur_block_id);\n\t\t\t\t\tisParsed = true;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (isParsed == false) {\n\t\t\tswitch (type) {\n\t\t\t\tcase 1:\n\t\t\t\t\tthis.parseGeometry(this._cur_block_id);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 22:\n\t\t\t\t\tthis.parseContainer(this._cur_block_id);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 23:\n\t\t\t\t\tthis.parseMeshInstance(this._cur_block_id);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 81:\n\t\t\t\t\tthis.parseMaterial(this._cur_block_id);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 82:\n\t\t\t\t\tthis.parseTexture(this._cur_block_id);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 101:\n\t\t\t\t\tthis.parseSkeleton(this._cur_block_id);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 102:\n\t\t\t\t\tthis.parseSkeletonPose(this._cur_block_id);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 103:\n\t\t\t\t\tthis.parseSkeletonAnimation(this._cur_block_id);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 121:\n\t\t\t\t//this.parseUVAnimation(this._cur_block_id);\n\t\t\t\t//break;\n\t\t\t\tcase 254:\n\t\t\t\t\tthis.parseNameSpace(this._cur_block_id);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 255:\n\t\t\t\t\tthis.parseMetaData(this._cur_block_id);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (this._debug)\n\t\t\t\t\t\tconsole.log(\"AWDBlock:   Unknown BlockType  (BlockID = \" + this._cur_block_id + \") - Skip \" + len + \" bytes\");\n\n\t\t\t\t\tthis._newBlockBytes.position += len;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this._debug) {\n\t\t\tif (this._newBlockBytes.position != blockEndBlock)\n\t\t\t\tconsole.log(\"  (!)(!)(!) Error while reading AWDBlock ID \" + this._cur_block_id + \" = skip to next block\");\n\n\t\t\tif (block.errorMessages) {\n\t\t\t\tvar len:number = block.errorMessages.length;\n\t\t\t\tfor (var msgCnt:number = 0; msgCnt < len; msgCnt++)\n\t\t\t\t\tconsole.log(\"        (!) Error: \" + block.errorMessages[msgCnt] + \" (!)\");\n\t\t\t}\n\n\t\t\tconsole.log(\"\\n\");\n\t\t}\n\n\t\tif (this._debugTimers && !this.parsingPaused)\n\t\t\tthis.updateTimers(type);\n\n\t\tthis._body.position = blockEndAll;\n\t\tthis._newBlockBytes = null;\n\t}\n\n\tprivate updateTimers(type:number)\n\t{\n\t\tvar end_timing = performance.now();\n\t\tvar time_delta = end_timing - this.start_timeing;\n\t\tthis._time_all += time_delta;\n\n\t\tif (type == 1) {\n\t\t\tthis._time_geom += time_delta;\n\t\t\tthis._num_geom++;\n\t\t} else if (type == 133) {\n\t\t\tthis._time_timeline += time_delta;\n\t\t\tthis._num_timeline++;\n\t\t} else if (type == 135) {\n\t\t\tthis._time_fonts += time_delta;\n\t\t\tthis._num_fonts++;\n\t\t} else if (type == 134) {\n\t\t\tthis._time_textfields += time_delta;\n\t\t\tthis._num_textfields++;\n\t\t} else if (type == 44) {\n\t\t\tthis._time_sounds += time_delta;\n\t\t\tthis._num_sounds++;\n\t\t} else if (type == 82) {\n\t\t\tthis._time_textures += time_delta;\n\t\t\tthis._num_textures++;\n\t\t} else if (type == 81) {\n\t\t\tthis._time_materials += time_delta;\n\t\t\tthis._num_materials++;\n\t\t} else if(type==24) {\n\t\t\tthis._time_meshes += time_delta;\n\t\t\tthis._num_meshes++;\n\t\t}\n\t}\n\n\n\t//--Parser Blocks---------------------------------------------------------------------------\n\n\n\tprivate parseTesselatedFont(blockID:number)\n\t{\n\t\tvar name:string = this.parseVarStr();\n\t\tthis._blocks[blockID].name = name;\n\t\tvar new_font:Font=<Font>AssetLibrary.getAsset(this._blocks[blockID].name);\n\t\tvar newfont:Boolean = false;\n\t\tif(new_font==undefined){\n\t\t\tnew_font = new Font();\n\t\t\tnewfont=true;\n\t\t}\n\t\tvar font_style_cnt:number = this._newBlockBytes.readUnsignedInt();\n\t\tvar font_style_char_cnt:number;\n\t\tvar font_style_name:string;\n\t\tvar new_font_style:TesselatedFontTable;\n\t\tvar font_style_char:number;\n\t\tvar sm_len:number;\n\t\tvar sm_end:number;\n\t\tvar str_ftype:number, str_type:number, str_len:number, str_end:number;\n\t\tfor (var i:number = 0; i < font_style_cnt; ++i) {\n\t\t\tfont_style_name = this.parseVarStr();\n\n\t\t\t// dirty hack for icycle\n\t\t\t// we use bold chars for non-latin chars, but we use regular for � sign,\n\t\t\t// so the dirty hack is to merge the regular and the bold style\n\t\t\tif((this._blocks[blockID].name==\"Tahoma\") && (font_style_name==\"RegularStyle\")){\n\t\t\t\tfont_style_name=\"BoldStyle\";\n\t\t\t}\n\n\t\t\tnew_font_style = new_font.get_font_table(font_style_name);\n\t\t\tnew_font_style.set_font_em_size(this._newBlockBytes.readUnsignedInt());\n\t\t\tnew_font_style.set_whitespace_width(this._newBlockBytes.readUnsignedInt());\n\t\t\t//console.log(new_font_style.get_whitespace_width());\n\t\t\tfont_style_char_cnt = this._newBlockBytes.readUnsignedInt();\n\t\t\tfor (var j:number = 0; j < font_style_char_cnt; ++j) {\n\t\t\t\t// todo: this is basically a simplified version of the subgeom-parsing done in parseGeometry. Make a parseSubGeom() instead (?)\n\t\t\t\tfont_style_char = this._newBlockBytes.readUnsignedInt();\n\t\t\t\tsm_len = this._newBlockBytes.readUnsignedInt();\n\t\t\t\tsm_end = this._newBlockBytes.position + sm_len;\n\n\t\t\t\t// Loop through data streams\n\t\t\t\twhile (this._newBlockBytes.position < sm_end) {\n\t\t\t\t\t// Type, field type, length\n\t\t\t\t\tstr_type = this._newBlockBytes.readUnsignedByte();\n\t\t\t\t\tstr_ftype = this._newBlockBytes.readUnsignedByte();\n\t\t\t\t\tstr_len = this._newBlockBytes.readUnsignedInt();\n\t\t\t\t\tstr_end = this._newBlockBytes.position + str_len;\n\n\t\t\t\t\tif (str_type == 2) {//face indices positions\n\t\t\t\t\t\tvar indices:Array<number> = new Array<number>();\n\t\t\t\t\t\tfor(var idx:number = 0; this._newBlockBytes.position < str_end; idx++)\n\t\t\t\t\t\t\tindices[idx] = this._newBlockBytes.readUnsignedShort();\n\n\t\t\t\t\t} else if (str_type == 10) {// combined vertex2D stream 7 x float32\n\t\t\t\t\t\tvar curveData:ByteArray = new ByteArray(str_len);\n\t\t\t\t\t\tthis._newBlockBytes.readBytes(curveData, 0, str_len);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._newBlockBytes.position = str_end;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(curveData) {\n\t\t\t\t\tvar vertexBuffer:AttributesBuffer = new AttributesBuffer(20, str_len / 20);\n\t\t\t\t\tvertexBuffer.bufferView = new Uint8Array(<ArrayBuffer> curveData.arraybytes);\n\n\t\t\t\t\tvar curve_sub_geom:CurveSubGeometry = new CurveSubGeometry(vertexBuffer);\n\t\t\t\t\t//curve_sub_geom.setUVs(new Float2Attributes(vertexBuffer));\n\t\t\t\t\tcurve_sub_geom.autoDeriveUVs=false;\n\t\t\t\t\tnew_font_style.set_subgeo_for_char(font_style_char.toString(), curve_sub_geom);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.parseProperties(null);\n\t\tthis.parseUserAttributes();\n\t\tif(newfont) {\n\t\t\tthis._pFinalizeAsset(<IAsset>new_font, name);\n\t\t}\n\n\t\tthis._blocks[blockID].data = new_font;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a font: Name = '\" + name);\n\t}\n\n\tprivate static textFormatProperties:Object = {\n\t\t1:AWDParser.UINT16,\n\t\t2:AWDParser.UINT16,\n\t\t3:AWDParser.UINT8,\n\t\t4:AWDParser.UINT8,\n\t\t5:AWDParser.UINT8,\n\t\t6:AWDParser.UINT8,\n\t\t7:AWDParser.UINT16,\n\t\t8:AWDParser.UINT16,\n\t\t9:AWDParser.UINT16,\n\t\t10:AWDParser.UINT16};\n\n\tprivate parseTextFormat(blockID:number)\n\t{\n\t\tvar name:string = this.parseVarStr();\n\t\tthis._blocks[blockID].name = name;\n\n\t\tvar font:Font = <Font> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\tvar font_style_name:string = this.parseVarStr();\n\n\t\tvar newTextFormat:TextFormat = new TextFormat();\n\t\tnewTextFormat.font_name = font.name;\n\n\t\tvar font_table:TesselatedFontTable = font.get_font_table(font_style_name);\n\t\tif (font_table!=null) {\n\t\t\tnewTextFormat.font_style = font_style_name;\n\t\t\tnewTextFormat.font_table = font_table;\n\t\t}\n\n\t\tvar mat:BasicMaterial = <BasicMaterial> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\tmat.bothSides = true;\n\n\t\tvar num_uv_values:number = this._newBlockBytes.readUnsignedByte();\n\t\tvar uv_values:Array<number> = [];\n\t\tfor(var uvcnt:number = 0; uvcnt < num_uv_values; uvcnt++)\n\t\t\tuv_values[uvcnt] = this._newBlockBytes.readFloat();\n\n\t\tnewTextFormat.uv_values = uv_values;\n\t\tvar format_props:AWDProperties = this.parseProperties(AWDParser.textFormatProperties);\n\n\t\tnewTextFormat.size = format_props.get(1,12);\n\t\tnewTextFormat.letterSpacing = format_props.get(2,0);\n\t\t//newTextFormat.rotated = format_props.get(3,false);\n\t\tnewTextFormat.kerning = format_props.get(4,true);\n\t\t//newTextFormat.baseline_shift = format_props.get(5,1);\n\t\tvar tf_align_int:number = format_props.get(6,0);\n\t\tif(tf_align_int==1){\n\t\t\tnewTextFormat.align=\"right\";\n\t\t}\n\t\telse if(tf_align_int==2){\n\t\t\tnewTextFormat.align=\"center\";\n\t\t}\n\t\tnewTextFormat.indent = format_props.get(7,0);\n\t\tnewTextFormat.leftMargin = format_props.get(8,0);\n\t\tnewTextFormat.rightMargin = format_props.get(9,0);\n\t\t//newTextFormat.linespacing = format_props.get(10,0);\n\t\tnewTextFormat.material = mat;\n\t\tthis.parseUserAttributes();// textformat has no extra-properties\n\t\t//newTextFormat.extra =\n\n\t\tthis._pFinalizeAsset(<IAsset> newTextFormat, name);\n\t\tthis._blocks[blockID].data = newTextFormat;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a TextFormat: Name = '\" + name + \" font: \"+font.name);\n\t}\n\n\tprivate static textFieldProperties:Object = {\n\t\t1:AWDParser.BOOL,\n\t\t3:AWDParser.BOOL,\n\t\t4:AWDParser.BOOL,\n\t\t5:AWDParser.BOOL,\n\t\t7:AWDParser.UINT8,\n\t\t8:AWDParser.UINT8,\n\t\t9:AWDParser.UINT8};\n\n\tprivate static textFieldTypes:Array<string> = [\"static\", \"dynamic\", \"input\", \"input\"];\n\n\n\tprivate paresTextField(blockID:number, factory:ITimelineSceneGraphFactory)\n\t{\n\t\tvar name:string = this.parseVarStr();\n\t\tthis._blocks[blockID].name = name;\n        var newTextField = factory.createTextField();\n\t\tvar text_field_type:number=this._newBlockBytes.readUnsignedByte();\n\n\t\tnewTextField.type = AWDParser.textFieldTypes[text_field_type];\n\n\t\tif(text_field_type == 3)\n\t\t\tnewTextField.displayAsPassword = true;\n\n\t\t//\n\t\tnewTextField.textWidth = Math.abs(this._newBlockBytes.readFloat());\n\t\tnewTextField.textHeight = Math.abs(this._newBlockBytes.readFloat());\n\t\tvar num_paragraphs:number = this._newBlockBytes.readUnsignedInt();\n\t\tvar complete_text:string = \"\";\n\t\t//console.log(\"num_paragraphs  '\" + num_paragraphs);\n\t\tfor(var paracnt:number=0; paracnt<num_paragraphs; paracnt++){\n\n\t\t\tvar num_textruns:number = this._newBlockBytes.readUnsignedInt();\n\t\t\t//console.log(\"num_textruns  '\" + num_textruns);\n\t\t\tfor(var textrun_cnt:number=0; textrun_cnt<num_textruns; textrun_cnt++) {\n\t\t\t\tvar text_format:TextFormat = <TextFormat> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\t\t\tvar txt_length = this._newBlockBytes.readUnsignedInt();\n\t\t\t\t//console.log(\"txt_length  '\" + txt_length);\n\t\t\t\tif (txt_length > 0) {\n\t\t\t\t\tvar this_txt:string = this._newBlockBytes.readUTFBytes(txt_length);\n\t\t\t\t\t//newTextField.appendText(this_txt, text_format);\n\t\t\t\t\tcomplete_text += this_txt;\n\t\t\t\t\t//console.log(\"this_txt  '\" + this_txt);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//newTextField.closeParagraph();\n\t\t}\n\t\tnewTextField.textFormat=text_format;\n\t\tnewTextField.text=complete_text;\n\t\t//newTextField.construct_geometry();\n\t\t// todo: optional matrix etc can be put in properties.\n\n\t\tvar props:AWDProperties = this.parseProperties(AWDParser.textFieldProperties);\n\t\tnewTextField.selectable = props.get(1, false);\n\t\tnewTextField.border =  props.get(3, false);\n\t\t//newTextField.renderHTML =  props.get(4, false);\n\t\t//newTextField.scrollable =  props.get(5, false);\n\t\t//newTextField.text_flow =  props.get(7, 0);\n\t\t//newTextField.orientationMode =  props.get(8, 0);\n\t\t//newTextField.line_mode =  props.get(9, 0);\n\t\tnewTextField.extra = this.parseUserAttributes();\n\n\t\t//console.log(\"Parsed a TextField: Name = '\" + name + \"| text  = \" + complete_text);\n\t\tthis._pFinalizeAsset(<IAsset> newTextField, name);\n\t\tthis._blocks[blockID].data = newTextField;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a TextField: Name = '\" + name + \"| text  = \" + complete_text);\n\t}\n\n\t// Block ID = 25\n\tprivate parseBillBoardLibraryBlock(blockID:number)\n\t{\n\n\t\tvar name:string = this.parseVarStr();\n\t\tvar mat:BasicMaterial = <BasicMaterial> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\tmat.bothSides=true;\n\t\tvar billboard:Billboard = new Billboard(mat);\n\n\t\t// todo: optional matrix etc can be put in properties.\n\t\tthis.parseProperties(null);\n\n\t\tbillboard.extra = this.parseUserAttributes();\n\n\t\tthis._pFinalizeAsset(<IAsset> billboard, name);\n\n\t\tthis._blocks[blockID].data = billboard;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a Library-Billboard: Name = '\" + name + \"| Material-Name = \" + mat.name);\n\t}\n\t// Block ID = 24\n\tprivate parseMeshLibraryBlock(blockID:number)\n\t{\n\t\tvar name:string = this.parseVarStr();\n\t\tvar data_id:number = this._newBlockBytes.readUnsignedInt();\n\t\tvar geom:Geometry = <Geometry> this._blocks[data_id].data;\n\t\tthis._blocks[blockID].geoID = data_id;\n\n\t\tvar num_materials:number = this._newBlockBytes.readUnsignedShort();\n\t\tvar materials:Array<MethodMaterial> = new Array<MethodMaterial>();\n\t\tvar materialNames:Array<string> = new Array<string>();\n\t\tvar mat:MethodMaterial;\n\t\tfor (var materials_parsed:number = 0; materials_parsed < num_materials; materials_parsed++) {\n\t\t\tmat = <MethodMaterial> (this._blocks[this._newBlockBytes.readUnsignedInt()].data || DefaultMaterialManager.getDefaultMaterial());\n\t\t\t//mat.preserveAlpha = true;\n\t\t\tmat.alphaBlending = true;\n\t\t\tmat.useColorTransform = true;\n\t\t\tmaterials[materials_parsed] = mat;\n\t\t\tmaterialNames[materials_parsed] = mat.name;\n\t\t}\n\n\t\tvar start_timeing = performance.now();\n\t\tvar mesh:Mesh = new Mesh(geom, null);\n\t\tvar end_timing = performance.now();\n\t\tvar time_delta = end_timing - start_timeing;\n\t\tthis._time_geom_bytes += time_delta;\n\n\t\tif (materials.length >= 1 && mesh.subMeshes.length == 1) {\n\t\t\tmesh.material = materials[0];\n\t\t} else if (materials.length > 1) {\n\t\t\t// Assign each sub-mesh in the mesh a material from the list. If more sub-meshes\n\t\t\t// than materials, repeat the last material for all remaining sub-meshes.\n\t\t\tfor (var i:number = 0; i < mesh.subMeshes.length; i++)\n\t\t\t\tmesh.subMeshes[i].material = materials[Math.min(materials.length - 1, i)];\n\t\t}\n\n\t\tvar num_subgeoms:number = this._newBlockBytes.readUnsignedShort();\n\t\tif(num_subgeoms!=mesh.subMeshes.length){\n\t\t\tthrow new Error(\"num subgeoms does not match num submeshes\")\n\t\t}\n\t\tfor (var i:number = 0; i < num_subgeoms; i++) {\n\n\t\t\tvar sampler:Sampler2D = new Sampler2D();\n\t\t\tvar x:number = this._newBlockBytes.readFloat();\n\t\t\tvar y:number = this._newBlockBytes.readFloat();\n\t\t\tvar width:number = this._newBlockBytes.readFloat() - x;\n\t\t\tvar height:number = this._newBlockBytes.readFloat() - y;\n\n\t\t\tsampler.imageRect = new Rectangle(x, y, width, height);\n\t\t\tmesh.subMeshes[i].material.imageRect = true;\n\t\t\tmesh.subMeshes[i].style = new Style();\n\t\t\tmesh.subMeshes[i].style.addSamplerAt(sampler, mesh.subMeshes[i].material.getTextureAt(0));\n\t\t\t// optional: transform matrix\n\t\t\tvar hasUVTransform:boolean = !this._newBlockBytes.readUnsignedByte();\n\t\t\tif(hasUVTransform){\n\t\t\t\tvar matrix:Array<number> = this.parseMatrix32RawData();\n\t\t\t\tmesh.subMeshes[i].material.animateUVs = true;\n\t\t\t\tmesh.subMeshes[i].uvTransform = new Matrix(matrix[0], matrix[2], matrix[1], matrix[3], matrix[4], matrix[5]);\n\t\t\t}\n\t\t}\n\n\t\tthis.parseProperties(null);\n\t\tmesh.extra = this.parseUserAttributes();\n\n\t\tthis._pFinalizeAsset(<IAsset> mesh, name);\n\n\t\tthis._blocks[blockID].data = mesh;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a Library-Mesh: Name = '\" + name + \"| Geometry-Name = \" + geom.name + \" | SubMeshes = \" + mesh.subMeshes.length + \" | Mat-Names = \" + materialNames);\n\t}\n\n\tprivate parseAudioBlock(blockID:number, factory:ITimelineSceneGraphFactory)\n\t{\n\t\t//var asset:Audio;todo create asset for audio\n\n\t\tthis._blocks[blockID].name = this.parseVarStr();\n\n\t\tvar type:number = this._newBlockBytes.readUnsignedByte();\n\t\tvar data_len:number;\n\n\t\t// External\n\t\tif (type == 0) {\n\t\t\tdata_len = this._newBlockBytes.readUnsignedInt();\n\t\t\tvar url:string;\n\t\t\turl = this._newBlockBytes.readUTFBytes(data_len);\n\t\t\t// todo parser needs to be able to handle mp3 and wav files if we trigger the loading of external ressource\n\t\t\tthis._pAddDependency(this._cur_block_id.toString(), new URLRequest(url), false, null, true);\n\t\t} else {\n\t\t\t// todo: exporter does not export embed sounds yet\n\t\t\tdata_len = this._newBlockBytes.readUnsignedInt();\n\n\t\t\tvar data:ByteArray = new ByteArray(data_len);\n\t\t\tthis._newBlockBytes.readBytes(data, 0, data_len);\n\n\t\t\t// todo parse sound from bytes\n\t\t\t// this._pAddDependency(this._cur_block_id.toString(), null, false, ParserUtils.by(data), true);\n\t\t\tthis._pAddDependency(this._cur_block_id.toString(), null, false, data, true);\n\t\t}\n\n\t\t// Ignore for now\n\t\tthis.parseProperties(null);\n\t\tthis._blocks[blockID].extras = this.parseUserAttributes();\n\t\tthis._pPauseAndRetrieveDependencies();\n\t\t//this._blocks[blockID].data = asset;todo\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Start parsing a \" + [\"external\", \"embed\"][type] + \" Audio file\");\n\t}\n\n\t//Block ID = 4\n\tprivate parseTimeLine(blockID:number, factory:ITimelineSceneGraphFactory)\n\t{\n\t\tvar i:number;\n\t\tvar j:number;\n\t\tvar cmd_asset:DisplayObject;\n\t\tvar new_timeline:Timeline = new Timeline();\n\t\tvar timeLineContainer = factory.createMovieClip(new_timeline);\n\t\tvar name = this.parseVarStr();\n\t\tvar isScene = !!this._newBlockBytes.readUnsignedByte();\n\t\tvar sceneID = this._newBlockBytes.readUnsignedByte();\n\t\tvar fps = this._newBlockBytes.readFloat();\n\n\t\t// register list of potential childs\n\t\t// a potential child can be reused on a timeline (added / removed / added)\n\t\t// However, for each potential child, we need to register the max-number of instances that a frame contains\n\t\t// we parse 2 lists of potential-childs:\n\t\t// -\tthe first list contains potential-childs that are only ever instanced once per frame.\n\t\t// -\tthe second list contains potential-childs that are instanced multiple times on some frames.\n\n\t\t// on registering a child, the child gets a incremental-id assigned. This is the id, that the commands are using to access the childs.\n\t\t// hence we need to be careful to register all objects in correct order.\n\n\t\tvar num_potential_childs:number = this._newBlockBytes.readUnsignedShort();\n\t\tfor (i = 0; i < num_potential_childs; i++) {\n\t\t\tcmd_asset = <DisplayObject> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\t\tif (cmd_asset != null) {\n\t\t\t\tnew_timeline.registerPotentialChild(cmd_asset);\n\t\t\t} else {\n\t\t\t\t//todo: register a default display object on timeline, so we do not mess up the incremental obj-id\n\t\t\t\t//timeLineContainer.registerPotentialChild(cmd_asset);\n\t\t\t\tconsole.log(\"ERROR when collecting objects for timeline\");\n\t\t\t}\n\t\t}\n\n\t\tvar num_all_display_instances:number = num_potential_childs;\n\n\t\tvar num_potential_childs_multi_instanced = this._newBlockBytes.readUnsignedShort();\n\t\tfor (i = 0; i < num_potential_childs_multi_instanced; i++) {\n\t\t\tcmd_asset = <DisplayObject> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\t\tvar num_instances:number = this._newBlockBytes.readUnsignedShort();\n\t\t\tnum_all_display_instances += num_instances;\n\t\t\tif (cmd_asset != null) {\n\t\t\t\tfor (j = 0; j < num_instances; j++)\n\t\t\t\t\tnew_timeline.registerPotentialChild(cmd_asset);\n\t\t\t} else {\n\t\t\t\tfor (j = 0; j < num_instances; j++) {\n\t\t\t\t\t//todo: register a default display object on timeline, so we do not mess up the incremental obj-id\n\t\t\t\t\t//timeLineContainer.registerPotentialChild(cmd_asset);\n\t\t\t\t\tconsole.log(\"ERROR when collecting objects for timeline\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed \" + (num_potential_childs + num_potential_childs_multi_instanced) + \" potential childs. They will be used by \" + num_all_display_instances + \" instances.\");\n\n\t\t// register list of potential sounds - for now we always have 0 sounds\n\t\tvar num_potential_sounds = this._newBlockBytes.readUnsignedShort();\n\n\n\t\tvar str_cnt = this._newBlockBytes.readUnsignedByte();\n\t\tvar str_len = 0;\n\t\tvar str_data_type = 0;\n\t\tvar str_type=0;\n\t\tvar str_counter=0;\n\t\tfor(i=0; i<str_cnt;i++){\n\t\t\t// the first 6 lists are not optional and always in same order\n\t\t\t// hence we can get type by incremental counter instead of stored uint8\n\t\t\tif(str_counter<6)\n\t\t\t\tstr_type=str_counter;\n\t\t\telse\n\t\t\t\tstr_type = this._newBlockBytes.readUnsignedByte();\n\t\t\t// get the data type for this stream (1:UINT8 - 2:UINT16 - 3:UINT32)\n\t\t\tstr_data_type = this._newBlockBytes.readUnsignedByte();\n\t\t\t// size of this stream in byte\n\t\t\tstr_len = this._newBlockBytes.readUnsignedInt();\n\t\t\tif(str_len>0) {\n\t\t\t\tvar keyframes_start_indices_data:ByteArray = new ByteArray(str_len);\n\t\t\t\tthis._newBlockBytes.readBytes(keyframes_start_indices_data, 0, str_len);\n\t\t\t\tvar new_buffer:ArrayBufferView;\n\t\t\t\t//console.log(\"str_data_type = \"+str_type);\n\t\t\t\tswitch (str_data_type) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tnew_buffer = new Uint8Array(<ArrayBuffer> keyframes_start_indices_data.arraybytes);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tnew_buffer = new Uint16Array(<ArrayBuffer> keyframes_start_indices_data.arraybytes);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\tnew_buffer = new Uint32Array(<ArrayBuffer> keyframes_start_indices_data.arraybytes);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tswitch (str_type) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\tnew_timeline.keyframe_durations = new_buffer;\n\t\t\t\t\t\tnew_timeline.numKeyFrames=str_len / str_data_type;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tnew_timeline.frame_command_indices = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tnew_timeline.frame_recipe = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tnew_timeline.command_length_stream = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\tnew_timeline.command_index_stream = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 5:\n\t\t\t\t\t\tnew_timeline.add_child_stream = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 6:\n\t\t\t\t\t\tnew_timeline.remove_child_stream = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 7:\n\t\t\t\t\t\tnew_timeline.update_child_stream = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 8:\n\t\t\t\t\t\tnew_timeline.update_child_props_indices_stream = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 9:\n\t\t\t\t\t\tnew_timeline.update_child_props_length_stream = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 10:\n\t\t\t\t\t\tnew_timeline.property_type_stream = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 11:\n\t\t\t\t\t\tnew_timeline.property_index_stream = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 12:\n\t\t\t\t\t\tnew_timeline.properties_stream_int = new_buffer;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstr_counter++;\n\t\t}\n\t\tvar lc:number=0;\n\t\tvar float_array_data:ByteArray;\n\t\tstr_cnt = this._newBlockBytes.readUnsignedByte();\n\t\tfor(i=0; i<str_cnt;i++){\n\t\t\tstr_type = this._newBlockBytes.readUnsignedByte();\n\t\t\tswitch(str_type) {\n\t\t\t\tcase 0://mtx_scale\n\t\t\t\t\tstr_len = this._newBlockBytes.readUnsignedInt();\n\t\t\t\t\tfloat_array_data = new ByteArray(str_len);\n\t\t\t\t\tthis._newBlockBytes.readBytes(float_array_data, 0, str_len);\n\t\t\t\t\tnew_timeline.properties_stream_f32_mtx_scale_rot=new Float32Array(<ArrayBuffer> float_array_data.arraybytes);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1://mtx_pos\n\t\t\t\t\tstr_len = this._newBlockBytes.readUnsignedInt();\n\t\t\t\t\tfloat_array_data = new ByteArray(str_len);\n\t\t\t\t\tthis._newBlockBytes.readBytes(float_array_data, 0, str_len);\n\t\t\t\t\tnew_timeline.properties_stream_f32_mtx_pos=new Float32Array(<ArrayBuffer> float_array_data.arraybytes);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2://mtx_all\n\t\t\t\t\tstr_len = this._newBlockBytes.readUnsignedInt();\n\t\t\t\t\tfloat_array_data = new ByteArray(str_len);\n\t\t\t\t\tthis._newBlockBytes.readBytes(float_array_data, 0, str_len);\n\t\t\t\t\tnew_timeline.properties_stream_f32_mtx_all=new Float32Array(<ArrayBuffer> float_array_data.arraybytes);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3://ct\n\t\t\t\t\tstr_len = this._newBlockBytes.readUnsignedInt();\n\t\t\t\t\tfloat_array_data = new ByteArray(str_len);\n\t\t\t\t\tthis._newBlockBytes.readBytes(float_array_data, 0, str_len);\n\t\t\t\t\tnew_timeline.properties_stream_f32_ct=new Float32Array(<ArrayBuffer> float_array_data.arraybytes);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4://labels\n\t\t\t\t\tstr_len = this._newBlockBytes.readUnsignedShort();\n\t\t\t\t\t//console.log(\"start reading labels \"+str_len);\n\t\t\t\t\tfor (lc = 0; lc < str_len; lc++) {\n\t\t\t\t\t\tnew_timeline._labels[this.parseVarStr()] = this._newBlockBytes.readUnsignedShort();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 5://name_stream\n\t\t\t\t\tstr_len = this._newBlockBytes.readUnsignedShort();\n\t\t\t\t\tvar string_props_array:Array<string>=[];\n\t\t\t\t\tfor (lc = 0; lc < str_len; lc++) {\n\t\t\t\t\t\tstring_props_array.push(this._newBlockBytes.readUTFBytes(this._newBlockBytes.readUnsignedShort()));\n\t\t\t\t\t}\n\t\t\t\t\tnew_timeline.properties_stream_strings = string_props_array;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 6://script_stream\n\t\t\t\t\tstr_len = this._newBlockBytes.readUnsignedShort();\n\t\t\t\t\tfor (lc = 0; lc < str_len; lc++) {\n\t\t\t\t\t\tvar frame_index=this._newBlockBytes.readUnsignedShort();\n\t\t\t\t\t\tvar one_str_len=this._newBlockBytes.readUnsignedInt();\n\t\t\t\t\t\t//this._newBlockBytes.readUTFBytes(one_str_len);\n\t\t\t\t\t\tnew_timeline.add_framescript(this._newBlockBytes.readUTFBytes(one_str_len), frame_index);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tnew_timeline.init();\n\t\tthis.parseProperties(null);\n\t\tthis.parseUserAttributes();\n\t\tthis._pFinalizeAsset(<IAsset>timeLineContainer, name);\n\n\t\tthis._blocks[blockID].data = timeLineContainer;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a TIMELINE: Name = \" + name + \"| isScene = \" + isScene + \"| sceneID = \" + sceneID + \"| numFrames = \");\n\t}\n\n\tprivate static geometryProperties:Object = {\n\t\t1:AWDParser.GEO_NUMBER,\n\t\t2:AWDParser.GEO_NUMBER};\n\n\tprivate static subGeometryProperties:Object = {\n\t\t1:AWDParser.GEO_NUMBER,\n\t\t2:AWDParser.GEO_NUMBER};\n\n\t//Block ID = 1\n\tprivate parseGeometry(blockID:number)\n\t{\n\t\tvar geom:Geometry = new Geometry();\n\n\t\t// Read name and sub count\n\t\tvar name:string = this.parseVarStr();\n\t\tvar num_subs:number = this._newBlockBytes.readUnsignedShort();\n\n\t\t// Read optional properties\n\t\tvar props:AWDProperties = this.parseProperties(AWDParser.geometryProperties);\n\t\tvar geoScaleU:number = props.get(1, 1);\n\t\tvar geoScaleV:number = props.get(2, 1);\n\n\t\t// Loop through sub meshes\n\t\tfor (var subs_parsed:number = 0;  subs_parsed < num_subs; subs_parsed++) {\n\t\t\tvar is_curve_geom:boolean=false;\n\t\t\tvar sm_len:number, sm_end:number;\n\t\t\tvar w_indices:Array<number>;\n\t\t\tvar weights:Array<number>;\n\n\t\t\tsm_len = this._newBlockBytes.readUnsignedInt();\n\t\t\tsm_end = this._newBlockBytes.position + sm_len;\n\n\t\t\tvar subProps:AWDProperties = this.parseProperties(AWDParser.subGeometryProperties);\n\t\t\t// Loop through data streams\n\t\t\twhile (this._newBlockBytes.position < sm_end) {\n\t\t\t\tvar idx:number = 0;\n\t\t\t\tvar str_ftype:number, str_type:number, str_len:number, str_end:number;\n\n\t\t\t\t// Type, field type, length\n\t\t\t\tstr_type = this._newBlockBytes.readUnsignedByte();\n\t\t\t\tstr_ftype = this._newBlockBytes.readUnsignedByte();\n\t\t\t\tstr_len = this._newBlockBytes.readUnsignedInt();\n\t\t\t\tstr_end = this._newBlockBytes.position + str_len;\n\n\t\t\t\tvar x:number, y:number, z:number;\n\n\t\t\t\tif (str_type == 1) {//vertex 3d positions\n\t\t\t\t\tvar verts:Array<number> = new Array<number>();\n\n\t\t\t\t\twhile (this._newBlockBytes.position < str_end) {\n\n\t\t\t\t\t\tx = this.readNumber(this._accuracyGeo);\n\t\t\t\t\t\ty = this.readNumber(this._accuracyGeo);\n\t\t\t\t\t\tz = this.readNumber(this._accuracyGeo);\n\n\t\t\t\t\t\tverts[idx++] = x;\n\t\t\t\t\t\tverts[idx++] = y;\n\t\t\t\t\t\tverts[idx++] = z;\n\t\t\t\t\t}\n\t\t\t\t} else if (str_type == 2) {//face indicies positions\n\t\t\t\t\tvar indices:Array<number> = new Array<number>();\n\t\t\t\t\twhile (this._newBlockBytes.position < str_end)\n\t\t\t\t\t\tindices[idx++] = this._newBlockBytes.readUnsignedShort();\n\n\t\t\t\t} else if (str_type == 3) {\n\t\t\t\t\tvar uvs:Array<number> = new Array<number>();\n\t\t\t\t\twhile (this._newBlockBytes.position < str_end)\n\t\t\t\t\t\tuvs[idx++] = this.readNumber(this._accuracyGeo);\n\t\t\t\t} else if (str_type == 4) {\n\t\t\t\t\tvar normals:Array<number> = new Array<number>();\n\t\t\t\t\twhile (this._newBlockBytes.position < str_end)\n\t\t\t\t\t\tnormals[idx++] = this.readNumber(this._accuracyGeo);\n\t\t\t\t} else if (str_type == 6) {\n\t\t\t\t\tw_indices = Array<number>();\n\t\t\t\t\twhile (this._newBlockBytes.position < str_end)\n\t\t\t\t\t\tw_indices[idx++] = this._newBlockBytes.readUnsignedShort()*3;\n\t\t\t\t} else if (str_type == 7) {\n\t\t\t\t\tweights = new Array<number>();\n\t\t\t\t\twhile (this._newBlockBytes.position < str_end)\n\t\t\t\t\t\tweights[idx++] = this.readNumber(this._accuracyGeo);\n\t\t\t\t} else if (str_type == 8) {// 2d-positions - not used yet.\n\t\t\t\t\tthis._newBlockBytes.position = str_end;\n\t\t\t\t} else if (str_type == 9) {// combined vertex3D stream 13 x float32\n\t\t\t\t\tthis._newBlockBytes.position = str_end;\n\t\t\t\t} else if (str_type == 10) {// combined vertex2D stream 5 x float32\n\t\t\t\t\tis_curve_geom = true;\n\t\t\t\t\tvar curveData:ByteArray = new ByteArray(str_len);\n\t\t\t\t\tthis._newBlockBytes.readBytes(curveData, 0, str_len);\n\t\t\t\t} else {\n\t\t\t\t\tthis._newBlockBytes.position = str_end;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.parseUserAttributes(); // Ignore sub-mesh attributes for now\n\n\t\t\tif(is_curve_geom){\n\t\t\t\tvar vertexBuffer:AttributesBuffer = new AttributesBuffer(28, str_len/28);\n\t\t\t\tvertexBuffer.bufferView = new Uint8Array(<ArrayBuffer> curveData.arraybytes);\n\n\t\t\t\tvar curve_sub_geom:CurveSubGeometry = new CurveSubGeometry(vertexBuffer);\n\t\t\t\tcurve_sub_geom.setUVs(new Float2Attributes(vertexBuffer));\n\t\t\t\tgeom.addSubGeometry(curve_sub_geom);\n\t\t\t\tif (this._debug)\n\t\t\t\t\tconsole.log(\"Parsed a CurveSubGeometry\");\n\t\t\t} else {\n\t\t\t\tvar triangle_sub_geom = new TriangleSubGeometry(new AttributesBuffer());\n\n\t\t\t\tif (weights)\n\t\t\t\t\ttriangle_sub_geom.jointsPerVertex = weights.length / (verts.length / 3);\n\n\t\t\t\tif (normals)\n\t\t\t\t\ttriangle_sub_geom.autoDeriveNormals = false;\n\n\t\t\t\tif (uvs)\n\t\t\t\t\ttriangle_sub_geom.autoDeriveUVs = false;\n\n\t\t\t\ttriangle_sub_geom.autoDeriveTangents = true;\n\n\t\t\t\ttriangle_sub_geom.setIndices(indices);\n\t\t\t\ttriangle_sub_geom.setPositions(verts);\n\t\t\t\ttriangle_sub_geom.setNormals(normals);\n\t\t\t\ttriangle_sub_geom.setUVs(uvs);\n\t\t\t\ttriangle_sub_geom.setTangents(null);\n\t\t\t\ttriangle_sub_geom.setJointWeights(weights);\n\t\t\t\ttriangle_sub_geom.setJointIndices(w_indices);\n\n\t\t\t\tvar scaleU:number = subProps.get(1, 1);\n\t\t\t\tvar scaleV:number = subProps.get(2, 1);\n\t\t\t\tvar setSubUVs:boolean = false; //this should remain false atm, because in AwayBuilder the uv is only scaled by the geometry\n\n\t\t\t\tif ((geoScaleU != scaleU) || (geoScaleV != scaleV)) {\n\t\t\t\t\tsetSubUVs = true;\n\t\t\t\t\tscaleU = geoScaleU / scaleU;\n\t\t\t\t\tscaleV = geoScaleV / scaleV;\n\t\t\t\t}\n\n\t\t\t\tif (setSubUVs)\n\t\t\t\t\ttriangle_sub_geom.scaleUV(scaleU, scaleV);\n\n\t\t\t\tgeom.addSubGeometry(triangle_sub_geom);\n\t\t\t\tif (this._debug)\n\t\t\t\t\tconsole.log(\"Parsed a TriangleSubGeometry\");\n\t\t\t}\n\n\n\t\t\t// TODO: Somehow map in-sub to out-sub indices to enable look-up\n\t\t\t// when creating meshes (and their material assignments.)\n\t\t}\n\n\t\tif ((geoScaleU != 1) || (geoScaleV != 1))\n\t\t\tgeom.scaleUV(geoScaleU, geoScaleV);\n\t\tthis.parseUserAttributes();\n\t\tthis._pFinalizeAsset(<IAsset> geom, name);\n\t\tthis._blocks[blockID].data = geom;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a TriangleGeometry: Name = \" + name);\n\t}\n\n\tprivate static primitiveProperties:Object = {\n\t\t101:AWDParser.GEO_NUMBER,\n\t\t102:AWDParser.GEO_NUMBER,\n\t\t103:AWDParser.GEO_NUMBER,\n\t\t110:AWDParser.GEO_NUMBER,\n\t\t111:AWDParser.GEO_NUMBER,\n\t\t301:AWDParser.UINT16,\n\t\t302:AWDParser.UINT16,\n\t\t303:AWDParser.UINT16,\n\t\t701:AWDParser.BOOL,\n\t\t702:AWDParser.BOOL,\n\t\t703:AWDParser.BOOL,\n\t\t704:AWDParser.BOOL};\n\n\tprivate static primitiveTypes:Array<string> = [\"Unsupported Type-ID\", \"PrimitivePlanePrefab\", \"PrimitiveCubePrefab\", \"PrimitiveSpherePrefab\", \"PrimitiveCylinderPrefab\", \"PrimitivesConePrefab\", \"PrimitivesCapsulePrefab\", \"PrimitivesTorusPrefab\"];\n\n\t//Block ID = 11\n\tprivate parsePrimitves(blockID:number)\n\t{\n\t\tvar name:string;\n\t\tvar prefab:PrefabBase;\n\t\tvar primType:number;\n\t\tvar subs_parsed:number;\n\t\tvar props:AWDProperties;\n\t\tvar bsm:Matrix3D;\n\n\t\t// Read name and sub count\n\t\tname = this.parseVarStr();\n\t\tprimType = this._newBlockBytes.readUnsignedByte();\n\t\tprops = this.parseProperties(AWDParser.primitiveProperties);\n\n\t\t// to do, not all properties are set on all primitives\n\t\tswitch (primType) {\n\t\t\tcase 1:\n\t\t\t\tprefab = new PrimitivePlanePrefab(props.get(101, 100), props.get(102, 100), props.get(301, 1), props.get(302, 1), props.get(701, true), props.get(702, false));\n\t\t\t\tbreak;\n\n\t\t\tcase 2:\n\t\t\t\tprefab = new PrimitiveCubePrefab(props.get(101, 100), props.get(102, 100), props.get(103, 100), props.get(301, 1), props.get(302, 1), props.get(303, 1), props.get(701, true));\n\t\t\t\tbreak;\n\n\t\t\tcase 3:\n\t\t\t\tprefab = new PrimitiveSpherePrefab(props.get(101, 50), props.get(301, 16), props.get(302, 12), props.get(701, true));\n\t\t\t\tbreak;\n\n\t\t\tcase 4:\n\t\t\t\tprefab = new PrimitiveCylinderPrefab(props.get(101, 50), props.get(102, 50), props.get(103, 100), props.get(301, 16), props.get(302, 1), true, true, true); // bool701, bool702, bool703, bool704);\n\t\t\t\tif (!props.get(701, true))\n\t\t\t\t\t(<PrimitiveCylinderPrefab>prefab).topClosed = false;\n\t\t\t\tif (!props.get(702, true))\n\t\t\t\t\t(<PrimitiveCylinderPrefab>prefab).bottomClosed = false;\n\t\t\t\tif (!props.get(703, true))\n\t\t\t\t\t(<PrimitiveCylinderPrefab>prefab).yUp = false;\n\n\t\t\t\tbreak;\n\n\t\t\tcase 5:\n\t\t\t\tprefab = new PrimitiveConePrefab(props.get(101, 50), props.get(102, 100), props.get(301, 16), props.get(302, 1), props.get(701, true), props.get(702, true));\n\t\t\t\tbreak;\n\n\t\t\tcase 6:\n\t\t\t\tprefab = new PrimitiveCapsulePrefab(props.get(101, 50), props.get(102, 100), props.get(301, 16), props.get(302, 15), props.get(701, true));\n\t\t\t\tbreak;\n\n\t\t\tcase 7:\n\t\t\t\tprefab = new PrimitiveTorusPrefab(props.get(101, 50), props.get(102, 50), props.get(301, 16), props.get(302, 8), props.get(701, true));\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tprefab = new PrefabBase();\n\t\t\t\tconsole.log(\"ERROR: UNSUPPORTED PREFAB_TYPE\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif ((props.get(110, 1) != 1) || (props.get(111, 1) != 1)) {\n\t\t\t//geom.subGeometries;\n\t\t\t//geom.scaleUV(props.get(110, 1), props.get(111, 1)); //TODO add back scaling to prefabs\n\t\t}\n\n\t\tthis.parseUserAttributes();\n\t\tprefab.name = name;\n\t\tthis._pFinalizeAsset(prefab, name);\n\t\tthis._blocks[blockID].data = prefab;\n\n\t\tif (this._debug) {\n\t\t\tif ((primType < 0) || (primType > 7))\n\t\t\t\tprimType = 0;\n\n\t\t\tconsole.log(\"Parsed a Primivite: Name = \" + name + \"| type = \" + AWDParser.primitiveTypes[primType]);\n\t\t}\n\t}\n\n\tprivate static containerProperties:Object = {\n\t\t1:AWDParser.MATRIX_NUMBER,\n\t\t2:AWDParser.MATRIX_NUMBER,\n\t\t3:AWDParser.MATRIX_NUMBER,\n\t\t4:AWDParser.UINT8};\n\n\t// Block ID = 22\n\tprivate parseContainer(blockID:number)\n\t{\n\t\tvar name:string;\n\t\tvar mtx:Matrix3D;\n\t\tvar ctr:DisplayObjectContainer;\n\t\tvar parent:DisplayObjectContainer = <DisplayObjectContainer> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\n\t\tmtx = this.parseMatrix3D();\n\t\tname = this.parseVarStr();\n\n\t\tvar parentName:string = \"Root (TopLevel)\";\n\t\tctr = new DisplayObjectContainer();\n\t\tctr.transform.matrix3D = mtx;\n\n\t\tif (parent) {\n\t\t\tparent.addChild(ctr);\n\t\t\tparentName = parent.name;\n\t\t} else {\n\t\t\t//add to the content property\n\t\t\t(<DisplayObjectContainer> this._pContent).addChild(ctr);\n\t\t}\n\n\t\t// in AWD version 2.1 we read the Container properties\n\t\tif ((this._version[0] == 2) && (this._version[1] == 1)) {\n\t\t\tvar props:AWDProperties = this.parseProperties(AWDParser.containerProperties);\n\t\t\tctr.pivot = new Vector3D(props.get(1, 0), props.get(2, 0), props.get(3, 0));\n\t\t} else {// in other versions we do not read the Container properties\n\t\t\tthis.parseProperties(null);\n\t\t}\n\n\t\t// the extraProperties should only be set for AWD2.1-Files, but is read for both versions\n\t\tctr.extra = this.parseUserAttributes();\n\n\t\tthis._pFinalizeAsset(<IAsset> ctr, name);\n\t\tthis._blocks[blockID].data = ctr;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a Container: Name = '\" + name + \"' | Parent-Name = \" + parentName);\n\t}\n\n\tprivate static meshInstanceProperties:Object = {\n\t\t1:AWDParser.MATRIX_NUMBER,\n\t\t2:AWDParser.MATRIX_NUMBER,\n\t\t3:AWDParser.MATRIX_NUMBER,\n\t\t4:AWDParser.UINT8,\n\t\t5:AWDParser.BOOL};\n\n\t// Block ID = 23\n\tprivate parseMeshInstance(blockID:number)\n\t{\n\t\tvar parent:DisplayObjectContainer = <DisplayObjectContainer> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\tvar mtx:Matrix3D = this.parseMatrix3D();\n\t\tvar name:string = this.parseVarStr();\n\n\t\tvar data_id:number = this._newBlockBytes.readUnsignedInt();\n\t\tvar asset:IAsset = <IAsset> this._blocks[data_id].data;\n\t\tvar geom:Geometry;\n\t\tvar prefab:PrefabBase;\n\t\tvar isPrefab:boolean=false;\n\t\tif (asset.isAsset(Geometry)) {\n\t\t\tgeom = <Geometry> asset;\n\t\t} else {\n\t\t\tisPrefab = true;\n\t\t\tprefab = <PrefabBase> asset;\n\t\t}\n\n\t\tthis._blocks[blockID].geoID = data_id;\n\t\tvar num_materials:number = this._newBlockBytes.readUnsignedShort();\n\t\tvar materials:Array<MethodMaterial> = new Array<MethodMaterial>();\n\t\tvar materialNames:Array<string> = new Array<string>();\n\t\tvar mat:MethodMaterial;\n\t\tfor (var materials_parsed:number = 0; materials_parsed < num_materials; materials_parsed++) {\n\t\t\tmat = <MethodMaterial> (this._blocks[this._newBlockBytes.readUnsignedInt()].data || DefaultMaterialManager.getDefaultMaterial());\n\t\t\tmaterials[materials_parsed] = mat;\n\t\t\tmaterialNames[materials_parsed] = mat.name;\n\t\t}\n\n\t\tvar mesh:Mesh = isPrefab? <Mesh> prefab.getNewObject() : new Mesh(geom, null);\n\t\tmesh.transform.matrix3D = mtx;\n\n\t\tvar parentName:string = \"Root (TopLevel)\";\n\t\tif (parent) {\n\t\t\tparent.addChild(mesh);\n\t\t\tparentName = parent.name;\n\t\t} else {\n\t\t\t//add to the content property\n\t\t\t(<DisplayObjectContainer> this._pContent).addChild(mesh);\n\t\t}\n\n\t\tif (materials.length >= 1 && mesh.subMeshes.length == 1) {\n\t\t\tmesh.material = materials[0];\n\t\t} else if (materials.length > 1) {\n\t\t\t// Assign each sub-mesh in the mesh a material from the list. If more sub-meshes\n\t\t\t// than materials, repeat the last material for all remaining sub-meshes.\n\t\t\tfor (var i:number = 0; i < mesh.subMeshes.length; i++)\n\t\t\t\tmesh.subMeshes[i].material = materials[Math.min(materials.length - 1, i)];\n\t\t}\n\t\tif ((this._version[0] == 2) && (this._version[1] == 1)) {\n\t\t\tvar props:AWDProperties = this.parseProperties(AWDParser.meshInstanceProperties);\n\t\t\tmesh.pivot = new Vector3D(props.get(1, 0), props.get(2, 0), props.get(3, 0));\n\t\t\tmesh.castsShadows = props.get(5, true);\n\t\t} else {\n\t\t\tthis.parseProperties(null);\n\t\t}\n\n\t\tmesh.extra = this.parseUserAttributes();\n\n\t\tthis._pFinalizeAsset(<IAsset> mesh, name);\n\t\tthis._blocks[blockID].data = mesh;\n\n\t\tif (this._debug) {\n\t\t\tif (isPrefab)\n\t\t\t\tconsole.log(\"Parsed a Mesh for Prefab: Name = '\" + name + \"' | Parent-Name = \" + parentName + \"| Prefab-Name = \" + prefab.name + \" | SubMeshes = \" + mesh.subMeshes.length + \" | Mat-Names = \" + materialNames);\n\t\t\telse\n\t\t\t\tconsole.log(\"Parsed a Mesh for Geometry: Name = '\" + name + \"' | Parent-Name = \" + parentName + \"| Geometry-Name = \" + geom.name + \" | SubMeshes = \" + mesh.subMeshes.length + \" | Mat-Names = \" + materialNames);\n\t\t}\n\t}\n\n\n\t//Block ID 31\n\tprivate parseSkyboxInstance(blockID:number)\n\t{\n\t\tvar name:string = this.parseVarStr();\n\t\tvar asset:Skybox = new Skybox();\n\t\tvar tex:SingleCubeTexture = <SingleCubeTexture> (this._blocks[this._newBlockBytes.readUnsignedInt()].data || DefaultMaterialManager.getDefaultTexture(asset));\n\t\tasset.texture = tex;\n\n\t\tthis.parseProperties(null);\n\t\tasset.extra = this.parseUserAttributes();\n\t\tthis._pFinalizeAsset(asset, name);\n\t\tthis._blocks[blockID].data = asset;\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a Skybox: Name = '\" + name + \"' | CubeTexture-Name = \" + tex.name);\n\t}\n\n\tprivate static lightProperties:Object = {\n\t\t1:AWDParser.PROPERTY_NUMBER,\n\t\t2:AWDParser.PROPERTY_NUMBER,\n\t\t3:AWDParser.COLOR,\n\t\t4:AWDParser.PROPERTY_NUMBER,\n\t\t5:AWDParser.PROPERTY_NUMBER,\n\t\t6:AWDParser.BOOL,\n\t\t7:AWDParser.COLOR,\n\t\t8:AWDParser.PROPERTY_NUMBER,\n\t\t9:AWDParser.UINT8,\n\t\t10:AWDParser.UINT8,\n\t\t11:AWDParser.PROPERTY_NUMBER,\n\t\t12:AWDParser.UINT16,\n\t\t21:AWDParser.MATRIX_NUMBER,\n\t\t22:AWDParser.MATRIX_NUMBER,\n\t\t23:AWDParser.MATRIX_NUMBER};\n\n\t//Block ID = 41\n\tprivate parseLight(blockID:number)\n\t{\n\t\tvar light:LightBase;\n\t\tvar newShadowMapper:ShadowMapperBase;\n\n\t\tvar parent:DisplayObjectContainer = <DisplayObjectContainer> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\tvar mtx:Matrix3D = this.parseMatrix3D();\n\t\tvar name:string = this.parseVarStr();\n\t\tvar lightType:number = this._newBlockBytes.readUnsignedByte();\n\t\tvar props:AWDProperties = this.parseProperties(AWDParser.lightProperties);\n\t\tvar shadowMapperType:number = props.get(9, 0);\n\t\tvar lightTypes:Array<string> = [\"Unsupported LightType\", \"PointLight\", \"DirectionalLight\"];\n\t\tvar shadowMapperTypes:Array<string> = [\"No ShadowMapper\", \"DirectionalShadowMapper\", \"NearDirectionalShadowMapper\", \"CascadeShadowMapper\", \"CubeMapShadowMapper\"];\n\n\t\tif (lightType == 1) {\n\t\t\tlight = new PointLight();\n\n\t\t\t(<PointLight> light).radius = props.get(1, 90000);\n\t\t\t(<PointLight> light).fallOff = props.get(2, 100000);\n\n\t\t\tif (shadowMapperType > 0) {\n\t\t\t\tif (shadowMapperType == 4) {\n\t\t\t\t\tnewShadowMapper = new CubeMapShadowMapper();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlight.transform.matrix3D = mtx;\n\t\t}\n\n\t\tif (lightType == 2) {\n\t\t\tlight = new DirectionalLight(props.get(21, 0), props.get(22, -1), props.get(23, 1));\n\n\t\t\tif (shadowMapperType > 0) {\n\t\t\t\tif (shadowMapperType == 1) {\n\t\t\t\t\tnewShadowMapper = new DirectionalShadowMapper();\n\t\t\t\t}\n\n\t\t\t\t//if (shadowMapperType == 2)\n\t\t\t\t//  newShadowMapper = new NearDirectionalShadowMapper(props.get(11, 0.5));\n\t\t\t\t//if (shadowMapperType == 3)\n\t\t\t\t//   newShadowMapper = new CascadeShadowMapper(props.get(12, 3));\n\n\t\t\t}\n\t\t}\n\n\t\tlight.color = props.get(3, 0xffffff);\n\t\tlight.specular = props.get(4, 1.0);\n\t\tlight.diffuse = props.get(5, 1.0);\n\t\tlight.ambientColor = props.get(7, 0xffffff);\n\t\tlight.ambient = props.get(8, 0.0);\n\n\t\t// if a shadowMapper has been created, adjust the depthMapSize if needed, assign to light and set castShadows to true\n\t\tif (newShadowMapper) {\n\t\t\tif (newShadowMapper instanceof CubeMapShadowMapper) {\n\t\t\t\tif (props.get(10, 1) != 1)\n\t\t\t\t\tnewShadowMapper.depthMapSize = this._depthSizeDic[props.get(10, 1)];\n\t\t\t} else {\n\t\t\t\tif (props.get(10, 2) != 2)\n\t\t\t\t\tnewShadowMapper.depthMapSize = this._depthSizeDic[props.get(10, 2)];\n\t\t\t}\n\n\t\t\tlight.shadowMapper = newShadowMapper;\n\t\t\tlight.castsShadows = true;\n\t\t}\n\n\t\tvar parentName:string = \"Root (TopLevel)\";\n\t\tif (parent) {\n\t\t\tparent.addChild(light);\n\t\t\tparentName = parent.name;\n\t\t} else {\n\t\t\t//add to the content property\n\t\t\t(<DisplayObjectContainer> this._pContent).addChild(light);\n\t\t}\n\n\t\tthis.parseUserAttributes();\n\t\tthis._pFinalizeAsset(< IAsset> light, name);\n\n\t\tthis._blocks[blockID].data = light;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a Light: Name = '\" + name + \"' | Type = \" + lightTypes[lightType] + \" | Parent-Name = \" + parentName + \" | ShadowMapper-Type = \" + shadowMapperTypes[shadowMapperType]);\n\t}\n\n\tprivate static cameraProperties:Object = {\n\t\t101:AWDParser.PROPERTY_NUMBER,\n\t\t102:AWDParser.PROPERTY_NUMBER,\n\t\t103:AWDParser.PROPERTY_NUMBER,\n\t\t104:AWDParser.PROPERTY_NUMBER};\n\n\tprivate static cameraPivotProperties:Object = {\n\t\t1:AWDParser.MATRIX_NUMBER,\n\t\t2:AWDParser.MATRIX_NUMBER,\n\t\t3:AWDParser.MATRIX_NUMBER,\n\t\t4:AWDParser.UINT8};\n\n\t//Block ID = 43\n\tprivate parseCamera(blockID:number)\n\t{\n\t\tvar parent:DisplayObjectContainer = <DisplayObjectContainer> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\tvar mtx:Matrix3D = this.parseMatrix3D();\n\t\tvar name:string = this.parseVarStr();\n\t\tvar projection:ProjectionBase;\n\n\t\tthis._newBlockBytes.readUnsignedByte(); //set as active camera\n\t\tthis._newBlockBytes.readShort(); //lengthof lenses - not used yet\n\n\t\tvar projectiontype:number = this._newBlockBytes.readShort();\n\t\tvar props:AWDProperties = this.parseProperties(AWDParser.cameraProperties);\n\n\t\tswitch (projectiontype) {\n\t\t\tcase 5001:\n\t\t\t\tprojection = new PerspectiveProjection(props.get(101, 60));\n\t\t\t\tbreak;\n\t\t\tcase 5002:\n\t\t\t\tprojection = new OrthographicProjection(props.get(101, 500));\n\t\t\t\tbreak;\n\t\t\tcase 5003:\n\t\t\t\tprojection = new OrthographicOffCenterProjection(props.get(101, -400), props.get(102, 400), props.get(103, -300), props.get(104, 300));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.log(\"unsupportedLenstype\");\n\t\t\t\treturn;\n\t\t}\n\n\t\tvar camera:Camera = new Camera(projection);\n\t\tcamera.transform.matrix3D = mtx;\n\n\t\tvar parentName:string = \"Root (TopLevel)\";\n\t\tif (parent) {\n\t\t\tparent.addChild(camera);\n\t\t\tparentName = parent.name;\n\t\t} else {\n\t\t\t//add to the content property\n\t\t\t(<DisplayObjectContainer> this._pContent).addChild(camera);\n\t\t}\n\n\t\tcamera.name = name;\n\t\tprops = this.parseProperties(AWDParser.cameraPivotProperties);\n\t\tcamera.pivot = new Vector3D(props.get(1, 0), props.get(2, 0), props.get(3, 0));\n\t\tcamera.extra = this.parseUserAttributes();\n\n\t\tthis._pFinalizeAsset(camera, name);\n\n\t\tthis._blocks[blockID].data = camera;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a Camera: Name = '\" + name + \"' | Projectiontype = \" + projection + \" | Parent-Name = \" + parentName);\n\t}\n\n\t//Block ID = 51\n\tprivate parseLightPicker(blockID:number)\n\t{\n\t\tvar name:string = this.parseVarStr();\n\t\tvar numLights:number = this._newBlockBytes.readUnsignedShort();\n\t\tvar lightsArray:Array<LightBase> = new Array<LightBase>();\n\n\t\tvar lightsArrayNames:Array<string> = new Array<string>();\n\n\t\tfor (var k:number = 0; k < numLights; k++) {\n\t\t\tvar light:LightBase = <LightBase> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\t\tlightsArray.push(light);\n\t\t\tlightsArrayNames.push(light.name);\n\t\t}\n\n\t\tif (lightsArray.length == 0) {\n\t\t\tthis._blocks[blockID].addError(\"Could not create this LightPicker, cause no Light was found.\");\n\t\t\tthis.parseUserAttributes();\n\t\t\treturn; //return without any more parsing for this block\n\t\t}\n\n\t\tvar lightPick:LightPickerBase = new StaticLightPicker(lightsArray);\n\t\tlightPick.name = name;\n\n\t\tthis.parseUserAttributes();\n\t\tthis._pFinalizeAsset(<IAsset> lightPick, name);\n\n\t\tthis._blocks[blockID].data = lightPick;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a StaticLightPicker: Name = '\" + name + \"' | Texture-Name = \" + lightsArrayNames);\n\t}\n\n\t// (1=color, 2=bitmap url, 10=alpha, 11=alpha_blending, 12=alpha_threshold, 13=repeat)\n\tprivate static materialProperties:Object = {\n\t\t1:AWDParser.INT32,\n\t\t2:AWDParser.BADDR,\n\t\t10:AWDParser.PROPERTY_NUMBER,\n\t\t11:AWDParser.BOOL,\n\t\t12:AWDParser.PROPERTY_NUMBER,\n\t\t13:AWDParser.BOOL};\n\n\t//Block ID = 81\n\tprivate parseMaterial(blockID:number)\n\t{\n\t\t// TODO: not used\n\t\t////blockLength = block.len;\n\t\tvar name:string;\n\t\tvar type:number;\n\t\tvar props:AWDProperties;\n\t\tvar mat:MethodMaterial;\n\t\tvar finalize:boolean;\n\t\tvar num_methods:number;\n\t\tvar methods_parsed:number;\n\t\tvar returnedArray:Array<any>;\n\n\t\tname = this.parseVarStr();\n\t\ttype = this._newBlockBytes.readUnsignedByte();\n\t\tnum_methods = this._newBlockBytes.readUnsignedByte();\n\n\t\t// Read material numerical properties\n\t\tprops = this.parseProperties(AWDParser.materialProperties);\n\n\t\tmethods_parsed = 0;\n\t\twhile (methods_parsed < num_methods) {\n\t\t\tvar method_type:number;\n\n\t\t\tmethod_type = this._newBlockBytes.readUnsignedShort();\n\t\t\tthis.parseProperties(null);\n\t\t\tthis.parseUserAttributes();\n\t\t\tmethods_parsed += 1;\n\t\t}\n\n\t\tvar debugString:string = \"\";\n\t\tif (type === 1) { // Color material\n\t\t\tdebugString += \"Parsed a ColorMaterial(SinglePass): Name = '\" + name + \"' | \";\n\t\t\tvar color:number = props.get(1, 0xffffff);\n\t\t\tif (this.materialMode < 2) {\n\t\t\t\tmat = new MethodMaterial(color, props.get(10, 1.0));\n\t\t\t} else {\n\t\t\t\tmat = new MethodMaterial(color);\n\t\t\t\tmat.mode = MethodMaterialMode.MULTI_PASS;\n\t\t\t}\n\t\t} else if (type === 2) {\n\t\t\tvar texture:Single2DTexture = <Single2DTexture> this._blocks[props.get(2, 0)].data;\n\n\t\t\tmat = new MethodMaterial();\n\t\t\tmat.ambientMethod.texture = texture;\n\n\t\t\tif (this.materialMode < 2) {\n\t\t\t\tmat.alphaBlending = props.get(11, false);\n\t\t\t\tmat.alpha = props.get(10, 1.0);\n\t\t\t\tdebugString += \"Parsed a MethodMaterial(SinglePass): Name = '\" + name + \"'\" + (texture? \" | Texture-Name = \" + texture.name : \"\");\n\t\t\t} else {\n\t\t\t\tmat.mode = MethodMaterialMode.MULTI_PASS;\n\t\t\t\tdebugString += \"Parsed a MethodMaterial(MultiPass): Name = '\" + name + \"'\" + (texture? \" | Texture-Name = \" + texture.name : \"\");\n\t\t\t}\n\t\t}\n\n\t\tmat.extra = this.parseUserAttributes();\n\t\tmat.alphaThreshold = props.get(12, 0.0);\n\t\tmat.style.sampler = new Sampler2D(props.get(13, false));\n\n\t\tthis._pFinalizeAsset(<IAsset> mat, name);\n\n\t\tthis._blocks[blockID].data = mat;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(debugString);\n\t}\n\t\n\tprivate static material_v1Properties:Object = {1:AWDParser.UINT32,\n\t\t2:AWDParser.BADDR,\n\t\t3:AWDParser.BADDR,\n\t\t4:AWDParser.UINT8,\n\t\t5:AWDParser.BOOL,\n\t\t6:AWDParser.BOOL,\n\t\t7:AWDParser.BOOL,\n\t\t8:AWDParser.BOOL,\n\t\t9:AWDParser.UINT8,\n\t\t10:AWDParser.PROPERTY_NUMBER,\n\t\t11:AWDParser.BOOL,\n\t\t12:AWDParser.PROPERTY_NUMBER,\n\t\t13:AWDParser.BOOL,\n\t\t15:AWDParser.PROPERTY_NUMBER,\n\t\t16:AWDParser.UINT32,\n\t\t17:AWDParser.BADDR,\n\t\t18:AWDParser.PROPERTY_NUMBER,\n\t\t19:AWDParser.PROPERTY_NUMBER,\n\t\t20:AWDParser.UINT32,\n\t\t21:AWDParser.BADDR,\n\t\t22:AWDParser.BADDR};\n\n\tprivate static method_v1Properties:Object = {\n\t\t1:AWDParser.BADDR,\n\t\t2:AWDParser.BADDR,\n\t\t3:AWDParser.BADDR,\n\t\t101:AWDParser.PROPERTY_NUMBER,\n\t\t102:AWDParser.PROPERTY_NUMBER,\n\t\t103:AWDParser.PROPERTY_NUMBER,\n\t\t201:AWDParser.UINT32,\n\t\t202:AWDParser.UINT32,\n\t\t301:AWDParser.UINT16,\n\t\t302:AWDParser.UINT16,\n\t\t401:AWDParser.UINT8,\n\t\t402:AWDParser.UINT8,\n\t\t601:AWDParser.COLOR,\n\t\t602:AWDParser.COLOR,\n\t\t701:AWDParser.BOOL,\n\t\t702:AWDParser.BOOL,\n\t\t801:AWDParser.MTX4x4};\n\n\t// Block ID = 81 AWD2.1\n\tprivate parseMaterial_v1(blockID:number)\n\t{\n\t\tvar mat:MethodMaterial;\n\t\tvar diffuseTexture:Single2DTexture;\n\t\tvar normalTexture:TextureBase;\n\t\tvar specTexture:TextureBase;\n\n\t\tvar name:string = this.parseVarStr();\n\t\tvar type:number = this._newBlockBytes.readUnsignedByte();\n\t\tvar num_methods:number = this._newBlockBytes.readUnsignedByte();\n\t\tvar props:AWDProperties = this.parseProperties(AWDParser.material_v1Properties);\n\t\tvar spezialType:number = props.get(4, 0);\n\t\tvar debugString:string = \"Parsed Material \";\n\n\t\tif (spezialType >= 2) {//this is no supported material\n\t\t\tthis._blocks[blockID].addError(\"Material-spezialType '\" + spezialType + \"' is not supported, can only be 0:singlePass, 1:MultiPass !\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (type <= 2) {// Color material\n\t\t\tif (this.materialMode == 1)\n\t\t\t\tspezialType = 0;\n\t\t\telse if (this.materialMode == 2)\n\t\t\t\tspezialType = 1;\n\n\t\t\tif (spezialType < 2) {//this is SinglePass or MultiPass\n\n\t\t\t\tif (type == 1) {// Color material\n\t\t\t\t\tvar color:number = props.get(1, 0xcccccc);//TODO temporarily swapped so that diffuse color goes to ambient\n\n\t\t\t\t\tif (spezialType == 1) {//\tMultiPassMaterial\n\t\t\t\t\t\tmat = new MethodMaterial(color);\n\t\t\t\t\t\tmat.mode = MethodMaterialMode.MULTI_PASS;\n\t\t\t\t\t\tdebugString += \"Parsed a ColorMaterial(MultiPass): Name = '\" + name + \"' | \";\n\n\t\t\t\t\t} else { //\tSinglePassMaterial\n\t\t\t\t\t\tmat = new MethodMaterial(color, props.get(10, 1.0));\n\t\t\t\t\t\tmat.alphaBlending = props.get(11, false);\n\t\t\t\t\t\tdebugString += \"Parsed a ColorMaterial(SinglePass): Name = '\" + name + \"' | \";\n\t\t\t\t\t}\n\n\t\t\t\t} else if (type == 2) {// texture material\n\t\t\t\t\tvar texture:Single2DTexture = <Single2DTexture> this._blocks[props.get(2, 0)].data;\n\n\t\t\t\t\tmat = new MethodMaterial();\n\t\t\t\t\tmat.ambientMethod.texture = texture;\n\n\t\t\t\t\tif (spezialType == 1) {// MultiPassMaterial\n\t\t\t\t\t\tmat.mode = MethodMaterialMode.MULTI_PASS;\n\n\t\t\t\t\t\tdebugString += \"Parsed a MethodMaterial(MultiPass): Name = '\" + name + \"'\" + (texture? \" | Texture-Name = \" + texture.name : \"\");\n\t\t\t\t\t} else {//\tSinglePassMaterial\n\t\t\t\t\t\tmat.alpha = props.get(10, 1.0);\n\t\t\t\t\t\tmat.alphaBlending = props.get(11, false);\n\n\t\t\t\t\t\tdebugString += \"Parsed a MethodMaterial(SinglePass): Name = '\" + name + \"'\" + (texture? \" | Texture-Name = \" + texture.name : \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tdiffuseTexture = <Single2DTexture> this._blocks[props.get(17, 0)].data;\n\t\t\t\tnormalTexture = <TextureBase> this._blocks[props.get(3, 0)].data;\n\t\t\t\tspecTexture = <TextureBase> this._blocks[props.get(21, 0)].data;\n\t\t\t\tmat.lightPicker = <LightPickerBase> this._blocks[props.get(22, 0)].data;\n\t\t\t\tmat.style.sampler = new Sampler2D(props.get(13, false), props.get(5, true), props.get(6, true))\n\t\t\t\tmat.bothSides = props.get(7, false);\n\t\t\t\tmat.alphaPremultiplied = props.get(8, false);\n\t\t\t\tmat.blendMode = this.blendModeDic[props.get(9, 0)];\n\n\t\t\t\tif (diffuseTexture) {\n\t\t\t\t\tmat.diffuseTexture = diffuseTexture;\n\t\t\t\t\tdebugString += \" | DiffuseTexture-Name = \" + diffuseTexture.name;\n\t\t\t\t}\n\n\t\t\t\tif (normalTexture) {\n\t\t\t\t\tmat.normalMethod.texture = normalTexture;\n\t\t\t\t\tdebugString += \" | NormalTexture-Name = \" + normalTexture.name;\n\t\t\t\t}\n\n\t\t\t\tif (specTexture) {\n\t\t\t\t\tmat.specularMethod.texture = specTexture;\n\t\t\t\t\tdebugString += \" | SpecularTexture-Name = \" + specTexture.name;\n\t\t\t\t}\n\n\t\t\t\tmat.alphaThreshold = props.get(12, 0.0);\n\t\t\t\tmat.ambientMethod.strength = props.get(15, 1.0);\n\t\t\t\tmat.diffuseMethod.color = props.get(16, 0xffffff);\n\t\t\t\tmat.specularMethod.strength = props.get(18, 1.0);\n\t\t\t\tmat.specularMethod.gloss = props.get(19, 50);\n\t\t\t\tmat.specularMethod.color = props.get(20, 0xffffff);\n\n\t\t\t\tfor (var methods_parsed:number = 0; methods_parsed < num_methods; methods_parsed++) {\n\t\t\t\t\tvar method_type:number;\n\t\t\t\t\tmethod_type = this._newBlockBytes.readUnsignedShort();\n\n\t\t\t\t\tprops = this.parseProperties(AWDParser.method_v1Properties);\n\n\t\t\t\t\tswitch (method_type) {\n\t\t\t\t\t\tcase 999: //wrapper-Methods that will load a previous parsed EffektMethod returned\n\t\t\t\t\t\t\tvar effectMethod:EffectMethodBase = <EffectMethodBase> this._blocks[props.get(1, 0)].data;\n\t\t\t\t\t\t\tmat.addEffectMethod(effectMethod);\n\t\t\t\t\t\t\tdebugString += \" | EffectMethod-Name = \" + effectMethod.name;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 998: //wrapper-Methods that will load a previous parsed ShadowMapMethod\n\t\t\t\t\t\t\tvar shadowMapMethod:ShadowMapMethodBase = <ShadowMapMethodBase> this._blocks[props.get(1, 0)].data;\n\t\t\t\t\t\t\tmat.shadowMethod = shadowMapMethod;\n\t\t\t\t\t\t\tdebugString += \" | ShadowMethod-Name = \" + shadowMapMethod.name;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 1: //EnvMapAmbientMethod\n\t\t\t\t\t\t\tvar cubeTexture:SingleCubeTexture = <SingleCubeTexture> this._blocks[props.get(1, 0)].data;\n\t\t\t\t\t\t\tmat.ambientMethod = new AmbientEnvMapMethod();\n\t\t\t\t\t\t\tmat.ambientMethod.texture = cubeTexture;\n\t\t\t\t\t\t\tdebugString += \" | AmbientEnvMapMethod | EnvMap-Name =\" + cubeTexture.name;\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 51: //DepthDiffuseMethod\n\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseDepthMethod();\n\t\t\t\t\t\t\tdebugString += \" | DiffuseDepthMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 52: //GradientDiffuseMethod\n\t\t\t\t\t\t\tvar texture:Single2DTexture = <Single2DTexture> this._blocks[props.get(1, 0)].data;\n\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseGradientMethod(texture);\n\t\t\t\t\t\t\tdebugString += \" | DiffuseGradientMethod | GradientDiffuseTexture-Name =\" + texture.name;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 53: //WrapDiffuseMethod\n\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseWrapMethod(props.get(101, 5));\n\t\t\t\t\t\t\tdebugString += \" | DiffuseWrapMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 54: //LightMapDiffuseMethod\n\t\t\t\t\t\t\tvar texture:Single2DTexture = <Single2DTexture> this._blocks[props.get(1, 0)].data;\n\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseLightMapMethod(texture, this.blendModeDic[props.get(401, 10)], false, mat.diffuseMethod);\n\t\t\t\t\t\t\tdebugString += \" | DiffuseLightMapMethod | LightMapTexture-Name =\" + texture.name;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 55: //CelDiffuseMethod\n\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseCelMethod(props.get(401, 3), mat.diffuseMethod);\n\t\t\t\t\t\t\t(<DiffuseCelMethod> mat.diffuseMethod).smoothness = props.get(101, 0.1);\n\t\t\t\t\t\t\tdebugString += \" | DiffuseCelMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 56: //SubSurfaceScatteringMethod\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\tmat.diffuseMethod = new DiffuseSubSurfaceMethod(); //depthMapSize and depthMapOffset ?\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\t(<DiffuseSubSurfaceMethod> mat.diffuseMethod).scattering = props.get(101, 0.2);\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\t(<DiffuseSubSurfaceMethod> mat.diffuseMethod).translucency = props.get(102, 1);\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\t(<DiffuseSubSurfaceMethod> mat.diffuseMethod).scatterColor = props.get(601, 0xffffff);\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\tdebugString += \" | DiffuseSubSurfaceMethod\";\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 101: //AnisotropicSpecularMethod\n\t\t\t\t\t\t\tmat.specularMethod = new SpecularAnisotropicMethod();\n\t\t\t\t\t\t\tdebugString += \" | SpecularAnisotropicMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 102: //SpecularPhongMethod\n\t\t\t\t\t\t\tmat.specularMethod = new SpecularPhongMethod();\n\t\t\t\t\t\t\tdebugString += \" | SpecularPhongMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 103: //CellSpecularMethod\n\t\t\t\t\t\t\tmat.specularMethod = new SpecularCelMethod(props.get(101, 0.5), mat.specularMethod);\n\t\t\t\t\t\t\t(<SpecularCelMethod> mat.specularMethod).smoothness = props.get(102, 0.1);\n\t\t\t\t\t\t\tdebugString += \" | SpecularCelMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 104: //SpecularFresnelMethod\n\t\t\t\t\t\t\tmat.specularMethod = new SpecularFresnelMethod(props.get(701, true), mat.specularMethod);\n\t\t\t\t\t\t\t(<SpecularFresnelMethod> mat.specularMethod).fresnelPower = props.get(101, 5);\n\t\t\t\t\t\t\t(<SpecularFresnelMethod> mat.specularMethod).normalReflectance = props.get(102, 0.1);\n\t\t\t\t\t\t\tdebugString += \" | SpecularFresnelMethod\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 151://HeightMapNormalMethod - thios is not implemented for now, but might appear later\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 152: //SimpleWaterNormalMethod\n\t\t\t\t\t\t\tvar texture:Single2DTexture = <Single2DTexture> this._blocks[props.get(1, 0)].data;\n\t\t\t\t\t\t\tmat.normalMethod = new NormalSimpleWaterMethod(<Single2DTexture> mat.normalMethod.texture || texture, texture);\n\t\t\t\t\t\t\tdebugString += \" | NormalSimpleWaterMethod | Second-NormalTexture-Name = \" + texture.name;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tthis.parseUserAttributes();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// todo: we should not need this anymore (if using texture-atlas)\n\t\telse if ((type>=3)&&(type<=7)){\n\t\t\t// if this is a basic material, we create it, finalize it, assign it to block-cache and return and return.\n\t\t\tvar color:number = props.get(1, 0xcccccc);\n\t\t\tdebugString+=color;\n\t\t\n\t\t\tvar diffuseTexture:Single2DTexture = <Single2DTexture> this._blocks[props.get(2, 0)].data;\n\t\t\tvar basic_mat:BasicMaterial = new BasicMaterial();\n\t\t\tbasic_mat.texture = diffuseTexture;\n\t\t\tbasic_mat.bothSides = true;\n\t\t\tbasic_mat.preserveAlpha = true;\n\t\t\tbasic_mat.alphaBlending = true;\n\t\t\tbasic_mat.extra = this.parseUserAttributes();\n\t\t\tthis._pFinalizeAsset(<IAsset> basic_mat, name);\n\t\t\tthis._blocks[blockID].data = basic_mat;\n\t\t\tif (this._debug)\n\t\t\t\tconsole.log(debugString);\n\t\t\treturn;\n\t\t\n\t\t}\n\t\tmat.extra = this.parseUserAttributes();\n\t\tthis._pFinalizeAsset(<IAsset> mat, name);\n\n\t\tthis._blocks[blockID].data = mat;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(debugString);\n\t}\n\n\t//Block ID = 82\n\tprivate parseTexture(blockID:number)\n\t{\n\t\tthis._blocks[blockID].name = this.parseVarStr();\n\n\t\tvar type:number = this._newBlockBytes.readUnsignedByte();\n\n\t\tthis._texture_users[this._cur_block_id] = [];\n\n\t\t// External\n\t\tif (type == 0) {\n\t\t\tvar url:string = this._newBlockBytes.readUTFBytes(this._newBlockBytes.readUnsignedInt());\n\t\t\tthis._pAddDependency(this._cur_block_id.toString(), new URLRequest(url), false, null, true);\n\n\t\t} else {\n\t\t\tvar data_len:number = this._newBlockBytes.readUnsignedInt();\n\t\t\tvar data:ByteArray = new ByteArray(data_len);\n\t\t\tthis._newBlockBytes.readBytes(data, 0, data_len);\n\n\t\t\t//\n\t\t\t// AWD3Parserutils - Fix for FireFox Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=715075 .\n\t\t\t//\n\t\t\t// Converting data to image here instead of parser - fix FireFox bug where image width / height is 0 when created from data\n\t\t\t// This gives the browser time to initialise image width / height.\n\n\t\t\tthis._pAddDependency(this._cur_block_id.toString(), null, false, data, true);\n\t\t\t//this._pAddDependency(this._cur_block_id.toString(), null, false, data, true);\n\n\t\t}\n\n\t\t// Ignore for now\n\t\tthis.parseProperties(null);\n\t\tthis._blocks[blockID].extras = this.parseUserAttributes();\n\n\t\tthis._pPauseAndRetrieveDependencies();\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Start parsing a \" + [\"external\", \"embed\"][type] + \" Bitmap for Texture\");\n\t}\n\n\t//Block ID = 83\n\tprivate parseCubeTexture(blockID:number)\n\t{\n\t\t//blockLength = block.len;\n\t\tvar data_len:number;\n\t\tvar i:number;\n\n\t\tthis._texture_users[ this._cur_block_id ] = [];\n\n\t\tvar type:number = this._newBlockBytes.readUnsignedByte();\n\n\t\tthis._blocks[blockID].name = this.parseVarStr();\n\n\t\tfor (i = 0; i < 6; i++) {\n\t\t\tthis._texture_users[this._cur_block_id] = [];\n\n\t\t\t// External\n\t\t\tif (type == 0) {\n\t\t\t\tdata_len = this._newBlockBytes.readUnsignedInt();\n\t\t\t\tvar url:string;\n\t\t\t\turl = this._newBlockBytes.readUTFBytes(data_len);\n\t\t\t\tthis._pAddDependency(this._cur_block_id.toString(), new URLRequest(url), false, null, true, i);\n\t\t\t} else {\n\n\t\t\t\tdata_len = this._newBlockBytes.readUnsignedInt();\n\t\t\t\tvar data:ByteArray = new ByteArray(data_len);\n\t\t\t\tthis._newBlockBytes.readBytes(data, 0, data_len);\n\n\t\t\t\tthis._pAddDependency(this._cur_block_id.toString(), null, false, ParserUtils.byteArrayToImage(data), true, i);\n\t\t\t}\n\t\t}\n\n\t\t// Ignore for now\n\t\tthis.parseProperties(null);\n\t\tthis._blocks[blockID].extras = this.parseUserAttributes();\n\t\tthis._pPauseAndRetrieveDependencies();\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Start parsing 6 \" + [\"external\", \"embed\"][type] + \" Bitmaps for CubeTexture\");\n\t}\n\n\t//Block ID = 91\n\tprivate parseSharedMethodBlock(blockID:number)\n\t{\n\t\tvar asset:EffectMethodBase;\n\n\t\tthis._blocks[blockID].name = this.parseVarStr();\n\t\tasset = this.parseSharedMethodList(blockID);\n\t\tthis.parseUserAttributes();\n\t\tthis._blocks[blockID].data = asset;\n\t\tthis._pFinalizeAsset(<IAsset> asset, this._blocks[blockID].name);\n\t\tthis._blocks[blockID].data = asset;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a EffectMethod: Name = \" + asset.name + \" Type = \" + asset);\n\t}\n\n\t//Block ID = 92\n\tprivate parseShadowMethodBlock(blockID:number)\n\t{\n\t\tthis._blocks[blockID].name = this.parseVarStr();\n\t\tvar light:LightBase = <LightBase> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\tvar asset:ShadowMethodBase = this.parseShadowMethodList(light, blockID);\n\n\t\tif (!asset)\n\t\t\treturn;\n\n\t\tthis.parseUserAttributes(); // Ignore for now\n\t\tthis._pFinalizeAsset(<IAsset> asset, this._blocks[blockID].name);\n\t\tthis._blocks[blockID].data = asset;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a ShadowMapMethodMethod: Name = \" + asset.name + \" | Type = \" + asset + \" | Light-Name = \", light.name);\n\t}\n\n\tprivate static commandProperties:Object = {\n\t\t1:AWDParser.BADDR};\n\n\tprivate static targetProperties:Object = {\n\t\t1:AWDParser.MATRIX_NUMBER,\n\t\t2:AWDParser.MATRIX_NUMBER,\n\t\t3:AWDParser.MATRIX_NUMBER,\n\t\t4:AWDParser.UINT8};\n\t\n\t//Block ID = 253\n\tprivate parseCommand(blockID:number)\n\t{\n\t\tvar hasBlocks:boolean = ( this._newBlockBytes.readUnsignedByte() == 1 );\n\t\tvar parentObject:DisplayObjectContainer = <DisplayObjectContainer> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\tvar targetObject:DisplayObjectContainer;\n\t\tvar mtx:Matrix3D = this.parseMatrix3D();\n\t\tvar name:string = this.parseVarStr();\n\n\t\tvar numCommands:number = this._newBlockBytes.readShort();\n\t\tvar typeCommand:number = this._newBlockBytes.readShort();\n\n\t\tvar props:AWDProperties = this.parseProperties(AWDParser.commandProperties);\n\n\t\tswitch (typeCommand) {\n\t\t\tcase 1:\n\t\t\t\ttargetObject = this._blocks[props.get(1, 0)].data;\n\t\t\t\ttargetObject.transform.matrix3D = mtx;\n\n\t\t\t\tif (parentObject)\n\t\t\t\t\tparentObject.addChild(targetObject);\n\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (targetObject) {\n\t\t\tprops = this.parseProperties(AWDParser.targetProperties);\n\n\t\t\ttargetObject.pivot = new Vector3D(props.get(1, 0), props.get(2, 0), props.get(3, 0));\n\t\t\ttargetObject.extra = this.parseUserAttributes();\n\t\t}\n\n\t\tthis._blocks[blockID].data = targetObject;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a CommandBlock: Name = '\" + name);\n\t}\n\t\n\tprivate static metaDataProperties:Object = {\n\t\t1:AWDParser.UINT32,\n\t\t2:AWDParser.AWDSTRING,\n\t\t3:AWDParser.AWDSTRING,\n\t\t4:AWDParser.AWDSTRING,\n\t\t5:AWDParser.AWDSTRING};\n\n\t//blockID 255\n\tprivate parseMetaData(blockID:number)\n\t{\n\t\tvar props:AWDProperties = this.parseProperties(AWDParser.metaDataProperties);\n\n\t\tif (this._debug) {\n\t\t\tconsole.log(\"Parsed a MetaDataBlock: TimeStamp         = \" + props.get(1, 0));\n\t\t\tconsole.log(\"                        EncoderName       = \" + props.get(2, \"unknown\"));\n\t\t\tconsole.log(\"                        EncoderVersion    = \" + props.get(3, \"unknown\"));\n\t\t\tconsole.log(\"                        GeneratorName     = \" + props.get(4, \"unknown\"));\n\t\t\tconsole.log(\"                        GeneratorVersion  = \" + props.get(5, \"unknown\"));\n\t\t}\n\t}\n\n\t//blockID 254\n\tprivate parseNameSpace(blockID:number)\n\t{\n\t\tvar id:number = this._newBlockBytes.readUnsignedByte();\n\t\tvar nameSpaceString:string = this.parseVarStr();\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a NameSpaceBlock: ID = \" + id + \" | String = \" + nameSpaceString);\n\t}\n\n\t//--Parser UTILS---------------------------------------------------------------------------\n\n\tprivate shadowMethodListProperties:Object = {\n\t\t1:AWDParser.BADDR,\n\t\t2:AWDParser.BADDR,\n\t\t3:AWDParser.BADDR,\n\t\t101:AWDParser.PROPERTY_NUMBER,\n\t\t102:AWDParser.PROPERTY_NUMBER,\n\t\t103:AWDParser.PROPERTY_NUMBER,\n\t\t201:AWDParser.UINT32,\n\t\t202:AWDParser.UINT32,\n\t\t301:AWDParser.UINT16,\n\t\t302:AWDParser.UINT16,\n\t\t401:AWDParser.UINT8,\n\t\t402:AWDParser.UINT8,\n\t\t601:AWDParser.COLOR,\n\t\t602:AWDParser.COLOR,\n\t\t701:AWDParser.BOOL,\n\t\t702:AWDParser.BOOL,\n\t\t801:AWDParser.MTX4x4}\n\t\n\t// this functions reads and creates a ShadowMethodMethod\n\tprivate parseShadowMethodList(light:LightBase, blockID:number):ShadowMethodBase\n\t{\n\n\t\tvar methodType:number = this._newBlockBytes.readUnsignedShort();\n\t\tvar shadowMethod:ShadowMethodBase;\n\t\tvar props:AWDProperties = this.parseProperties(this.shadowMethodListProperties);\n\n\t\tvar targetID:number;\n\t\tvar returnedArray:Array<any>\n\t\tswitch (methodType) {\n\t\t\t//\t\t\t\tcase 1001: //CascadeShadowMapMethod\n\t\t\t//\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t//\t\t\t\t\treturnedArray = getAssetByID(targetID, [ShadowMapMethodBase.assetType]);\n\t\t\t//\t\t\t\t\tif (!returnedArray[0]) {\n\t\t\t//\t\t\t\t\t\t_blocks[blockID].addError(\"Could not find the ShadowBaseMethod (ID = \" + targetID + \" ) for this CascadeShadowMapMethod - ShadowMethod not created\");\n\t\t\t//\t\t\t\t\t\treturn shadowMethod;\n\t\t\t//\t\t\t\t\t}\n\t\t\t//\t\t\t\t\tshadowMethod = new CascadeShadowMapMethod(returnedArray[1]);\n\t\t\t//\t\t\t\t\tbreak;\n\t\t\tcase 1002: //ShadowNearMethod\n\t\t\t\tshadowMethod = new ShadowNearMethod(<ShadowMethodBase> this._blocks[props.get(1, 0)].data);\n\t\t\t\tbreak;\n\t\t\tcase 1101: //ShadowFilteredMethod\n\t\t\t\tshadowMethod = new ShadowFilteredMethod(<DirectionalLight> light);\n\t\t\t\t(<ShadowFilteredMethod> shadowMethod).alpha = props.get(101, 1);\n\t\t\t\t(<ShadowFilteredMethod> shadowMethod).epsilon = props.get(102, 0.002);\n\t\t\t\tbreak;\n\n\t\t\tcase 1102: //ShadowDitheredMethod\n\t\t\t\tshadowMethod = new ShadowDitheredMethod(<DirectionalLight> light, <number> props.get(201, 5));\n\t\t\t\t(<ShadowDitheredMethod> shadowMethod).alpha = props.get(101, 1);\n\t\t\t\t(<ShadowDitheredMethod> shadowMethod).epsilon = props.get(102, 0.002);\n\t\t\t\t(<ShadowDitheredMethod> shadowMethod).range = props.get(103, 1);\n\n\t\t\t\tbreak;\n\t\t\tcase 1103: //ShadowSoftMethod\n\t\t\t\tshadowMethod = new ShadowSoftMethod(<DirectionalLight> light, <number> props.get(201, 5));\n\t\t\t\t(<ShadowSoftMethod> shadowMethod).alpha = props.get(101, 1);\n\t\t\t\t(<ShadowSoftMethod> shadowMethod).epsilon = props.get(102, 0.002);\n\t\t\t\t(<ShadowSoftMethod> shadowMethod).range = props.get(103, 1);\n\n\t\t\t\tbreak;\n\t\t\tcase 1104: //ShadowHardMethod\n\t\t\t\tshadowMethod = new ShadowHardMethod(light);\n\t\t\t\t(<ShadowHardMethod> shadowMethod).alpha = props.get(101, 1);\n\t\t\t\t(<ShadowHardMethod> shadowMethod).epsilon = props.get(102, 0.002);\n\t\t\t\tbreak;\n\n\t\t}\n\t\tthis.parseUserAttributes();\n\t\treturn shadowMethod;\n\t}\n\n\t//Block ID 101\n\tprivate parseSkeleton(blockID:number /*uint*/)\n\t{\n\t\tvar name:string = this.parseVarStr();\n\t\tvar num_joints:number /*uint*/ = this._newBlockBytes.readUnsignedShort();\n\t\tvar skeleton:Skeleton = new Skeleton();\n\t\tthis.parseProperties(null); // Discard properties for now\n\n\t\tfor (var joints_parsed:number = 0; joints_parsed < num_joints; joints_parsed++) {\n\t\t\tvar joint:SkeletonJoint;\n\t\t\tvar ibp:Matrix3D;\n\t\t\t// Ignore joint id\n\t\t\tthis._newBlockBytes.readUnsignedShort();\n\t\t\tjoint = new SkeletonJoint();\n\t\t\tjoint.parentIndex = this._newBlockBytes.readUnsignedShort() - 1; // 0=null in AWD\n\t\t\tjoint.name = this.parseVarStr();\n\n\t\t\tibp = this.parseMatrix3D();\n\t\t\tjoint.inverseBindPose = ibp.rawData;\n\t\t\t// Ignore joint props/attributes for now\n\t\t\tthis.parseProperties(null);\n\t\t\tthis.parseUserAttributes();\n\t\t\tskeleton.joints.push(joint);\n\t\t}\n\n\t\t// Discard attributes for now\n\t\tthis.parseUserAttributes();\n\t\tthis._pFinalizeAsset(skeleton, name);\n\n\t\tthis._blocks[blockID].data = skeleton;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a Skeleton: Name = \" + skeleton.name + \" | Number of Joints = \" + joints_parsed);\n\t}\n\n\t//Block ID = 102\n\tprivate parseSkeletonPose(blockID:number /*uint*/)\n\t{\n\t\tvar name:string = this.parseVarStr();\n\t\tvar num_joints:number /*uint*/ = this._newBlockBytes.readUnsignedShort();\n\t\tthis.parseProperties(null); // Ignore properties for now\n\n\t\tvar pose:SkeletonPose = new SkeletonPose();\n\n\t\tfor (var joints_parsed:number = 0; joints_parsed < num_joints; joints_parsed++) {\n\t\t\tvar joint_pose:JointPose;\n\t\t\tvar has_transform:number /*uint*/;\n\t\t\tjoint_pose = new JointPose();\n\t\t\thas_transform = this._newBlockBytes.readUnsignedByte();\n\t\t\tif (has_transform == 1) {\n\t\t\t\tvar mtx_data:Float32Array = this.parseMatrix43RawData();\n\n\t\t\t\tvar mtx:Matrix3D = new Matrix3D(mtx_data);\n\t\t\t\tjoint_pose.orientation.fromMatrix(mtx);\n\t\t\t\tjoint_pose.translation.copyFrom(mtx.position);\n\n\t\t\t\tpose.jointPoses[joints_parsed] = joint_pose;\n\t\t\t}\n\t\t}\n\n\t\t// Skip attributes for now\n\t\tthis.parseUserAttributes();\n\t\tthis._pFinalizeAsset(pose, name);\n\n\t\tthis._blocks[blockID].data = pose;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a SkeletonPose: Name = \" + pose.name + \" | Number of Joints = \" + joints_parsed);\n\t}\n\n\t//blockID 103\n\tprivate parseSkeletonAnimation(blockID:number /*uint*/)\n\t{\n\t\tvar frame_dur:number;\n\t\tvar pose_id:number;\n\t\tvar name:string = this.parseVarStr();\n\t\tvar clip:SkeletonClipNode = new SkeletonClipNode();\n\t\tvar num_frames:number /*uint*/ = this._newBlockBytes.readUnsignedShort();\n\t\tthis.parseProperties(null); // Ignore properties for now\n\n\t\tfor (var frames_parsed:number = 0; frames_parsed < num_frames; frames_parsed++) {\n\t\t\tpose_id = this._newBlockBytes.readUnsignedInt();\n\t\t\tframe_dur = this._newBlockBytes.readUnsignedShort();\n\t\t\tclip.addFrame(<SkeletonPose> this._blocks[pose_id].data, frame_dur);\n\t\t}\n\t\tif (clip.frames.length == 0) {\n\t\t\tthis._blocks[blockID].addError(\"Could not this SkeletonClipNode, because no Frames where set.\");\n\t\t\treturn;\n\t\t}\n\t\t// Ignore attributes for now\n\t\tthis.parseUserAttributes();\n\t\tthis._pFinalizeAsset(clip, name);\n\t\tthis._blocks[blockID].data = clip;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a SkeletonClipNode: Name = \" + clip.name + \" | Number of Frames = \" + clip.frames.length);\n\t}\n\t\n\tprivate meshPoseAnimationProperties:Object = {\n\t\t1:AWDParser.BOOL,\n\t\t2:AWDParser.BOOL};\n\n\t//Block ID = 111 /  Block ID = 112\n\tprivate parseMeshPoseAnimation(blockID:number /*uint*/, poseOnly:boolean = false)\n\t{\n\t\tvar subMeshParsed:number /*uint*/;\n\t\tvar x:number;\n\t\tvar y:number;\n\t\tvar z:number;\n\t\tvar str_len:number;\n\t\tvar str_end:number;\n\t\tvar subGeom:TriangleSubGeometry;\n\t\tvar idx:number /*int*/ = 0;\n\t\tvar clip:VertexClipNode = new VertexClipNode();\n\t\tvar indices:Short3Attributes;\n\t\tvar verts:Array<number>;\n\t\tvar streamtypes:Array<number> /*int*/ = new Array<number>() /*int*/;\n\t\tvar props:AWDProperties;\n\t\tvar name:string = this.parseVarStr();\n\t\tvar geo_id:number /*int*/ = this._newBlockBytes.readUnsignedInt();\n\t\tvar geometry:Geometry = <Geometry> this._blocks[geo_id].data;\n\n\t\tvar uvs:Array<Float32Array> = this.getUVForVertexAnimation(geo_id);\n\n\t\tvar num_frames:number = (!poseOnly)? this._newBlockBytes.readUnsignedShort() : 1;\n\n\t\tvar num_submeshes:number = this._newBlockBytes.readUnsignedShort();\n\t\tvar num_Streams:number = this._newBlockBytes.readUnsignedShort();\n\t\tfor (var streamsParsed:number = 0; streamsParsed < num_Streams; streamsParsed++)\n\t\t\tstreamtypes.push(this._newBlockBytes.readUnsignedShort());\n\n\t\tprops = this.parseProperties(this.meshPoseAnimationProperties);\n\n\t\tclip.looping = props.get(1, true);\n\t\tclip.stitchFinalFrame = props.get(2, false);\n\n\t\tvar frame_dur:number;\n\t\tfor (var frames_parsed:number = 0; frames_parsed < num_frames; frames_parsed++) {\n\t\t\tframe_dur = this._newBlockBytes.readUnsignedShort();\n\t\t\tgeometry = new Geometry();\n\t\t\tsubMeshParsed = 0;\n\t\t\twhile (subMeshParsed < num_submeshes) {\n\t\t\t\tstreamsParsed = 0;\n\t\t\t\tstr_len = this._newBlockBytes.readUnsignedInt();\n\t\t\t\tstr_end = this._newBlockBytes.position + str_len;\n\t\t\t\twhile (streamsParsed < num_Streams) {\n\t\t\t\t\tif (streamtypes[streamsParsed] == 1) {\n\t\t\t\t\t\tindices = geometry.subGeometries[subMeshParsed].indices;\n\t\t\t\t\t\tverts = new Array<number>();\n\t\t\t\t\t\tidx = 0;\n\t\t\t\t\t\twhile (this._newBlockBytes.position < str_end) {\n\t\t\t\t\t\t\tx = this.readNumber(this._accuracyGeo);\n\t\t\t\t\t\t\ty = this.readNumber(this._accuracyGeo);\n\t\t\t\t\t\t\tz = this.readNumber(this._accuracyGeo);\n\t\t\t\t\t\t\tverts[idx++] = x;\n\t\t\t\t\t\t\tverts[idx++] = y;\n\t\t\t\t\t\t\tverts[idx++] = z;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsubGeom = new TriangleSubGeometry(new AttributesBuffer());\n\t\t\t\t\t\tsubGeom.setIndices(indices);\n\t\t\t\t\t\tsubGeom.setPositions(verts);\n\t\t\t\t\t\tsubGeom.setUVs(uvs[subMeshParsed]);\n\t\t\t\t\t\tsubGeom.setNormals(null);\n\t\t\t\t\t\tsubGeom.setTangents(null);\n\t\t\t\t\t\tsubGeom.autoDeriveNormals = false;\n\t\t\t\t\t\tsubGeom.autoDeriveTangents = false;\n\t\t\t\t\t\tsubMeshParsed++;\n\t\t\t\t\t\tgeometry.addSubGeometry(subGeom)\n\t\t\t\t\t} else\n\t\t\t\t\t\tthis._newBlockBytes.position = str_end;\n\t\t\t\t\tstreamsParsed++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tclip.addFrame(geometry, frame_dur);\n\t\t}\n\t\tthis.parseUserAttributes();\n\t\tthis._pFinalizeAsset(clip, name);\n\n\t\tthis._blocks[blockID].data = clip;\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a VertexClipNode: Name = \" + clip.name + \" | Target-Geometry-Name = \" + geometry.name + \" | Number of Frames = \" + clip.frames.length);\n\t}\n\n\tprivate static vertexAnimationSetProperties:Object = {\n\t\t1:AWDParser.UINT16};\n\t\n\t//BlockID 113\n\tprivate parseVertexAnimationSet(blockID:number /*uint*/)\n\t{\n\t\tvar name:string = this.parseVarStr();\n\t\tvar num_frames:number /*uint*/ = this._newBlockBytes.readUnsignedShort();\n\t\tvar props:AWDProperties = this.parseProperties(AWDParser.vertexAnimationSetProperties);\n\t\tvar skeletonFrames:Array<SkeletonClipNode> = new Array<SkeletonClipNode>();\n\t\tvar vertexFrames:Array<VertexClipNode> = new Array<VertexClipNode>();\n\t\tvar clipNode:AnimationClipNodeBase;\n\t\tfor (var frames_parsed:number = 0; frames_parsed < num_frames; frames_parsed++) {\n\t\t\tclipNode = <AnimationClipNodeBase> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\t\t\tif (clipNode instanceof VertexClipNode)\n\t\t\t\tvertexFrames.push(<VertexClipNode> clipNode);\n\t\t\telse if (clipNode instanceof SkeletonClipNode)\n\t\t\t\tskeletonFrames.push(<SkeletonClipNode> clipNode);\n\t\t}\n\n\t\tif ((vertexFrames.length == 0) && (skeletonFrames.length == 0)) {\n\t\t\tthis._blocks[blockID].addError(\"Could not create this AnimationSet, because it contains no animations\");\n\t\t\treturn;\n\t\t}\n\n\t\tthis.parseUserAttributes();\n\n\t\tif (vertexFrames.length > 0) {\n\t\t\tvar newVertexAnimationSet:VertexAnimationSet = new VertexAnimationSet();\n\n\t\t\tfor (var i:number /*int*/ = 0; i < vertexFrames.length; i++)\n\t\t\t\tnewVertexAnimationSet.addAnimation(vertexFrames[i]);\n\n\t\t\tthis._pFinalizeAsset(newVertexAnimationSet, name);\n\n\t\t\tthis._blocks[blockID].data = newVertexAnimationSet;\n\n\t\t\tif (this._debug)\n\t\t\t\tconsole.log(\"Parsed a VertexAnimationSet: Name = \" + name + \" | Animations = \" + newVertexAnimationSet.animations.length + \" | Animation-Names = \" + newVertexAnimationSet.animationNames);\n\n\t\t} else if (skeletonFrames.length > 0) {\n\t\t\tvar newSkeletonAnimationSet:SkeletonAnimationSet = new SkeletonAnimationSet(props.get(1, 4)); //props.get(1,4));\n\t\t\tfor (var i:number /*int*/ = 0; i < skeletonFrames.length; i++)\n\t\t\t\tnewSkeletonAnimationSet.addAnimation(skeletonFrames[i]);\n\t\t\tthis._pFinalizeAsset(newSkeletonAnimationSet, name);\n\n\t\t\tthis._blocks[blockID].data = newSkeletonAnimationSet;\n\n\t\t\tif (this._debug)\n\t\t\t\tconsole.log(\"Parsed a SkeletonAnimationSet: Name = \" + name + \" | Animations = \" + newSkeletonAnimationSet.animations.length + \" | Animation-Names = \" + newSkeletonAnimationSet.animationNames);\n\t\t}\n\t}\n\n\tprivate static animatorSetProperties:Object = {1:AWDParser.BADDR};\n\t\n\t//BlockID 122\n\tprivate parseAnimatorSet(blockID:number /*uint*/)\n\t{\n\t\tvar name:string = this.parseVarStr();\n\t\tvar type:number = this._newBlockBytes.readUnsignedShort();\n\t\tvar props:AWDProperties = this.parseProperties(AWDParser.animatorSetProperties);\n\t\tvar targetAnimationSet:AnimationSetBase = <AnimationSetBase> this._blocks[this._newBlockBytes.readUnsignedInt()].data;\n\n\t\tvar targetMeshes:Array<Mesh> = new Array<Mesh>();\n\t\tvar targetMeshLength:number /*uint*/ = this._newBlockBytes.readUnsignedShort();\n\t\tfor (var i:number /*int*/ = 0; i < targetMeshLength; i++)\n\t\t\ttargetMeshes.push(<Mesh> this._blocks[this._newBlockBytes.readUnsignedInt()].data);\n\n\t\tvar activeState:number /*uint*/ = this._newBlockBytes.readUnsignedShort();\n\t\tvar autoplay:boolean = ( this._newBlockBytes.readUnsignedByte() == 1 );\n\t\tthis.parseUserAttributes();\n\t\tthis.parseUserAttributes();\n\n\t\tvar thisAnimator:AnimatorBase;\n\t\tif (type == 1)\n\t\t\tthisAnimator = new SkeletonAnimator(<SkeletonAnimationSet> targetAnimationSet, <Skeleton> this._blocks[props.get(1, 0)].data);\n\t\telse if (type == 2)\n\t\t\tthisAnimator = new VertexAnimator(<VertexAnimationSet> targetAnimationSet);\n\n\t\tthis._pFinalizeAsset(thisAnimator, name);\n\t\tthis._blocks[blockID].data = thisAnimator;\n\n\t\tfor (i = 0; i < targetMeshes.length; i++) {\n\t\t\tif (type == 1)\n\t\t\t\ttargetMeshes[i].animator = (<SkeletonAnimator> thisAnimator);\n\t\t\telse if (type == 2)\n\t\t\t\ttargetMeshes[i].animator = (<VertexAnimator> thisAnimator);\n\t\t}\n\n\t\tif (this._debug)\n\t\t\tconsole.log(\"Parsed a Animator: Name = \" + name);\n\t}\n\n\tprivate sharedMethodListProperties:Object = {\n\t\t1:AWDParser.BADDR,\n\t\t2:AWDParser.BADDR,\n\t\t3:AWDParser.BADDR,\n\t\t101:AWDParser.PROPERTY_NUMBER,\n\t\t102:AWDParser.PROPERTY_NUMBER,\n\t\t103:AWDParser.PROPERTY_NUMBER,\n\t\t104:AWDParser.PROPERTY_NUMBER,\n\t\t105:AWDParser.PROPERTY_NUMBER,\n\t\t106:AWDParser.PROPERTY_NUMBER,\n\t\t107:AWDParser.PROPERTY_NUMBER,\n\t\t201:AWDParser.UINT32,\n\t\t202:AWDParser.UINT32,\n\t\t301:AWDParser.UINT16,\n\t\t302:AWDParser.UINT16,\n\t\t401:AWDParser.UINT8,\n\t\t402:AWDParser.UINT8,\n\t\t601:AWDParser.COLOR,\n\t\t602:AWDParser.COLOR,\n\t\t701:AWDParser.BOOL,\n\t\t702:AWDParser.BOOL};\n\n\t// this functions reads and creates a EffectMethod\n\tprivate parseSharedMethodList(blockID:number):EffectMethodBase\n\t{\n\t\tvar methodType:number = this._newBlockBytes.readUnsignedShort();\n\t\tvar effectMethodReturn:EffectMethodBase;\n\n\t\tvar props:AWDProperties = this.parseProperties(this.sharedMethodListProperties);\n\n\t\tswitch (methodType) {\n\t\t\t// Effect Methods\n\t\t\tcase 401: //ColorMatrix\n\t\t\t\teffectMethodReturn = new EffectColorMatrixMethod(props.get(101, new Array(0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1)));\n\t\t\t\tbreak;\n\t\t\tcase 402: //ColorTransform\n\t\t\t\teffectMethodReturn = new EffectColorTransformMethod();\n\t\t\t\tvar offCol:number /*uint*/ = props.get(601, 0x00000000);\n\t\t\t\t(<EffectColorTransformMethod> effectMethodReturn).colorTransform = new ColorTransform(props.get(102, 1), props.get(103, 1), props.get(104, 1), props.get(101, 1), ((offCol >> 16) & 0xFF), ((offCol >> 8) & 0xFF), (offCol & 0xFF), ((offCol >> 24) & 0xFF));\n\t\t\t\tbreak;\n\t\t\tcase 403: //EnvMap\n\t\t\t\teffectMethodReturn = new EffectEnvMapMethod(<SingleCubeTexture> this._blocks[props.get(1, 0)].data, <number> props.get(101, 1));\n\t\t\t\tvar targetID:number = props.get(2, 0);\n\t\t\t\tif (targetID > 0) {\n\t\t\t\t\t// Todo: test mask with EnvMapMethod\n\t\t\t\t\t//(<EnvMapMethod> effectMethodReturn).mask = <TextureBase> this._blocks[targetID].data;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 404: //LightMapMethod\n\t\t\t\teffectMethodReturn = new EffectLightMapMethod(this._blocks[props.get(1, 0)].data, this.blendModeDic[props.get(401, 10)]); //usesecondaryUV not set\n\t\t\t\tbreak;\n\t\t\t//\t\t\t\tcase 405: //ProjectiveTextureMethod\n\t\t\t//\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t//\t\t\t\t\treturnedArray = getAssetByID(targetID, [TextureProjector.assetType]);\n\t\t\t//\t\t\t\t\tif (!returnedArray[0])\n\t\t\t//\t\t\t\t\t\t_blocks[blockID].addError(\"Could not find the TextureProjector (ID = \" + targetID + \" ) for this ProjectiveTextureMethod\");\n\t\t\t//\t\t\t\t\teffectMethodReturn = new ProjectiveTextureMethod(returnedArray[1], blendModeDic[props.get(401, 10)]);\n\t\t\t//\t\t\t\t\tbreak;\n\t\t\tcase 406: //RimLightMethod\n\t\t\t\teffectMethodReturn = new EffectRimLightMethod(props.get(601, 0xffffff), props.get(101, 0.4), props.get(101, 2)); //blendMode\n\t\t\t\tbreak;\n\t\t\tcase 407: //AlphaMaskMethod\n\t\t\t\teffectMethodReturn = new EffectAlphaMaskMethod(this._blocks[props.get(1, 0)].data, props.get(701, false));\n\t\t\t\tbreak;\n\t\t\t//\t\t\t\tcase 408: //RefractionEnvMapMethod\n\t\t\t//\t\t\t\t\ttargetID = props.get(1, 0);\n\t\t\t//\t\t\t\t\treturnedArray = getAssetByID(targetID, [TextureBase.assetType], \"CubeTexture\");\n\t\t\t//\t\t\t\t\tif (!returnedArray[0])\n\t\t\t//\t\t\t\t\t\t_blocks[blockID].addError(\"Could not find the EnvMap (ID = \" + targetID + \" ) for this RefractionEnvMapMethod\");\n\t\t\t//\t\t\t\t\teffectMethodReturn = new RefractionEnvMapMethod(returnedArray[1], props.get(101, 0.1), props.get(102, 0.01), props.get(103, 0.01), props.get(104, 0.01));\n\t\t\t//\t\t\t\t\tRefractionEnvMapMethod(effectMethodReturn).alpha = props.get(104, 1);\n\t\t\t//\t\t\t\t\tbreak;\n\t\t\t//\t\t\t\tcase 409: //OutlineMethod\n\t\t\t//\t\t\t\t\teffectMethodReturn = new OutlineMethod(props.get(601, 0x00000000), props.get(101, 1), props.get(701, true), props.get(702, false));\n\t\t\t//\t\t\t\t\tbreak;\n\t\t\tcase 410: //FresnelEnvMapMethod\n\t\t\t\teffectMethodReturn = new EffectFresnelEnvMapMethod(this._blocks[props.get(1, 0)].data, props.get(101, 1));\n\t\t\t\tbreak;\n\t\t\tcase 411: //FogMethod\n\t\t\t\teffectMethodReturn = new EffectFogMethod(props.get(101, 0), props.get(102, 1000), props.get(601, 0x808080));\n\t\t\t\tbreak;\n\n\t\t}\n\t\tthis.parseUserAttributes();\n\t\treturn effectMethodReturn;\n\n\t}\n\n\tprivate parseUserAttributes():Object\n\t{\n\t\tvar list_len:number = this._newBlockBytes.readUnsignedInt();\n\n\t\tif (list_len > 0) {\n\t\t\tvar list_end:number = this._newBlockBytes.position + list_len;\n\t\t\tvar attributes:Object = {};\n\n\t\t\tfor (var attibuteCnt:number = 0; this._newBlockBytes.position < list_end; attibuteCnt++) {\n\t\t\t\tvar ns_id:number;\n\t\t\t\tvar attr_key:string;\n\t\t\t\tvar attr_type:number;\n\t\t\t\tvar attr_len:number;\n\t\t\t\tvar attr_val:any;\n\n\t\t\t\t// TODO: Properly tend to namespaces in attributes\n\t\t\t\tns_id = this._newBlockBytes.readUnsignedByte();\n\t\t\t\tattr_key = this.parseVarStr();\n\t\t\t\tattr_type = this._newBlockBytes.readUnsignedByte();\n\t\t\t\tattr_len = this._newBlockBytes.readUnsignedInt();\n\n\t\t\t\tif ((this._newBlockBytes.position + attr_len) > list_end) {\n\t\t\t\t\tconsole.log(\"           Error in reading attribute # \" + attibuteCnt + \" = skipped to end of attribute-list\");\n\t\t\t\t\tthis._newBlockBytes.position = list_end;\n\t\t\t\t\treturn attributes;\n\t\t\t\t}\n\n\t\t\t\tswitch (attr_type) {\n\t\t\t\t\tcase AWDParser.AWDSTRING:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readUTFBytes(attr_len);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWDParser.INT8:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readByte();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWDParser.INT16:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readShort();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWDParser.INT32:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readInt();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWDParser.BOOL:\n\t\t\t\t\tcase AWDParser.UINT8:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readUnsignedByte();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWDParser.UINT16:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readUnsignedShort();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWDParser.UINT32:\n\t\t\t\t\tcase AWDParser.BADDR:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readUnsignedInt();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWDParser.FLOAT32:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readFloat();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase AWDParser.FLOAT64:\n\t\t\t\t\t\tattr_val = this._newBlockBytes.readDouble();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tattr_val = 'unimplemented attribute type ' + attr_type;\n\t\t\t\t\t\tthis._newBlockBytes.position += attr_len;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tattributes[attr_key] = attr_val;\n\n\t\t\t\tif (this._debug)\n\t\t\t\t\tconsole.log(\"attribute = name: \" + attr_key + \"  / value = \" + attr_val);\n\t\t\t}\n\t\t}\n\n\t\treturn attributes;\n\t}\n\n\tprivate parseProperties(expected:Object):AWDProperties\n\t{\n\t\tvar list_len:number = this._newBlockBytes.readUnsignedInt();\n\t\tvar props:AWDProperties = new AWDProperties();\n\t\tvar list_end:number = this._newBlockBytes.position + list_len;\n\n\t\tif (expected) {\n\t\t\tvar len:number;\n\t\t\tvar key:number;\n\t\t\tvar type:number;\n\n\t\t\tfor (var propertyCnt:number = 0; this._newBlockBytes.position < list_end; propertyCnt++) {\n\t\t\t\tkey = this._newBlockBytes.readUnsignedShort();\n\t\t\t\tlen = this._newBlockBytes.readUnsignedInt();\n\n\t\t\t\tif ((this._newBlockBytes.position + len) > list_end) {\n\t\t\t\t\tconsole.log(\"           Error in reading property # \" + propertyCnt + \" = skipped to end of propertie-list\");\n\t\t\t\t\tthis._newBlockBytes.position = list_end;\n\t\t\t\t\treturn props;\n\t\t\t\t}\n\n\t\t\t\tif (expected[key]) {\n\t\t\t\t\ttype = expected[key];\n\t\t\t\t\tprops.set(key, this.parseAttrValue(type, len));\n\t\t\t\t} else {\n\t\t\t\t\tthis._newBlockBytes.position += len;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis._newBlockBytes.position = list_end;\n\t\t}\n\n\t\treturn props;\n\t}\n\n\tprivate parseAttrValue(type:number, len:number):any\n\t{\n\t\tvar elem_len:number;\n\t\tvar read_func:Function;\n\t\tvar accuracy:boolean;\n\n\t\tswitch (type) {\n\t\t\tcase AWDParser.BOOL:\n\t\t\tcase AWDParser.INT8:\n\t\t\t\telem_len = 1;\n\t\t\t\tread_func = this._newBlockBytes.readByte;\n\t\t\t\tbreak;\n\n\t\t\tcase AWDParser.INT16:\n\t\t\t\telem_len = 2;\n\t\t\t\tread_func = this._newBlockBytes.readShort;\n\t\t\t\tbreak;\n\n\t\t\tcase AWDParser.INT32:\n\t\t\t\telem_len = 4;\n\t\t\t\tread_func = this._newBlockBytes.readInt;\n\t\t\t\tbreak;\n\n\t\t\tcase AWDParser.UINT8:\n\t\t\t\telem_len = 1;\n\t\t\t\tread_func = this._newBlockBytes.readUnsignedByte;\n\t\t\t\tbreak;\n\n\t\t\tcase AWDParser.UINT16:\n\t\t\t\telem_len = 2;\n\t\t\t\tread_func = this._newBlockBytes.readUnsignedShort;\n\t\t\t\tbreak;\n\n\t\t\tcase AWDParser.UINT32:\n\t\t\tcase AWDParser.COLOR:\n\t\t\tcase AWDParser.BADDR:\n\t\t\t\telem_len = 4;\n\t\t\t\tread_func = this._newBlockBytes.readUnsignedInt;\n\t\t\t\tbreak;\n\n\t\t\tcase AWDParser.FLOAT32:\n\t\t\t\telem_len = 4;\n\t\t\t\tread_func = this._newBlockBytes.readFloat;\n\t\t\t\tbreak;\n\n\t\t\tcase AWDParser.FLOAT64:\n\t\t\t\telem_len = 8;\n\t\t\t\tread_func = this._newBlockBytes.readDouble;\n\t\t\t\tbreak;\n\n\t\t\tcase AWDParser.AWDSTRING:\n\t\t\t\treturn this._newBlockBytes.readUTFBytes(len);\n\n\t\t\tcase AWDParser.VECTOR2x1:\n\t\t\tcase AWDParser.VECTOR3x1:\n\t\t\tcase AWDParser.VECTOR4x1:\n\t\t\tcase AWDParser.MTX3x2:\n\t\t\tcase AWDParser.MTX3x3:\n\t\t\tcase AWDParser.MTX4x3:\n\t\t\tcase AWDParser.MTX4x4:\n\t\t\t\telem_len = 8;\n\t\t\t\tread_func = this._newBlockBytes.readDouble;\n\t\t\t\tbreak;\n\t\t\tcase AWDParser.GEO_NUMBER:\n\t\t\t\taccuracy = this._accuracyGeo;\n\t\t\tcase AWDParser.MATRIX_NUMBER:\n\t\t\t\taccuracy = this._accuracyMatrix;\n\t\t\tcase AWDParser.PROPERTY_NUMBER:\n\t\t\t\taccuracy = this._accuracyProps;\n\t\t\tdefault:\n\t\t\t\tif (accuracy) {\n\t\t\t\t\telem_len = 8;\n\t\t\t\t\tread_func = this._newBlockBytes.readDouble;\n\t\t\t\t} else {\n\t\t\t\t\telem_len = 4;\n\t\t\t\t\tread_func = this._newBlockBytes.readFloat;\n\t\t\t\t}\n\t\t}\n\n\t\tif (elem_len < len) {\n\t\t\tvar list:Array<any> = [];\n\t\t\tvar num_elems:number = len/elem_len;\n\n\t\t\tfor (var num_read:number = 0; num_read < num_elems; num_read++)\n\t\t\t\tlist[num_read] = read_func.call(this._newBlockBytes);\n\n\t\t\treturn list;\n\t\t} else {\n\t\t\treturn read_func.call(this._newBlockBytes);\n\t\t}\n\t}\n\n\tprivate parseHeader()\n\t{\n\t\tthis._byteData.position = 3; // Skip magic string and parse version\n\n\t\tthis._version[0] = this._byteData.readUnsignedByte();\n\t\tthis._version[1] = this._byteData.readUnsignedByte();\n\n\t\tvar flags:number = this._byteData.readUnsignedShort(); // Parse bit flags\n\n\t\tthis._streaming = BitFlags.test(flags, BitFlags.FLAG1);\n\n\t\t// if we set _accuracyOnBlocks, the precision-values are read from each block-header.\n\t\tif ((this._version[0] == 2) && (this._version[1] == 1)) {\n\t\t\tthis._accuracyMatrix = BitFlags.test(flags, BitFlags.FLAG2);\n\t\t\tthis._accuracyGeo = BitFlags.test(flags, BitFlags.FLAG3);\n\t\t\tthis._accuracyProps = BitFlags.test(flags, BitFlags.FLAG4);\n\t\t}\n\n\t\tthis._compression = this._byteData.readUnsignedByte(); // compression\n\n\t\tif (this._debug) {\n\t\t\tconsole.log(\"Import AWDFile of version = \" + this._version[0] + \" - \" + this._version[1]);\n\t\t\tconsole.log(\"Global Settings = Compression = \" + this._compression + \" | Streaming = \" + this._streaming + \" | Matrix-Precision = \" + this._accuracyMatrix + \" | Geometry-Precision = \" + this._accuracyGeo + \" | Properties-Precision = \" + this._accuracyProps);\n\t\t}\n\n\t\t// Check file integrity\n\t\tvar body_len:number = this._byteData.readUnsignedInt();\n\t\tif (!this._streaming && body_len != this._byteData.getBytesAvailable())\n\t\t\tthis._pDieWithError('AWD2 body length does not match header integrity field');\n\n\t}\n\t// Helper - functions\n\tprivate getUVForVertexAnimation(meshID:number /*uint*/):Array<Float32Array>\n\t{\n\t\tif (this._blocks[meshID].data instanceof Mesh)\n\t\t\tmeshID = this._blocks[meshID].geoID;\n\n\t\tif (this._blocks[meshID].uvsForVertexAnimation)\n\t\t\treturn this._blocks[meshID].uvsForVertexAnimation;\n\n\t\tvar geometry:Geometry = (<Geometry> this._blocks[meshID].data);\n\t\tvar sub_geom:TriangleSubGeometry;\n\t\tvar uvsForVertexAnimation:Array<Float32Array> = this._blocks[meshID].uvsForVertexAnimation = new Array<Float32Array>();\n\n\t\tvar len:number = geometry.subGeometries.length;\n\t\tfor (var geoCnt:number= 0; geoCnt < len; geoCnt++) {\n\t\t\tsub_geom = <TriangleSubGeometry> geometry.subGeometries[geoCnt];\n\t\t\tuvsForVertexAnimation[geoCnt] = sub_geom.uvs.get(sub_geom.numVertices);\n\t\t}\n\n\t\treturn this._blocks[meshID].uvsForVertexAnimation;\n\t}\n\n\tprivate parseVarStr():string\n\t{\n\t\treturn this._newBlockBytes.readUTFBytes(this._newBlockBytes.readUnsignedShort());\n\t}\n\n\tprivate readNumber(precision:boolean = false):number\n\t{\n\t\tif (precision)\n\t\t\treturn this._newBlockBytes.readDouble();\n\n\t\treturn this._newBlockBytes.readFloat();\n\t}\n\n\tprivate parseMatrix3D():Matrix3D\n\t{\n\t\treturn new Matrix3D(this.parseMatrix43RawData());\n\t}\n\n\tprivate parseMatrix32RawData():Array<number>\n\t{\n\t\tvar mtx_raw:Array<number> = new Array<number>(6);\n\n\t\tfor (var i:number = 0; i < 6; i++)\n\t\t\tmtx_raw[i] = this._newBlockBytes.readFloat();\n\n\t\treturn mtx_raw;\n\t}\n\n\tprivate parseMatrix43RawData():Float32Array\n\t{\n\t\tvar mtx_raw:Float32Array = new Float32Array(16);\n\n\t\tmtx_raw[0] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[1] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[2] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[3] = 0.0;\n\t\tmtx_raw[4] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[5] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[6] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[7] = 0.0;\n\t\tmtx_raw[8] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[9] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[10] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[11] = 0.0;\n\t\tmtx_raw[12] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[13] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[14] = this.readNumber(this._accuracyMatrix);\n\t\tmtx_raw[15] = 1.0;\n\n\t\t//TODO: fix max exporter to remove NaN values in joint 0 inverse bind pose\n\n\t\tif (isNaN(mtx_raw[0])) {\n\t\t\tmtx_raw[0] = 1;\n\t\t\tmtx_raw[1] = 0;\n\t\t\tmtx_raw[2] = 0;\n\t\t\tmtx_raw[4] = 0;\n\t\t\tmtx_raw[5] = 1;\n\t\t\tmtx_raw[6] = 0;\n\t\t\tmtx_raw[8] = 0;\n\t\t\tmtx_raw[9] = 0;\n\t\t\tmtx_raw[10] = 1;\n\t\t\tmtx_raw[12] = 0;\n\t\t\tmtx_raw[13] = 0;\n\t\t\tmtx_raw[14] = 0;\n\t\t}\n\n\t\treturn mtx_raw;\n\t}\n}\n\nexport = AWDParser;\n\n\nclass AWDProperties\n{\n\tpublic set(key:number, value:any)\n\t{\n\t\tthis[key] = value;\n\t}\n\n\tpublic get(key:number, fallback:any):any\n\t{\n\t\treturn (this[key] || fallback);\n\t}\n}\n\n/**\n *\n */\nclass BitFlags\n{\n\tpublic static FLAG1:number = 1;\n\tpublic static FLAG2:number = 2;\n\tpublic static FLAG3:number = 4;\n\tpublic static FLAG4:number = 8;\n\tpublic static FLAG5:number = 16;\n\tpublic static FLAG6:number = 32;\n\tpublic static FLAG7:number = 64;\n\tpublic static FLAG8:number = 128;\n\tpublic static FLAG9:number = 256;\n\tpublic static FLAG10:number = 512;\n\tpublic static FLAG11:number = 1024;\n\tpublic static FLAG12:number = 2048;\n\tpublic static FLAG13:number = 4096;\n\tpublic static FLAG14:number = 8192;\n\tpublic static FLAG15:number = 16384;\n\tpublic static FLAG16:number = 32768;\n\n\tpublic static test(flags:number, testFlag:number):boolean\n\t{\n\t\treturn (flags & testFlag) == testFlag;\n\t}\n}\n",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport BitmapImage2D\t\t\t\t\t= require(\"awayjs-core/lib/image/BitmapImage2D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport URLLoaderDataFormat\t\t\t\t= require(\"awayjs-core/lib/net/URLLoaderDataFormat\");\nimport URLRequest\t\t\t\t\t\t= require(\"awayjs-core/lib/net/URLRequest\");\nimport ParserBase\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserBase\");\nimport ParserUtils\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserUtils\");\nimport ResourceDependency\t\t\t\t= require(\"awayjs-core/lib/parsers/ResourceDependency\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport DisplayObject\t\t\t\t\t= require(\"awayjs-display/lib/base/DisplayObject\");\nimport Camera\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Camera\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport DefaultMaterialManager\t\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\nimport Single2DTexture\t\t\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\n\nimport VertexClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/VertexClipNode\");\nimport VertexAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/VertexAnimationSet\");\n\nimport MethodMaterial\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterial\");\nimport MethodMaterialMode\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterialMode\");\n\n/**\n * MD2Parser provides a parser for the MD2 data type.\n */\nclass MD2Parser extends ParserBase\n{\n\tpublic static FPS:number /*int*/ = 6;\n\n\tprivate _clipNodes:Object = new Object();\n\tprivate _byteData:ByteArray;\n\tprivate _startedParsing:boolean;\n\tprivate _parsedHeader:boolean;\n\tprivate _parsedUV:boolean;\n\tprivate _parsedFaces:boolean;\n\tprivate _parsedFrames:boolean;\n\n\tprivate _ident:number /*uint*/;\n\tprivate _version:number /*uint*/;\n\tprivate _skinWidth:number /*uint*/;\n\tprivate _skinHeight:number /*uint*/;\n\t//private _frameSize : number /*uint*/;\n\tprivate _numSkins:number /*uint*/;\n\tprivate _numVertices:number /*uint*/;\n\tprivate _numST:number /*uint*/;\n\tprivate _numTris:number /*uint*/;\n\t//private _numGlCmds : number /*uint*/;\n\tprivate _numFrames:number /*uint*/;\n\tprivate _offsetSkins:number /*uint*/;\n\tprivate _offsetST:number /*uint*/;\n\tprivate _offsetTris:number /*uint*/;\n\tprivate _offsetFrames:number /*uint*/;\n\t//private _offsetGlCmds : number /*uint*/;\n\tprivate _offsetEnd:number /*uint*/;\n\n\tprivate _uvIndices:Array<number>;\n\tprivate _indices:Array<number> /*uint*/;\n\tprivate _vertIndices:Array<number>;\n\n\t// the current subgeom being built\n\tprivate _animationSet:VertexAnimationSet = new VertexAnimationSet();\n\tprivate _firstSubGeom:TriangleSubGeometry;\n\tprivate _uvs:Array<number>;\n\tprivate _finalUV:Array<number>;\n\n\tprivate _materialNames:Array<string>;\n\tprivate _textureType:string;\n\tprivate _ignoreTexturePath:boolean;\n\tprivate _mesh:Mesh;\n\tprivate _geometry:Geometry;\n\n\tprivate materialFinal:boolean = false;\n\tprivate geoCreated:boolean = false;\n\n\t/**\n\t * Creates a new MD2Parser object.\n\t * @param textureType The extension of the texture (e.g. jpg/png/...)\n\t * @param ignoreTexturePath If true, the path of the texture is ignored\n\t */\n\tconstructor(textureType:string = \"jpg\", ignoreTexturePath:boolean = true)\n\t{\n\t\tsuper(URLLoaderDataFormat.ARRAY_BUFFER);\n\t\tthis._textureType = textureType;\n\t\tthis._ignoreTexturePath = ignoreTexturePath;\n\t}\n\n\t/**\n\t * Indicates whether or not a given file extension is supported by the parser.\n\t * @param extension The file extension of a potential file to be parsed.\n\t * @return Whether or not the given file type is supported.\n\t */\n\tpublic static supportsType(extension:string):boolean\n\t{\n\t\textension = extension.toLowerCase();\n\t\treturn extension == \"md2\";\n\t}\n\n\t/**\n\t * Tests whether a data block can be parsed by the parser.\n\t * @param data The data block to potentially be parsed.\n\t * @return Whether or not the given data is supported.\n\t */\n\tpublic static supportsData(data:any):boolean\n\t{\n\t\treturn (ParserUtils.toString(data, 4) == 'IDP2');\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iResolveDependency(resourceDependency:ResourceDependency)\n\t{\n\t\tif (resourceDependency.assets.length != 1)\n\t\t\treturn;\n\n\t\tvar material:MethodMaterial = new MethodMaterial(<BitmapImage2D> resourceDependency.assets[0]);\n\n\t\tif (this.materialMode >= 2)\n\t\t\tmaterial.mode = MethodMaterialMode.MULTI_PASS;\n\n\t\t//add to the content property\n\t\t(<DisplayObjectContainer> this._pContent).addChild(this._mesh);\n\n\t\tmaterial.name = this._mesh.material.name;\n\t\tthis._mesh.material = material;\n\t\tthis._pFinalizeAsset(material);\n\t\tthis._pFinalizeAsset(this._mesh.geometry);\n\t\tthis._pFinalizeAsset(this._mesh);\n\n\t\tthis.materialFinal = true;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iResolveDependencyFailure(resourceDependency:ResourceDependency)\n\t{\n\t\t// apply system default\n\t\tif (this.materialMode < 2) {\n\t\t\tthis._mesh.material = DefaultMaterialManager.getDefaultMaterial();\n\t\t} else {\n\t\t\tthis._mesh.material = new MethodMaterial(DefaultMaterialManager.getDefaultImage2D());\n\t\t\t(<MethodMaterial> this._mesh.material).mode = MethodMaterialMode.MULTI_PASS;\n\t\t}\n\n\t\t//add to the content property\n\t\t(<DisplayObjectContainer> this._pContent).addChild(this._mesh);\n\n\t\tthis._pFinalizeAsset(this._mesh.geometry);\n\t\tthis._pFinalizeAsset(this._mesh);\n\t\tthis.materialFinal = true;\n\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pProceedParsing():boolean\n\t{\n\t\tif (!this._startedParsing) {\n\t\t\tthis._byteData = this._pGetByteData();\n\t\t\tthis._startedParsing = true;\n\n\t\t\t// Reset bytearray read position (which may have been\n\t\t\t// moved forward by the supportsData() function.)\n\t\t\tthis._byteData.position = 0;\n\t\t}\n\n\t\twhile (this._pHasTime()) {\n\t\t\tif (!this._parsedHeader) {\n\t\t\t\t//----------------------------------------------------------------------------\n\t\t\t\t// LITTLE_ENDIAN - Default for ArrayBuffer / Not implemented in ByteArray\n\t\t\t\t//----------------------------------------------------------------------------\n\t\t\t\t//this._byteData.endian = Endian.LITTLE_ENDIAN;\n\n\t\t\t\t// TODO: Create a mesh only when encountered (if it makes sense\n\t\t\t\t// for this file format) and return it using this._pFinalizeAsset()\n\t\t\t\tthis._geometry = new Geometry();\n\t\t\t\tthis._mesh = new Mesh(this._geometry, null);\n\t\t\t\tif (this.materialMode < 2) {\n\t\t\t\t\tthis._mesh.material = DefaultMaterialManager.getDefaultMaterial();\n\t\t\t\t} else {\n\t\t\t\t\tthis._mesh.material = new MethodMaterial(DefaultMaterialManager.getDefaultImage2D());\n\t\t\t\t\t(<MethodMaterial> this._mesh.material).mode = MethodMaterialMode.MULTI_PASS;\n\t\t\t\t}\n\n\t\t\t\t//_geometry.animation = new VertexAnimation(2, VertexAnimationMode.ABSOLUTE);\n\t\t\t\t//_animator = new VertexAnimator(VertexAnimationState(_mesh.animationState));\n\n\t\t\t\t// Parse header and decompress body\n\t\t\t\tthis.parseHeader();\n\t\t\t\tthis.parseMaterialNames();\n\t\t\t} else if (!this._parsedUV) {\n\t\t\t\tthis.parseUV();\n\t\t\t} else if (!this._parsedFaces) {\n\t\t\t\tthis.parseFaces();\n\t\t\t} else if (!this._parsedFrames) {\n\t\t\t\tthis.parseFrames();\n\t\t\t} else if ((this.geoCreated) && (this.materialFinal)) {\n\t\t\t\treturn ParserBase.PARSING_DONE;\n\t\t\t} else if (!this.geoCreated) {\n\t\t\t\tthis.geoCreated = true;\n\t\t\t\t//create default subgeometry\n\t\t\t\tthis._geometry.addSubGeometry(this._firstSubGeom.clone());\n\t\t\t\t// Force name to be chosen by this._pFinalizeAsset()\n\t\t\t\tthis._mesh.name = \"\";\n\t\t\t\tif (this.materialFinal) {\n\t\t\t\t\t//add to the content property\n\t\t\t\t\t(<DisplayObjectContainer> this._pContent).addChild(this._mesh);\n\n\t\t\t\t\tthis._pFinalizeAsset(this._mesh.geometry);\n\t\t\t\t\tthis._pFinalizeAsset(this._mesh);\n\t\t\t\t}\n\n\t\t\t\tthis._pPauseAndRetrieveDependencies();\n\t\t\t}\n\t\t}\n\n\t\treturn ParserBase.MORE_TO_PARSE;\n\t}\n\n\tpublic _pStartParsing(frameLimit:number)\n\t{\n\t\t//create a content object for Loaders\n\t\tthis._pContent = new DisplayObjectContainer();\n\n\t\tsuper._pStartParsing(frameLimit);\n\t}\n\n\t/**\n\t * Reads in all that MD2 Header data that is declared as private variables.\n\t * I know its a lot, and it looks ugly, but only way to do it in Flash\n\t */\n\tprivate parseHeader()\n\t{\n\t\tthis._ident = this._byteData.readInt();\n\t\tthis._version = this._byteData.readInt();\n\t\tthis._skinWidth = this._byteData.readInt();\n\t\tthis._skinHeight = this._byteData.readInt();\n\t\t//skip this._frameSize\n\t\tthis._byteData.readInt();\n\t\tthis._numSkins = this._byteData.readInt();\n\t\tthis._numVertices = this._byteData.readInt();\n\t\tthis._numST = this._byteData.readInt();\n\t\tthis._numTris = this._byteData.readInt();\n\t\t//skip this._numGlCmds\n\t\tthis._byteData.readInt();\n\t\tthis._numFrames = this._byteData.readInt();\n\t\tthis._offsetSkins = this._byteData.readInt();\n\t\tthis._offsetST = this._byteData.readInt();\n\t\tthis._offsetTris = this._byteData.readInt();\n\t\tthis._offsetFrames = this._byteData.readInt();\n\t\t//skip this._offsetGlCmds\n\t\tthis._byteData.readInt();\n\t\tthis._offsetEnd = this._byteData.readInt();\n\n\t\tthis._parsedHeader = true;\n\t}\n\n\t/**\n\t * Parses the file names for the materials.\n\t */\n\tprivate parseMaterialNames()\n\t{\n\t\tvar url:string;\n\t\tvar name:string;\n\t\tvar extIndex:number /*int*/;\n\t\tvar slashIndex:number /*int*/;\n\t\tthis._materialNames = new Array<string>();\n\t\tthis._byteData.position = this._offsetSkins;\n\n\t\tvar regExp:RegExp = new RegExp(\"[^a-zA-Z0-9\\\\_\\/.]\", \"g\");\n\t\tfor (var i:number /*uint*/ = 0; i < this._numSkins; ++i) {\n\t\t\tname = this._byteData.readUTFBytes(64);\n\t\t\tname = name.replace(regExp, \"\");\n\t\t\textIndex = name.lastIndexOf(\".\");\n\t\t\tif (this._ignoreTexturePath)\n\t\t\t\tslashIndex = name.lastIndexOf(\"/\");\n\t\t\tif (name.toLowerCase().indexOf(\".jpg\") == -1 && name.toLowerCase().indexOf(\".png\") == -1) {\n\t\t\t\tname = name.substring(slashIndex + 1, extIndex);\n\t\t\t\turl = name + \".\" + this._textureType;\n\t\t\t} else {\n\t\t\t\turl = name;\n\t\t\t}\n\n\t\t\tthis._materialNames[i] = name;\n\n\t\t\t// only support 1 skin TODO: really?\n\t\t\tif (this.dependencies.length == 0)\n\t\t\t\tthis._pAddDependency(name, new URLRequest(url));\n\t\t}\n\n\t\tif (this._materialNames.length > 0)\n\t\t\tthis._mesh.material.name = this._materialNames[0];\n\t\telse\n\t\t\tthis.materialFinal = true;\n\t}\n\n\t/**\n\t * Parses the uv data for the mesh.\n\t */\n\tprivate parseUV()\n\t{\n\t\tvar j:number /*uint*/ = 0;\n\n\t\tthis._uvs = new Array<number>(this._numST*2);\n\t\tthis._byteData.position = this._offsetST;\n\t\tfor (var i:number /*uint*/ = 0; i < this._numST; i++) {\n\t\t\tthis._uvs[j++] = this._byteData.readShort()/this._skinWidth;\n\t\t\tthis._uvs[j++] = this._byteData.readShort()/this._skinHeight;\n\t\t}\n\n\t\tthis._parsedUV = true;\n\t}\n\n\t/**\n\t * Parses unique indices for the faces.\n\t */\n\tprivate parseFaces()\n\t{\n\t\tvar a:number /*uint*/, b:number /*uint*/, c:number /*uint*/, ta:number /*uint*/, tb:number /*uint*/, tc:number /*uint*/;\n\t\tvar i:number /*uint*/;\n\n\t\tthis._vertIndices = new Array<number>();\n\t\tthis._uvIndices = new Array<number>();\n\t\tthis._indices = new Array<number>() /*uint*/;\n\n\t\tthis._byteData.position = this._offsetTris;\n\n\t\tfor (i = 0; i < this._numTris; i++) {\n\t\t\t//collect vertex indices\n\t\t\ta = this._byteData.readUnsignedShort();\n\t\t\tb = this._byteData.readUnsignedShort();\n\t\t\tc = this._byteData.readUnsignedShort();\n\n\t\t\t//collect uv indices\n\t\t\tta = this._byteData.readUnsignedShort();\n\t\t\ttb = this._byteData.readUnsignedShort();\n\t\t\ttc = this._byteData.readUnsignedShort();\n\n\t\t\tthis.addIndex(a, ta);\n\t\t\tthis.addIndex(b, tb);\n\t\t\tthis.addIndex(c, tc);\n\t\t}\n\n\t\tvar len:number /*uint*/ = this._uvIndices.length;\n\t\tthis._finalUV = new Array<number>(len*2);\n\n\t\tfor (i = 0; i < len; ++i) {\n\t\t\tthis._finalUV[i << 1] = this._uvs[this._uvIndices[i] << 1];\n\t\t\tthis._finalUV[(i << 1) + 1] = this._uvs[(this._uvIndices[i] << 1) + 1];\n\t\t}\n\n\t\tthis._parsedFaces = true;\n\t}\n\n\t/**\n\t * Adds a face index to the list if it doesn't exist yet, based on vertexIndex and uvIndex, and adds the\n\t * corresponding vertex and uv data in the correct location.\n\t * @param vertexIndex The original index in the vertex list.\n\t * @param uvIndex The original index in the uv list.\n\t */\n\tprivate addIndex(vertexIndex:number /*uint*/, uvIndex:number /*uint*/)\n\t{\n\t\tvar index:number /*int*/ = this.findIndex(vertexIndex, uvIndex);\n\n\t\tif (index == -1) {\n\t\t\tthis._indices.push(this._vertIndices.length);\n\t\t\tthis._vertIndices.push(vertexIndex);\n\t\t\tthis._uvIndices.push(uvIndex);\n\t\t} else\n\t\t\tthis._indices.push(index);\n\t}\n\n\t/**\n\t * Finds the final index corresponding to the original MD2's vertex and uv indices. Returns -1 if it wasn't added yet.\n\t * @param vertexIndex The original index in the vertex list.\n\t * @param uvIndex The original index in the uv list.\n\t * @return The index of the final mesh corresponding to the original vertex and uv index. -1 if it doesn't exist yet.\n\t */\n\tprivate findIndex(vertexIndex:number /*uint*/, uvIndex:number /*uint*/):number /*int*/\n\t{\n\t\tvar len:number /*uint*/ = this._vertIndices.length;\n\n\t\tfor (var i:number /*uint*/ = 0; i < len; ++i) {\n\t\t\tif (this._vertIndices[i] == vertexIndex && this._uvIndices[i] == uvIndex)\n\t\t\t\treturn i;\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\t/**\n\t * Parses all the frame geometries.\n\t */\n\tprivate parseFrames()\n\t{\n\t\tvar sx:number, sy:number, sz:number;\n\t\tvar tx:number, ty:number, tz:number;\n\t\tvar geometry:Geometry;\n\t\tvar subGeom:TriangleSubGeometry;\n\t\tvar vertLen:number /*uint*/ = this._vertIndices.length;\n\t\tvar fvertices:Array<number>;\n\t\tvar tvertices:Array<number>;\n\t\tvar i:number /*uint*/, j:number /*int*/, k:number /*uint*/;\n\t\t//var ch : number /*uint*/;\n\t\tvar name:string = \"\";\n\t\tvar prevClip:VertexClipNode = null;\n\n\t\tthis._byteData.position = this._offsetFrames;\n\n\t\tfor (i = 0; i < this._numFrames; i++) {\n\n\t\t\ttvertices = new Array<number>();\n\t\t\tfvertices = new Array<number>(vertLen*3);\n\n\t\t\tsx = this._byteData.readFloat();\n\t\t\tsy = this._byteData.readFloat();\n\t\t\tsz = this._byteData.readFloat();\n\n\t\t\ttx = this._byteData.readFloat();\n\t\t\tty = this._byteData.readFloat();\n\t\t\ttz = this._byteData.readFloat();\n\n\t\t\tname = this.readFrameName();\n\n\t\t\t// Note, the extra data.position++ in the for loop is there\n\t\t\t// to skip over a byte that holds the \"vertex normal index\"\n\t\t\tfor (j = 0; j < this._numVertices; j++, this._byteData.position++)\n\t\t\t\ttvertices.push(sx*this._byteData.readUnsignedByte() + tx, sy*this._byteData.readUnsignedByte() + ty, sz*this._byteData.readUnsignedByte() + tz);\n\n\t\t\tk = 0;\n\t\t\tfor (j = 0; j < vertLen; j++) {\n\t\t\t\tfvertices[k++] = tvertices[this._vertIndices[j]*3];\n\t\t\t\tfvertices[k++] = tvertices[this._vertIndices[j]*3 + 2];\n\t\t\t\tfvertices[k++] = tvertices[this._vertIndices[j]*3 + 1];\n\t\t\t}\n\n\t\t\tsubGeom = new TriangleSubGeometry(new AttributesBuffer());\n\n\t\t\tif (this._firstSubGeom == null)\n\t\t\t\tthis._firstSubGeom = subGeom;\n\n\t\t\tgeometry = new Geometry();\n\t\t\tgeometry.addSubGeometry(subGeom);\n\n\t\t\tsubGeom.setIndices(this._indices);\n\t\t\tsubGeom.setPositions(fvertices);\n\t\t\tsubGeom.setUVs(this._finalUV);\n\t\t\t// cause explicit updates\n\t\t\tsubGeom.setNormals(null);\n\t\t\tsubGeom.setTangents(null);\n\t\t\t// turn auto updates off because they may be animated and set explicitly\n\t\t\tsubGeom.autoDeriveNormals = false;\n\t\t\tsubGeom.autoDeriveTangents = false;\n\n\t\t\tvar clip:VertexClipNode = this._clipNodes[name];\n\n\t\t\tif (!clip) {\n\t\t\t\t// If another sequence was parsed before this one, starting\n\t\t\t\t// a new state means the previous one is complete and can\n\t\t\t\t// hence be finalized.\n\t\t\t\tif (prevClip) {\n\t\t\t\t\tthis._pFinalizeAsset(prevClip);\n\t\t\t\t\tthis._animationSet.addAnimation(prevClip);\n\t\t\t\t}\n\n\t\t\t\tclip = new VertexClipNode();\n\t\t\t\tclip.name = name;\n\t\t\t\tclip.stitchFinalFrame = true;\n\n\t\t\t\tthis._clipNodes[name] = clip;\n\n\t\t\t\tprevClip = clip;\n\t\t\t}\n\t\t\tclip.addFrame(geometry, 1000/MD2Parser.FPS);\n\t\t}\n\n\t\t// Finalize the last state\n\t\tif (prevClip) {\n\t\t\tthis._pFinalizeAsset(prevClip);\n\t\t\tthis._animationSet.addAnimation(prevClip);\n\t\t}\n\n\t\t// Force this._pFinalizeAsset() to decide name\n\t\tthis._pFinalizeAsset(this._animationSet);\n\n\t\tthis._parsedFrames = true;\n\t}\n\n\tprivate readFrameName():string\n\t{\n\t\tvar name:string = \"\";\n\t\tvar k:number /*uint*/ = 0;\n\t\tfor (var j:number /*uint*/ = 0; j < 16; j++) {\n\t\t\tvar ch:number /*uint*/ = this._byteData.readUnsignedByte();\n\n\t\t\tif (Math.floor(ch) > 0x39 && Math.floor(ch) <= 0x7A && k == 0)\n\t\t\t\tname += String.fromCharCode(ch);\n\n\t\t\tif (Math.floor(ch) >= 0x30 && Math.floor(ch) <= 0x39)\n\t\t\t\tk++;\n\t\t}\n\t\treturn name;\n\t}\n}\n\nexport = MD2Parser;",
    "import Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport URLLoaderDataFormat\t\t\t\t= require(\"awayjs-core/lib/net/URLLoaderDataFormat\");\nimport ParserBase\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserBase\");\n\nimport JointPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/JointPose\");\nimport SkeletonPose\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonPose\");\nimport SkeletonClipNode\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/nodes/SkeletonClipNode\");\n\n/**\n * MD5AnimParser provides a parser for the md5anim data type, providing an animation sequence for the md5 format.\n *\n * todo: optimize\n */\nclass MD5AnimParser extends ParserBase\n{\n\tprivate _textData:string;\n\tprivate _startedParsing:boolean;\n\tpublic static VERSION_TOKEN:string = \"MD5Version\";\n\tpublic static COMMAND_LINE_TOKEN:string = \"commandline\";\n\tpublic static NUM_FRAMES_TOKEN:string = \"numFrames\";\n\tpublic static NUM_JOINTS_TOKEN:string = \"numJoints\";\n\tpublic static FRAME_RATE_TOKEN:string = \"frameRate\";\n\tpublic static NUM_ANIMATED_COMPONENTS_TOKEN:string = \"numAnimatedComponents\";\n\n\tpublic static HIERARCHY_TOKEN:string = \"hierarchy\";\n\tpublic static BOUNDS_TOKEN:string = \"bounds\";\n\tpublic static BASE_FRAME_TOKEN:string = \"baseframe\";\n\tpublic static FRAME_TOKEN:string = \"frame\";\n\n\tpublic static COMMENT_TOKEN:string = \"//\";\n\n\tprivate _parseIndex:number /*int*/ = 0;\n\tprivate _reachedEOF:boolean;\n\tprivate _line:number /*int*/ = 0;\n\tprivate _charLineIndex:number /*int*/ = 0;\n\tprivate _version:number /*int*/;\n\tprivate _frameRate:number /*int*/;\n\tprivate _numFrames:number /*int*/;\n\tprivate _numJoints:number /*int*/;\n\tprivate _numAnimatedComponents:number /*int*/;\n\n\tprivate _hierarchy:Array<HierarchyData>;\n\tprivate _bounds:Array<BoundsData>;\n\tprivate _frameData:Array<FrameData>;\n\tprivate _baseFrameData:Array<BaseFrameData>;\n\n\tprivate _rotationQuat:Quaternion;\n\tprivate _clip:SkeletonClipNode;\n\n\t/**\n\t * Creates a new MD5AnimParser object.\n\t * @param uri The url or id of the data or file to be parsed.\n\t * @param extra The holder for extra contextual data that the parser might need.\n\t */\n\tconstructor(additionalRotationAxis:Vector3D = null, additionalRotationRadians:number = 0)\n\t{\n\t\tsuper(URLLoaderDataFormat.TEXT);\n\t\tthis._rotationQuat = new Quaternion();\n\t\tvar t1:Quaternion = new Quaternion();\n\t\tvar t2:Quaternion = new Quaternion();\n\n\t\tt1.fromAxisAngle(Vector3D.X_AXIS, -Math.PI*.5);\n\t\tt2.fromAxisAngle(Vector3D.Y_AXIS, -Math.PI*.5);\n\n\t\tthis._rotationQuat.multiply(t2, t1);\n\n\t\tif (additionalRotationAxis) {\n\t\t\tthis._rotationQuat.multiply(t2, t1);\n\t\t\tt1.fromAxisAngle(additionalRotationAxis, additionalRotationRadians);\n\t\t\tthis._rotationQuat.multiply(t1, this._rotationQuat);\n\t\t}\n\t}\n\n\t/**\n\t * Indicates whether or not a given file extension is supported by the parser.\n\t * @param extension The file extension of a potential file to be parsed.\n\t * @return Whether or not the given file type is supported.\n\t */\n\tpublic static supportsType(extension:string):boolean\n\t{\n\t\textension = extension.toLowerCase();\n\t\treturn extension == \"md5anim\";\n\t}\n\n\t/**\n\t * Tests whether a data block can be parsed by the parser.\n\t * @param data The data block to potentially be parsed.\n\t * @return Whether or not the given data is supported.\n\t */\n\tpublic static supportsData(data:any):boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pProceedParsing():boolean\n\t{\n\t\tvar token:string;\n\n\t\tif (!this._startedParsing) {\n\t\t\tthis._textData = this._pGetTextData();\n\t\t\tthis._startedParsing = true;\n\t\t}\n\n\t\twhile (this._pHasTime()) {\n\t\t\ttoken = this.getNextToken();\n\t\t\tswitch (token) {\n\t\t\t\tcase MD5AnimParser.COMMENT_TOKEN:\n\t\t\t\t\tthis.ignoreLine();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"\":\n\t\t\t\t\t// can occur at the end of a file\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5AnimParser.VERSION_TOKEN:\n\t\t\t\t\tthis._version = this.getNextInt();\n\t\t\t\t\tif (this._version != 10)\n\t\t\t\t\t\tthrow new Error(\"Unknown version number encountered!\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5AnimParser.COMMAND_LINE_TOKEN:\n\t\t\t\t\tthis.parseCMD();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5AnimParser.NUM_FRAMES_TOKEN:\n\t\t\t\t\tthis._numFrames = this.getNextInt();\n\t\t\t\t\tthis._bounds = new Array<BoundsData>();\n\t\t\t\t\tthis._frameData = new Array<FrameData>();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5AnimParser.NUM_JOINTS_TOKEN:\n\t\t\t\t\tthis._numJoints = this.getNextInt();\n\t\t\t\t\tthis._hierarchy = new Array<HierarchyData>(this._numJoints);\n\t\t\t\t\tthis._baseFrameData = new Array<BaseFrameData>(this._numJoints);\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5AnimParser.FRAME_RATE_TOKEN:\n\t\t\t\t\tthis._frameRate = this.getNextInt();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5AnimParser.NUM_ANIMATED_COMPONENTS_TOKEN:\n\t\t\t\t\tthis._numAnimatedComponents = this.getNextInt();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5AnimParser.HIERARCHY_TOKEN:\n\t\t\t\t\tthis.parseHierarchy();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5AnimParser.BOUNDS_TOKEN:\n\t\t\t\t\tthis.parseBounds();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5AnimParser.BASE_FRAME_TOKEN:\n\t\t\t\t\tthis.parseBaseFrame();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5AnimParser.FRAME_TOKEN:\n\t\t\t\t\tthis.parseFrame();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (!this._reachedEOF)\n\t\t\t\t\t\tthis.sendUnknownKeywordError();\n\t\t\t}\n\n\t\t\tif (this._reachedEOF) {\n\t\t\t\tthis._clip = new SkeletonClipNode();\n\t\t\t\tthis.translateClip();\n\t\t\t\tthis._pFinalizeAsset(this._clip);\n\t\t\t\treturn ParserBase.PARSING_DONE;\n\t\t\t}\n\t\t}\n\t\treturn ParserBase.MORE_TO_PARSE;\n\t}\n\n\t/**\n\t * Converts all key frame data to an SkinnedAnimationSequence.\n\t */\n\tprivate translateClip():void\n\t{\n\t\tfor (var i:number /*int*/ = 0; i < this._numFrames; ++i)\n\t\t\tthis._clip.addFrame(this.translatePose(this._frameData[i]), 1000/this._frameRate);\n\t}\n\n\t/**\n\t * Converts a single key frame data to a SkeletonPose.\n\t * @param frameData The actual frame data.\n\t * @return A SkeletonPose containing the frame data's pose.\n\t */\n\tprivate translatePose(frameData:FrameData):SkeletonPose\n\t{\n\t\tvar hierarchy:HierarchyData;\n\t\tvar pose:JointPose;\n\t\tvar base:BaseFrameData;\n\t\tvar flags:number /*int*/;\n\t\tvar j:number /*int*/;\n\t\tvar translate:Vector3D = new Vector3D();\n\t\tvar orientation:Quaternion = new Quaternion();\n\t\tvar components:Array<number> = frameData.components;\n\t\tvar skelPose:SkeletonPose = new SkeletonPose();\n\t\tvar jointPoses:Array<JointPose> = skelPose.jointPoses;\n\n\t\tfor (var i:number /*int*/ = 0; i < this._numJoints; ++i) {\n\t\t\tj = 0;\n\t\t\tpose = new JointPose();\n\t\t\thierarchy = this._hierarchy[i];\n\t\t\tbase = this._baseFrameData[i];\n\t\t\tflags = hierarchy.flags;\n\t\t\ttranslate.x = base.position.x;\n\t\t\ttranslate.y = base.position.y;\n\t\t\ttranslate.z = base.position.z;\n\t\t\torientation.x = base.orientation.x;\n\t\t\torientation.y = base.orientation.y;\n\t\t\torientation.z = base.orientation.z;\n\n\t\t\tif (flags & 1)\n\t\t\t\ttranslate.x = components[hierarchy.startIndex + (j++)];\n\t\t\tif (flags & 2)\n\t\t\t\ttranslate.y = components[hierarchy.startIndex + (j++)];\n\t\t\tif (flags & 4)\n\t\t\t\ttranslate.z = components[hierarchy.startIndex + (j++)];\n\t\t\tif (flags & 8)\n\t\t\t\torientation.x = components[hierarchy.startIndex + (j++)];\n\t\t\tif (flags & 16)\n\t\t\t\torientation.y = components[hierarchy.startIndex + (j++)];\n\t\t\tif (flags & 32)\n\t\t\t\torientation.z = components[hierarchy.startIndex + (j++)];\n\n\t\t\tvar w:number = 1 - orientation.x*orientation.x - orientation.y*orientation.y - orientation.z*orientation.z;\n\t\t\torientation.w = w < 0? 0 : -Math.sqrt(w);\n\n\t\t\tif (hierarchy.parentIndex < 0) {\n\t\t\t\tpose.orientation.multiply(this._rotationQuat, orientation);\n\t\t\t\tpose.translation = this._rotationQuat.rotatePoint(translate);\n\t\t\t} else {\n\t\t\t\tpose.orientation.copyFrom(orientation);\n\t\t\t\tpose.translation.x = translate.x;\n\t\t\t\tpose.translation.y = translate.y;\n\t\t\t\tpose.translation.z = translate.z;\n\t\t\t}\n\t\t\tpose.orientation.y = -pose.orientation.y;\n\t\t\tpose.orientation.z = -pose.orientation.z;\n\t\t\tpose.translation.x = -pose.translation.x;\n\n\t\t\tjointPoses[i] = pose;\n\t\t}\n\n\t\treturn skelPose;\n\t}\n\n\t/**\n\t * Parses the skeleton's hierarchy data.\n\t */\n\tprivate parseHierarchy():void\n\t{\n\t\tvar ch:string;\n\t\tvar data:HierarchyData;\n\t\tvar token:string = this.getNextToken();\n\t\tvar i:number /*int*/ = 0;\n\n\t\tif (token != \"{\")\n\t\t\tthis.sendUnknownKeywordError();\n\n\t\tdo {\n\t\t\tif (this._reachedEOF)\n\t\t\t\tthis.sendEOFError();\n\t\t\tdata = new HierarchyData();\n\t\t\tdata.name = this.parseLiteralstring();\n\t\t\tdata.parentIndex = this.getNextInt();\n\t\t\tdata.flags = this.getNextInt();\n\t\t\tdata.startIndex = this.getNextInt();\n\t\t\tthis._hierarchy[i++] = data;\n\n\t\t\tch = this.getNextChar();\n\n\t\t\tif (ch == \"/\") {\n\t\t\t\tthis.putBack();\n\t\t\t\tch = this.getNextToken();\n\t\t\t\tif (ch == MD5AnimParser.COMMENT_TOKEN)\n\t\t\t\t\tthis.ignoreLine();\n\t\t\t\tch = this.getNextChar();\n\t\t\t}\n\n\t\t\tif (ch != \"}\")\n\t\t\t\tthis.putBack();\n\n\t\t} while (ch != \"}\");\n\t}\n\n\t/**\n\t * Parses frame bounds.\n\t */\n\tprivate parseBounds():void\n\t{\n\t\tvar ch:string;\n\t\tvar data:BoundsData;\n\t\tvar token:string = this.getNextToken();\n\t\tvar i:number /*int*/ = 0;\n\n\t\tif (token != \"{\")\n\t\t\tthis.sendUnknownKeywordError();\n\n\t\tdo {\n\t\t\tif (this._reachedEOF)\n\t\t\t\tthis.sendEOFError();\n\t\t\tdata = new BoundsData();\n\t\t\tdata.min = this.parseVector3D();\n\t\t\tdata.max = this.parseVector3D();\n\t\t\tthis._bounds[i++] = data;\n\n\t\t\tch = this.getNextChar();\n\n\t\t\tif (ch == \"/\") {\n\t\t\t\tthis.putBack();\n\t\t\t\tch = this.getNextToken();\n\t\t\t\tif (ch == MD5AnimParser.COMMENT_TOKEN)\n\t\t\t\t\tthis.ignoreLine();\n\t\t\t\tch = this.getNextChar();\n\t\t\t}\n\n\t\t\tif (ch != \"}\")\n\t\t\t\tthis.putBack();\n\n\t\t} while (ch != \"}\");\n\t}\n\n\t/**\n\t * Parses the base frame.\n\t */\n\tprivate parseBaseFrame():void\n\t{\n\t\tvar ch:string;\n\t\tvar data:BaseFrameData;\n\t\tvar token:string = this.getNextToken();\n\t\tvar i:number /*int*/ = 0;\n\n\t\tif (token != \"{\")\n\t\t\tthis.sendUnknownKeywordError();\n\n\t\tdo {\n\t\t\tif (this._reachedEOF)\n\t\t\t\tthis.sendEOFError();\n\t\t\tdata = new BaseFrameData();\n\t\t\tdata.position = this.parseVector3D();\n\t\t\tdata.orientation = this.parseQuaternion();\n\t\t\tthis._baseFrameData[i++] = data;\n\n\t\t\tch = this.getNextChar();\n\n\t\t\tif (ch == \"/\") {\n\t\t\t\tthis.putBack();\n\t\t\t\tch = this.getNextToken();\n\t\t\t\tif (ch == MD5AnimParser.COMMENT_TOKEN)\n\t\t\t\t\tthis.ignoreLine();\n\t\t\t\tch = this.getNextChar();\n\t\t\t}\n\n\t\t\tif (ch != \"}\")\n\t\t\t\tthis.putBack();\n\n\t\t} while (ch != \"}\");\n\t}\n\n\t/**\n\t * Parses a single frame.\n\t */\n\tprivate parseFrame():void\n\t{\n\t\tvar ch:string;\n\t\tvar data:FrameData;\n\t\tvar token:string;\n\t\tvar frameIndex:number /*int*/;\n\n\t\tframeIndex = this.getNextInt();\n\n\t\ttoken = this.getNextToken();\n\t\tif (token != \"{\")\n\t\t\tthis.sendUnknownKeywordError();\n\n\t\tdo {\n\t\t\tif (this._reachedEOF)\n\t\t\t\tthis.sendEOFError();\n\t\t\tdata = new FrameData();\n\t\t\tdata.components = new Array<number>(this._numAnimatedComponents);\n\n\t\t\tfor (var i:number /*int*/ = 0; i < this._numAnimatedComponents; ++i)\n\t\t\t\tdata.components[i] = this.getNextNumber();\n\n\t\t\tthis._frameData[frameIndex] = data;\n\n\t\t\tch = this.getNextChar();\n\n\t\t\tif (ch == \"/\") {\n\t\t\t\tthis.putBack();\n\t\t\t\tch = this.getNextToken();\n\t\t\t\tif (ch == MD5AnimParser.COMMENT_TOKEN)\n\t\t\t\t\tthis.ignoreLine();\n\t\t\t\tch = this.getNextChar();\n\t\t\t}\n\n\t\t\tif (ch != \"}\")\n\t\t\t\tthis.putBack();\n\n\t\t} while (ch != \"}\");\n\t}\n\n\t/**\n\t * Puts back the last read character into the data stream.\n\t */\n\tprivate putBack():void\n\t{\n\t\tthis._parseIndex--;\n\t\tthis._charLineIndex--;\n\t\tthis._reachedEOF = this._parseIndex >= this._textData.length;\n\t}\n\n\t/**\n\t * Gets the next token in the data stream.\n\t */\n\tprivate getNextToken():string\n\t{\n\t\tvar ch:string;\n\t\tvar token:string = \"\";\n\n\t\twhile (!this._reachedEOF) {\n\t\t\tch = this.getNextChar();\n\t\t\tif (ch == \" \" || ch == \"\\r\" || ch == \"\\n\" || ch == \"\\t\") {\n\t\t\t\tif (token != MD5AnimParser.COMMENT_TOKEN)\n\t\t\t\t\tthis.skipWhiteSpace();\n\t\t\t\tif (token != \"\")\n\t\t\t\t\treturn token;\n\t\t\t} else\n\t\t\t\ttoken += ch;\n\n\t\t\tif (token == MD5AnimParser.COMMENT_TOKEN)\n\t\t\t\treturn token;\n\t\t}\n\n\t\treturn token;\n\t}\n\n\t/**\n\t * Skips all whitespace in the data stream.\n\t */\n\tprivate skipWhiteSpace():void\n\t{\n\t\tvar ch:string;\n\n\t\tdo\n\t\t\tch = this.getNextChar(); while (ch == \"\\n\" || ch == \" \" || ch == \"\\r\" || ch == \"\\t\");\n\n\t\tthis.putBack();\n\t}\n\n\t/**\n\t * Skips to the next line.\n\t */\n\tprivate ignoreLine():void\n\t{\n\t\tvar ch:string;\n\t\twhile (!this._reachedEOF && ch != \"\\n\")\n\t\t\tch = this.getNextChar();\n\t}\n\n\t/**\n\t * Retrieves the next single character in the data stream.\n\t */\n\tprivate getNextChar():string\n\t{\n\t\tvar ch:string = this._textData.charAt(this._parseIndex++);\n\n\t\tif (ch == \"\\n\") {\n\t\t\t++this._line;\n\t\t\tthis._charLineIndex = 0;\n\t\t} else if (ch != \"\\r\")\n\t\t\t++this._charLineIndex;\n\n\t\tif (this._parseIndex == this._textData.length)\n\t\t\tthis._reachedEOF = true;\n\n\t\treturn ch;\n\t}\n\n\t/**\n\t * Retrieves the next integer in the data stream.\n\t */\n\tprivate getNextInt():number /*int*/\n\t{\n\t\tvar i:number = parseInt(this.getNextToken());\n\t\tif (isNaN(i))\n\t\t\tthis.sendParseError(\"int type\");\n\t\treturn i;\n\t}\n\n\t/**\n\t * Retrieves the next floating point number in the data stream.\n\t */\n\tprivate getNextNumber():number\n\t{\n\t\tvar f:number = parseFloat(this.getNextToken());\n\t\tif (isNaN(f))\n\t\t\tthis.sendParseError(\"float type\");\n\t\treturn f;\n\t}\n\n\t/**\n\t * Retrieves the next 3d vector in the data stream.\n\t */\n\tprivate parseVector3D():Vector3D\n\t{\n\t\tvar vec:Vector3D = new Vector3D();\n\t\tvar ch:string = this.getNextToken();\n\n\t\tif (ch != \"(\")\n\t\t\tthis.sendParseError(\"(\");\n\t\tvec.x = this.getNextNumber();\n\t\tvec.y = this.getNextNumber();\n\t\tvec.z = this.getNextNumber();\n\n\t\tif (this.getNextToken() != \")\")\n\t\t\tthis.sendParseError(\")\");\n\n\t\treturn vec;\n\t}\n\n\t/**\n\t * Retrieves the next quaternion in the data stream.\n\t */\n\tprivate parseQuaternion():Quaternion\n\t{\n\t\tvar quat:Quaternion = new Quaternion();\n\t\tvar ch:string = this.getNextToken();\n\n\t\tif (ch != \"(\")\n\t\t\tthis.sendParseError(\"(\");\n\t\tquat.x = this.getNextNumber();\n\t\tquat.y = this.getNextNumber();\n\t\tquat.z = this.getNextNumber();\n\n\t\t// quat supposed to be unit length\n\t\tvar t:number = 1 - (quat.x*quat.x) - (quat.y*quat.y) - (quat.z*quat.z);\n\t\tquat.w = t < 0? 0 : -Math.sqrt(t);\n\n\t\tif (this.getNextToken() != \")\")\n\t\t\tthis.sendParseError(\")\");\n\n\t\treturn quat;\n\t}\n\n\t/**\n\t * Parses the command line data.\n\t */\n\tprivate parseCMD():void\n\t{\n\t\t// just ignore the command line property\n\t\tthis.parseLiteralstring();\n\t}\n\n\t/**\n\t * Retrieves the next literal string in the data stream. A literal string is a sequence of characters bounded\n\t * by double quotes.\n\t */\n\tprivate parseLiteralstring():string\n\t{\n\t\tthis.skipWhiteSpace();\n\n\t\tvar ch:string = this.getNextChar();\n\t\tvar str:string = \"\";\n\n\t\tif (ch != \"\\\"\")\n\t\t\tthis.sendParseError(\"\\\"\");\n\n\t\tdo {\n\t\t\tif (this._reachedEOF)\n\t\t\t\tthis.sendEOFError();\n\t\t\tch = this.getNextChar();\n\t\t\tif (ch != \"\\\"\")\n\t\t\t\tstr += ch;\n\t\t} while (ch != \"\\\"\");\n\n\t\treturn str;\n\t}\n\n\t/**\n\t * Throws an end-of-file error when a premature end of file was encountered.\n\t */\n\tprivate sendEOFError():void\n\t{\n\t\tthrow new Error(\"Unexpected end of file\");\n\t}\n\n\t/**\n\t * Throws an error when an unexpected token was encountered.\n\t * @param expected The token type that was actually expected.\n\t */\n\tprivate sendParseError(expected:string):void\n\t{\n\t\tthrow new Error(\"Unexpected token at line \" + (this._line + 1) + \", character \" + this._charLineIndex + \". \" + expected + \" expected, but \" + this._textData.charAt(this._parseIndex - 1) + \" encountered\");\n\t}\n\n\t/**\n\t * Throws an error when an unknown keyword was encountered.\n\t */\n\tprivate sendUnknownKeywordError():void\n\t{\n\t\tthrow new Error(\"Unknown keyword at line \" + (this._line + 1) + \", character \" + this._charLineIndex + \". \");\n\t}\n}\n\nexport = MD5AnimParser;\n\n\n/**\n *\n */\nclass BaseFrameData\n{\n\t/**\n\t *\n\t */\n\tpublic position:Vector3D;\n\n\t/**\n\t *\n\t */\n\tpublic orientation:Quaternion;\n}\n\n/**\n *\n */\nclass BoundsData\n{\n\t/**\n\t *\n\t */\n\tpublic min:Vector3D;\n\n\t/**\n\t *\n\t */\n\tpublic max:Vector3D;\n}\n\n/**\n *\n */\nclass FrameData\n{\n\t/**\n\t *\n\t */\n\tpublic index:number /*int*/;\n\n\t/**\n\t *\n\t */\n\tpublic components:Array<number>;\n}\n\n/**\n *\n */\nclass HierarchyData\n{\n\t/**\n\t *\n\t */\n\tpublic name:string;\n\n\t/**\n\t *\n\t */\n\tpublic parentIndex:number /*int*/;\n\n\t/**\n\t *\n\t */\n\tpublic flags:number /*int*/;\n\n\t/**\n\t *\n\t */\n\tpublic startIndex:number /*int*/;\n}",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport URLLoaderDataFormat\t\t\t\t= require(\"awayjs-core/lib/net/URLLoaderDataFormat\");\nimport ParserBase\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserBase\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\n\nimport SkeletonAnimationSet\t\t\t\t= require(\"awayjs-renderergl/lib/animators/SkeletonAnimationSet\");\nimport Skeleton\t\t\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/Skeleton\");\nimport SkeletonJoint\t\t\t\t\t= require(\"awayjs-renderergl/lib/animators/data/SkeletonJoint\");\n\n// todo: create animation system, parse skeleton\n\n/**\n * MD5MeshParser provides a parser for the md5mesh data type, providing the geometry of the md5 format.\n *\n * todo: optimize\n */\nclass MD5MeshParser extends ParserBase\n{\n\tprivate _textData:string;\n\tprivate _startedParsing:boolean;\n\tpublic static VERSION_TOKEN:string = \"MD5Version\";\n\tpublic static COMMAND_LINE_TOKEN:string = \"commandline\";\n\tpublic static NUM_JOINTS_TOKEN:string = \"numJoints\";\n\tpublic static NUM_MESHES_TOKEN:string = \"numMeshes\";\n\tpublic static COMMENT_TOKEN:string = \"//\";\n\tpublic static JOINTS_TOKEN:string = \"joints\";\n\tpublic static MESH_TOKEN:string = \"mesh\";\n\n\tpublic static MESH_SHADER_TOKEN:string = \"shader\";\n\tpublic static MESH_NUM_VERTS_TOKEN:string = \"numverts\";\n\tpublic static MESH_VERT_TOKEN:string = \"vert\";\n\tpublic static MESH_NUM_TRIS_TOKEN:string = \"numtris\";\n\tpublic static MESH_TRI_TOKEN:string = \"tri\";\n\tpublic static MESH_NUM_WEIGHTS_TOKEN:string = \"numweights\";\n\tpublic static MESH_WEIGHT_TOKEN:string = \"weight\";\n\n\tprivate _parseIndex:number /*int*/ = 0;\n\tprivate _reachedEOF:boolean;\n\tprivate _line:number /*int*/ = 0;\n\tprivate _charLineIndex:number /*int*/ = 0;\n\tprivate _version:number /*int*/;\n\tprivate _numJoints:number /*int*/;\n\tprivate _numMeshes:number /*int*/;\n\n\tprivate _mesh:Mesh;\n\tprivate _shaders:Array<string>;\n\n\tprivate _maxJointCount:number /*int*/;\n\tprivate _meshData:Array<MeshData>;\n\tprivate _bindPoses:Array<Matrix3D>;\n\tprivate _geometry:Geometry;\n\n\tprivate _skeleton:Skeleton;\n\tprivate _animationSet:SkeletonAnimationSet;\n\n\tprivate _rotationQuat:Quaternion;\n\n\t/**\n\t * Creates a new MD5MeshParser object.\n\t */\n\tconstructor(additionalRotationAxis:Vector3D = null, additionalRotationRadians:number = 0)\n\t{\n\t\tsuper(URLLoaderDataFormat.TEXT);\n\t\tthis._rotationQuat = new Quaternion();\n\n\t\tthis._rotationQuat.fromAxisAngle(Vector3D.X_AXIS, -Math.PI*.5);\n\n\t\tif (additionalRotationAxis) {\n\t\t\tvar quat:Quaternion = new Quaternion();\n\t\t\tquat.fromAxisAngle(additionalRotationAxis, additionalRotationRadians);\n\t\t\tthis._rotationQuat.multiply(this._rotationQuat, quat);\n\t\t}\n\t}\n\n\t/**\n\t * Indicates whether or not a given file extension is supported by the parser.\n\t * @param extension The file extension of a potential file to be parsed.\n\t * @return Whether or not the given file type is supported.\n\t */\n\tpublic static supportsType(extension:string):boolean\n\t{\n\t\textension = extension.toLowerCase();\n\t\treturn extension == \"md5mesh\";\n\t}\n\n\t/**\n\t * Tests whether a data block can be parsed by the parser.\n\t * @param data The data block to potentially be parsed.\n\t * @return Whether or not the given data is supported.\n\t */\n\tpublic static supportsData(data:any):boolean\n\t{\n\t\treturn false;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pProceedParsing():boolean\n\t{\n\t\tvar token:string;\n\n\t\tif (!this._startedParsing) {\n\t\t\tthis._textData = this._pGetTextData();\n\t\t\tthis._startedParsing = true;\n\t\t}\n\n\t\twhile (this._pHasTime()) {\n\t\t\ttoken = this.getNextToken();\n\t\t\tswitch (token) {\n\t\t\t\tcase MD5MeshParser.COMMENT_TOKEN:\n\t\t\t\t\tthis.ignoreLine();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.VERSION_TOKEN:\n\t\t\t\t\tthis._version = this.getNextInt();\n\t\t\t\t\tif (this._version != 10)\n\t\t\t\t\t\tthrow new Error(\"Unknown version number encountered!\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.COMMAND_LINE_TOKEN:\n\t\t\t\t\tthis.parseCMD();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.NUM_JOINTS_TOKEN:\n\t\t\t\t\tthis._numJoints = this.getNextInt();\n\t\t\t\t\tthis._bindPoses = new Array<Matrix3D>(this._numJoints);\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.NUM_MESHES_TOKEN:\n\t\t\t\t\tthis._numMeshes = this.getNextInt();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.JOINTS_TOKEN:\n\t\t\t\t\tthis.parseJoints();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.MESH_TOKEN:\n\t\t\t\t\tthis.parseMesh();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (!this._reachedEOF)\n\t\t\t\t\t\tthis.sendUnknownKeywordError();\n\t\t\t}\n\n\t\t\tif (this._reachedEOF) {\n\t\t\t\tthis.calculateMaxJointCount();\n\t\t\t\tthis._animationSet = new SkeletonAnimationSet(this._maxJointCount);\n\n\t\t\t\tthis._mesh = new Mesh(new Geometry(), null);\n\t\t\t\tthis._geometry = this._mesh.geometry;\n\n\t\t\t\tfor (var i:number /*int*/ = 0; i < this._meshData.length; ++i)\n\t\t\t\t\tthis._geometry.addSubGeometry(this.translateGeom(this._meshData[i].vertexData, this._meshData[i].weightData, this._meshData[i].indices));\n\n\t\t\t\t//_geometry.animation = _animation;\n\t\t\t\t//\t\t\t\t\t_mesh.animationController = _animationController;\n\n\t\t\t\t//add to the content property\n\t\t\t\t(<DisplayObjectContainer> this._pContent).addChild(this._mesh);\n\n\t\t\t\tthis._pFinalizeAsset(this._geometry);\n\t\t\t\tthis._pFinalizeAsset(this._mesh);\n\t\t\t\tthis._pFinalizeAsset(this._skeleton);\n\t\t\t\tthis._pFinalizeAsset(this._animationSet);\n\t\t\t\treturn ParserBase.PARSING_DONE;\n\t\t\t}\n\t\t}\n\t\treturn ParserBase.MORE_TO_PARSE;\n\t}\n\n\tpublic _pStartParsing(frameLimit:number)\n\t{\n\t\t//create a content object for Loaders\n\t\tthis._pContent = new DisplayObjectContainer();\n\n\t\tsuper._pStartParsing(frameLimit);\n\t}\n\n\tprivate calculateMaxJointCount():void\n\t{\n\t\tthis._maxJointCount = 0;\n\n\t\tvar numMeshData:number /*int*/ = this._meshData.length;\n\t\tfor (var i:number /*int*/ = 0; i < numMeshData; ++i) {\n\t\t\tvar meshData:MeshData = this._meshData[i];\n\t\t\tvar vertexData:Array<VertexData> = meshData.vertexData;\n\t\t\tvar numVerts:number /*int*/ = vertexData.length;\n\n\t\t\tfor (var j:number /*int*/ = 0; j < numVerts; ++j) {\n\t\t\t\tvar zeroWeights:number /*int*/ = this.countZeroWeightJoints(vertexData[j], meshData.weightData);\n\t\t\t\tvar totalJoints:number /*int*/ = vertexData[j].countWeight - zeroWeights;\n\t\t\t\tif (totalJoints > this._maxJointCount)\n\t\t\t\t\tthis._maxJointCount = totalJoints;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate countZeroWeightJoints(vertex:VertexData, weights:Array<JointData>):number /*int*/\n\t{\n\t\tvar start:number /*int*/ = vertex.startWeight;\n\t\tvar end:number /*int*/ = vertex.startWeight + vertex.countWeight;\n\t\tvar count:number /*int*/ = 0;\n\t\tvar weight:number;\n\n\t\tfor (var i:number /*int*/ = start; i < end; ++i) {\n\t\t\tweight = weights[i].bias;\n\t\t\tif (weight == 0)\n\t\t\t\t++count;\n\t\t}\n\n\t\treturn count;\n\t}\n\n\t/**\n\t * Parses the skeleton's joints.\n\t */\n\tprivate parseJoints():void\n\t{\n\t\tvar ch:string;\n\t\tvar joint:SkeletonJoint;\n\t\tvar pos:Vector3D;\n\t\tvar quat:Quaternion;\n\t\tvar i:number /*int*/ = 0;\n\t\tvar token:string = this.getNextToken();\n\n\t\tif (token != \"{\")\n\t\t\tthis.sendUnknownKeywordError();\n\n\t\tthis._skeleton = new Skeleton();\n\n\t\tdo {\n\t\t\tif (this._reachedEOF)\n\t\t\t\tthis.sendEOFError();\n\t\t\tjoint = new SkeletonJoint();\n\t\t\tjoint.name = this.parseLiteralstring();\n\t\t\tjoint.parentIndex = this.getNextInt();\n\t\t\tpos = this.parseVector3D();\n\t\t\tpos = this._rotationQuat.rotatePoint(pos);\n\t\t\tquat = this.parseQuaternion();\n\n\t\t\t// todo: check if this is correct, or maybe we want to actually store it as quats?\n\t\t\tthis._bindPoses[i] = quat.toMatrix3D();\n\t\t\tthis._bindPoses[i].appendTranslation(pos.x, pos.y, pos.z);\n\t\t\tvar inv:Matrix3D = this._bindPoses[i].clone();\n\t\t\tinv.invert();\n\t\t\tjoint.inverseBindPose = inv.rawData;\n\n\t\t\tthis._skeleton.joints[i++] = joint;\n\n\t\t\tch = this.getNextChar();\n\n\t\t\tif (ch == \"/\") {\n\t\t\t\tthis.putBack();\n\t\t\t\tch = this.getNextToken();\n\t\t\t\tif (ch == MD5MeshParser.COMMENT_TOKEN)\n\t\t\t\t\tthis.ignoreLine();\n\t\t\t\tch = this.getNextChar();\n\n\t\t\t}\n\n\t\t\tif (ch != \"}\")\n\t\t\t\tthis.putBack();\n\t\t} while (ch != \"}\");\n\t}\n\n\t/**\n\t * Puts back the last read character into the data stream.\n\t */\n\tprivate putBack():void\n\t{\n\t\tthis._parseIndex--;\n\t\tthis._charLineIndex--;\n\t\tthis._reachedEOF = this._parseIndex >= this._textData.length;\n\t}\n\n\t/**\n\t * Parses the mesh geometry.\n\t */\n\tprivate parseMesh():void\n\t{\n\t\tvar token:string = this.getNextToken();\n\t\tvar ch:string;\n\t\tvar vertexData:Array<VertexData>;\n\t\tvar weights:Array<JointData>;\n\t\tvar indices:Array<number> /*uint*/;\n\n\t\tif (token != \"{\")\n\t\t\tthis.sendUnknownKeywordError();\n\n\t\tif (this._shaders == null)\n\t\t\tthis._shaders = new Array<string>();\n\n\t\twhile (ch != \"}\") {\n\t\t\tch = this.getNextToken();\n\t\t\tswitch (ch) {\n\t\t\t\tcase MD5MeshParser.COMMENT_TOKEN:\n\t\t\t\t\tthis.ignoreLine();\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.MESH_SHADER_TOKEN:\n\t\t\t\t\tthis._shaders.push(this.parseLiteralstring());\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.MESH_NUM_VERTS_TOKEN:\n\t\t\t\t\tvertexData = new Array<VertexData>(this.getNextInt());\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.MESH_NUM_TRIS_TOKEN:\n\t\t\t\t\tindices = new Array<number>(this.getNextInt()*3) /*uint*/;\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.MESH_NUM_WEIGHTS_TOKEN:\n\t\t\t\t\tweights = new Array<JointData>(this.getNextInt());\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.MESH_VERT_TOKEN:\n\t\t\t\t\tthis.parseVertex(vertexData);\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.MESH_TRI_TOKEN:\n\t\t\t\t\tthis.parseTri(indices);\n\t\t\t\t\tbreak;\n\t\t\t\tcase MD5MeshParser.MESH_WEIGHT_TOKEN:\n\t\t\t\t\tthis.parseJoint(weights);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this._meshData == null)\n\t\t\tthis._meshData = new Array<MeshData>();\n\n\t\tvar i:number /*uint*/ = this._meshData.length;\n\t\tthis._meshData[i] = new MeshData();\n\t\tthis._meshData[i].vertexData = vertexData;\n\t\tthis._meshData[i].weightData = weights;\n\t\tthis._meshData[i].indices = indices;\n\t}\n\n\t/**\n\t * Converts the mesh data to a SkinnedSub instance.\n\t * @param vertexData The mesh's vertices.\n\t * @param weights The joint weights per vertex.\n\t * @param indices The indices for the faces.\n\t * @return A SubGeometry instance containing all geometrical data for the current mesh.\n\t */\n\tprivate translateGeom(vertexData:Array<VertexData>, weights:Array<JointData>, indices:Array<number> /*uint*/):TriangleSubGeometry\n\t{\n\t\tvar len:number /*int*/ = vertexData.length;\n\t\tvar v1:number /*int*/, v2:number /*int*/, v3:number /*int*/;\n\t\tvar vertex:VertexData;\n\t\tvar weight:JointData;\n\t\tvar bindPose:Matrix3D;\n\t\tvar pos:Vector3D;\n\t\tvar subGeom:TriangleSubGeometry = new TriangleSubGeometry(new AttributesBuffer());\n\t\tvar uvs:Array<number> = new Array<number>(len*2);\n\t\tvar vertices:Array<number> = new Array<number>(len*3);\n\t\tvar jointIndices:Array<number> = new Array<number>(len*this._maxJointCount);\n\t\tvar jointWeights:Array<number> = new Array<number>(len*this._maxJointCount);\n\t\tvar l:number /*int*/ = 0;\n\t\tvar nonZeroWeights:number /*int*/;\n\n\t\tfor (var i:number /*int*/ = 0; i < len; ++i) {\n\t\t\tvertex = vertexData[i];\n\t\t\tv1 = vertex.index*3;\n\t\t\tv2 = v1 + 1;\n\t\t\tv3 = v1 + 2;\n\t\t\tvertices[v1] = vertices[v2] = vertices[v3] = 0;\n\n\t\t\tnonZeroWeights = 0;\n\t\t\tfor (var j:number /*int*/ = 0; j < vertex.countWeight; ++j) {\n\t\t\t\tweight = weights[vertex.startWeight + j];\n\t\t\t\tif (weight.bias > 0) {\n\t\t\t\t\tbindPose = this._bindPoses[weight.joint];\n\t\t\t\t\tpos = bindPose.transformVector(weight.pos);\n\t\t\t\t\tvertices[v1] += pos.x*weight.bias;\n\t\t\t\t\tvertices[v2] += pos.y*weight.bias;\n\t\t\t\t\tvertices[v3] += pos.z*weight.bias;\n\n\t\t\t\t\t// indices need to be multiplied by 3 (amount of matrix registers)\n\t\t\t\t\tjointIndices[l] = weight.joint*3;\n\t\t\t\t\tjointWeights[l++] = weight.bias;\n\t\t\t\t\t++nonZeroWeights;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (j = nonZeroWeights; j < this._maxJointCount; ++j) {\n\t\t\t\tjointIndices[l] = 0;\n\t\t\t\tjointWeights[l++] = 0;\n\t\t\t}\n\n\t\t\tv1 = vertex.index << 1;\n\t\t\tuvs[v1++] = vertex.s;\n\t\t\tuvs[v1] = vertex.t;\n\t\t}\n\n\t\tsubGeom.jointsPerVertex = this._maxJointCount;\n\t\tsubGeom.setIndices(indices);\n\t\tsubGeom.setPositions(vertices);\n\t\tsubGeom.setUVs(uvs);\n\t\tsubGeom.setJointIndices(jointIndices);\n\t\tsubGeom.setJointWeights(jointWeights);\n\t\t// cause explicit updates\n\t\tsubGeom.setNormals(null);\n\t\tsubGeom.setTangents(null);\n\t\t// turn auto updates off because they may be animated and set explicitly\n\t\tsubGeom.autoDeriveTangents = false;\n\t\tsubGeom.autoDeriveNormals = false;\n\n\t\treturn subGeom;\n\t}\n\n\t/**\n\t * Retrieve the next triplet of vertex indices that form a face.\n\t * @param indices The index list in which to store the read data.\n\t */\n\tprivate parseTri(indices:Array<number> /*uint*/):void\n\t{\n\t\tvar index:number /*int*/ = this.getNextInt()*3;\n\t\tindices[index] = this.getNextInt();\n\t\tindices[index + 1] = this.getNextInt();\n\t\tindices[index + 2] = this.getNextInt();\n\t}\n\n\t/**\n\t * Reads a new joint data set for a single joint.\n\t * @param weights the target list to contain the weight data.\n\t */\n\tprivate parseJoint(weights:Array<JointData>):void\n\t{\n\t\tvar weight:JointData = new JointData();\n\t\tweight.index = this.getNextInt();\n\t\tweight.joint = this.getNextInt();\n\t\tweight.bias = this.getNextNumber();\n\t\tweight.pos = this.parseVector3D();\n\t\tweights[weight.index] = weight;\n\t}\n\n\t/**\n\t * Reads the data for a single vertex.\n\t * @param vertexData The list to contain the vertex data.\n\t */\n\tprivate parseVertex(vertexData:Array<VertexData>):void\n\t{\n\t\tvar vertex:VertexData = new VertexData();\n\t\tvertex.index = this.getNextInt();\n\t\tthis.parseUV(vertex);\n\t\tvertex.startWeight = this.getNextInt();\n\t\tvertex.countWeight = this.getNextInt();\n\t\t//\t\t\tif (vertex.countWeight > _maxJointCount) _maxJointCount = vertex.countWeight;\n\t\tvertexData[vertex.index] = vertex;\n\t}\n\n\t/**\n\t * Reads the next uv coordinate.\n\t * @param vertexData The vertexData to contain the UV coordinates.\n\t */\n\tprivate parseUV(vertexData:VertexData):void\n\t{\n\t\tvar ch:string = this.getNextToken();\n\t\tif (ch != \"(\")\n\t\t\tthis.sendParseError(\"(\");\n\t\tvertexData.s = this.getNextNumber();\n\t\tvertexData.t = this.getNextNumber();\n\n\t\tif (this.getNextToken() != \")\")\n\t\t\tthis.sendParseError(\")\");\n\t}\n\n\t/**\n\t * Gets the next token in the data stream.\n\t */\n\tprivate getNextToken():string\n\t{\n\t\tvar ch:string;\n\t\tvar token:string = \"\";\n\n\t\twhile (!this._reachedEOF) {\n\t\t\tch = this.getNextChar();\n\t\t\tif (ch == \" \" || ch == \"\\r\" || ch == \"\\n\" || ch == \"\\t\") {\n\t\t\t\tif (token != MD5MeshParser.COMMENT_TOKEN)\n\t\t\t\t\tthis.skipWhiteSpace();\n\t\t\t\tif (token != \"\")\n\t\t\t\t\treturn token;\n\t\t\t} else\n\t\t\t\ttoken += ch;\n\n\t\t\tif (token == MD5MeshParser.COMMENT_TOKEN)\n\t\t\t\treturn token;\n\t\t}\n\n\t\treturn token;\n\t}\n\n\t/**\n\t * Skips all whitespace in the data stream.\n\t */\n\tprivate skipWhiteSpace():void\n\t{\n\t\tvar ch:string;\n\n\t\tdo\n\t\t\tch = this.getNextChar(); while (ch == \"\\n\" || ch == \" \" || ch == \"\\r\" || ch == \"\\t\");\n\n\t\tthis.putBack();\n\t}\n\n\t/**\n\t * Skips to the next line.\n\t */\n\tprivate ignoreLine():void\n\t{\n\t\tvar ch:string;\n\t\twhile (!this._reachedEOF && ch != \"\\n\")\n\t\t\tch = this.getNextChar();\n\t}\n\n\t/**\n\t * Retrieves the next single character in the data stream.\n\t */\n\tprivate getNextChar():string\n\t{\n\t\tvar ch:string = this._textData.charAt(this._parseIndex++);\n\n\t\tif (ch == \"\\n\") {\n\t\t\t++this._line;\n\t\t\tthis._charLineIndex = 0;\n\t\t} else if (ch != \"\\r\")\n\t\t\t++this._charLineIndex;\n\n\t\tif (this._parseIndex >= this._textData.length)\n\t\t\tthis._reachedEOF = true;\n\n\t\treturn ch;\n\t}\n\n\t/**\n\t * Retrieves the next integer in the data stream.\n\t */\n\tprivate getNextInt():number /*int*/\n\t{\n\t\tvar i:number = parseInt(this.getNextToken());\n\t\tif (isNaN(i))\n\t\t\tthis.sendParseError(\"int type\");\n\t\treturn i;\n\t}\n\n\t/**\n\t * Retrieves the next floating point number in the data stream.\n\t */\n\tprivate getNextNumber():number\n\t{\n\t\tvar f:number = parseFloat(this.getNextToken());\n\t\tif (isNaN(f))\n\t\t\tthis.sendParseError(\"float type\");\n\t\treturn f;\n\t}\n\n\t/**\n\t * Retrieves the next 3d vector in the data stream.\n\t */\n\tprivate parseVector3D():Vector3D\n\t{\n\t\tvar vec:Vector3D = new Vector3D();\n\t\tvar ch:string = this.getNextToken();\n\n\t\tif (ch != \"(\")\n\t\t\tthis.sendParseError(\"(\");\n\t\tvec.x = -this.getNextNumber();\n\t\tvec.y = this.getNextNumber();\n\t\tvec.z = this.getNextNumber();\n\n\t\tif (this.getNextToken() != \")\")\n\t\t\tthis.sendParseError(\")\");\n\n\t\treturn vec;\n\t}\n\n\t/**\n\t * Retrieves the next quaternion in the data stream.\n\t */\n\tprivate parseQuaternion():Quaternion\n\t{\n\t\tvar quat:Quaternion = new Quaternion();\n\t\tvar ch:string = this.getNextToken();\n\n\t\tif (ch != \"(\")\n\t\t\tthis.sendParseError(\"(\");\n\t\tquat.x = this.getNextNumber();\n\t\tquat.y = -this.getNextNumber();\n\t\tquat.z = -this.getNextNumber();\n\n\t\t// quat supposed to be unit length\n\t\tvar t:number = 1 - quat.x*quat.x - quat.y*quat.y - quat.z*quat.z;\n\t\tquat.w = t < 0? 0 : -Math.sqrt(t);\n\n\t\tif (this.getNextToken() != \")\")\n\t\t\tthis.sendParseError(\")\");\n\n\t\tvar rotQuat:Quaternion = new Quaternion();\n\t\trotQuat.multiply(this._rotationQuat, quat);\n\t\treturn rotQuat;\n\t}\n\n\t/**\n\t * Parses the command line data.\n\t */\n\tprivate parseCMD():void\n\t{\n\t\t// just ignore the command line property\n\t\tthis.parseLiteralstring();\n\t}\n\n\t/**\n\t * Retrieves the next literal string in the data stream. A literal string is a sequence of characters bounded\n\t * by double quotes.\n\t */\n\tprivate parseLiteralstring():string\n\t{\n\t\tthis.skipWhiteSpace();\n\n\t\tvar ch:string = this.getNextChar();\n\t\tvar str:string = \"\";\n\n\t\tif (ch != \"\\\"\")\n\t\t\tthis.sendParseError(\"\\\"\");\n\n\t\tdo {\n\t\t\tif (this._reachedEOF)\n\t\t\t\tthis.sendEOFError();\n\t\t\tch = this.getNextChar();\n\t\t\tif (ch != \"\\\"\")\n\t\t\t\tstr += ch;\n\t\t} while (ch != \"\\\"\");\n\n\t\treturn str;\n\t}\n\n\t/**\n\t * Throws an end-of-file error when a premature end of file was encountered.\n\t */\n\tprivate sendEOFError():void\n\t{\n\t\tthrow new Error(\"Unexpected end of file\");\n\t}\n\n\t/**\n\t * Throws an error when an unexpected token was encountered.\n\t * @param expected The token type that was actually expected.\n\t */\n\tprivate sendParseError(expected:string):void\n\t{\n\t\tthrow new Error(\"Unexpected token at line \" + (this._line + 1) + \", character \" + this._charLineIndex + \". \" + expected + \" expected, but \" + this._textData.charAt(this._parseIndex - 1) + \" encountered\");\n\t}\n\n\t/**\n\t * Throws an error when an unknown keyword was encountered.\n\t */\n\tprivate sendUnknownKeywordError():void\n\t{\n\t\tthrow new Error(\"Unknown keyword at line \" + (this._line + 1) + \", character \" + this._charLineIndex + \". \");\n\t}\n}\n\nexport = MD5MeshParser;\n\n\nclass VertexData\n{\n\tpublic index:number /*int*/;\n\tpublic s:number;\n\tpublic t:number;\n\tpublic startWeight:number /*int*/;\n\tpublic countWeight:number /*int*/;\n}\n\nclass JointData\n{\n\tpublic index:number /*int*/;\n\tpublic joint:number /*int*/;\n\tpublic bias:number;\n\tpublic pos:Vector3D;\n}\n\nclass MeshData\n{\n\tpublic vertexData:Array<VertexData>;\n\tpublic weightData:Array<JointData>;\n\tpublic indices:Array<number> /*uint*/;\n}",
    "import AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport BitmapImage2D\t\t\t\t\t= require(\"awayjs-core/lib/image/BitmapImage2D\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport URLLoaderDataFormat\t\t\t\t= require(\"awayjs-core/lib/net/URLLoaderDataFormat\");\nimport URLRequest\t\t\t\t\t\t= require(\"awayjs-core/lib/net/URLRequest\");\nimport ParserBase\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserBase\");\nimport ParserUtils\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserUtils\");\nimport ResourceDependency\t\t\t\t= require(\"awayjs-core/lib/parsers/ResourceDependency\");\nimport ByteArray\t\t\t\t\t\t= require(\"awayjs-core/lib/utils/ByteArray\");\n\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport DefaultMaterialManager\t\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport Single2DTexture\t\t\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\n\nimport MethodMaterial\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterial\");\nimport MethodMaterialMode\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterialMode\");\n\n/**\n * Max3DSParser provides a parser for the 3ds data type.\n */\nclass Max3DSParser extends ParserBase\n{\n\tprivate _byteData:ByteArray;\n\n\tprivate _textures:Object;\n\tprivate _materials:Object;\n\tprivate _unfinalized_objects:Object;\n\n\tprivate _cur_obj_end:number;\n\tprivate _cur_obj:ObjectVO;\n\n\tprivate _cur_mat_end:number;\n\tprivate _cur_mat:MaterialVO;\n\tprivate _useSmoothingGroups:boolean;\n\n\t/**\n\t * Creates a new <code>Max3DSParser</code> object.\n\t *\n\t * @param useSmoothingGroups Determines whether the parser looks for smoothing groups in the 3ds file or assumes uniform smoothing. Defaults to true.\n\t */\n\tconstructor(useSmoothingGroups:boolean = true)\n\t{\n\t\tsuper(URLLoaderDataFormat.ARRAY_BUFFER);\n\n\t\tthis._useSmoothingGroups = useSmoothingGroups;\n\t}\n\n\t/**\n\t * Indicates whether or not a given file extension is supported by the parser.\n\t * @param extension The file extension of a potential file to be parsed.\n\t * @return Whether or not the given file type is supported.\n\t */\n\tpublic static supportsType(extension:string):boolean\n\t{\n\t\textension = extension.toLowerCase();\n\t\treturn extension == \"3ds\";\n\t}\n\n\t/**\n\t * Tests whether a data block can be parsed by the parser.\n\t * @param data The data block to potentially be parsed.\n\t * @return Whether or not the given data is supported.\n\t */\n\tpublic static supportsData(data:any):boolean\n\t{\n\t\tvar ba:ByteArray;\n\n\t\tba = ParserUtils.toByteArray(data);\n\t\tif (ba) {\n\t\t\tba.position = 0;\n\t\t\tif (ba.readShort() == 0x4d4d)\n\t\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iResolveDependency(resourceDependency:ResourceDependency):void\n\t{\n\t\tif (resourceDependency.assets.length == 1) {\n\t\t\tvar asset:IAsset;\n\n\t\t\tasset = resourceDependency.assets[0];\n\t\t\tif (asset.isAsset(BitmapImage2D)) {\n\t\t\t\tvar tex:TextureVO;\n\n\t\t\t\ttex = this._textures[resourceDependency.id];\n\t\t\t\ttex.texture = new Single2DTexture(<BitmapImage2D> asset);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iResolveDependencyFailure(resourceDependency:ResourceDependency):void\n\t{\n\t\t// TODO: Implement\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pProceedParsing():boolean\n\t{\n\t\tif (!this._byteData) {\n\t\t\tthis._byteData = this._pGetByteData();\n\t\t\tthis._byteData.position = 0;\n\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t// LITTLE_ENDIAN - Default for ArrayBuffer / Not implemented in ByteArray\n\t\t\t//----------------------------------------------------------------------------\n\t\t\t//this._byteData.endian = Endian.LITTLE_ENDIAN;// Should be default\n\t\t\t//----------------------------------------------------------------------------\n\n\t\t\tthis._textures = {};\n\t\t\tthis._materials = {};\n\t\t\tthis._unfinalized_objects = {};\n\t\t}\n\n\t\t// TODO: With this construct, the loop will run no-op for as long\n\t\t// as there is time once file has finished reading. Consider a nice\n\t\t// way to stop loop when byte array is empty, without putting it in\n\t\t// the while-conditional, which will prevent finalizations from\n\t\t// happening after the last chunk.\n\t\twhile (this._pHasTime()) {\n\n\t\t\t// If we are currently working on an object, and the most recent chunk was\n\t\t\t// the last one in that object, finalize the current object.\n\t\t\tif (this._cur_mat && this._byteData.position >= this._cur_mat_end)\n\t\t\t\tthis.finalizeCurrentMaterial();\n\t\t\telse if (this._cur_obj && this._byteData.position >= this._cur_obj_end) {\n\t\t\t\t// Can't finalize at this point, because we have to wait until the full\n\t\t\t\t// animation section has been parsed for any potential pivot definitions\n\t\t\t\tthis._unfinalized_objects[this._cur_obj.name] = this._cur_obj;\n\t\t\t\tthis._cur_obj_end = Number.MAX_VALUE /*uint*/;\n\t\t\t\tthis._cur_obj = null;\n\t\t\t}\n\n\t\t\tif (this._byteData.getBytesAvailable() > 0) {\n\t\t\t\tvar cid:number /*uint*/;\n\t\t\t\tvar len:number /*uint*/;\n\t\t\t\tvar end:number /*uint*/;\n\n\t\t\t\tcid = this._byteData.readUnsignedShort();\n\t\t\t\tlen = this._byteData.readUnsignedInt();\n\t\t\t\tend = this._byteData.position + (len - 6);\n\n\t\t\t\tswitch (cid) {\n\t\t\t\t\tcase 0x4D4D: // MAIN3DS\n\t\t\t\t\tcase 0x3D3D: // EDIT3DS\n\t\t\t\t\tcase 0xB000: // KEYF3DS\n\t\t\t\t\t\t// This types are \"container chunks\" and contain only\n\t\t\t\t\t\t// sub-chunks (no data on their own.) This means that\n\t\t\t\t\t\t// there is nothing more to parse at this point, and\n\t\t\t\t\t\t// instead we should progress to the next chunk, which\n\t\t\t\t\t\t// will be the first sub-chunk of this one.\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 0xAFFF: // MATERIAL\n\t\t\t\t\t\tthis._cur_mat_end = end;\n\t\t\t\t\t\tthis._cur_mat = this.parseMaterial();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 0x4000: // EDIT_OBJECT\n\t\t\t\t\t\tthis._cur_obj_end = end;\n\t\t\t\t\t\tthis._cur_obj = new ObjectVO();\n\t\t\t\t\t\tthis._cur_obj.name = this.readNulTermstring();\n\t\t\t\t\t\tthis._cur_obj.materials = new Array<string>();\n\t\t\t\t\t\tthis._cur_obj.materialFaces = {};\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 0x4100: // OBJ_TRIMESH\n\t\t\t\t\t\tthis._cur_obj.type = Mesh.assetType;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 0x4110: // TRI_VERTEXL\n\t\t\t\t\t\tthis.parseVertexList();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 0x4120: // TRI_FACELIST\n\t\t\t\t\t\tthis.parseFaceList();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 0x4140: // TRI_MAPPINGCOORDS\n\t\t\t\t\t\tthis.parseUVList();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 0x4130: // Face materials\n\t\t\t\t\t\tthis.parseFaceMaterialList();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 0x4160: // Transform\n\t\t\t\t\t\tthis._cur_obj.transform = this.readTransform();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 0xB002: // Object animation (including pivot)\n\t\t\t\t\t\tthis.parseObjectAnimation(end);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 0x4150: // Smoothing groups\n\t\t\t\t\t\tthis.parseSmoothingGroups();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\t// Skip this (unknown) chunk\n\t\t\t\t\t\tthis._byteData.position += (len - 6);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// Pause parsing if there were any dependencies found during this\n\t\t\t\t// iteration (i.e. if there are any dependencies that need to be\n\t\t\t\t// retrieved at this time.)\n\t\t\t\tif (this.dependencies.length) {\n\t\t\t\t\tthis._pPauseAndRetrieveDependencies();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// More parsing is required if the entire byte array has not yet\n\t\t// been read, or if there is a currently non-finalized object in\n\t\t// the pipeline.\n\t\tif (this._byteData.getBytesAvailable() || this._cur_obj || this._cur_mat) {\n\t\t\treturn ParserBase.MORE_TO_PARSE;\n\t\t} else {\n\t\t\tvar name:string;\n\n\t\t\t// Finalize any remaining objects before ending.\n\t\t\tfor (name in this._unfinalized_objects) {\n\t\t\t\tvar obj:DisplayObjectContainer;\n\t\t\t\tobj = this.constructObject(this._unfinalized_objects[name]);\n\t\t\t\tif (obj) {\n\t\t\t\t\t//add to the content property\n\t\t\t\t\t(<DisplayObjectContainer> this._pContent).addChild(obj);\n\n\t\t\t\t\tthis._pFinalizeAsset(obj, name);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn ParserBase.PARSING_DONE;\n\t\t}\n\t}\n\n\tpublic _pStartParsing(frameLimit:number)\n\t{\n\t\t//create a content object for Loaders\n\t\tthis._pContent = new DisplayObjectContainer();\n\n\t\tsuper._pStartParsing(frameLimit);\n\t}\n\n\tprivate parseMaterial():MaterialVO\n\t{\n\t\tvar mat:MaterialVO;\n\n\t\tmat = new MaterialVO();\n\n\t\twhile (this._byteData.position < this._cur_mat_end) {\n\t\t\tvar cid:number /*uint*/;\n\t\t\tvar len:number /*uint*/;\n\t\t\tvar end:number /*uint*/;\n\n\t\t\tcid = this._byteData.readUnsignedShort();\n\t\t\tlen = this._byteData.readUnsignedInt();\n\t\t\tend = this._byteData.position + (len - 6);\n\n\t\t\tswitch (cid) {\n\t\t\t\tcase 0xA000: // Material name\n\t\t\t\t\tmat.name = this.readNulTermstring();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0xA010: // Ambient color\n\t\t\t\t\tmat.ambientColor = this.readColor();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0xA020: // Diffuse color\n\t\t\t\t\tmat.diffuseColor = this.readColor();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0xA030: // Specular color\n\t\t\t\t\tmat.specularColor = this.readColor();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0xA081: // Two-sided, existence indicates \"true\"\n\t\t\t\t\tmat.twoSided = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0xA200: // Main (color) texture\n\t\t\t\t\tmat.colorMap = this.parseTexture(end);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0xA204: // Specular map\n\t\t\t\t\tmat.specularMap = this.parseTexture(end);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis._byteData.position = end;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn mat;\n\t}\n\n\tprivate parseTexture(end:number /*uint*/):TextureVO\n\t{\n\t\tvar tex:TextureVO;\n\n\t\ttex = new TextureVO();\n\n\t\twhile (this._byteData.position < end) {\n\t\t\tvar cid:number /*uint*/;\n\t\t\tvar len:number /*uint*/;\n\n\t\t\tcid = this._byteData.readUnsignedShort();\n\t\t\tlen = this._byteData.readUnsignedInt();\n\n\t\t\tswitch (cid) {\n\t\t\t\tcase 0xA300:\n\t\t\t\t\ttex.url = this.readNulTermstring();\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\t// Skip this unknown texture sub-chunk\n\t\t\t\t\tthis._byteData.position += (len - 6);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis._textures[tex.url] = tex;\n\t\tthis._pAddDependency(tex.url, new URLRequest(tex.url));\n\n\t\treturn tex;\n\t}\n\n\tprivate parseVertexList():void\n\t{\n\t\tvar i:number /*uint*/;\n\t\tvar len:number /*uint*/;\n\t\tvar count:number /*uint*/;\n\n\t\tcount = this._byteData.readUnsignedShort();\n\t\tthis._cur_obj.verts = new Array<number>(count*3);\n\n\t\ti = 0;\n\t\tlen = this._cur_obj.verts.length;\n\t\twhile (i < len) {\n\t\t\tvar x:number, y:number, z:number;\n\n\t\t\tx = this._byteData.readFloat();\n\t\t\ty = this._byteData.readFloat();\n\t\t\tz = this._byteData.readFloat();\n\n\t\t\tthis._cur_obj.verts[i++] = x;\n\t\t\tthis._cur_obj.verts[i++] = z;\n\t\t\tthis._cur_obj.verts[i++] = y;\n\t\t}\n\t}\n\n\tprivate parseFaceList():void\n\t{\n\t\tvar i:number /*uint*/;\n\t\tvar len:number /*uint*/;\n\t\tvar count:number /*uint*/;\n\n\t\tcount = this._byteData.readUnsignedShort();\n\t\tthis._cur_obj.indices = new Array<number>(count*3) /*uint*/;\n\n\t\ti = 0;\n\t\tlen = this._cur_obj.indices.length;\n\t\twhile (i < len) {\n\t\t\tvar i0:number /*uint*/, i1:number /*uint*/, i2:number /*uint*/;\n\n\t\t\ti0 = this._byteData.readUnsignedShort();\n\t\t\ti1 = this._byteData.readUnsignedShort();\n\t\t\ti2 = this._byteData.readUnsignedShort();\n\n\t\t\tthis._cur_obj.indices[i++] = i0;\n\t\t\tthis._cur_obj.indices[i++] = i2;\n\t\t\tthis._cur_obj.indices[i++] = i1;\n\n\t\t\t// Skip \"face info\", irrelevant in Away3D\n\t\t\tthis._byteData.position += 2;\n\t\t}\n\n\t\tthis._cur_obj.smoothingGroups = new Array<number>(count) /*uint*/;\n\t}\n\n\tprivate parseSmoothingGroups():void\n\t{\n\t\tvar len:number /*uint*/ = this._cur_obj.indices.length/3;\n\t\tvar i:number /*uint*/ = 0;\n\t\twhile (i < len) {\n\t\t\tthis._cur_obj.smoothingGroups[i] = this._byteData.readUnsignedInt();\n\t\t\ti++;\n\t\t}\n\t}\n\n\tprivate parseUVList():void\n\t{\n\t\tvar i:number /*uint*/;\n\t\tvar len:number /*uint*/;\n\t\tvar count:number /*uint*/;\n\n\t\tcount = this._byteData.readUnsignedShort();\n\t\tthis._cur_obj.uvs = new Array<number>(count*2);\n\n\t\ti = 0;\n\t\tlen = this._cur_obj.uvs.length;\n\t\twhile (i < len) {\n\t\t\tthis._cur_obj.uvs[i++] = this._byteData.readFloat();\n\t\t\tthis._cur_obj.uvs[i++] = 1.0 - this._byteData.readFloat();\n\t\t}\n\t}\n\n\tprivate parseFaceMaterialList():void\n\t{\n\t\tvar mat:string;\n\t\tvar count:number /*uint*/;\n\t\tvar i:number /*uint*/;\n\t\tvar faces:Array<number> /*uint*/;\n\n\t\tmat = this.readNulTermstring();\n\t\tcount = this._byteData.readUnsignedShort();\n\n\t\tfaces = new Array<number>(count) /*uint*/;\n\t\ti = 0;\n\t\twhile (i < faces.length)\n\t\t\tfaces[i++] = this._byteData.readUnsignedShort();\n\n\t\tthis._cur_obj.materials.push(mat);\n\t\tthis._cur_obj.materialFaces[mat] = faces;\n\t}\n\n\tprivate parseObjectAnimation(end:number):void\n\t{\n\t\tvar vo:ObjectVO;\n\t\tvar obj:DisplayObjectContainer;\n\t\tvar pivot:Vector3D;\n\t\tvar name:string;\n\t\tvar hier:number /*uint*/;\n\n\t\t// Pivot defaults to origin\n\t\tpivot = new Vector3D;\n\n\t\twhile (this._byteData.position < end) {\n\t\t\tvar cid:number /*uint*/;\n\t\t\tvar len:number /*uint*/;\n\n\t\t\tcid = this._byteData.readUnsignedShort();\n\t\t\tlen = this._byteData.readUnsignedInt();\n\n\t\t\tswitch (cid) {\n\t\t\t\tcase 0xb010: // Name/hierarchy\n\t\t\t\t\tname = this.readNulTermstring();\n\t\t\t\t\tthis._byteData.position += 4;\n\t\t\t\t\thier = this._byteData.readShort();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 0xb013: // Pivot\n\t\t\t\t\tpivot.x = this._byteData.readFloat();\n\t\t\t\t\tpivot.z = this._byteData.readFloat();\n\t\t\t\t\tpivot.y = this._byteData.readFloat();\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis._byteData.position += (len - 6);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// If name is \"$$$DUMMY\" this is an empty object (e.g. a container)\n\t\t// and will be ignored in this version of the parser\n\t\t// TODO: Implement containers in 3DS parser.\n\t\tif (name != '$$$DUMMY' && this._unfinalized_objects.hasOwnProperty(name)) {\n\t\t\tvo = this._unfinalized_objects[name];\n\t\t\tobj = this.constructObject(vo, pivot);\n\n\t\t\tif (obj) {\n\t\t\t\t//add to the content property\n\t\t\t\t(<DisplayObjectContainer> this._pContent).addChild(obj);\n\n\t\t\t\tthis._pFinalizeAsset(obj, vo.name);\n\t\t\t}\n\n\n\t\t\tdelete this._unfinalized_objects[name];\n\t\t}\n\t}\n\n\tprivate constructObject(obj:ObjectVO, pivot:Vector3D = null):DisplayObjectContainer\n\t{\n\t\tif (obj.type == Mesh.assetType) {\n\t\t\tvar i:number /*uint*/;\n\t\t\tvar sub:TriangleSubGeometry;\n\t\t\tvar geom:Geometry;\n\t\t\tvar mat:MaterialBase;\n\t\t\tvar mesh:Mesh;\n\t\t\tvar mtx:Matrix3D;\n\t\t\tvar vertices:Array<VertexVO>;\n\t\t\tvar faces:Array<FaceVO>;\n\n\t\t\tif (obj.materials.length > 1)\n\t\t\t\tconsole.log(\"The Away3D 3DS parser does not support multiple materials per mesh at this point.\");\n\n\t\t\t// Ignore empty objects\n\t\t\tif (!obj.indices || obj.indices.length == 0)\n\t\t\t\treturn null;\n\n\t\t\tvertices = new Array<VertexVO>(obj.verts.length/3);\n\t\t\tfaces = new Array<FaceVO>(obj.indices.length/3);\n\n\t\t\tthis.prepareData(vertices, faces, obj);\n\n\t\t\tif (this._useSmoothingGroups)\n\t\t\t\tthis.applySmoothGroups(vertices, faces);\n\n\t\t\tobj.verts = new Array<number>(vertices.length*3);\n\t\t\tfor (i = 0; i < vertices.length; i++) {\n\t\t\t\tobj.verts[i*3] = vertices[i].x;\n\t\t\t\tobj.verts[i*3 + 1] = vertices[i].y;\n\t\t\t\tobj.verts[i*3 + 2] = vertices[i].z;\n\t\t\t}\n\t\t\tobj.indices = new Array<number>(faces.length*3) /*uint*/;\n\n\t\t\tfor (i = 0; i < faces.length; i++) {\n\t\t\t\tobj.indices[i*3] = faces[i].a;\n\t\t\t\tobj.indices[i*3 + 1] = faces[i].b;\n\t\t\t\tobj.indices[i*3 + 2] = faces[i].c;\n\t\t\t}\n\n\t\t\tif (obj.uvs) {\n\t\t\t\t// If the object had UVs to start with, use UVs generated by\n\t\t\t\t// smoothing group splitting algorithm. Otherwise those UVs\n\t\t\t\t// will be nonsense and should be skipped.\n\t\t\t\tobj.uvs = new Array<number>(vertices.length*2);\n\t\t\t\tfor (i = 0; i < vertices.length; i++) {\n\t\t\t\t\tobj.uvs[i*2] = vertices[i].u;\n\t\t\t\t\tobj.uvs[i*2 + 1] = vertices[i].v;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgeom = new Geometry();\n\n\t\t\t// Construct sub-geometries (potentially splitting buffers)\n\t\t\t// and add them to geometry.\n\t\t\tsub = new TriangleSubGeometry(new AttributesBuffer());\n\t\t\tsub.setIndices(obj.indices);\n\t\t\tsub.setPositions(obj.verts);\n\t\t\tsub.setUVs(obj.uvs);\n\n\t\t\tgeom.addSubGeometry(sub);\n\n\t\t\tif (obj.materials.length > 0) {\n\t\t\t\tvar mname:string;\n\t\t\t\tmname = obj.materials[0];\n\t\t\t\tmat = this._materials[mname].material;\n\t\t\t}\n\n\t\t\t// Apply pivot translation to geometry if a pivot was\n\t\t\t// found while parsing the keyframe chunk earlier.\n\t\t\tif (pivot) {\n\t\t\t\tif (obj.transform) {\n\t\t\t\t\t// If a transform was found while parsing the\n\t\t\t\t\t// object chunk, use it to find the local pivot vector\n\t\t\t\t\tmtx = new Matrix3D(obj.transform);\n\t\t\t\t\tmtx.rawData[12] = 0;\n\t\t\t\t\tmtx.rawData[13] = 0;\n\t\t\t\t\tmtx.rawData[14] = 0;\n\t\t\t\t\tpivot = mtx.transformVector(pivot);\n\t\t\t\t}\n\n\t\t\t\tpivot.scaleBy(-1);\n\n\t\t\t\tmtx = new Matrix3D();\n\t\t\t\tmtx.appendTranslation(pivot.x, pivot.y, pivot.z);\n\t\t\t\tgeom.applyTransformation(mtx);\n\t\t\t}\n\n\t\t\t// Apply transformation to geometry if a transformation\n\t\t\t// was found while parsing the object chunk earlier.\n\t\t\tif (obj.transform) {\n\t\t\t\tmtx = new Matrix3D(obj.transform);\n\t\t\t\tmtx.invert();\n\t\t\t\tgeom.applyTransformation(mtx);\n\t\t\t}\n\n\t\t\t// Final transform applied to geometry. Finalize the geometry,\n\t\t\t// which will no longer be modified after this point.\n\t\t\tthis._pFinalizeAsset(geom, obj.name.concat('_geom'));\n\n\t\t\t// Build mesh and return it\n\t\t\tmesh = new Mesh(geom, mat);\n\t\t\tmesh.transform.matrix3D = new Matrix3D(obj.transform);\n\t\t\treturn mesh;\n\t\t}\n\n\t\t// If reached, unknown\n\t\treturn null;\n\t}\n\n\tprivate prepareData(vertices:Array<VertexVO>, faces:Array<FaceVO>, obj:ObjectVO):void\n\t{\n\t\t// convert raw ObjectVO's data to structured VertexVO and FaceVO\n\t\tvar i:number /*int*/;\n\t\tvar j:number /*int*/;\n\t\tvar k:number /*int*/;\n\t\tvar len:number /*int*/ = obj.verts.length;\n\t\tfor (i = 0, j = 0, k = 0; i < len;) {\n\t\t\tvar v:VertexVO = new VertexVO;\n\t\t\tv.x = obj.verts[i++];\n\t\t\tv.y = obj.verts[i++];\n\t\t\tv.z = obj.verts[i++];\n\t\t\tif (obj.uvs) {\n\t\t\t\tv.u = obj.uvs[j++];\n\t\t\t\tv.v = obj.uvs[j++];\n\t\t\t}\n\t\t\tvertices[k++] = v;\n\t\t}\n\t\tlen = obj.indices.length;\n\t\tfor (i = 0, k = 0; i < len;) {\n\t\t\tvar f:FaceVO = new FaceVO();\n\t\t\tf.a = obj.indices[i++];\n\t\t\tf.b = obj.indices[i++];\n\t\t\tf.c = obj.indices[i++];\n\t\t\tf.smoothGroup = obj.smoothingGroups[k] || 0;\n\t\t\tfaces[k++] = f;\n\t\t}\n\t}\n\n\tprivate applySmoothGroups(vertices:Array<VertexVO>, faces:Array<FaceVO>):void\n\t{\n\t\t// clone vertices according to following rule:\n\t\t// clone if vertex's in faces from groups 1+2 and 3\n\t\t// don't clone if vertex's in faces from groups 1+2, 3 and 1+3\n\n\t\tvar i:number /*int*/;\n\t\tvar j:number /*int*/;\n\t\tvar k:number /*int*/;\n\t\tvar l:number /*int*/;\n\t\tvar len:number /*int*/;\n\t\tvar numVerts:number /*uint*/ = vertices.length;\n\t\tvar numFaces:number /*uint*/ = faces.length;\n\n\t\t// extract groups data for vertices\n\t\tvar vGroups:Array<Array<number>> /*uint*/ = new Array<Array<number>>(numVerts) /*uint*/;\n\t\tfor (i = 0; i < numVerts; i++)\n\t\t\tvGroups[i] = new Array<number>() /*uint*/;\n\t\tfor (i = 0; i < numFaces; i++) {\n\t\t\tvar face:FaceVO = faces[i];\n\t\t\tfor (j = 0; j < 3; j++) {\n\t\t\t\tvar groups:Array<number> /*uint*/ = vGroups[(j == 0)? face.a : ((j == 1)? face.b : face.c)];\n\t\t\t\tvar group:number /*uint*/ = face.smoothGroup;\n\t\t\t\tfor (k = groups.length - 1; k >= 0; k--) {\n\t\t\t\t\tif ((group & groups[k]) > 0) {\n\t\t\t\t\t\tgroup |= groups[k];\n\t\t\t\t\t\tgroups.splice(k, 1);\n\t\t\t\t\t\tk = groups.length - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgroups.push(group);\n\t\t\t}\n\t\t}\n\t\t// clone vertices\n\t\tvar vClones:Array<Array<number>> /*uint*/ = new Array<Array<number>>(numVerts) /*uint*/;\n\t\tfor (i = 0; i < numVerts; i++) {\n\t\t\tif ((len = vGroups[i].length) < 1)\n\t\t\t\tcontinue;\n\t\t\tvar clones:Array<number> /*uint*/ = new Array<number>(len) /*uint*/;\n\t\t\tvClones[i] = clones;\n\t\t\tclones[0] = i;\n\t\t\tvar v0:VertexVO = vertices[i];\n\t\t\tfor (j = 1; j < len; j++) {\n\t\t\t\tvar v1:VertexVO = new VertexVO;\n\t\t\t\tv1.x = v0.x;\n\t\t\t\tv1.y = v0.y;\n\t\t\t\tv1.z = v0.z;\n\t\t\t\tv1.u = v0.u;\n\t\t\t\tv1.v = v0.v;\n\t\t\t\tclones[j] = vertices.length;\n\t\t\t\tvertices.push(v1);\n\t\t\t}\n\t\t}\n\t\tnumVerts = vertices.length;\n\n\t\tfor (i = 0; i < numFaces; i++) {\n\t\t\tface = faces[i];\n\t\t\tgroup = face.smoothGroup;\n\t\t\tfor (j = 0; j < 3; j++) {\n\t\t\t\tk = (j == 0)? face.a : ((j == 1)? face.b : face.c);\n\t\t\t\tgroups = vGroups[k];\n\t\t\t\tlen = groups.length;\n\t\t\t\tclones = vClones[k];\n\t\t\t\tfor (l = 0; l < len; l++) {\n\t\t\t\t\tif (((group == 0) && (groups[l] == 0)) || ((group & groups[l]) > 0)) {\n\t\t\t\t\t\tvar index:number /*uint*/ = clones[l];\n\t\t\t\t\t\tif (group == 0) {\n\t\t\t\t\t\t\t// vertex is unique if no smoothGroup found\n\t\t\t\t\t\t\tgroups.splice(l, 1);\n\t\t\t\t\t\t\tclones.splice(l, 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j == 0)\n\t\t\t\t\t\t\tface.a = index; else if (j == 1)\n\t\t\t\t\t\t\tface.b = index; else\n\t\t\t\t\t\t\tface.c = index;\n\t\t\t\t\t\tl = len;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate finalizeCurrentMaterial():void\n\t{\n\t\tvar mat:MethodMaterial;\n\n\t\tmat = new MethodMaterial(this._cur_mat.ambientColor);\n\n\t\tif (this._cur_mat.colorMap)\n\t\t\tmat.ambientMethod.texture = this._cur_mat.colorMap.texture || DefaultMaterialManager.getDefaultTexture();\n\n\t\tmat.diffuseMethod.color = this._cur_mat.diffuseColor;\n\t\tmat.specularMethod.color = this._cur_mat.specularColor;\n\n\t\tif (this.materialMode >= 2)\n\t\t\tmat.mode = MethodMaterialMode.MULTI_PASS;\n\n\t\tmat.bothSides = this._cur_mat.twoSided;\n\n\t\tthis._pFinalizeAsset(mat, this._cur_mat.name);\n\n\t\tthis._materials[this._cur_mat.name] = this._cur_mat;\n\t\tthis._cur_mat.material = mat;\n\n\t\tthis._cur_mat = null;\n\t}\n\n\tprivate readNulTermstring():string\n\t{\n\t\tvar chr:number /*int*/;\n\t\tvar str:string = \"\";\n\n\t\twhile ((chr = this._byteData.readUnsignedByte()) > 0)\n\t\t\tstr += String.fromCharCode(chr);\n\n\t\treturn str;\n\t}\n\n\tprivate readTransform():Float32Array\n\t{\n\t\tvar data:Float32Array = new Float32Array(16);\n\n\t\t// X axis\n\t\tdata[0] = this._byteData.readFloat(); // X\n\t\tdata[2] = this._byteData.readFloat(); // Z\n\t\tdata[1] = this._byteData.readFloat(); // Y\n\t\tdata[3] = 0;\n\n\t\t// Z axis\n\t\tdata[8] = this._byteData.readFloat(); // X\n\t\tdata[10] = this._byteData.readFloat(); // Z\n\t\tdata[9] = this._byteData.readFloat(); // Y\n\t\tdata[11] = 0;\n\n\t\t// Y Axis\n\t\tdata[4] = this._byteData.readFloat(); // X\n\t\tdata[6] = this._byteData.readFloat(); // Z\n\t\tdata[5] = this._byteData.readFloat(); // Y\n\t\tdata[7] = 0;\n\n\t\t// Translation\n\t\tdata[12] = this._byteData.readFloat(); // X\n\t\tdata[14] = this._byteData.readFloat(); // Z\n\t\tdata[13] = this._byteData.readFloat(); // Y\n\t\tdata[15] = 1;\n\n\t\treturn data;\n\t}\n\n\tprivate readColor():number /*int*/\n\t{\n\t\tvar cid:number /*int*/;\n\t\tvar len:number /*int*/;\n\t\tvar r:number /*int*/, g:number /*int*/, b:number /*int*/;\n\n\t\tcid = this._byteData.readUnsignedShort();\n\t\tlen = this._byteData.readUnsignedInt();\n\n\t\tswitch (cid) {\n\t\t\tcase 0x0010: // Floats\n\t\t\t\tr = this._byteData.readFloat()*255;\n\t\t\t\tg = this._byteData.readFloat()*255;\n\t\t\t\tb = this._byteData.readFloat()*255;\n\t\t\t\tbreak;\n\t\t\tcase 0x0011: // 24-bit color\n\t\t\t\tr = this._byteData.readUnsignedByte();\n\t\t\t\tg = this._byteData.readUnsignedByte();\n\t\t\t\tb = this._byteData.readUnsignedByte();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis._byteData.position += (len - 6);\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn (r << 16) | (g << 8) | b;\n\t}\n}\n\nexport = Max3DSParser;\n\n/**\n *\n */\nclass FaceVO\n{\n\tpublic a:number /*int*/;\n\tpublic b:number /*int*/;\n\tpublic c:number /*int*/;\n\tpublic smoothGroup:number /*int*/;\n}\n\n/**\n *\n */\nclass MaterialVO\n{\n\tpublic name:string;\n\tpublic ambientColor:number /*int*/;\n\tpublic diffuseColor:number /*int*/;\n\tpublic specularColor:number /*int*/;\n\tpublic twoSided:boolean;\n\tpublic colorMap:TextureVO;\n\tpublic specularMap:TextureVO;\n\tpublic material:MaterialBase;\n}\n\n/**\n *\n */\nclass ObjectVO\n{\n\tpublic name:string;\n\tpublic type:string;\n\tpublic pivotX:number;\n\tpublic pivotY:number;\n\tpublic pivotZ:number;\n\tpublic transform:Float32Array;\n\tpublic verts:Array<number>;\n\tpublic indices:Array<number> /*int*/;\n\tpublic uvs:Array<number>;\n\tpublic materialFaces:Object;\n\tpublic materials:Array<string>;\n\tpublic smoothingGroups:Array<number> /*int*/;\n}\n\n/**\n *\n */\nclass TextureVO\n{\n\tpublic url:string;\n\tpublic texture:Single2DTexture;\n}\n\n/**\n *\n */\nclass VertexVO\n{\n\tpublic x:number;\n\tpublic y:number;\n\tpublic z:number;\n\tpublic u:number;\n\tpublic v:number;\n\tpublic normal:Vector3D;\n\tpublic tangent:Vector3D;\n}",
    "import Sampler2D\t\t\t\t\t= require(\"awayjs-core/lib/image/Sampler2D\");\nimport AttributesBuffer\t\t\t\t\t= require(\"awayjs-core/lib/attributes/AttributesBuffer\");\nimport BitmapImage2D\t\t\t\t\t= require(\"awayjs-core/lib/image/BitmapImage2D\");\nimport Matrix3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Matrix3D\");\nimport Quaternion\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Quaternion\");\nimport Vector3D\t\t\t\t\t\t\t= require(\"awayjs-core/lib/geom/Vector3D\");\nimport IAsset\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/IAsset\");\nimport URLLoaderDataFormat\t\t\t\t= require(\"awayjs-core/lib/net/URLLoaderDataFormat\");\nimport URLRequest\t\t\t\t\t\t= require(\"awayjs-core/lib/net/URLRequest\");\nimport ParserBase\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserBase\");\nimport ParserUtils\t\t\t\t\t\t= require(\"awayjs-core/lib/parsers/ParserUtils\");\nimport ResourceDependency\t\t\t\t= require(\"awayjs-core/lib/parsers/ResourceDependency\");\n\nimport TriangleSubGeometry\t\t\t\t= require(\"awayjs-display/lib/base/TriangleSubGeometry\");\nimport Geometry\t\t\t\t\t\t\t= require(\"awayjs-display/lib/base/Geometry\");\nimport DisplayObjectContainer\t\t\t= require(\"awayjs-display/lib/containers/DisplayObjectContainer\");\nimport Mesh\t\t\t\t\t\t\t\t= require(\"awayjs-display/lib/entities/Mesh\");\nimport DefaultMaterialManager\t\t\t= require(\"awayjs-display/lib/managers/DefaultMaterialManager\");\nimport MaterialBase\t\t\t\t\t\t= require(\"awayjs-display/lib/materials/MaterialBase\");\nimport Single2DTexture\t\t\t\t\t= require(\"awayjs-display/lib/textures/Single2DTexture\");\n\nimport MethodMaterial\t\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterial\");\nimport MethodMaterialMode\t\t\t\t= require(\"awayjs-methodmaterials/lib/MethodMaterialMode\");\nimport SpecularBasicMethod\t\t\t\t= require(\"awayjs-methodmaterials/lib/methods/SpecularBasicMethod\");\n\n/**\n * OBJParser provides a parser for the OBJ data type.\n */\nclass OBJParser extends ParserBase\n{\n\tprivate _textData:string;\n\tprivate _startedParsing:boolean;\n\tprivate _charIndex:number;\n\tprivate _oldIndex:number;\n\tprivate _stringLength:number;\n\tprivate _currentObject:ObjectGroup;\n\tprivate _currentGroup:Group;\n\tprivate _currentMaterialGroup:MaterialGroup;\n\tprivate _objects:Array<ObjectGroup>;\n\tprivate _materialIDs:string[];\n\tprivate _materialLoaded:Array<LoadedMaterial>;\n\tprivate _materialSpecularData:Array<SpecularData>;\n\tprivate _meshes:Array<Mesh>;\n\tprivate _lastMtlID:string;\n\tprivate _objectIndex:number;\n\tprivate _realIndices;\n\tprivate _vertexIndex:number;\n\tprivate _vertices:Array<Vertex>;\n\tprivate _vertexNormals:Array<Vertex>;\n\tprivate _uvs:Array<UV>;\n\tprivate _scale:number;\n\tprivate _mtlLib:boolean;\n\tprivate _mtlLibLoaded:boolean = true;\n\tprivate _activeMaterialID:string = \"\";\n\n\t/**\n\t * Creates a new OBJParser object.\n\t * @param uri The url or id of the data or file to be parsed.\n\t * @param extra The holder for extra contextual data that the parser might need.\n\t */\n\tconstructor(scale:number = 1)\n\t{\n\t\tsuper(URLLoaderDataFormat.TEXT);\n\t\tthis._scale = scale;\n\t}\n\n\t/**\n\t * Scaling factor applied directly to vertices data\n\t * @param value The scaling factor.\n\t */\n\tpublic set scale(value:number)\n\t{\n\t\tthis._scale = value;\n\t}\n\n\t/**\n\t * Indicates whether or not a given file extension is supported by the parser.\n\t * @param extension The file extension of a potential file to be parsed.\n\t * @return Whether or not the given file type is supported.\n\t */\n\tpublic static supportsType(extension:string):boolean\n\t{\n\t\textension = extension.toLowerCase();\n\t\treturn extension == \"obj\";\n\t}\n\n\t/**\n\t * Tests whether a data block can be parsed by the parser.\n\t * @param data The data block to potentially be parsed.\n\t * @return Whether or not the given data is supported.\n\t */\n\tpublic static supportsData(data:any):boolean\n\t{\n\t\tvar content:string = ParserUtils.toString(data);\n\t\tvar hasV:boolean = false;\n\t\tvar hasF:boolean = false;\n\n\t\tif (content) {\n\t\t\thasV = content.indexOf(\"\\nv \") != -1;\n\t\t\thasF = content.indexOf(\"\\nf \") != -1;\n\t\t}\n\n\t\treturn hasV && hasF;\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iResolveDependency(resourceDependency:ResourceDependency)\n\t{\n\t\tif (resourceDependency.id == 'mtl') {\n\t\t\tvar str:string = ParserUtils.toString(resourceDependency.data);\n\t\t\tthis.parseMtl(str);\n\n\t\t} else {\n\t\t\tvar asset:IAsset;\n\n\t\t\tif (resourceDependency.assets.length != 1) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tasset = resourceDependency.assets[0];\n\n\t\t\tif (asset.isAsset(BitmapImage2D)) {\n\n\t\t\t\tvar lm:LoadedMaterial = new LoadedMaterial();\n\t\t\t\tlm.materialID = resourceDependency.id;\n\t\t\t\tlm.texture = new Single2DTexture(<BitmapImage2D> asset);\n\n\t\t\t\tthis._materialLoaded.push(lm);\n\n\t\t\t\tif (this._meshes.length > 0) {\n\t\t\t\t\tthis.applyMaterial(lm);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _iResolveDependencyFailure(resourceDependency:ResourceDependency)\n\t{\n\t\tif (resourceDependency.id == \"mtl\") {\n\t\t\tthis._mtlLib = false;\n\t\t\tthis._mtlLibLoaded = false;\n\t\t} else {\n\t\t\tvar lm:LoadedMaterial = new LoadedMaterial();\n\t\t\tlm.materialID = resourceDependency.id;\n\t\t\tthis._materialLoaded.push(lm);\n\t\t}\n\n\t\tif (this._meshes.length > 0)\n\t\t\tthis.applyMaterial(lm);\n\t}\n\n\t/**\n\t * @inheritDoc\n\t */\n\tpublic _pProceedParsing():boolean\n\t{\n\t\tvar line:string;\n\t\tvar creturn:string = String.fromCharCode(10);\n\t\tvar trunk;\n\n\t\tif (!this._startedParsing) {\n\t\t\tthis._textData = this._pGetTextData();\n\t\t\t// Merge linebreaks that are immediately preceeded by\n\t\t\t// the \"escape\" backward slash into single lines.\n\t\t\tthis._textData = this._textData.replace(/\\\\[\\r\\n]+\\s*/gm, ' ');\n\t\t}\n\n\t\tif (this._textData.indexOf(creturn) == -1)\n\t\t\tcreturn = String.fromCharCode(13);\n\n\t\tif (!this._startedParsing) {\n\t\t\tthis._startedParsing = true;\n\t\t\tthis._vertices = new Array<Vertex>();\n\t\t\tthis._vertexNormals = new Array<Vertex>();\n\t\t\tthis._materialIDs = new Array<string>();\n\t\t\tthis._materialLoaded = new Array<LoadedMaterial>();\n\t\t\tthis._meshes = new Array<Mesh>();\n\t\t\tthis._uvs = new Array<UV>();\n\t\t\tthis._stringLength = this._textData.length;\n\t\t\tthis._charIndex = this._textData.indexOf(creturn, 0);\n\t\t\tthis._oldIndex = 0;\n\t\t\tthis._objects = new Array<ObjectGroup>();\n\t\t\tthis._objectIndex = 0;\n\t\t}\n\n\t\twhile (this._charIndex < this._stringLength && this._pHasTime()) {\n\t\t\tthis._charIndex = this._textData.indexOf(creturn, this._oldIndex);\n\n\t\t\tif (this._charIndex == -1)\n\t\t\t\tthis._charIndex = this._stringLength;\n\n\t\t\tline = this._textData.substring(this._oldIndex, this._charIndex);\n\t\t\tline = line.split('\\r').join(\"\");\n\t\t\tline = line.replace(\"  \", \" \");\n\t\t\ttrunk = line.split(\" \");\n\t\t\tthis._oldIndex = this._charIndex + 1;\n\t\t\tthis.parseLine(trunk);\n\n\t\t\t// If whatever was parsed on this line resulted in the\n\t\t\t// parsing being paused to retrieve dependencies, break\n\t\t\t// here and do not continue parsing until un-paused.\n\t\t\tif (this.parsingPaused) {\n\t\t\t\treturn ParserBase.MORE_TO_PARSE;\n\t\t\t}\n\n\t\t}\n\n\t\tif (this._charIndex >= this._stringLength) {\n\n\t\t\tif (this._mtlLib && !this._mtlLibLoaded) {\n\t\t\t\treturn ParserBase.MORE_TO_PARSE;\n\t\t\t}\n\n\t\t\tthis.translate();\n\t\t\tthis.applyMaterials();\n\n\t\t\treturn ParserBase.PARSING_DONE;\n\t\t}\n\n\t\treturn ParserBase.MORE_TO_PARSE;\n\t}\n\n\tpublic _pStartParsing(frameLimit:number)\n\t{\n\t\t//create a content object for Loaders\n\t\tthis._pContent = new DisplayObjectContainer();\n\n\t\tsuper._pStartParsing(frameLimit);\n\t}\n\n\t/**\n\t * Parses a single line in the OBJ file.\n\t */\n\tprivate parseLine(trunk)\n\t{\n\t\tswitch (trunk[0]) {\n\n\t\t\tcase \"mtllib\":\n\n\t\t\t\tthis._mtlLib = true;\n\t\t\t\tthis._mtlLibLoaded = false;\n\t\t\t\tthis.loadMtl(trunk[1]);\n\n\t\t\t\tbreak;\n\n\t\t\tcase \"g\":\n\n\t\t\t\tthis.createGroup(trunk);\n\n\t\t\t\tbreak;\n\n\t\t\tcase \"o\":\n\n\t\t\t\tthis.createObject(trunk);\n\n\t\t\t\tbreak;\n\n\t\t\tcase \"usemtl\":\n\n\t\t\t\tif (this._mtlLib) {\n\n\t\t\t\t\tif (!trunk[1])\n\t\t\t\t\t\ttrunk[1] = \"def000\";\n\n\t\t\t\t\tthis._materialIDs.push(trunk[1]);\n\t\t\t\t\tthis._activeMaterialID = trunk[1];\n\n\t\t\t\t\tif (this._currentGroup)\n\t\t\t\t\t\tthis._currentGroup.materialID = this._activeMaterialID;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tcase \"v\":\n\n\t\t\t\tthis.parseVertex(trunk);\n\n\t\t\t\tbreak;\n\n\t\t\tcase \"vt\":\n\n\t\t\t\tthis.parseUV(trunk);\n\n\t\t\t\tbreak;\n\n\t\t\tcase \"vn\":\n\n\t\t\t\tthis.parseVertexNormal(trunk);\n\n\t\t\t\tbreak;\n\n\t\t\tcase \"f\":\n\n\t\t\t\tthis.parseFace(trunk);\n\n\t\t}\n\t}\n\n\t/**\n\t * Converts the parsed data into an Away3D scenegraph structure\n\t */\n\tprivate translate()\n\t{\n\t\tfor (var objIndex:number = 0; objIndex < this._objects.length; ++objIndex) {\n\t\t\tvar groups:Array<Group> = this._objects[objIndex].groups;\n\t\t\tvar numGroups:number = groups.length;\n\t\t\tvar materialGroups:Array<MaterialGroup>;\n\t\t\tvar numMaterialGroups:number;\n\t\t\tvar geometry:Geometry;\n\t\t\tvar mesh:Mesh;\n\n\t\t\tvar m:number;\n\t\t\tvar sm:number;\n\t\t\tvar bmMaterial:MethodMaterial;\n\n\t\t\tfor (var g:number = 0; g < numGroups; ++g) {\n\t\t\t\tgeometry = new Geometry();\n\t\t\t\tmaterialGroups = groups[g].materialGroups;\n\t\t\t\tnumMaterialGroups = materialGroups.length;\n\n\t\t\t\tfor (m = 0; m < numMaterialGroups; ++m)\n\t\t\t\t\tthis.translateMaterialGroup(materialGroups[m], geometry);\n\n\t\t\t\tif (geometry.subGeometries.length == 0)\n\t\t\t\t\tcontinue;\n\n\t\t\t\t// Finalize and force type-based name\n\t\t\t\tthis._pFinalizeAsset(<IAsset> geometry);//, \"\");\n\n\t\t\t\tbmMaterial = new MethodMaterial(DefaultMaterialManager.getDefaultImage2D());\n\n\t\t\t\t//check for multipass\n\t\t\t\tif (this.materialMode >= 2)\n\t\t\t\t\tbmMaterial.mode = MethodMaterialMode.MULTI_PASS;\n\n\t\t\t\tmesh = new Mesh(geometry, bmMaterial);\n\n\t\t\t\tif (this._objects[objIndex].name) {\n\t\t\t\t\t// this is a full independent object ('o' tag in OBJ file)\n\t\t\t\t\tmesh.name = this._objects[objIndex].name;\n\n\t\t\t\t} else if (groups[g].name) {\n\n\t\t\t\t\t// this is a group so the sub groups contain the actual mesh object names ('g' tag in OBJ file)\n\t\t\t\t\tmesh.name = groups[g].name;\n\n\t\t\t\t} else {\n\t\t\t\t\t// No name stored. Use empty string which will force it\n\t\t\t\t\t// to be overridden by finalizeAsset() to type default.\n\t\t\t\t\tmesh.name = \"\";\n\t\t\t\t}\n\n\t\t\t\tthis._meshes.push(mesh);\n\n\t\t\t\tif (groups[g].materialID != \"\")\n\t\t\t\t\tbmMaterial.name = groups[g].materialID + \"~\" + mesh.name; else\n\t\t\t\t\tbmMaterial.name = this._lastMtlID + \"~\" + mesh.name;\n\n\t\t\t\tif (mesh.subMeshes.length > 1) {\n\t\t\t\t\tfor (sm = 1; sm < mesh.subMeshes.length; ++sm)\n\t\t\t\t\t\tmesh.subMeshes[sm].material = bmMaterial;\n\t\t\t\t}\n\n\t\t\t\t//add to the content property\n\t\t\t\t(<DisplayObjectContainer> this._pContent).addChild(mesh);\n\n\t\t\t\tthis._pFinalizeAsset(<IAsset> mesh);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Translates an obj's material group to a subgeometry.\n\t * @param materialGroup The material group data to convert.\n\t * @param geometry The Geometry to contain the converted SubGeometry.\n\t */\n\tprivate translateMaterialGroup(materialGroup:MaterialGroup, geometry:Geometry)\n\t{\n\t\tvar faces:Array<FaceData> = materialGroup.faces;\n\t\tvar face:FaceData;\n\t\tvar numFaces:number = faces.length;\n\t\tvar numVerts:number;\n\t\tvar sub:TriangleSubGeometry;\n\n\t\tvar vertices:Array<number> = new Array<number>();\n\t\tvar uvs:Array<number> = new Array<number>();\n\t\tvar normals:Array<number> = new Array<number>();\n\t\tvar indices:Array<number> /*uint*/ = new Array<number>();\n\n\t\tthis._realIndices = [];\n\t\tthis._vertexIndex = 0;\n\n\t\tvar j:number;\n\t\tfor (var i:number = 0; i < numFaces; ++i) {\n\n\t\t\tface = faces[i];\n\t\t\tnumVerts = face.indexIds.length - 1;\n\n\t\t\tfor (j = 1; j < numVerts; ++j) {\n\n\t\t\t\tthis.translateVertexData(face, j, vertices, uvs, indices, normals);\n\t\t\t\tthis.translateVertexData(face, 0, vertices, uvs, indices, normals);\n\t\t\t\tthis.translateVertexData(face, j + 1, vertices, uvs, indices, normals);\n\t\t\t}\n\t\t}\n\t\tif (vertices.length > 0) {\n\t\t\tsub = new TriangleSubGeometry(new AttributesBuffer());\n\t\t\tsub.autoDeriveNormals = normals.length? false : true;\n\t\t\tsub.setIndices(indices);\n\t\t\tsub.setPositions(vertices);\n\t\t\tsub.setNormals(normals);\n\t\t\tsub.setUVs(uvs);\n\n\t\t\tgeometry.addSubGeometry(sub);\n\t\t}\n\t}\n\n\tprivate translateVertexData(face:FaceData, vertexIndex:number, vertices:Array<number>, uvs:Array<number>, indices:Array<number> /*uint*/, normals:Array<number>)\n\t{\n\t\tvar index:number;\n\t\tvar vertex:Vertex;\n\t\tvar vertexNormal:Vertex;\n\t\tvar uv:UV;\n\n\t\tif (!this._realIndices[face.indexIds[vertexIndex]]) {\n\n\t\t\tindex = this._vertexIndex;\n\t\t\tthis._realIndices[face.indexIds[vertexIndex]] = ++this._vertexIndex;\n\t\t\tvertex = this._vertices[face.vertexIndices[vertexIndex] - 1];\n\t\t\tvertices.push(vertex.x*this._scale, vertex.y*this._scale, vertex.z*this._scale);\n\n\t\t\tif (face.normalIndices.length > 0) {\n\t\t\t\tvertexNormal = this._vertexNormals[face.normalIndices[vertexIndex] - 1];\n\t\t\t\tnormals.push(vertexNormal.x, vertexNormal.y, vertexNormal.z);\n\t\t\t}\n\n\t\t\tif (face.uvIndices.length > 0) {\n\n\t\t\t\ttry {\n\t\t\t\t\tuv = this._uvs[face.uvIndices[vertexIndex] - 1];\n\t\t\t\t\tuvs.push(uv.u, uv.v);\n\n\t\t\t\t} catch (e) {\n\n\t\t\t\t\tswitch (vertexIndex) {\n\t\t\t\t\t\tcase 0:\n\t\t\t\t\t\t\tuvs.push(0, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\tuvs.push(.5, 0);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\tuvs.push(1, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\t\t\tindex = this._realIndices[face.indexIds[vertexIndex]] - 1;\n\t\t}\n\n\t\tindices.push(index);\n\t}\n\n\t/**\n\t * Creates a new object group.\n\t * @param trunk The data block containing the object tag and its parameters\n\t */\n\tprivate createObject(trunk)\n\t{\n\t\tthis._currentGroup = null;\n\t\tthis._currentMaterialGroup = null;\n\t\tthis._objects.push(this._currentObject = new ObjectGroup());\n\n\t\tif (trunk)\n\t\t\tthis._currentObject.name = trunk[1];\n\t}\n\n\t/**\n\t * Creates a new group.\n\t * @param trunk The data block containing the group tag and its parameters\n\t */\n\tprivate createGroup(trunk)\n\t{\n\t\tif (!this._currentObject)\n\t\t\tthis.createObject(null);\n\t\tthis._currentGroup = new Group();\n\n\t\tthis._currentGroup.materialID = this._activeMaterialID;\n\n\t\tif (trunk)\n\t\t\tthis._currentGroup.name = trunk[1];\n\t\tthis._currentObject.groups.push(this._currentGroup);\n\n\t\tthis.createMaterialGroup(null);\n\t}\n\n\t/**\n\t * Creates a new material group.\n\t * @param trunk The data block containing the material tag and its parameters\n\t */\n\tprivate createMaterialGroup(trunk)\n\t{\n\t\tthis._currentMaterialGroup = new MaterialGroup();\n\t\tif (trunk)\n\t\t\tthis._currentMaterialGroup.url = trunk[1];\n\t\tthis._currentGroup.materialGroups.push(this._currentMaterialGroup);\n\t}\n\n\t/**\n\t * Reads the next vertex coordinates.\n\t * @param trunk The data block containing the vertex tag and its parameters\n\t */\n\tprivate parseVertex(trunk)\n\t{\n\t\t//for the very rare cases of other delimiters/charcodes seen in some obj files\n\n\t\tvar v1:number, v2:number , v3:number;\n\t\tif (trunk.length > 4) {\n\t\t\tvar nTrunk = [];\n\t\t\tvar val:number;\n\n\t\t\tfor (var i:number = 1; i < trunk.length; ++i) {\n\t\t\t\tval = parseFloat(trunk[i]);\n\t\t\t\tif (!isNaN(val))\n\t\t\t\t\tnTrunk.push(val);\n\t\t\t}\n\n\t\t\tv1 = <number> nTrunk[0];\n\t\t\tv2 = <number> nTrunk[1];\n\t\t\tv3 = <number> -nTrunk[2];\n\t\t\tthis._vertices.push(new Vertex(v1, v2, v3));\n\n\t\t} else {\n\t\t\tv1 = <number> parseFloat(trunk[1]);\n\t\t\tv2 = <number> parseFloat(trunk[2]);\n\t\t\tv3 = <number> -parseFloat(trunk[3]);\n\n\t\t\tthis._vertices.push(new Vertex(v1, v2, v3));\n\t\t}\n\n\t}\n\n\t/**\n\t * Reads the next uv coordinates.\n\t * @param trunk The data block containing the uv tag and its parameters\n\t */\n\tprivate parseUV(trunk)\n\t{\n\t\tif (trunk.length > 3) {\n\t\t\tvar nTrunk = [];\n\t\t\tvar val:number;\n\t\t\tfor (var i:number = 1; i < trunk.length; ++i) {\n\t\t\t\tval = parseFloat(trunk[i]);\n\t\t\t\tif (!isNaN(val))\n\t\t\t\t\tnTrunk.push(val);\n\t\t\t}\n\t\t\tthis._uvs.push(new UV(nTrunk[0], 1 - nTrunk[1]));\n\n\t\t} else {\n\t\t\tthis._uvs.push(new UV(parseFloat(trunk[1]), 1 - parseFloat(trunk[2])));\n\t\t}\n\n\t}\n\n\t/**\n\t * Reads the next vertex normal coordinates.\n\t * @param trunk The data block containing the vertex normal tag and its parameters\n\t */\n\tprivate parseVertexNormal(trunk)\n\t{\n\t\tif (trunk.length > 4) {\n\t\t\tvar nTrunk = [];\n\t\t\tvar val:number;\n\t\t\tfor (var i:number = 1; i < trunk.length; ++i) {\n\t\t\t\tval = parseFloat(trunk[i]);\n\t\t\t\tif (!isNaN(val))\n\t\t\t\t\tnTrunk.push(val);\n\t\t\t}\n\t\t\tthis._vertexNormals.push(new Vertex(nTrunk[0], nTrunk[1], -nTrunk[2]));\n\n\t\t} else {\n\t\t\tthis._vertexNormals.push(new Vertex(parseFloat(trunk[1]), parseFloat(trunk[2]), -parseFloat(trunk[3])));\n\t\t}\n\t}\n\n\t/**\n\t * Reads the next face's indices.\n\t * @param trunk The data block containing the face tag and its parameters\n\t */\n\tprivate parseFace(trunk)\n\t{\n\t\tvar len:number = trunk.length;\n\t\tvar face:FaceData = new FaceData();\n\n\t\tif (!this._currentGroup) {\n\t\t\tthis.createGroup(null);\n\t\t}\n\n\t\tvar indices;\n\t\tfor (var i:number = 1; i < len; ++i) {\n\n\t\t\tif (trunk[i] == \"\") {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tindices = trunk[i].split(\"/\");\n\t\t\tface.vertexIndices.push(this.parseIndex(parseInt(indices[0]), this._vertices.length));\n\n\t\t\tif (indices[1] && String(indices[1]).length > 0)\n\t\t\t\tface.uvIndices.push(this.parseIndex(parseInt(indices[1]), this._uvs.length));\n\n\t\t\tif (indices[2] && String(indices[2]).length > 0)\n\t\t\t\tface.normalIndices.push(this.parseIndex(parseInt(indices[2]), this._vertexNormals.length));\n\n\t\t\tface.indexIds.push(trunk[i]);\n\t\t}\n\n\t\tthis._currentMaterialGroup.faces.push(face);\n\t}\n\n\t/**\n\t * This is a hack around negative face coords\n\t */\n\tprivate parseIndex(index:number, length:number):number\n\t{\n\t\tif (index < 0)\n\t\t\treturn index + length + 1; else\n\t\t\treturn index;\n\t}\n\n\tprivate parseMtl(data:string)\n\t{\n\t\tvar materialDefinitions = data.split('newmtl');\n\t\tvar lines;\n\t\tvar trunk;\n\t\tvar j:number;\n\n\t\tvar basicSpecularMethod:SpecularBasicMethod;\n\t\tvar useSpecular:boolean;\n\t\tvar useColor:boolean;\n\t\tvar diffuseColor:number;\n\t\tvar color:number;\n\t\tvar specularColor:number;\n\t\tvar specular:number;\n\t\tvar alpha:number;\n\t\tvar mapkd:string;\n\n\t\tfor (var i:number = 0; i < materialDefinitions.length; ++i) {\n\n\n\t\t\tlines = (materialDefinitions[i].split('\\r')).join(\"\").split('\\n');\n\t\t\t//lines = (materialDefinitions[i].split('\\r') as Array).join(\"\").split('\\n');\n\n\t\t\tif (lines.length == 1)\n\t\t\t\tlines = materialDefinitions[i].split(String.fromCharCode(13));\n\n\t\t\tdiffuseColor = color = specularColor = 0xFFFFFF;\n\t\t\tspecular = 0;\n\t\t\tuseSpecular = false;\n\t\t\tuseColor = false;\n\t\t\talpha = 1;\n\t\t\tmapkd = \"\";\n\n\t\t\tfor (j = 0; j < lines.length; ++j) {\n\n\t\t\t\tlines[j] = lines[j].replace(/\\s+$/, \"\");\n\n\t\t\t\tif (lines[j].substring(0, 1) != \"#\" && (j == 0 || lines[j] != \"\")) {\n\t\t\t\t\ttrunk = lines[j].split(\" \");\n\n\t\t\t\t\tif (String(trunk[0]).charCodeAt(0) == 9 || String(trunk[0]).charCodeAt(0) == 32)\n\t\t\t\t\t\ttrunk[0] = trunk[0].substring(1, trunk[0].length);\n\n\t\t\t\t\tif (j == 0) {\n\t\t\t\t\t\tthis._lastMtlID = trunk.join(\"\");\n\t\t\t\t\t\tthis._lastMtlID = (this._lastMtlID == \"\")? \"def000\" : this._lastMtlID;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tswitch (trunk[0]) {\n\n\t\t\t\t\t\t\tcase \"Ka\":\n\t\t\t\t\t\t\t\tif (trunk[1] && !isNaN(Number(trunk[1])) && trunk[2] && !isNaN(Number(trunk[2])) && trunk[3] && !isNaN(Number(trunk[3])))\n\t\t\t\t\t\t\t\t\tcolor = trunk[1]*255 << 16 | trunk[2]*255 << 8 | trunk[3]*255;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase \"Ks\":\n\t\t\t\t\t\t\t\tif (trunk[1] && !isNaN(Number(trunk[1])) && trunk[2] && !isNaN(Number(trunk[2])) && trunk[3] && !isNaN(Number(trunk[3]))) {\n\t\t\t\t\t\t\t\t\tspecularColor = trunk[1]*255 << 16 | trunk[2]*255 << 8 | trunk[3]*255;\n\t\t\t\t\t\t\t\t\tuseSpecular = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase \"Ns\":\n\t\t\t\t\t\t\t\tif (trunk[1] && !isNaN(Number(trunk[1])))\n\t\t\t\t\t\t\t\t\tspecular = Number(trunk[1])*0.001;\n\t\t\t\t\t\t\t\tif (specular == 0)\n\t\t\t\t\t\t\t\t\tuseSpecular = false;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase \"Kd\":\n\t\t\t\t\t\t\t\tif (trunk[1] && !isNaN(Number(trunk[1])) && trunk[2] && !isNaN(Number(trunk[2])) && trunk[3] && !isNaN(Number(trunk[3]))) {\n\t\t\t\t\t\t\t\t\tdiffuseColor = trunk[1]*255 << 16 | trunk[2]*255 << 8 | trunk[3]*255;\n\t\t\t\t\t\t\t\t\tuseColor = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase \"tr\":\n\t\t\t\t\t\t\tcase \"d\":\n\t\t\t\t\t\t\t\tif (trunk[1] && !isNaN(Number(trunk[1])))\n\t\t\t\t\t\t\t\t\talpha = Number(trunk[1]);\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase \"map_Kd\":\n\t\t\t\t\t\t\t\tmapkd = this.parseMapKdString(trunk);\n\t\t\t\t\t\t\t\tmapkd = mapkd.replace(/\\\\/g, \"/\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (mapkd != \"\") {\n\n\t\t\t\tif (useSpecular) {\n\n\t\t\t\t\tbasicSpecularMethod = new SpecularBasicMethod();\n\t\t\t\t\tbasicSpecularMethod.color = specularColor;\n\t\t\t\t\tbasicSpecularMethod.strength = specular;\n\n\t\t\t\t\tvar specularData:SpecularData = new SpecularData();\n\t\t\t\t\tspecularData.alpha = alpha;\n\t\t\t\t\tspecularData.basicSpecularMethod = basicSpecularMethod;\n\t\t\t\t\tspecularData.materialID = this._lastMtlID;\n\n\t\t\t\t\tif (!this._materialSpecularData)\n\t\t\t\t\t\tthis._materialSpecularData = new Array<SpecularData>();\n\n\t\t\t\t\tthis._materialSpecularData.push(specularData);\n\n\t\t\t\t}\n\n\t\t\t\tthis._pAddDependency(this._lastMtlID, new URLRequest(mapkd));\n\n\t\t\t} else if (useColor && !isNaN(color)) {\n\n\t\t\t\tvar lm:LoadedMaterial = new LoadedMaterial();\n\t\t\t\tlm.materialID = this._lastMtlID;\n\n\t\t\t\tif (alpha == 0)\n\t\t\t\t\tconsole.log(\"Warning: an alpha value of 0 was found in mtl color tag (Tr or d) ref:\" + this._lastMtlID + \", mesh(es) using it will be invisible!\");\n\n\t\t\t\tvar cm:MethodMaterial = new MethodMaterial(color);\n\n\t\t\t\tif (this.materialMode < 2) {\n\t\t\t\t\tcm.alpha = alpha;\n\t\t\t\t} else {\n\t\t\t\t\tcm.mode = MethodMaterialMode.MULTI_PASS;\n\t\t\t\t}\n\n\t\t\t\tcm.diffuseMethod.color = diffuseColor;\n\n\t\t\t\tif (useSpecular) {\n\t\t\t\t\tcm.specularMethod.color = specularColor;\n\t\t\t\t\tcm.specularMethod.strength = specular;\n\t\t\t\t}\n\n\t\t\t\tlm.cm = cm;\n\n\t\t\t\tthis._materialLoaded.push(lm);\n\n\t\t\t\tif (this._meshes.length > 0)\n\t\t\t\t\tthis.applyMaterial(lm);\n\n\t\t\t}\n\t\t}\n\n\t\tthis._mtlLibLoaded = true;\n\t}\n\n\tprivate parseMapKdString(trunk):string\n\t{\n\t\tvar url:string = \"\";\n\t\tvar i:number;\n\t\tvar breakflag:boolean;\n\n\t\tfor (i = 1; i < trunk.length;) {\n\t\t\tswitch (trunk[i]) {\n\t\t\t\tcase \"-blendu\":\n\t\t\t\tcase \"-blendv\":\n\t\t\t\tcase \"-cc\":\n\t\t\t\tcase \"-clamp\":\n\t\t\t\tcase \"-texres\":\n\t\t\t\t\ti += 2; //Skip ahead 1 attribute\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"-mm\":\n\t\t\t\t\ti += 3; //Skip ahead 2 attributes\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"-o\":\n\t\t\t\tcase \"-s\":\n\t\t\t\tcase \"-t\":\n\t\t\t\t\ti += 4; //Skip ahead 3 attributes\n\t\t\t\t\tcontinue;\n\t\t\t\tdefault:\n\t\t\t\t\tbreakflag = true;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (breakflag)\n\t\t\t\tbreak;\n\t\t}\n\n\t\t//Reconstruct URL/filename\n\t\tfor (i; i < trunk.length; i++) {\n\t\t\turl += trunk[i];\n\t\t\turl += \" \";\n\t\t}\n\n\t\t//Remove the extraneous space and/or newline from the right side\n\t\turl = url.replace(/\\s+$/, \"\");\n\n\t\treturn url;\n\t}\n\n\tprivate loadMtl(mtlurl:string)\n\t{\n\t\t// Add raw-data dependency to queue and load dependencies now,\n\t\t// which will pause the parsing in the meantime.\n\t\tthis._pAddDependency('mtl', new URLRequest(mtlurl), true);\n\t\tthis._pPauseAndRetrieveDependencies();//\n\t}\n\n\tprivate applyMaterial(lm:LoadedMaterial)\n\t{\n\t\tvar decomposeID;\n\t\tvar mesh:Mesh;\n\t\tvar tm:MethodMaterial;\n\t\tvar j:number;\n\t\tvar specularData:SpecularData;\n\n\t\tfor (var i:number = 0; i < this._meshes.length; ++i) {\n\t\t\tmesh = this._meshes[i];\n\t\t\tdecomposeID = mesh.material.name.split(\"~\");\n\n\t\t\tif (decomposeID[0] == lm.materialID) {\n\n\t\t\t\tif (lm.cm) {\n\t\t\t\t\tif (mesh.material)\n\t\t\t\t\t\tmesh.material = null;\n\t\t\t\t\tmesh.material = lm.cm;\n\n\t\t\t\t} else if (lm.texture) {\n\t\t\t\t\ttm = <MethodMaterial > mesh.material;\n\n\t\t\t\t\ttm.ambientMethod.texture = lm.texture;\n\t\t\t\t\ttm.style.color = lm.color;\n\t\t\t\t\ttm.alpha = lm.alpha;\n\t\t\t\t\ttm.style.sampler = new Sampler2D(true);\n\n\t\t\t\t\tif (this.materialMode < 2) // if materialMode is 0 or 1, we create a SinglePass\n\t\t\t\t\t\ttm.alpha = lm.alpha;\n\t\t\t\t\telse\n\t\t\t\t\t\ttm.mode = MethodMaterialMode.MULTI_PASS;\n\n\t\t\t\t\tif (lm.specularMethod) {\n\n\t\t\t\t\t\t// By setting the specularMethod property to null before assigning\n\t\t\t\t\t\t// the actual method instance, we avoid having the properties of\n\t\t\t\t\t\t// the new method being overridden with the settings from the old\n\t\t\t\t\t\t// one, which is default behavior of the setter.\n\t\t\t\t\t\ttm.specularMethod = null;\n\t\t\t\t\t\ttm.specularMethod = lm.specularMethod;\n\n\t\t\t\t\t} else if (this._materialSpecularData) {\n\n\t\t\t\t\t\tfor (j = 0; j < this._materialSpecularData.length; ++j) {\n\t\t\t\t\t\t\tspecularData = this._materialSpecularData[j];\n\n\t\t\t\t\t\t\tif (specularData.materialID == lm.materialID) {\n\t\t\t\t\t\t\t\ttm.specularMethod = null; // Prevent property overwrite (see above)\n\t\t\t\t\t\t\t\ttm.specularMethod = specularData.basicSpecularMethod;\n\t\t\t\t\t\t\t\ttm.specularMethod.color = specularData.color;\n\t\t\t\t\t\t\t\ttm.specularMethod.strength = specularData.alpha;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tmesh.material.name = decomposeID[1]? decomposeID[1] : decomposeID[0];\n\t\t\t\tthis._meshes.splice(i, 1);\n\t\t\t\t--i;\n\t\t\t}\n\t\t}\n\n\t\tif (lm.cm || tm)\n\t\t\tthis._pFinalizeAsset(lm.cm || tm);\n\t}\n\n\tprivate applyMaterials()\n\t{\n\t\tif (this._materialLoaded.length == 0)\n\t\t\treturn;\n\n\t\tfor (var i:number = 0; i < this._materialLoaded.length; ++i)\n\t\t\tthis.applyMaterial(this._materialLoaded[i]);\n\t}\n}\n\nexport = OBJParser;\n\nclass ObjectGroup\n{\n\tpublic name:string;\n\tpublic groups:Group[] = new Array<Group>();\n}\n\nclass Group\n{\n\tpublic name:string;\n\tpublic materialID:string;\n\tpublic materialGroups:MaterialGroup[] = new Array<MaterialGroup>();\n}\n\nclass MaterialGroup\n{\n\tpublic url:string;\n\tpublic faces:FaceData[] = new Array<FaceData>();\n}\n\nclass SpecularData\n{\n\tpublic materialID:string;\n\tpublic basicSpecularMethod:SpecularBasicMethod;\n\tpublic color:number = 0xFFFFFF;\n\tpublic alpha:number = 1;\n}\n\nclass LoadedMaterial\n{\n\tpublic materialID:string;\n\tpublic texture:Single2DTexture;\n\tpublic cm:MaterialBase;\n\tpublic specularMethod:SpecularBasicMethod;\n\tpublic color:number = 0xFFFFFF;\n\tpublic alpha:number = 1;\n}\n\nclass FaceData\n{\n\tpublic vertexIndices:Array<number> /*uint*/ = new Array<number>();\n\tpublic uvIndices:Array<number> /*uint*/ = new Array<number>();\n\tpublic normalIndices:Array<number> /*uint*/ = new Array<number>();\n\tpublic indexIds:string[] = new Array<string>(); // used for real index lookups\n}\n\n/**\n* Texture coordinates value object.\n*/\nclass UV\n{\n\tprivate _u:number;\n\tprivate _v:number;\n\n\t/**\n\t * Creates a new <code>UV</code> object.\n\t *\n\t * @param    u        [optional]    The horizontal coordinate of the texture value. Defaults to 0.\n\t * @param    v        [optional]    The vertical coordinate of the texture value. Defaults to 0.\n\t */\n\tconstructor(u:number = 0, v:number = 0)\n\t{\n\t\tthis._u = u;\n\t\tthis._v = v;\n\t}\n\n\t/**\n\t * Defines the vertical coordinate of the texture value.\n\t */\n\tpublic get v():number\n\t{\n\t\treturn this._v;\n\t}\n\n\tpublic set v(value:number)\n\t{\n\t\tthis._v = value;\n\t}\n\n\t/**\n\t * Defines the horizontal coordinate of the texture value.\n\t */\n\tpublic get u():number\n\t{\n\t\treturn this._u;\n\t}\n\n\tpublic set u(value:number)\n\t{\n\t\tthis._u = value;\n\t}\n\n\t/**\n\t * returns a new UV value Object\n\t */\n\tpublic clone():UV\n\t{\n\t\treturn new UV(this._u, this._v);\n\t}\n\n\t/**\n\t * returns the value object as a string for trace/debug purpose\n\t */\n\tpublic toString():string\n\t{\n\t\treturn this._u + \",\" + this._v;\n\t}\n}\n\nclass Vertex\n{\n\tprivate _x:number;\n\tprivate _y:number;\n\tprivate _z:number;\n\tprivate _index:number;\n\n\t/**\n\t * Creates a new <code>Vertex</code> value object.\n\t *\n\t * @param    x            [optional]    The x value. Defaults to 0.\n\t * @param    y            [optional]    The y value. Defaults to 0.\n\t * @param    z            [optional]    The z value. Defaults to 0.\n\t * @param    index        [optional]    The index value. Defaults is NaN.\n\t */\n\tconstructor(x:number = 0, y:number = 0, z:number = 0, index:number = 0)\n\t{\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._z = z;\n\t\tthis._index = index;\n\t}\n\n\t/**\n\t * To define/store the index of value object\n\t * @param    ind        The index\n\t */\n\tpublic set index(ind:number)\n\t{\n\t\tthis._index = ind;\n\t}\n\n\tpublic get index():number\n\t{\n\t\treturn this._index;\n\t}\n\n\t/**\n\t * To define/store the x value of the value object\n\t * @param    value        The x value\n\t */\n\tpublic get x():number\n\t{\n\t\treturn this._x;\n\t}\n\n\tpublic set x(value:number)\n\t{\n\t\tthis._x = value;\n\t}\n\n\t/**\n\t * To define/store the y value of the value object\n\t * @param    value        The y value\n\t */\n\tpublic get y():number\n\t{\n\t\treturn this._y;\n\t}\n\n\tpublic set y(value:number)\n\t{\n\t\tthis._y = value;\n\t}\n\n\t/**\n\t * To define/store the z value of the value object\n\t * @param    value        The z value\n\t */\n\tpublic get z():number\n\t{\n\t\treturn this._z;\n\t}\n\n\tpublic set z(value:number)\n\t{\n\t\tthis._z = value;\n\t}\n\n\t/**\n\t * returns a new Vertex value Object\n\t */\n\tpublic clone():Vertex\n\t{\n\t\treturn new Vertex(this._x, this._y, this._z);\n\t}\n}",
    "import Loader\t\t\t\t\t\t\t= require(\"awayjs-core/lib/library/Loader\");\n\nimport AWDParser\t\t\t\t\t\t= require(\"awayjs-parsers/lib/AWDParser\");\nimport Max3DSParser\t\t\t\t\t\t= require(\"awayjs-parsers/lib/Max3DSParser\");\nimport MD2Parser\t\t\t\t\t\t= require(\"awayjs-parsers/lib/MD2Parser\");\nimport OBJParser\t\t\t\t\t\t= require(\"awayjs-parsers/lib/OBJParser\");\n\n/**\n *\n */\nclass Parsers\n{\n\t/**\n\t * A list of all parsers that come bundled with Away3D. Use this to quickly\n\t * enable support for all bundled parsers to the file format auto-detection\n\t * feature, using any of the enableParsers() methods on loaders, e.g.:\n\t *\n\t * <code>AssetLibrary.enableParsers(Parsers.ALL_BUNDLED);</code>\n\t *\n\t * Beware however that this requires all parser classes to be included in the\n\t * SWF file, which will add 50-100 kb to the file. When only a limited set of\n\t * file formats are used, SWF file size can be saved by adding the parsers\n\t * individually using AssetLibrary.enableParser()\n\t *\n\t * A third way is to specify a parser for each loaded file, thereby bypassing\n\t * the auto-detection mechanisms altogether, while at the same time allowing\n\t * any properties that are unique to that parser to be set for that load.\n\t *\n\t * The bundled parsers are:\n\t *\n\t * <ul>\n\t * <li>AC3D (.ac)</li>\n\t * <li>Away Data version 1 ASCII and version 2 binary (.awd). AWD1 BSP unsupported</li>\n\t * <li>3DMax (.3ds)</li>\n\t * <li>DXF (.dxf)</li>\n\t * <li>Quake 2 MD2 models (.md2)</li>\n\t * <li>Doom 3 MD5 animation clips (.md5anim)</li>\n\t * <li>Doom 3 MD5 meshes (.md5mesh)</li>\n\t * <li>Wavefront OBJ (.obj)</li>\n\t * <li>Collada (.dae)</li>\n\t * <li>Images (.jpg, .png)</li>\n\t * </ul>\n\t *\n\t * @see away.library.AssetLibrary.enableParser\n\t */\n\tpublic static ALL_BUNDLED:Array<Object> = Array<Object>(AWDParser, Max3DSParser, MD2Parser, OBJParser);\n\n\t/**\n\t * Short-hand function to enable all bundled parsers for auto-detection. In practice,\n\t * this is the same as invoking enableParsers(Parsers.ALL_BUNDLED) on any of the\n\t * loader classes SingleFileLoader, LoaderSession, AssetLibrary or Loader3D.\n\t *\n\t * See notes about file size in the documentation for the ALL_BUNDLED constant.\n\t *\n\t * @see away.parsers.Parsers.ALL_BUNDLED\n\t */\n\tpublic static enableAllBundled():void\n\t{\n\t\tLoader.enableParsers(Parsers.ALL_BUNDLED);\n\t}\n}\n\nexport = Parsers;"
  ],
  "sourceRoot": ""
}