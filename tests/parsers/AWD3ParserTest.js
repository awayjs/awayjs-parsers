var AssetLibrary = require("awayjs-core/lib/library/AssetLibrary");
var AssetType = require("awayjs-core/lib/library/AssetType");
var AssetEvent = require("awayjs-core/lib/events/AssetEvent");
var URLRequest = require("awayjs-core/lib/net/URLRequest");
var LoaderEvent = require("awayjs-core/lib/events/LoaderEvent");
var OrthographicProjection = require("awayjs-core/lib/projections/OrthographicProjection");
var RequestAnimationFrame = require("awayjs-core/lib/utils/RequestAnimationFrame");
var View = require("awayjs-display/lib/containers/View");
var Loader = require("awayjs-display/lib/containers/Loader");
var DefaultRenderer = require("awayjs-renderergl/lib/DefaultRenderer");
var AWDParser = require("awayjs-parsers/lib/AWDParser");
var Partition2D = require("awayjs-player/lib/fl/partition/Partition2D");
var AWD3ParserTest = (function () {
    /**
     * Constructor
     */
    function AWD3ParserTest() {
        this._time = 0;
        this.init();
    }
    /**
     * Global initialise function
     */
    AWD3ParserTest.prototype.init = function () {
        this.initEngine();
        this.initObjects();
        this.initListeners();
    };
    /**
     * Initialise the engine
     */
    AWD3ParserTest.prototype.initEngine = function () {
        //create the view
        this._view = new View(new DefaultRenderer());
        this._view.backgroundColor = 0xffffff;
        //var bg_color_string:string = "#ff0000"//document.getElementById("bgColor").innerHTML);
        //this._view.backgroundColor = parseInt(bg_color_string.replace("#", "0x"));
        this._view.camera.projection = new OrthographicProjection(500);
        this._view.camera.projection.far = 500000;
        this._view.camera.projection.near = 0.1;
        this._view.camera.x = 0;
        this._view.camera.y = 0;
        this._view.camera.z = 300;
        this._view.camera.rotationX = -180;
        this._view.camera.rotationY = 0;
        this._view.camera.rotationZ = -180;
        //create custom lens
        // this._view.camera.projection = new OrthographicOffCenterProjection(0, 550, -400, 0);
        //  this._view.camera.projection.far = 500000;
        //  this._view.camera.projection.near = 0.1;
        /*
         //setup controller to be used on the camera
         this._cameraController = new HoverController(this._view.camera, null, 0, 0, 300, 10, 90);
         this._cameraController.lookAtPosition = new Vector3D(0, 50, 0);
         this._cameraController.tiltAngle = 0;
         this._cameraController.panAngle = 0;
         this._cameraController.minTiltAngle = 5;
         this._cameraController.maxTiltAngle = 60;
         this._cameraController.autoUpdate = false;
         */
    };
    /**
     * Initialise the scene objects
     */
    AWD3ParserTest.prototype.initObjects = function () {
        var _this = this;
        AssetLibrary.enableParser(AWDParser);
        //kickoff asset loading
        var loader = new Loader();
        loader.addEventListener(AssetEvent.ASSET_COMPLETE, function (event) { return _this.onAssetComplete(event); });
        loader.addEventListener(LoaderEvent.RESOURCE_COMPLETE, function (event) { return _this.onRessourceComplete(event); });
        //loader.load(new URLRequest(document.getElementById("awdPath").innerHTML));
        loader.load(new URLRequest("assets/AWD3/ScareCrow.awd"));
        //loader.load(new URLRequest("assets/AWD3/NestedTween.awd"));
        //loader.load(new URLRequest("assets/AWD3/SimpleShape.awd"));
        //loader.load(new URLRequest("assets/AWD3/ComplexShape.awd"));
        //loader.load(new URLRequest("assets/AWD3/Simple_mask_test.awd"));
    };
    /**
     * Initialise the listeners
     */
    AWD3ParserTest.prototype.initListeners = function () {
        var _this = this;
        window.onresize = function (event) { return _this.onResize(event); };
        document.onkeydown = function (event) { return _this.onKeyDown(event); };
        document.onmousedown = function (event) { return _this.onMouseDown(event); };
        document.onmouseup = function (event) { return _this.onMouseUp(event); };
        document.onmousemove = function (event) { return _this.onMouseMove(event); };
        document.onmousewheel = function (event) { return _this.onMouseWheel(event); };
        this.onResize();
        this._timer = new RequestAnimationFrame(this.onEnterFrame, this);
        this._timer.start();
    };
    /**
     * loader listener for asset complete events
     */
    AWD3ParserTest.prototype.onAssetComplete = function (event) {
        if (event.asset.assetType == AssetType.TIMELINE) {
            this._rootTimeLine = event.asset;
            this._rootTimeLine.partition = new Partition2D(this._rootTimeLine);
        }
    };
    /**
     * loader listener for asset complete events
     */
    AWD3ParserTest.prototype.onRessourceComplete = function (event) {
        if (this._rootTimeLine) {
            //console.log("LOADING A ROOT name = " + this._rootTimeLine.name + " duration=" + this._rootTimeLine.duration);
            this._view.scene.addChild(this._rootTimeLine);
        }
    };
    /**
     * Render loop
     */
    AWD3ParserTest.prototype.onEnterFrame = function (dt) {
        this._time += dt;
        //update camera controler
        // this._cameraController.update();
        if (this._rootTimeLine != undefined) {
            //console.log("RENDER = ");
            this._rootTimeLine.update(dt);
        }
        //console.log("RENDER = ");
        //update view
        this._view.render();
    };
    AWD3ParserTest.prototype.onKeyDown = function (event) {
        if (event.keyCode == 109) {
            var test = this._view.camera.projection;
            test.projectionHeight += 5;
        }
        else if (event.keyCode == 107) {
            var test = this._view.camera.projection;
            test.projectionHeight -= 5;
        }
    };
    AWD3ParserTest.prototype.onMouseDown = function (event) {
        /*  this._lastPanAngle = this._cameraController.panAngle;
         this._lastTiltAngle = this._cameraController.tiltAngle;
         this._move = true;*/
        this._lastMouseX = event.clientX;
        this._lastMouseY = event.clientY;
        this._move = true;
    };
    AWD3ParserTest.prototype.onMouseUp = function (event) {
        this._move = false;
    };
    AWD3ParserTest.prototype.onMouseMove = function (event) {
        if (this._move) {
            if (event.clientX > (this._lastMouseX + 10))
                this._view.camera.x += 10;
            else if (event.clientX > this._lastMouseX)
                this._view.camera.x++;
            else if (event.clientX < (this._lastMouseX - 10))
                this._view.camera.x -= 10;
            else if (event.clientX < this._lastMouseX)
                this._view.camera.x--;
            if (event.clientY > (this._lastMouseY + 10))
                this._view.camera.y += 10;
            else if (event.clientY > this._lastMouseY)
                this._view.camera.y++;
            else if (event.clientY < (this._lastMouseY - 10))
                this._view.camera.y -= 10;
            else if (event.clientY < this._lastMouseY)
                this._view.camera.y--;
            this._lastMouseX = event.clientX;
            this._lastMouseY = event.clientY;
        }
    };
    AWD3ParserTest.prototype.onMouseWheel = function (event) {
        /* this._cameraController.distance -= event.wheelDelta * 5;

         if (this._cameraController.distance < 100) {
         this._cameraController.distance = 100;
         } else if (this._cameraController.distance > 2000) {
         this._cameraController.distance = 2000;
         }
         */
    };
    AWD3ParserTest.prototype.onResize = function (event) {
        if (event === void 0) { event = null; }
        this._view.y = 0;
        this._view.x = 0;
        this._view.width = window.innerWidth;
        this._view.height = window.innerHeight;
    };
    return AWD3ParserTest;
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBhcnNlcnMvQVdEM1BhcnNlclRlc3QudHMiXSwibmFtZXMiOlsiQVdEM1BhcnNlclRlc3QiLCJBV0QzUGFyc2VyVGVzdC5jb25zdHJ1Y3RvciIsIkFXRDNQYXJzZXJUZXN0LmluaXQiLCJBV0QzUGFyc2VyVGVzdC5pbml0RW5naW5lIiwiQVdEM1BhcnNlclRlc3QuaW5pdE9iamVjdHMiLCJBV0QzUGFyc2VyVGVzdC5pbml0TGlzdGVuZXJzIiwiQVdEM1BhcnNlclRlc3Qub25Bc3NldENvbXBsZXRlIiwiQVdEM1BhcnNlclRlc3Qub25SZXNzb3VyY2VDb21wbGV0ZSIsIkFXRDNQYXJzZXJUZXN0Lm9uRW50ZXJGcmFtZSIsIkFXRDNQYXJzZXJUZXN0Lm9uS2V5RG93biIsIkFXRDNQYXJzZXJUZXN0Lm9uTW91c2VEb3duIiwiQVdEM1BhcnNlclRlc3Qub25Nb3VzZVVwIiwiQVdEM1BhcnNlclRlc3Qub25Nb3VzZU1vdmUiLCJBV0QzUGFyc2VyVGVzdC5vbk1vdXNlV2hlZWwiLCJBV0QzUGFyc2VyVGVzdC5vblJlc2l6ZSJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBTyxZQUFZLFdBQWUsc0NBQXNDLENBQUMsQ0FBQztBQUMxRSxJQUFPLFNBQVMsV0FBZSxtQ0FBbUMsQ0FBQyxDQUFDO0FBQ3BFLElBQU8sVUFBVSxXQUFlLG1DQUFtQyxDQUFDLENBQUM7QUFDckUsSUFBTyxVQUFVLFdBQWUsZ0NBQWdDLENBQUMsQ0FBQztBQUNsRSxJQUFPLFdBQVcsV0FBZSxvQ0FBb0MsQ0FBQyxDQUFDO0FBR3ZFLElBQU8sc0JBQXNCLFdBQVksb0RBQW9ELENBQUMsQ0FBQztBQUUvRixJQUFPLHFCQUFxQixXQUFZLDZDQUE2QyxDQUFDLENBQUM7QUFFdkYsSUFBTyxJQUFJLFdBQWlCLG9DQUFvQyxDQUFDLENBQUM7QUFLbEUsSUFBTyxNQUFNLFdBQWdCLHNDQUFzQyxDQUFDLENBQUM7QUFJckUsSUFBTyxlQUFlLFdBQWMsdUNBQXVDLENBQUMsQ0FBQztBQUs3RSxJQUFPLFNBQVMs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QkEsS0FBS0E7UUFFdEJXLElBQUlBLENBQUNBLEtBQUtBLEdBQUdBLEtBQUtBLENBQUNBO0lBQ3BCQSxDQUFDQTtJQUVPWCxvQ0FBV0EsR0FBbkJBLFVBQW9CQSxLQUFLQTtRQUV4QlksRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDaEJBLEVBQUVBLENBQUNBLENBQUVBLEtBQUtBLENBQUNBLE9BQU9BLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBO2dCQUN4Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsSUFBRUEsRUFBRUEsQ0FBQ0E7WUFDekJBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUVBLEtBQUtBLENBQUNBLE9BQU9BLEdBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBO2dCQUN4Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0E7WUFDdkJBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUVBLEtBQUtBLENBQUNBLE9BQU9BLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBO2dCQUM3Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsSUFBRUEsRUFBRUEsQ0FBQ0E7WUFDekJBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUVBLEtBQUtBLENBQUNBLE9BQU9BLEdBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBO2dCQUN4Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0E7WUFDdkJBLEVBQUVBLENBQUNBLENBQUVBLEtBQUtBLENBQUNBLE9BQU9BLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBO2dCQUN4Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsSUFBRUEsRUFBRUEsQ0FBQ0E7WUFDekJBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUVBLEtBQUtBLENBQUNBLE9BQU9BLEdBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBO2dCQUN4Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0E7WUFDdkJBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUVBLEtBQUtBLENBQUNBLE9BQU9BLEdBQUNBLENBQUNBLElBQUlBLENBQUNBLFdBQVdBLEdBQUNBLEVBQUVBLENBQUNBLENBQUNBO2dCQUM3Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsSUFBRUEsRUFBRUEsQ0FBQ0E7WUFDekJBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUVBLEtBQUtBLENBQUNBLE9BQU9BLEdBQUNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBO2dCQUN4Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0E7WUFDdkJBLElBQUlBLENBQUNBLFdBQVdBLEdBQUdBLEtBQUtBLENBQUNBLE9BQU9BLENBQUNBO1lBQ2pDQSxJQUFJQSxDQUFDQSxXQUFXQSxHQUFHQSxLQUFLQSxDQUFDQSxPQUFPQSxDQUFDQTtRQUdsQ0EsQ0FBQ0E7SUFDRkEsQ0FBQ0E7SUFFT1oscUNBQVlBLEdBQXBCQSxVQUFxQkEsS0FBS0E7UUFHekJhOzs7Ozs7O1dBT0dBO0lBQ0pBLENBQUNBO0lBRU9iLGlDQUFRQSxHQUFoQkEsVUFBaUJBLEtBQVlBO1FBQVpjLHFCQUFZQSxHQUFaQSxZQUFZQTtRQUU1QkEsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0EsR0FBV0EsQ0FBQ0EsQ0FBQ0E7UUFDekJBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLENBQUNBLEdBQVdBLENBQUNBLENBQUNBO1FBQ3pCQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxLQUFLQSxHQUFPQSxNQUFNQSxDQUFDQSxVQUFVQSxDQUFDQTtRQUN6Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsTUFBTUEsR0FBTUEsTUFBTUEsQ0FBQ0EsV0FBV0EsQ0FBQ0E7SUFDM0NBLENBQUNBO0lBRUZkLHFCQUFDQTtBQUFEQSxDQWpPQSxBQWlPQ0EsSUFBQSIsImZpbGUiOiJwYXJzZXJzL0FXRDNQYXJzZXJUZXN0LmpzIiwic291cmNlUm9vdCI6Ii4vdGVzdHMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXNzZXRMaWJyYXJ5XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9saWJyYXJ5L0Fzc2V0TGlicmFyeVwiKTtcclxuaW1wb3J0IEFzc2V0VHlwZVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvbGlicmFyeS9Bc3NldFR5cGVcIik7XHJcbmltcG9ydCBBc3NldEV2ZW50XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9ldmVudHMvQXNzZXRFdmVudFwiKTtcclxuaW1wb3J0IFVSTFJlcXVlc3RcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxSZXF1ZXN0XCIpO1xyXG5pbXBvcnQgTG9hZGVyRXZlbnRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2V2ZW50cy9Mb2FkZXJFdmVudFwiKTtcclxuaW1wb3J0IFZlY3RvcjNEXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2dlb20vVmVjdG9yM0RcIik7XHJcbmltcG9ydCBPcnRob2dyYXBoaWNPZmZDZW50ZXJQcm9qZWN0aW9uXHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9wcm9qZWN0aW9ucy9PcnRob2dyYXBoaWNPZmZDZW50ZXJQcm9qZWN0aW9uXCIpO1xyXG5pbXBvcnQgT3J0aG9ncmFwaGljUHJvamVjdGlvblx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvcHJvamVjdGlvbnMvT3J0aG9ncmFwaGljUHJvamVjdGlvblwiKTtcclxuaW1wb3J0IEtleWJvYXJkXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL3VpL0tleWJvYXJkXCIpO1xyXG5pbXBvcnQgUmVxdWVzdEFuaW1hdGlvbkZyYW1lXHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi91dGlscy9SZXF1ZXN0QW5pbWF0aW9uRnJhbWVcIik7XHJcblxyXG5pbXBvcnQgVmlld1x0XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2NvbnRhaW5lcnMvVmlld1wiKTtcclxuaW1wb3J0IE1lc2hcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy9NZXNoXCIpO1xyXG5pbXBvcnQgQ29udGFpbmVyXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9jb250YWluZXJzL0Rpc3BsYXlPYmplY3RDb250YWluZXJcIik7XHJcbmltcG9ydCBHZW9tZXRyeVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9iYXNlL0dlb21ldHJ5XCIpO1xyXG5pbXBvcnQgSG92ZXJDb250cm9sbGVyXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvY29udHJvbGxlcnMvSG92ZXJDb250cm9sbGVyXCIpO1xyXG5pbXBvcnQgTG9hZGVyXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2NvbnRhaW5lcnMvTG9hZGVyXCIpO1xyXG5pbXBvcnQgQ29sb3JNYXRlcmlhbFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL21hdGVyaWFscy9CYXNpY01hdGVyaWFsXCIpO1xyXG5pbXBvcnQgUHJpbWl0aXZlQ3ViZVByZWZhYlx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9wcmVmYWJzL1ByaW1pdGl2ZUN1YmVQcmVmYWJcIik7XHJcblxyXG5pbXBvcnQgRGVmYXVsdFJlbmRlcmVyXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvRGVmYXVsdFJlbmRlcmVyXCIpO1xyXG5cclxuaW1wb3J0IE1ldGhvZE1hdGVyaWFsXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9NZXRob2RNYXRlcmlhbFwiKTtcclxuaW1wb3J0IE1ldGhvZFJlbmRlcmVyUG9vbFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL3Bvb2wvTWV0aG9kUmVuZGVyZXJQb29sXCIpO1xyXG5cclxuaW1wb3J0IEFXRFBhcnNlclx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcGFyc2Vycy9saWIvQVdEUGFyc2VyXCIpO1xyXG5pbXBvcnQgTW92aWVDbGlwXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1wbGF5ZXIvbGliL2ZsL2Rpc3BsYXkvTW92aWVDbGlwXCIpO1xyXG5pbXBvcnQgUGFydGl0aW9uMkRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXBsYXllci9saWIvZmwvcGFydGl0aW9uL1BhcnRpdGlvbjJEXCIpO1xyXG5cclxuY2xhc3MgQVdEM1BhcnNlclRlc3Rcclxue1xyXG5cdC8vZW5naW5lIHZhcmlhYmxlc1xyXG5cdHByaXZhdGUgX3ZpZXc6IFZpZXc7XHJcblxyXG5cdHByaXZhdGUgX3Jvb3RUaW1lTGluZTogTW92aWVDbGlwO1xyXG5cclxuXHRwcml2YXRlIF90aW1lcjogUmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xyXG5cdHByaXZhdGUgX3RpbWU6IG51bWJlciA9IDA7XHJcblxyXG5cdC8vbmF2aWdhdGlvblxyXG5cdHByaXZhdGUgX2xhc3RNb3VzZVg6IG51bWJlcjtcclxuXHRwcml2YXRlIF9sYXN0TW91c2VZOiBudW1iZXI7XHJcblx0cHJpdmF0ZSBfbW92ZTogYm9vbGVhbjtcclxuXHJcblx0LyoqXHJcblx0ICogQ29uc3RydWN0b3JcclxuXHQgKi9cclxuXHRjb25zdHJ1Y3RvcigpXHJcblx0e1xyXG5cdFx0dGhpcy5pbml0KCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBHbG9iYWwgaW5pdGlhbGlzZSBmdW5jdGlvblxyXG5cdCAqL1xyXG5cclxuXHRwcml2YXRlIGluaXQoKTogdm9pZFxyXG5cdHtcclxuXHRcdHRoaXMuaW5pdEVuZ2luZSgpO1xyXG5cdFx0dGhpcy5pbml0T2JqZWN0cygpO1xyXG5cdFx0dGhpcy5pbml0TGlzdGVuZXJzKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBJbml0aWFsaXNlIHRoZSBlbmdpbmVcclxuXHQgKi9cclxuXHRwcml2YXRlIGluaXRFbmdpbmUoKTogdm9pZFxyXG5cdHtcclxuXHRcdC8vY3JlYXRlIHRoZSB2aWV3XHJcblx0XHR0aGlzLl92aWV3ID0gbmV3IFZpZXcobmV3IERlZmF1bHRSZW5kZXJlcigpKTtcclxuXHRcdHRoaXMuX3ZpZXcuYmFja2dyb3VuZENvbG9yID0gMHhmZmZmZmY7XHJcblx0XHQvL3ZhciBiZ19jb2xvcl9zdHJpbmc6c3RyaW5nID0gXCIjZmYwMDAwXCIvL2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmdDb2xvclwiKS5pbm5lckhUTUwpO1xyXG5cdFx0Ly90aGlzLl92aWV3LmJhY2tncm91bmRDb2xvciA9IHBhcnNlSW50KGJnX2NvbG9yX3N0cmluZy5yZXBsYWNlKFwiI1wiLCBcIjB4XCIpKTtcclxuXHJcblx0XHR0aGlzLl92aWV3LmNhbWVyYS5wcm9qZWN0aW9uID0gbmV3IE9ydGhvZ3JhcGhpY1Byb2plY3Rpb24oNTAwKTtcclxuXHRcdHRoaXMuX3ZpZXcuY2FtZXJhLnByb2plY3Rpb24uZmFyID0gNTAwMDAwO1xyXG5cdFx0dGhpcy5fdmlldy5jYW1lcmEucHJvamVjdGlvbi5uZWFyID0gMC4xO1xyXG5cdFx0dGhpcy5fdmlldy5jYW1lcmEueD0wO1xyXG5cdFx0dGhpcy5fdmlldy5jYW1lcmEueT0wO1xyXG5cdFx0dGhpcy5fdmlldy5jYW1lcmEuej0zMDA7XHJcblx0XHR0aGlzLl92aWV3LmNhbWVyYS5yb3RhdGlvblg9LTE4MDtcclxuXHRcdHRoaXMuX3ZpZXcuY2FtZXJhLnJvdGF0aW9uWT0wO1xyXG5cdFx0dGhpcy5fdmlldy5jYW1lcmEucm90YXRpb25aPS0xODA7XHJcblx0XHQvL2NyZWF0ZSBjdXN0b20gbGVuc1xyXG5cdFx0Ly8gdGhpcy5fdmlldy5jYW1lcmEucHJvamVjdGlvbiA9IG5ldyBPcnRob2dyYXBoaWNPZmZDZW50ZXJQcm9qZWN0aW9uKDAsIDU1MCwgLTQwMCwgMCk7XHJcblx0XHQvLyAgdGhpcy5fdmlldy5jYW1lcmEucHJvamVjdGlvbi5mYXIgPSA1MDAwMDA7XHJcblx0XHQvLyAgdGhpcy5fdmlldy5jYW1lcmEucHJvamVjdGlvbi5uZWFyID0gMC4xO1xyXG5cclxuXHRcdC8qXHJcblx0XHQgLy9zZXR1cCBjb250cm9sbGVyIHRvIGJlIHVzZWQgb24gdGhlIGNhbWVyYVxyXG5cdFx0IHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIgPSBuZXcgSG92ZXJDb250cm9sbGVyKHRoaXMuX3ZpZXcuY2FtZXJhLCBudWxsLCAwLCAwLCAzMDAsIDEwLCA5MCk7XHJcblx0XHQgdGhpcy5fY2FtZXJhQ29udHJvbGxlci5sb29rQXRQb3NpdGlvbiA9IG5ldyBWZWN0b3IzRCgwLCA1MCwgMCk7XHJcblx0XHQgdGhpcy5fY2FtZXJhQ29udHJvbGxlci50aWx0QW5nbGUgPSAwO1xyXG5cdFx0IHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIucGFuQW5nbGUgPSAwO1xyXG5cdFx0IHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIubWluVGlsdEFuZ2xlID0gNTtcclxuXHRcdCB0aGlzLl9jYW1lcmFDb250cm9sbGVyLm1heFRpbHRBbmdsZSA9IDYwO1xyXG5cdFx0IHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIuYXV0b1VwZGF0ZSA9IGZhbHNlO1xyXG5cdFx0ICovXHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBJbml0aWFsaXNlIHRoZSBzY2VuZSBvYmplY3RzXHJcblx0ICovXHJcblx0cHJpdmF0ZSBpbml0T2JqZWN0cygpOiB2b2lkXHJcblx0e1xyXG5cdFx0QXNzZXRMaWJyYXJ5LmVuYWJsZVBhcnNlcihBV0RQYXJzZXIpO1xyXG5cclxuXHRcdC8va2lja29mZiBhc3NldCBsb2FkaW5nXHJcblx0XHR2YXIgbG9hZGVyOkxvYWRlciA9IG5ldyBMb2FkZXIoKTtcclxuXHRcdGxvYWRlci5hZGRFdmVudExpc3RlbmVyKEFzc2V0RXZlbnQuQVNTRVRfQ09NUExFVEUsIChldmVudDogQXNzZXRFdmVudCkgPT4gdGhpcy5vbkFzc2V0Q29tcGxldGUoZXZlbnQpKTtcclxuXHRcdGxvYWRlci5hZGRFdmVudExpc3RlbmVyKExvYWRlckV2ZW50LlJFU09VUkNFX0NPTVBMRVRFLCAoZXZlbnQ6IExvYWRlckV2ZW50KSA9PiB0aGlzLm9uUmVzc291cmNlQ29tcGxldGUoZXZlbnQpKTtcclxuXHJcblxyXG5cdFx0Ly9sb2FkZXIubG9hZChuZXcgVVJMUmVxdWVzdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImF3ZFBhdGhcIikuaW5uZXJIVE1MKSk7XHJcblx0XHRsb2FkZXIubG9hZChuZXcgVVJMUmVxdWVzdChcImFzc2V0cy9BV0QzL1NjYXJlQ3Jvdy5hd2RcIikpO1xyXG5cdFx0Ly9sb2FkZXIubG9hZChuZXcgVVJMUmVxdWVzdChcImFzc2V0cy9BV0QzL05lc3RlZFR3ZWVuLmF3ZFwiKSk7XHJcblx0XHQvL2xvYWRlci5sb2FkKG5ldyBVUkxSZXF1ZXN0KFwiYXNzZXRzL0FXRDMvU2ltcGxlU2hhcGUuYXdkXCIpKTtcclxuXHRcdC8vbG9hZGVyLmxvYWQobmV3IFVSTFJlcXVlc3QoXCJhc3NldHMvQVdEMy9Db21wbGV4U2hhcGUuYXdkXCIpKTtcclxuXHRcdC8vbG9hZGVyLmxvYWQobmV3IFVSTFJlcXVlc3QoXCJhc3NldHMvQVdEMy9TaW1wbGVfbWFza190ZXN0LmF3ZFwiKSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBJbml0aWFsaXNlIHRoZSBsaXN0ZW5lcnNcclxuXHQgKi9cclxuXHRwcml2YXRlIGluaXRMaXN0ZW5lcnMoKTogdm9pZFxyXG5cdHtcclxuXHRcdHdpbmRvdy5vbnJlc2l6ZSAgPSAoZXZlbnQpID0+IHRoaXMub25SZXNpemUoZXZlbnQpO1xyXG5cclxuXHRcdGRvY3VtZW50Lm9ua2V5ZG93biA9IChldmVudCkgPT4gdGhpcy5vbktleURvd24oZXZlbnQpO1xyXG5cdFx0ZG9jdW1lbnQub25tb3VzZWRvd24gPSAoZXZlbnQpID0+IHRoaXMub25Nb3VzZURvd24oZXZlbnQpO1xyXG5cdFx0ZG9jdW1lbnQub25tb3VzZXVwID0gKGV2ZW50KSA9PiB0aGlzLm9uTW91c2VVcChldmVudCk7XHJcblx0XHRkb2N1bWVudC5vbm1vdXNlbW92ZSA9IChldmVudCkgPT4gdGhpcy5vbk1vdXNlTW92ZShldmVudCk7XHJcblx0XHRkb2N1bWVudC5vbm1vdXNld2hlZWwgPSAoZXZlbnQpID0+IHRoaXMub25Nb3VzZVdoZWVsKGV2ZW50KTtcclxuXHJcblx0XHR0aGlzLm9uUmVzaXplKCk7XHJcblxyXG5cdFx0dGhpcy5fdGltZXIgPSBuZXcgUmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMub25FbnRlckZyYW1lLCB0aGlzKTtcclxuXHRcdHRoaXMuX3RpbWVyLnN0YXJ0KCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBsb2FkZXIgbGlzdGVuZXIgZm9yIGFzc2V0IGNvbXBsZXRlIGV2ZW50c1xyXG5cdCAqL1xyXG5cdHByaXZhdGUgb25Bc3NldENvbXBsZXRlKGV2ZW50OiBBc3NldEV2ZW50KTogdm9pZFxyXG5cdHtcclxuXHRcdGlmKGV2ZW50LmFzc2V0LmFzc2V0VHlwZSA9PSBBc3NldFR5cGUuVElNRUxJTkUpIHtcclxuXHRcdFx0dGhpcy5fcm9vdFRpbWVMaW5lID0gPE1vdmllQ2xpcD4gZXZlbnQuYXNzZXQ7XHJcblx0XHRcdHRoaXMuX3Jvb3RUaW1lTGluZS5wYXJ0aXRpb24gPSBuZXcgUGFydGl0aW9uMkQodGhpcy5fcm9vdFRpbWVMaW5lKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIGxvYWRlciBsaXN0ZW5lciBmb3IgYXNzZXQgY29tcGxldGUgZXZlbnRzXHJcblx0ICovXHJcblx0cHJpdmF0ZSBvblJlc3NvdXJjZUNvbXBsZXRlKGV2ZW50OiBMb2FkZXJFdmVudCk6IHZvaWQge1xyXG5cdFx0aWYgKHRoaXMuX3Jvb3RUaW1lTGluZSkge1xyXG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiTE9BRElORyBBIFJPT1QgbmFtZSA9IFwiICsgdGhpcy5fcm9vdFRpbWVMaW5lLm5hbWUgKyBcIiBkdXJhdGlvbj1cIiArIHRoaXMuX3Jvb3RUaW1lTGluZS5kdXJhdGlvbik7XHJcblx0XHRcdHRoaXMuX3ZpZXcuc2NlbmUuYWRkQ2hpbGQodGhpcy5fcm9vdFRpbWVMaW5lKTtcclxuXHRcdFx0Ly8gYXV0b3BsYXkgbGlrZSBpbiBGbGFzaFxyXG5cdFx0XHQvL3RoaXMuX3Jvb3RUaW1lTGluZS5wbGF5KCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBSZW5kZXIgbG9vcFxyXG5cdCAqL1xyXG5cdHByaXZhdGUgb25FbnRlckZyYW1lKGR0OiBudW1iZXIpOiB2b2lkIHtcclxuXHRcdHRoaXMuX3RpbWUgKz0gZHQ7XHJcblxyXG5cdFx0Ly91cGRhdGUgY2FtZXJhIGNvbnRyb2xlclxyXG5cdFx0Ly8gdGhpcy5fY2FtZXJhQ29udHJvbGxlci51cGRhdGUoKTtcclxuXHJcblx0XHRpZiAodGhpcy5fcm9vdFRpbWVMaW5lICE9IHVuZGVmaW5lZCkge1xyXG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiUkVOREVSID0gXCIpO1xyXG5cdFx0XHR0aGlzLl9yb290VGltZUxpbmUudXBkYXRlKGR0KTtcclxuXHRcdH1cclxuXHRcdC8vY29uc29sZS5sb2coXCJSRU5ERVIgPSBcIik7XHJcblx0XHQvL3VwZGF0ZSB2aWV3XHJcblx0XHR0aGlzLl92aWV3LnJlbmRlcigpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBvbktleURvd24oZXZlbnQpOiB2b2lkIHtcclxuXHRcdGlmKGV2ZW50LmtleUNvZGU9PTEwOSl7XHJcblx0XHRcdHZhciB0ZXN0Ok9ydGhvZ3JhcGhpY1Byb2plY3Rpb24gPSA8T3J0aG9ncmFwaGljUHJvamVjdGlvbj4gdGhpcy5fdmlldy5jYW1lcmEucHJvamVjdGlvbjtcclxuXHRcdFx0dGVzdC5wcm9qZWN0aW9uSGVpZ2h0Kz01O1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZihldmVudC5rZXlDb2RlPT0xMDcpe1xyXG5cdFx0XHR2YXIgdGVzdDpPcnRob2dyYXBoaWNQcm9qZWN0aW9uID0gPE9ydGhvZ3JhcGhpY1Byb2plY3Rpb24+IHRoaXMuX3ZpZXcuY2FtZXJhLnByb2plY3Rpb247XHJcblx0XHRcdHRlc3QucHJvamVjdGlvbkhlaWdodC09NTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgb25Nb3VzZURvd24oZXZlbnQpOiB2b2lkXHJcblx0e1xyXG5cdFx0LyogIHRoaXMuX2xhc3RQYW5BbmdsZSA9IHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIucGFuQW5nbGU7XHJcblx0XHQgdGhpcy5fbGFzdFRpbHRBbmdsZSA9IHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIudGlsdEFuZ2xlO1xyXG5cdFx0IHRoaXMuX21vdmUgPSB0cnVlOyovXHJcblx0XHR0aGlzLl9sYXN0TW91c2VYID0gZXZlbnQuY2xpZW50WDtcclxuXHRcdHRoaXMuX2xhc3RNb3VzZVkgPSBldmVudC5jbGllbnRZO1xyXG5cdFx0dGhpcy5fbW92ZSA9IHRydWU7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIG9uTW91c2VVcChldmVudCk6IHZvaWRcclxuXHR7XHJcblx0XHR0aGlzLl9tb3ZlID0gZmFsc2U7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIG9uTW91c2VNb3ZlKGV2ZW50KVxyXG5cdHtcclxuXHRcdGlmICh0aGlzLl9tb3ZlKSB7XHJcblx0XHRcdGlmICggZXZlbnQuY2xpZW50WD4odGhpcy5fbGFzdE1vdXNlWCsxMCkpXHJcblx0XHRcdFx0dGhpcy5fdmlldy5jYW1lcmEueCs9MTA7XHJcblx0XHRcdGVsc2UgaWYgKCBldmVudC5jbGllbnRYPnRoaXMuX2xhc3RNb3VzZVgpXHJcblx0XHRcdFx0dGhpcy5fdmlldy5jYW1lcmEueCsrO1xyXG5cdFx0XHRlbHNlIGlmICggZXZlbnQuY2xpZW50WDwodGhpcy5fbGFzdE1vdXNlWC0xMCkpXHJcblx0XHRcdFx0dGhpcy5fdmlldy5jYW1lcmEueC09MTA7XHJcblx0XHRcdGVsc2UgaWYgKCBldmVudC5jbGllbnRYPHRoaXMuX2xhc3RNb3VzZVgpXHJcblx0XHRcdFx0dGhpcy5fdmlldy5jYW1lcmEueC0tO1xyXG5cdFx0XHRpZiAoIGV2ZW50LmNsaWVudFk+KHRoaXMuX2xhc3RNb3VzZVkrMTApKVxyXG5cdFx0XHRcdHRoaXMuX3ZpZXcuY2FtZXJhLnkrPTEwO1xyXG5cdFx0XHRlbHNlIGlmICggZXZlbnQuY2xpZW50WT50aGlzLl9sYXN0TW91c2VZKVxyXG5cdFx0XHRcdHRoaXMuX3ZpZXcuY2FtZXJhLnkrKztcclxuXHRcdFx0ZWxzZSBpZiAoIGV2ZW50LmNsaWVudFk8KHRoaXMuX2xhc3RNb3VzZVktMTApKVxyXG5cdFx0XHRcdHRoaXMuX3ZpZXcuY2FtZXJhLnktPTEwO1xyXG5cdFx0XHRlbHNlIGlmICggZXZlbnQuY2xpZW50WTx0aGlzLl9sYXN0TW91c2VZKVxyXG5cdFx0XHRcdHRoaXMuX3ZpZXcuY2FtZXJhLnktLTtcclxuXHRcdFx0dGhpcy5fbGFzdE1vdXNlWCA9IGV2ZW50LmNsaWVudFg7XHJcblx0XHRcdHRoaXMuX2xhc3RNb3VzZVkgPSBldmVudC5jbGllbnRZO1xyXG5cdFx0XHQvL3RoaXMuX2NhbWVyYUNvbnRyb2xsZXIucGFuQW5nbGUgPSAwLjMqKGV2ZW50LmNsaWVudFggLSB0aGlzLl9sYXN0TW91c2VYKSArIHRoaXMuX2xhc3RQYW5BbmdsZTtcclxuXHRcdFx0Ly90aGlzLl9jYW1lcmFDb250cm9sbGVyLnRpbHRBbmdsZSA9IDAuMyooZXZlbnQuY2xpZW50WSAtIHRoaXMuX2xhc3RNb3VzZVkpICsgdGhpcy5fbGFzdFRpbHRBbmdsZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgb25Nb3VzZVdoZWVsKGV2ZW50KTogdm9pZFxyXG5cdHtcclxuXHJcblx0XHQvKiB0aGlzLl9jYW1lcmFDb250cm9sbGVyLmRpc3RhbmNlIC09IGV2ZW50LndoZWVsRGVsdGEgKiA1O1xyXG5cclxuXHRcdCBpZiAodGhpcy5fY2FtZXJhQ29udHJvbGxlci5kaXN0YW5jZSA8IDEwMCkge1xyXG5cdFx0IHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIuZGlzdGFuY2UgPSAxMDA7XHJcblx0XHQgfSBlbHNlIGlmICh0aGlzLl9jYW1lcmFDb250cm9sbGVyLmRpc3RhbmNlID4gMjAwMCkge1xyXG5cdFx0IHRoaXMuX2NhbWVyYUNvbnRyb2xsZXIuZGlzdGFuY2UgPSAyMDAwO1xyXG5cdFx0IH1cclxuXHRcdCAqL1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBvblJlc2l6ZShldmVudCA9IG51bGwpOiB2b2lkXHJcblx0e1xyXG5cdFx0dGhpcy5fdmlldy55ICAgICAgICAgPSAwO1xyXG5cdFx0dGhpcy5fdmlldy54ICAgICAgICAgPSAwO1xyXG5cdFx0dGhpcy5fdmlldy53aWR0aCAgICAgPSB3aW5kb3cuaW5uZXJXaWR0aDtcclxuXHRcdHRoaXMuX3ZpZXcuaGVpZ2h0ICAgID0gd2luZG93LmlubmVySGVpZ2h0O1xyXG5cdH1cclxuXHJcbn1cclxuIl19